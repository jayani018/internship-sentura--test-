"use strict";var React=require("react"),ReactDOM=require("react-dom"),jsxRuntime=require("react/jsx-runtime");function _interopNamespaceDefault(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var React__namespace=_interopNamespaceDefault(React),ReactDOM__namespace=_interopNamespaceDefault(ReactDOM),LogLevel;class HttpError extends Error{constructor(e,t){const n=new.target.prototype;super(`${e}: Status code '${t}'`),this.statusCode=t,this.__proto__=n}}class TimeoutError extends Error{constructor(e="A timeout occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class AbortError extends Error{constructor(e="An abort occurred."){const t=new.target.prototype;super(e),this.__proto__=t}}class UnsupportedTransportError extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="UnsupportedTransportError",this.__proto__=n}}class DisabledTransportError extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="DisabledTransportError",this.__proto__=n}}class FailedToStartTransportError extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.transport=t,this.errorType="FailedToStartTransportError",this.__proto__=n}}class FailedToNegotiateWithServerError extends Error{constructor(e){const t=new.target.prototype;super(e),this.errorType="FailedToNegotiateWithServerError",this.__proto__=t}}class AggregateErrors extends Error{constructor(e,t){const n=new.target.prototype;super(e),this.innerErrors=t,this.__proto__=n}}class HttpResponse{constructor(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}class HttpClient{get(e,t){return this.send({...t,method:"GET",url:e})}post(e,t){return this.send({...t,method:"POST",url:e})}delete(e,t){return this.send({...t,method:"DELETE",url:e})}getCookieString(e){return""}}!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(LogLevel||(LogLevel={}));class NullLogger{constructor(){}log(e,t){}}NullLogger.instance=new NullLogger;const VERSION="7.0.14";class Arg{static isRequired(e,t){if(null==e)throw new Error(`The '${t}' argument is required.`)}static isNotEmpty(e,t){if(!e||e.match(/^\s*$/))throw new Error(`The '${t}' argument should not be empty.`)}static isIn(e,t,n){if(!(e in t))throw new Error(`Unknown ${n} value: ${e}.`)}}class Platform{static get isBrowser(){return"object"==typeof window&&"object"==typeof window.document}static get isWebWorker(){return"object"==typeof self&&"importScripts"in self}static get isReactNative(){return"object"==typeof window&&void 0===window.document}static get isNode(){return!this.isBrowser&&!this.isWebWorker&&!this.isReactNative}}function getDataDetail(e,t){let n="";return isArrayBuffer(e)?(n=`Binary data of length ${e.byteLength}`,t&&(n+=`. Content: '${formatArrayBuffer(e)}'`)):"string"==typeof e&&(n=`String data of length ${e.length}`,t&&(n+=`. Content: '${e}'`)),n}function formatArrayBuffer(e){const t=new Uint8Array(e);let n="";return t.forEach((e=>{n+=`0x${e<16?"0":""}${e.toString(16)} `})),n.substr(0,n.length-1)}function isArrayBuffer(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}async function sendMessage(e,t,n,i,r,s){const o={},[a,l]=getUserAgentHeader();o[a]=l,e.log(LogLevel.Trace,`(${t} transport) sending data. ${getDataDetail(r,s.logMessageContent)}.`);const c=isArrayBuffer(r)?"arraybuffer":"text",h=await n.post(i,{content:r,headers:{...o,...s.headers},responseType:c,timeout:s.timeout,withCredentials:s.withCredentials});e.log(LogLevel.Trace,`(${t} transport) request complete. Response status: ${h.statusCode}.`)}function createLogger(e){return void 0===e?new ConsoleLogger(LogLevel.Information):null===e?NullLogger.instance:void 0!==e.log?e:new ConsoleLogger(e)}class SubjectSubscription{constructor(e,t){this._subject=e,this._observer=t}dispose(){const e=this._subject.observers.indexOf(this._observer);e>-1&&this._subject.observers.splice(e,1),0===this._subject.observers.length&&this._subject.cancelCallback&&this._subject.cancelCallback().catch((e=>{}))}}class ConsoleLogger{constructor(e){this._minLevel=e,this.out=console}log(e,t){if(e>=this._minLevel){const n=`[${(new Date).toISOString()}] ${LogLevel[e]}: ${t}`;switch(e){case LogLevel.Critical:case LogLevel.Error:this.out.error(n);break;case LogLevel.Warning:this.out.warn(n);break;case LogLevel.Information:this.out.info(n);break;default:this.out.log(n)}}}}function getUserAgentHeader(){let e="X-SignalR-User-Agent";return Platform.isNode&&(e="User-Agent"),[e,constructUserAgent(VERSION,getOsName(),getRuntime(),getRuntimeVersion())]}function constructUserAgent(e,t,n,i){let r="Microsoft SignalR/";const s=e.split(".");return r+=`${s[0]}.${s[1]}`,r+=` (${e}; `,r+=t&&""!==t?`${t}; `:"Unknown OS; ",r+=`${n}`,r+=i?`; ${i}`:"; Unknown Runtime Version",r+=")",r}function getOsName(){if(!Platform.isNode)return"";switch(process.platform){case"win32":return"Windows NT";case"darwin":return"macOS";case"linux":return"Linux";default:return process.platform}}function getRuntimeVersion(){if(Platform.isNode)return process.versions.node}function getRuntime(){return Platform.isNode?"NodeJS":"Browser"}function getErrorString(e){return e.stack?e.stack:e.message?e.message:`${e}`}function getGlobalThis(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("could not find global")}class FetchHttpClient extends HttpClient{constructor(e){if(super(),this._logger=e,"undefined"==typeof fetch){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;this._jar=new(e("tough-cookie").CookieJar),this._fetchType=e("node-fetch"),this._fetchType=e("fetch-cookie")(this._fetchType,this._jar)}else this._fetchType=fetch.bind(getGlobalThis());if("undefined"==typeof AbortController){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;this._abortControllerType=e("abort-controller")}else this._abortControllerType=AbortController}async send(e){if(e.abortSignal&&e.abortSignal.aborted)throw new AbortError;if(!e.method)throw new Error("No method defined.");if(!e.url)throw new Error("No url defined.");const t=new this._abortControllerType;let n;e.abortSignal&&(e.abortSignal.onabort=()=>{t.abort(),n=new AbortError});let i,r=null;if(e.timeout){const i=e.timeout;r=setTimeout((()=>{t.abort(),this._logger.log(LogLevel.Warning,"Timeout from HTTP request."),n=new TimeoutError}),i)}""===e.content&&(e.content=void 0),e.content&&(e.headers=e.headers||{},isArrayBuffer(e.content)?e.headers["Content-Type"]="application/octet-stream":e.headers["Content-Type"]="text/plain;charset=UTF-8");try{i=await this._fetchType(e.url,{body:e.content,cache:"no-cache",credentials:!0===e.withCredentials?"include":"same-origin",headers:{"X-Requested-With":"XMLHttpRequest",...e.headers},method:e.method,mode:"cors",redirect:"follow",signal:t.signal})}catch(e){if(n)throw n;throw this._logger.log(LogLevel.Warning,`Error from HTTP request. ${e}.`),e}finally{r&&clearTimeout(r),e.abortSignal&&(e.abortSignal.onabort=null)}if(!i.ok){const e=await deserializeContent(i,"text");throw new HttpError(e||i.statusText,i.status)}const s=deserializeContent(i,e.responseType),o=await s;return new HttpResponse(i.status,i.statusText,o)}getCookieString(e){let t="";return Platform.isNode&&this._jar&&this._jar.getCookies(e,((e,n)=>t=n.join("; "))),t}}function deserializeContent(e,t){let n;switch(t){case"arraybuffer":n=e.arrayBuffer();break;case"text":default:n=e.text();break;case"blob":case"document":case"json":throw new Error(`${t} is not supported.`)}return n}class XhrHttpClient extends HttpClient{constructor(e){super(),this._logger=e}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new AbortError):e.method?e.url?new Promise(((t,n)=>{const i=new XMLHttpRequest;i.open(e.method,e.url,!0),i.withCredentials=void 0===e.withCredentials||e.withCredentials,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),""===e.content&&(e.content=void 0),e.content&&(isArrayBuffer(e.content)?i.setRequestHeader("Content-Type","application/octet-stream"):i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"));const r=e.headers;r&&Object.keys(r).forEach((e=>{i.setRequestHeader(e,r[e])})),e.responseType&&(i.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=()=>{i.abort(),n(new AbortError)}),e.timeout&&(i.timeout=e.timeout),i.onload=()=>{e.abortSignal&&(e.abortSignal.onabort=null),i.status>=200&&i.status<300?t(new HttpResponse(i.status,i.statusText,i.response||i.responseText)):n(new HttpError(i.response||i.responseText||i.statusText,i.status))},i.onerror=()=>{this._logger.log(LogLevel.Warning,`Error from HTTP request. ${i.status}: ${i.statusText}.`),n(new HttpError(i.statusText,i.status))},i.ontimeout=()=>{this._logger.log(LogLevel.Warning,"Timeout from HTTP request."),n(new TimeoutError)},i.send(e.content)})):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}}class DefaultHttpClient extends HttpClient{constructor(e){if(super(),"undefined"!=typeof fetch||Platform.isNode)this._httpClient=new FetchHttpClient(e);else{if("undefined"==typeof XMLHttpRequest)throw new Error("No usable HttpClient found.");this._httpClient=new XhrHttpClient(e)}}send(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new AbortError):e.method?e.url?this._httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))}getCookieString(e){return this._httpClient.getCookieString(e)}}class TextMessageFormat{static write(e){return`${e}${TextMessageFormat.RecordSeparator}`}static parse(e){if(e[e.length-1]!==TextMessageFormat.RecordSeparator)throw new Error("Message is incomplete.");const t=e.split(TextMessageFormat.RecordSeparator);return t.pop(),t}}TextMessageFormat.RecordSeparatorCode=30,TextMessageFormat.RecordSeparator=String.fromCharCode(TextMessageFormat.RecordSeparatorCode);class HandshakeProtocol{writeHandshakeRequest(e){return TextMessageFormat.write(JSON.stringify(e))}parseHandshakeResponse(e){let t,n;if(isArrayBuffer(e)){const i=new Uint8Array(e),r=i.indexOf(TextMessageFormat.RecordSeparatorCode);if(-1===r)throw new Error("Message is incomplete.");const s=r+1;t=String.fromCharCode.apply(null,Array.prototype.slice.call(i.slice(0,s))),n=i.byteLength>s?i.slice(s).buffer:null}else{const i=e,r=i.indexOf(TextMessageFormat.RecordSeparator);if(-1===r)throw new Error("Message is incomplete.");const s=r+1;t=i.substring(0,s),n=i.length>s?i.substring(s):null}const i=TextMessageFormat.parse(t),r=JSON.parse(i[0]);if(r.type)throw new Error("Expected a handshake response from the server.");return[n,r]}}var MessageType;!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(MessageType||(MessageType={}));class Subject{constructor(){this.observers=[]}next(e){for(const t of this.observers)t.next(e)}error(e){for(const t of this.observers)t.error&&t.error(e)}complete(){for(const e of this.observers)e.complete&&e.complete()}subscribe(e){return this.observers.push(e),new SubjectSubscription(this,e)}}const DEFAULT_TIMEOUT_IN_MS=3e4,DEFAULT_PING_INTERVAL_IN_MS=15e3;var HubConnectionState;!function(e){e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting"}(HubConnectionState||(HubConnectionState={}));class HubConnection{constructor(e,t,n,i){this._nextKeepAlive=0,this._freezeEventListener=()=>{this._logger.log(LogLevel.Warning,"The page is being frozen, this will likely lead to the connection being closed and messages being lost. For more information see the docs at https://docs.microsoft.com/aspnet/core/signalr/javascript-client#bsleep")},Arg.isRequired(e,"connection"),Arg.isRequired(t,"logger"),Arg.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=DEFAULT_TIMEOUT_IN_MS,this.keepAliveIntervalInMilliseconds=DEFAULT_PING_INTERVAL_IN_MS,this._logger=t,this._protocol=n,this.connection=e,this._reconnectPolicy=i,this._handshakeProtocol=new HandshakeProtocol,this.connection.onreceive=e=>this._processIncomingData(e),this.connection.onclose=e=>this._connectionClosed(e),this._callbacks={},this._methods={},this._closedCallbacks=[],this._reconnectingCallbacks=[],this._reconnectedCallbacks=[],this._invocationId=0,this._receivedHandshakeResponse=!1,this._connectionState=HubConnectionState.Disconnected,this._connectionStarted=!1,this._cachedPingMessage=this._protocol.writeMessage({type:MessageType.Ping})}static create(e,t,n,i){return new HubConnection(e,t,n,i)}get state(){return this._connectionState}get connectionId(){return this.connection&&this.connection.connectionId||null}get baseUrl(){return this.connection.baseUrl||""}set baseUrl(e){if(this._connectionState!==HubConnectionState.Disconnected&&this._connectionState!==HubConnectionState.Reconnecting)throw new Error("The HubConnection must be in the Disconnected or Reconnecting state to change the url.");if(!e)throw new Error("The HubConnection url must be a valid url.");this.connection.baseUrl=e}start(){return this._startPromise=this._startWithStateTransitions(),this._startPromise}async _startWithStateTransitions(){if(this._connectionState!==HubConnectionState.Disconnected)return Promise.reject(new Error("Cannot start a HubConnection that is not in the 'Disconnected' state."));this._connectionState=HubConnectionState.Connecting,this._logger.log(LogLevel.Debug,"Starting HubConnection.");try{await this._startInternal(),Platform.isBrowser&&window.document.addEventListener("freeze",this._freezeEventListener),this._connectionState=HubConnectionState.Connected,this._connectionStarted=!0,this._logger.log(LogLevel.Debug,"HubConnection connected successfully.")}catch(e){return this._connectionState=HubConnectionState.Disconnected,this._logger.log(LogLevel.Debug,`HubConnection failed to start successfully because of error '${e}'.`),Promise.reject(e)}}async _startInternal(){this._stopDuringStartError=void 0,this._receivedHandshakeResponse=!1;const e=new Promise(((e,t)=>{this._handshakeResolver=e,this._handshakeRejecter=t}));await this.connection.start(this._protocol.transferFormat);try{const t={protocol:this._protocol.name,version:this._protocol.version};if(this._logger.log(LogLevel.Debug,"Sending handshake request."),await this._sendMessage(this._handshakeProtocol.writeHandshakeRequest(t)),this._logger.log(LogLevel.Information,`Using HubProtocol '${this._protocol.name}'.`),this._cleanupTimeout(),this._resetTimeoutPeriod(),this._resetKeepAliveInterval(),await e,this._stopDuringStartError)throw this._stopDuringStartError;this.connection.features.inherentKeepAlive||await this._sendMessage(this._cachedPingMessage)}catch(e){throw this._logger.log(LogLevel.Debug,`Hub handshake failed with error '${e}' during start(). Stopping HubConnection.`),this._cleanupTimeout(),this._cleanupPingTimer(),await this.connection.stop(e),e}}async stop(){const e=this._startPromise;this._stopPromise=this._stopInternal(),await this._stopPromise;try{await e}catch(e){}}_stopInternal(e){return this._connectionState===HubConnectionState.Disconnected?(this._logger.log(LogLevel.Debug,`Call to HubConnection.stop(${e}) ignored because it is already in the disconnected state.`),Promise.resolve()):this._connectionState===HubConnectionState.Disconnecting?(this._logger.log(LogLevel.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState=HubConnectionState.Disconnecting,this._logger.log(LogLevel.Debug,"Stopping HubConnection."),this._reconnectDelayHandle?(this._logger.log(LogLevel.Debug,"Connection stopped during reconnect delay. Done reconnecting."),clearTimeout(this._reconnectDelayHandle),this._reconnectDelayHandle=void 0,this._completeClose(),Promise.resolve()):(this._cleanupTimeout(),this._cleanupPingTimer(),this._stopDuringStartError=e||new AbortError("The connection was stopped before the hub handshake could complete."),this.connection.stop(e)))}stream(e,...t){const[n,i]=this._replaceStreamingParams(t),r=this._createStreamInvocation(e,t,i);let s;const o=new Subject;return o.cancelCallback=()=>{const e=this._createCancelInvocation(r.invocationId);return delete this._callbacks[r.invocationId],s.then((()=>this._sendWithProtocol(e)))},this._callbacks[r.invocationId]=(e,t)=>{t?o.error(t):e&&(e.type===MessageType.Completion?e.error?o.error(new Error(e.error)):o.complete():o.next(e.item))},s=this._sendWithProtocol(r).catch((e=>{o.error(e),delete this._callbacks[r.invocationId]})),this._launchStreams(n,s),o}_sendMessage(e){return this._resetKeepAliveInterval(),this.connection.send(e)}_sendWithProtocol(e){return this._sendMessage(this._protocol.writeMessage(e))}send(e,...t){const[n,i]=this._replaceStreamingParams(t),r=this._sendWithProtocol(this._createInvocation(e,t,!0,i));return this._launchStreams(n,r),r}invoke(e,...t){const[n,i]=this._replaceStreamingParams(t),r=this._createInvocation(e,t,!1,i);return new Promise(((e,t)=>{this._callbacks[r.invocationId]=(n,i)=>{i?t(i):n&&(n.type===MessageType.Completion?n.error?t(new Error(n.error)):e(n.result):t(new Error(`Unexpected message type: ${n.type}`)))};const i=this._sendWithProtocol(r).catch((e=>{t(e),delete this._callbacks[r.invocationId]}));this._launchStreams(n,i)}))}on(e,t){e&&t&&(e=e.toLowerCase(),this._methods[e]||(this._methods[e]=[]),-1===this._methods[e].indexOf(t)&&this._methods[e].push(t))}off(e,t){if(!e)return;e=e.toLowerCase();const n=this._methods[e];if(n)if(t){const i=n.indexOf(t);-1!==i&&(n.splice(i,1),0===n.length&&delete this._methods[e])}else delete this._methods[e]}onclose(e){e&&this._closedCallbacks.push(e)}onreconnecting(e){e&&this._reconnectingCallbacks.push(e)}onreconnected(e){e&&this._reconnectedCallbacks.push(e)}_processIncomingData(e){if(this._cleanupTimeout(),this._receivedHandshakeResponse||(e=this._processHandshakeResponse(e),this._receivedHandshakeResponse=!0),e){const t=this._protocol.parseMessages(e,this._logger);for(const e of t)switch(e.type){case MessageType.Invocation:this._invokeClientMethod(e);break;case MessageType.StreamItem:case MessageType.Completion:{const t=this._callbacks[e.invocationId];if(t){e.type===MessageType.Completion&&delete this._callbacks[e.invocationId];try{t(e)}catch(e){this._logger.log(LogLevel.Error,`Stream callback threw error: ${getErrorString(e)}`)}}break}case MessageType.Ping:break;case MessageType.Close:{this._logger.log(LogLevel.Information,"Close message received from server.");const t=e.error?new Error("Server returned an error on close: "+e.error):void 0;!0===e.allowReconnect?this.connection.stop(t):this._stopPromise=this._stopInternal(t);break}default:this._logger.log(LogLevel.Warning,`Invalid message type: ${e.type}.`)}}this._resetTimeoutPeriod()}_processHandshakeResponse(e){let t,n;try{[n,t]=this._handshakeProtocol.parseHandshakeResponse(e)}catch(e){const t="Error parsing handshake response: "+e;this._logger.log(LogLevel.Error,t);const n=new Error(t);throw this._handshakeRejecter(n),n}if(t.error){const e="Server returned handshake error: "+t.error;this._logger.log(LogLevel.Error,e);const n=new Error(e);throw this._handshakeRejecter(n),n}return this._logger.log(LogLevel.Debug,"Server handshake complete."),this._handshakeResolver(),n}_resetKeepAliveInterval(){this.connection.features.inherentKeepAlive||(this._nextKeepAlive=(new Date).getTime()+this.keepAliveIntervalInMilliseconds,this._cleanupPingTimer())}_resetTimeoutPeriod(){if(!(this.connection.features&&this.connection.features.inherentKeepAlive||(this._timeoutHandle=setTimeout((()=>this.serverTimeout()),this.serverTimeoutInMilliseconds),void 0!==this._pingServerHandle))){let e=this._nextKeepAlive-(new Date).getTime();e<0&&(e=0),this._pingServerHandle=setTimeout((async()=>{if(this._connectionState===HubConnectionState.Connected)try{await this._sendMessage(this._cachedPingMessage)}catch{this._cleanupPingTimer()}}),e)}}serverTimeout(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))}async _invokeClientMethod(e){const t=e.target.toLowerCase(),n=this._methods[t];if(!n)return this._logger.log(LogLevel.Warning,`No client method with the name '${t}' found.`),void(e.invocationId&&(this._logger.log(LogLevel.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),await this._sendWithProtocol(this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null))));const i=n.slice(),r=!!e.invocationId;let s,o,a;for(const n of i)try{const i=s;s=await n.apply(this,e.arguments),r&&s&&i&&(this._logger.log(LogLevel.Error,`Multiple results provided for '${t}'. Sending error to server.`),a=this._createCompletionMessage(e.invocationId,"Client provided multiple results.",null)),o=void 0}catch(e){o=e,this._logger.log(LogLevel.Error,`A callback for the method '${t}' threw error '${e}'.`)}a?await this._sendWithProtocol(a):r?(o?a=this._createCompletionMessage(e.invocationId,`${o}`,null):void 0!==s?a=this._createCompletionMessage(e.invocationId,null,s):(this._logger.log(LogLevel.Warning,`No result given for '${t}' method and invocation ID '${e.invocationId}'.`),a=this._createCompletionMessage(e.invocationId,"Client didn't provide a result.",null)),await this._sendWithProtocol(a)):s&&this._logger.log(LogLevel.Error,`Result given for '${t}' method but server is not expecting a result.`)}_connectionClosed(e){this._logger.log(LogLevel.Debug,`HubConnection.connectionClosed(${e}) called while in state ${this._connectionState}.`),this._stopDuringStartError=this._stopDuringStartError||e||new AbortError("The underlying connection was closed before the hub handshake could complete."),this._handshakeResolver&&this._handshakeResolver(),this._cancelCallbacksWithError(e||new Error("Invocation canceled due to the underlying connection being closed.")),this._cleanupTimeout(),this._cleanupPingTimer(),this._connectionState===HubConnectionState.Disconnecting?this._completeClose(e):this._connectionState===HubConnectionState.Connected&&this._reconnectPolicy?this._reconnect(e):this._connectionState===HubConnectionState.Connected&&this._completeClose(e)}_completeClose(e){if(this._connectionStarted){this._connectionState=HubConnectionState.Disconnected,this._connectionStarted=!1,Platform.isBrowser&&window.document.removeEventListener("freeze",this._freezeEventListener);try{this._closedCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(LogLevel.Error,`An onclose callback called with error '${e}' threw error '${t}'.`)}}}async _reconnect(e){const t=Date.now();let n=0,i=void 0!==e?e:new Error("Attempting to reconnect due to a unknown error."),r=this._getNextRetryDelay(n++,0,i);if(null===r)return this._logger.log(LogLevel.Debug,"Connection not reconnecting because the IRetryPolicy returned null on the first reconnect attempt."),void this._completeClose(e);if(this._connectionState=HubConnectionState.Reconnecting,e?this._logger.log(LogLevel.Information,`Connection reconnecting because of error '${e}'.`):this._logger.log(LogLevel.Information,"Connection reconnecting."),0!==this._reconnectingCallbacks.length){try{this._reconnectingCallbacks.forEach((t=>t.apply(this,[e])))}catch(t){this._logger.log(LogLevel.Error,`An onreconnecting callback called with error '${e}' threw error '${t}'.`)}if(this._connectionState!==HubConnectionState.Reconnecting)return void this._logger.log(LogLevel.Debug,"Connection left the reconnecting state in onreconnecting callback. Done reconnecting.")}for(;null!==r;){if(this._logger.log(LogLevel.Information,`Reconnect attempt number ${n} will start in ${r} ms.`),await new Promise((e=>{this._reconnectDelayHandle=setTimeout(e,r)})),this._reconnectDelayHandle=void 0,this._connectionState!==HubConnectionState.Reconnecting)return void this._logger.log(LogLevel.Debug,"Connection left the reconnecting state during reconnect delay. Done reconnecting.");try{if(await this._startInternal(),this._connectionState=HubConnectionState.Connected,this._logger.log(LogLevel.Information,"HubConnection reconnected successfully."),0!==this._reconnectedCallbacks.length)try{this._reconnectedCallbacks.forEach((e=>e.apply(this,[this.connection.connectionId])))}catch(e){this._logger.log(LogLevel.Error,`An onreconnected callback called with connectionId '${this.connection.connectionId}; threw error '${e}'.`)}return}catch(e){if(this._logger.log(LogLevel.Information,`Reconnect attempt failed because of error '${e}'.`),this._connectionState!==HubConnectionState.Reconnecting)return this._logger.log(LogLevel.Debug,`Connection moved to the '${this._connectionState}' from the reconnecting state during reconnect attempt. Done reconnecting.`),void(this._connectionState===HubConnectionState.Disconnecting&&this._completeClose());i=e instanceof Error?e:new Error(e.toString()),r=this._getNextRetryDelay(n++,Date.now()-t,i)}}this._logger.log(LogLevel.Information,`Reconnect retries have been exhausted after ${Date.now()-t} ms and ${n} failed attempts. Connection disconnecting.`),this._completeClose()}_getNextRetryDelay(e,t,n){try{return this._reconnectPolicy.nextRetryDelayInMilliseconds({elapsedMilliseconds:t,previousRetryCount:e,retryReason:n})}catch(n){return this._logger.log(LogLevel.Error,`IRetryPolicy.nextRetryDelayInMilliseconds(${e}, ${t}) threw error '${n}'.`),null}}_cancelCallbacksWithError(e){const t=this._callbacks;this._callbacks={},Object.keys(t).forEach((n=>{const i=t[n];try{i(null,e)}catch(t){this._logger.log(LogLevel.Error,`Stream 'error' callback called with '${e}' threw error: ${getErrorString(t)}`)}}))}_cleanupPingTimer(){this._pingServerHandle&&(clearTimeout(this._pingServerHandle),this._pingServerHandle=void 0)}_cleanupTimeout(){this._timeoutHandle&&clearTimeout(this._timeoutHandle)}_createInvocation(e,t,n,i){if(n)return 0!==i.length?{arguments:t,streamIds:i,target:e,type:MessageType.Invocation}:{arguments:t,target:e,type:MessageType.Invocation};{const n=this._invocationId;return this._invocationId++,0!==i.length?{arguments:t,invocationId:n.toString(),streamIds:i,target:e,type:MessageType.Invocation}:{arguments:t,invocationId:n.toString(),target:e,type:MessageType.Invocation}}}_launchStreams(e,t){if(0!==e.length){t||(t=Promise.resolve());for(const n in e)e[n].subscribe({complete:()=>{t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n))))},error:e=>{let i;i=e instanceof Error?e.message:e&&e.toString?e.toString():"Unknown error",t=t.then((()=>this._sendWithProtocol(this._createCompletionMessage(n,i))))},next:e=>{t=t.then((()=>this._sendWithProtocol(this._createStreamItemMessage(n,e))))}})}}_replaceStreamingParams(e){const t=[],n=[];for(let i=0;i<e.length;i++){const r=e[i];if(this._isObservable(r)){const s=this._invocationId;this._invocationId++,t[s]=r,n.push(s.toString()),e.splice(i,1)}}return[t,n]}_isObservable(e){return e&&e.subscribe&&"function"==typeof e.subscribe}_createStreamInvocation(e,t,n){const i=this._invocationId;return this._invocationId++,0!==n.length?{arguments:t,invocationId:i.toString(),streamIds:n,target:e,type:MessageType.StreamInvocation}:{arguments:t,invocationId:i.toString(),target:e,type:MessageType.StreamInvocation}}_createCancelInvocation(e){return{invocationId:e,type:MessageType.CancelInvocation}}_createStreamItemMessage(e,t){return{invocationId:e,item:t,type:MessageType.StreamItem}}_createCompletionMessage(e,t,n){return t?{error:t,invocationId:e,type:MessageType.Completion}:{invocationId:e,result:n,type:MessageType.Completion}}}const DEFAULT_RETRY_DELAYS_IN_MILLISECONDS=[0,2e3,1e4,3e4,null];class DefaultReconnectPolicy{constructor(e){this._retryDelays=void 0!==e?[...e,null]:DEFAULT_RETRY_DELAYS_IN_MILLISECONDS}nextRetryDelayInMilliseconds(e){return this._retryDelays[e.previousRetryCount]}}class HeaderNames{}HeaderNames.Authorization="Authorization",HeaderNames.Cookie="Cookie";class AccessTokenHttpClient extends HttpClient{constructor(e,t){super(),this._innerClient=e,this._accessTokenFactory=t}async send(e){let t=!0;this._accessTokenFactory&&(!this._accessToken||e.url&&e.url.indexOf("/negotiate?")>0)&&(t=!1,this._accessToken=await this._accessTokenFactory()),this._setAuthorizationHeader(e);const n=await this._innerClient.send(e);return t&&401===n.statusCode&&this._accessTokenFactory?(this._accessToken=await this._accessTokenFactory(),this._setAuthorizationHeader(e),await this._innerClient.send(e)):n}_setAuthorizationHeader(e){e.headers||(e.headers={}),this._accessToken?e.headers[HeaderNames.Authorization]=`Bearer ${this._accessToken}`:this._accessTokenFactory&&e.headers[HeaderNames.Authorization]&&delete e.headers[HeaderNames.Authorization]}getCookieString(e){return this._innerClient.getCookieString(e)}}var HttpTransportType,TransferFormat;!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(HttpTransportType||(HttpTransportType={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(TransferFormat||(TransferFormat={}));let AbortController$1=class{constructor(){this._isAborted=!1,this.onabort=null}abort(){this._isAborted||(this._isAborted=!0,this.onabort&&this.onabort())}get signal(){return this}get aborted(){return this._isAborted}};class LongPollingTransport{constructor(e,t,n){this._httpClient=e,this._logger=t,this._pollAbort=new AbortController$1,this._options=n,this._running=!1,this.onreceive=null,this.onclose=null}get pollAborted(){return this._pollAbort.aborted}async connect(e,t){if(Arg.isRequired(e,"url"),Arg.isRequired(t,"transferFormat"),Arg.isIn(t,TransferFormat,"transferFormat"),this._url=e,this._logger.log(LogLevel.Trace,"(LongPolling transport) Connecting."),t===TransferFormat.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");const[n,i]=getUserAgentHeader(),r={[n]:i,...this._options.headers},s={abortSignal:this._pollAbort.signal,headers:r,timeout:1e5,withCredentials:this._options.withCredentials};t===TransferFormat.Binary&&(s.responseType="arraybuffer");const o=`${e}&_=${Date.now()}`;this._logger.log(LogLevel.Trace,`(LongPolling transport) polling: ${o}.`);const a=await this._httpClient.get(o,s);200!==a.statusCode?(this._logger.log(LogLevel.Error,`(LongPolling transport) Unexpected response code: ${a.statusCode}.`),this._closeError=new HttpError(a.statusText||"",a.statusCode),this._running=!1):this._running=!0,this._receiving=this._poll(this._url,s)}async _poll(e,t){try{for(;this._running;)try{const n=`${e}&_=${Date.now()}`;this._logger.log(LogLevel.Trace,`(LongPolling transport) polling: ${n}.`);const i=await this._httpClient.get(n,t);204===i.statusCode?(this._logger.log(LogLevel.Information,"(LongPolling transport) Poll terminated by server."),this._running=!1):200!==i.statusCode?(this._logger.log(LogLevel.Error,`(LongPolling transport) Unexpected response code: ${i.statusCode}.`),this._closeError=new HttpError(i.statusText||"",i.statusCode),this._running=!1):i.content?(this._logger.log(LogLevel.Trace,`(LongPolling transport) data received. ${getDataDetail(i.content,this._options.logMessageContent)}.`),this.onreceive&&this.onreceive(i.content)):this._logger.log(LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing.")}catch(e){this._running?e instanceof TimeoutError?this._logger.log(LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this._closeError=e,this._running=!1):this._logger.log(LogLevel.Trace,`(LongPolling transport) Poll errored after shutdown: ${e.message}`)}}finally{this._logger.log(LogLevel.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this._raiseOnClose()}}async send(e){return this._running?sendMessage(this._logger,"LongPolling",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}async stop(){this._logger.log(LogLevel.Trace,"(LongPolling transport) Stopping polling."),this._running=!1,this._pollAbort.abort();try{await this._receiving,this._logger.log(LogLevel.Trace,`(LongPolling transport) sending DELETE request to ${this._url}.`);const e={},[t,n]=getUserAgentHeader();e[t]=n;const i={headers:{...e,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials};await this._httpClient.delete(this._url,i),this._logger.log(LogLevel.Trace,"(LongPolling transport) DELETE request sent.")}finally{this._logger.log(LogLevel.Trace,"(LongPolling transport) Stop finished."),this._raiseOnClose()}}_raiseOnClose(){if(this.onclose){let e="(LongPolling transport) Firing onclose event.";this._closeError&&(e+=" Error: "+this._closeError),this._logger.log(LogLevel.Trace,e),this.onclose(this._closeError)}}}class ServerSentEventsTransport{constructor(e,t,n,i){this._httpClient=e,this._accessToken=t,this._logger=n,this._options=i,this.onreceive=null,this.onclose=null}async connect(e,t){return Arg.isRequired(e,"url"),Arg.isRequired(t,"transferFormat"),Arg.isIn(t,TransferFormat,"transferFormat"),this._logger.log(LogLevel.Trace,"(SSE transport) Connecting."),this._url=e,this._accessToken&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(this._accessToken)}`),new Promise(((n,i)=>{let r,s=!1;if(t===TransferFormat.Text){if(Platform.isBrowser||Platform.isWebWorker)r=new this._options.EventSource(e,{withCredentials:this._options.withCredentials});else{const t=this._httpClient.getCookieString(e),n={};n.Cookie=t;const[i,s]=getUserAgentHeader();n[i]=s,r=new this._options.EventSource(e,{withCredentials:this._options.withCredentials,headers:{...n,...this._options.headers}})}try{r.onmessage=e=>{if(this.onreceive)try{this._logger.log(LogLevel.Trace,`(SSE transport) data received. ${getDataDetail(e.data,this._options.logMessageContent)}.`),this.onreceive(e.data)}catch(e){return void this._close(e)}},r.onerror=e=>{s?this._close():i(new Error("EventSource failed to connect. The connection could not be found on the server, either the connection ID is not present on the server, or a proxy is refusing/buffering the connection. If you have multiple servers check that sticky sessions are enabled."))},r.onopen=()=>{this._logger.log(LogLevel.Information,`SSE connected to ${this._url}`),this._eventSource=r,s=!0,n()}}catch(e){return void i(e)}}else i(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))}))}async send(e){return this._eventSource?sendMessage(this._logger,"SSE",this._httpClient,this._url,e,this._options):Promise.reject(new Error("Cannot send until the transport is connected"))}stop(){return this._close(),Promise.resolve()}_close(e){this._eventSource&&(this._eventSource.close(),this._eventSource=void 0,this.onclose&&this.onclose(e))}}class WebSocketTransport{constructor(e,t,n,i,r,s){this._logger=n,this._accessTokenFactory=t,this._logMessageContent=i,this._webSocketConstructor=r,this._httpClient=e,this.onreceive=null,this.onclose=null,this._headers=s}async connect(e,t){let n;return Arg.isRequired(e,"url"),Arg.isRequired(t,"transferFormat"),Arg.isIn(t,TransferFormat,"transferFormat"),this._logger.log(LogLevel.Trace,"(WebSockets transport) Connecting."),this._accessTokenFactory&&(n=await this._accessTokenFactory()),new Promise(((i,r)=>{let s;e=e.replace(/^http/,"ws");const o=this._httpClient.getCookieString(e);let a=!1;if(Platform.isNode||Platform.isReactNative){const t={},[i,r]=getUserAgentHeader();t[i]=r,n&&(t[HeaderNames.Authorization]=`Bearer ${n}`),o&&(t[HeaderNames.Cookie]=o),s=new this._webSocketConstructor(e,void 0,{headers:{...t,...this._headers}})}else n&&(e+=(e.indexOf("?")<0?"?":"&")+`access_token=${encodeURIComponent(n)}`);s||(s=new this._webSocketConstructor(e)),t===TransferFormat.Binary&&(s.binaryType="arraybuffer"),s.onopen=t=>{this._logger.log(LogLevel.Information,`WebSocket connected to ${e}.`),this._webSocket=s,a=!0,i()},s.onerror=e=>{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"There was an error with the transport",this._logger.log(LogLevel.Information,`(WebSockets transport) ${t}.`)},s.onmessage=e=>{if(this._logger.log(LogLevel.Trace,`(WebSockets transport) data received. ${getDataDetail(e.data,this._logMessageContent)}.`),this.onreceive)try{this.onreceive(e.data)}catch(e){return void this._close(e)}},s.onclose=e=>{if(a)this._close(e);else{let t=null;t="undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent?e.error:"WebSocket failed to connect. The connection could not be found on the server, either the endpoint may not be a SignalR endpoint, the connection ID is not present on the server, or there is a proxy blocking WebSockets. If you have multiple servers check that sticky sessions are enabled.",r(new Error(t))}}}))}send(e){return this._webSocket&&this._webSocket.readyState===this._webSocketConstructor.OPEN?(this._logger.log(LogLevel.Trace,`(WebSockets transport) sending data. ${getDataDetail(e,this._logMessageContent)}.`),this._webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")}stop(){return this._webSocket&&this._close(void 0),Promise.resolve()}_close(e){this._webSocket&&(this._webSocket.onclose=()=>{},this._webSocket.onmessage=()=>{},this._webSocket.onerror=()=>{},this._webSocket.close(),this._webSocket=void 0),this._logger.log(LogLevel.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!this._isCloseEvent(e)||!1!==e.wasClean&&1e3===e.code?e instanceof Error?this.onclose(e):this.onclose():this.onclose(new Error(`WebSocket closed with status code: ${e.code} (${e.reason||"no reason given"}).`)))}_isCloseEvent(e){return e&&"boolean"==typeof e.wasClean&&"number"==typeof e.code}}const MAX_REDIRECTS=100;class HttpConnection{constructor(e,t={}){if(this._stopPromiseResolver=()=>{},this.features={},this._negotiateVersion=1,Arg.isRequired(e,"url"),this._logger=createLogger(t.logger),this.baseUrl=this._resolveUrl(e),(t=t||{}).logMessageContent=void 0!==t.logMessageContent&&t.logMessageContent,"boolean"!=typeof t.withCredentials&&void 0!==t.withCredentials)throw new Error("withCredentials option was not a 'boolean' or 'undefined' value");t.withCredentials=void 0===t.withCredentials||t.withCredentials,t.timeout=void 0===t.timeout?1e5:t.timeout;let n=null,i=null;if(Platform.isNode&&"undefined"!=typeof require){const e="function"==typeof __webpack_require__?__non_webpack_require__:require;n=e("ws"),i=e("eventsource")}Platform.isNode||"undefined"==typeof WebSocket||t.WebSocket?Platform.isNode&&!t.WebSocket&&n&&(t.WebSocket=n):t.WebSocket=WebSocket,Platform.isNode||"undefined"==typeof EventSource||t.EventSource?Platform.isNode&&!t.EventSource&&void 0!==i&&(t.EventSource=i):t.EventSource=EventSource,this._httpClient=new AccessTokenHttpClient(t.httpClient||new DefaultHttpClient(this._logger),t.accessTokenFactory),this._connectionState="Disconnected",this._connectionStarted=!1,this._options=t,this.onreceive=null,this.onclose=null}async start(e){if(e=e||TransferFormat.Binary,Arg.isIn(e,TransferFormat,"transferFormat"),this._logger.log(LogLevel.Debug,`Starting connection with transfer format '${TransferFormat[e]}'.`),"Disconnected"!==this._connectionState)return Promise.reject(new Error("Cannot start an HttpConnection that is not in the 'Disconnected' state."));if(this._connectionState="Connecting",this._startInternalPromise=this._startInternal(e),await this._startInternalPromise,"Disconnecting"===this._connectionState){const e="Failed to start the HttpConnection before stop() was called.";return this._logger.log(LogLevel.Error,e),await this._stopPromise,Promise.reject(new AbortError(e))}if("Connected"!==this._connectionState){const e="HttpConnection.startInternal completed gracefully but didn't enter the connection into the connected state!";return this._logger.log(LogLevel.Error,e),Promise.reject(new AbortError(e))}this._connectionStarted=!0}send(e){return"Connected"!==this._connectionState?Promise.reject(new Error("Cannot send data if the connection is not in the 'Connected' State.")):(this._sendQueue||(this._sendQueue=new TransportSendQueue(this.transport)),this._sendQueue.send(e))}async stop(e){return"Disconnected"===this._connectionState?(this._logger.log(LogLevel.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnected state.`),Promise.resolve()):"Disconnecting"===this._connectionState?(this._logger.log(LogLevel.Debug,`Call to HttpConnection.stop(${e}) ignored because the connection is already in the disconnecting state.`),this._stopPromise):(this._connectionState="Disconnecting",this._stopPromise=new Promise((e=>{this._stopPromiseResolver=e})),await this._stopInternal(e),void await this._stopPromise)}async _stopInternal(e){this._stopError=e;try{await this._startInternalPromise}catch(e){}if(this.transport){try{await this.transport.stop()}catch(e){this._logger.log(LogLevel.Error,`HttpConnection.transport.stop() threw error '${e}'.`),this._stopConnection()}this.transport=void 0}else this._logger.log(LogLevel.Debug,"HttpConnection.transport is undefined in HttpConnection.stop() because start() failed.")}async _startInternal(e){let t=this.baseUrl;this._accessTokenFactory=this._options.accessTokenFactory,this._httpClient._accessTokenFactory=this._accessTokenFactory;try{if(this._options.skipNegotiation){if(this._options.transport!==HttpTransportType.WebSockets)throw new Error("Negotiation can only be skipped when using the WebSocket transport directly.");this.transport=this._constructTransport(HttpTransportType.WebSockets),await this._startTransport(t,e)}else{let n=null,i=0;do{if(n=await this._getNegotiationResponse(t),"Disconnecting"===this._connectionState||"Disconnected"===this._connectionState)throw new AbortError("The connection was stopped during negotiation.");if(n.error)throw new Error(n.error);if(n.ProtocolVersion)throw new Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");if(n.url&&(t=n.url),n.accessToken){const e=n.accessToken;this._accessTokenFactory=()=>e,this._httpClient._accessToken=e,this._httpClient._accessTokenFactory=void 0}i++}while(n.url&&i<MAX_REDIRECTS);if(i===MAX_REDIRECTS&&n.url)throw new Error("Negotiate redirection limit exceeded.");await this._createTransport(t,this._options.transport,n,e)}this.transport instanceof LongPollingTransport&&(this.features.inherentKeepAlive=!0),"Connecting"===this._connectionState&&(this._logger.log(LogLevel.Debug,"The HttpConnection connected successfully."),this._connectionState="Connected")}catch(e){return this._logger.log(LogLevel.Error,"Failed to start the connection: "+e),this._connectionState="Disconnected",this.transport=void 0,this._stopPromiseResolver(),Promise.reject(e)}}async _getNegotiationResponse(e){const t={},[n,i]=getUserAgentHeader();t[n]=i;const r=this._resolveNegotiateUrl(e);this._logger.log(LogLevel.Debug,`Sending negotiation request: ${r}.`);try{const e=await this._httpClient.post(r,{content:"",headers:{...t,...this._options.headers},timeout:this._options.timeout,withCredentials:this._options.withCredentials});if(200!==e.statusCode)return Promise.reject(new Error(`Unexpected status code returned from negotiate '${e.statusCode}'`));const n=JSON.parse(e.content);return(!n.negotiateVersion||n.negotiateVersion<1)&&(n.connectionToken=n.connectionId),n}catch(e){let t="Failed to complete negotiation with the server: "+e;return e instanceof HttpError&&404===e.statusCode&&(t+=" Either this is not a SignalR endpoint or there is a proxy blocking the connection."),this._logger.log(LogLevel.Error,t),Promise.reject(new FailedToNegotiateWithServerError(t))}}_createConnectUrl(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+`id=${t}`:e}async _createTransport(e,t,n,i){let r=this._createConnectUrl(e,n.connectionToken);if(this._isITransport(t))return this._logger.log(LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,await this._startTransport(r,i),void(this.connectionId=n.connectionId);const s=[],o=n.availableTransports||[];let a=n;for(const n of o){const o=this._resolveTransportOrError(n,t,i);if(o instanceof Error)s.push(`${n.transport} failed:`),s.push(o);else if(this._isITransport(o)){if(this.transport=o,!a){try{a=await this._getNegotiationResponse(e)}catch(e){return Promise.reject(e)}r=this._createConnectUrl(e,a.connectionToken)}try{return await this._startTransport(r,i),void(this.connectionId=a.connectionId)}catch(e){if(this._logger.log(LogLevel.Error,`Failed to start the transport '${n.transport}': ${e}`),a=void 0,s.push(new FailedToStartTransportError(`${n.transport} failed: ${e}`,HttpTransportType[n.transport])),"Connecting"!==this._connectionState){const e="Failed to select transport before stop() was called.";return this._logger.log(LogLevel.Debug,e),Promise.reject(new AbortError(e))}}}}return s.length>0?Promise.reject(new AggregateErrors(`Unable to connect to the server with any of the available transports. ${s.join(" ")}`,s)):Promise.reject(new Error("None of the transports supported by the client are supported by the server."))}_constructTransport(e){switch(e){case HttpTransportType.WebSockets:if(!this._options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new WebSocketTransport(this._httpClient,this._accessTokenFactory,this._logger,this._options.logMessageContent,this._options.WebSocket,this._options.headers||{});case HttpTransportType.ServerSentEvents:if(!this._options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new ServerSentEventsTransport(this._httpClient,this._httpClient._accessToken,this._logger,this._options);case HttpTransportType.LongPolling:return new LongPollingTransport(this._httpClient,this._logger,this._options);default:throw new Error(`Unknown transport: ${e}.`)}}_startTransport(e,t){return this.transport.onreceive=this.onreceive,this.transport.onclose=e=>this._stopConnection(e),this.transport.connect(e,t)}_resolveTransportOrError(e,t,n){const i=HttpTransportType[e.transport];if(null==i)return this._logger.log(LogLevel.Debug,`Skipping transport '${e.transport}' because it is not supported by this client.`),new Error(`Skipping transport '${e.transport}' because it is not supported by this client.`);if(!transportMatches(t,i))return this._logger.log(LogLevel.Debug,`Skipping transport '${HttpTransportType[i]}' because it was disabled by the client.`),new DisabledTransportError(`'${HttpTransportType[i]}' is disabled by the client.`,i);if(!(e.transferFormats.map((e=>TransferFormat[e])).indexOf(n)>=0))return this._logger.log(LogLevel.Debug,`Skipping transport '${HttpTransportType[i]}' because it does not support the requested transfer format '${TransferFormat[n]}'.`),new Error(`'${HttpTransportType[i]}' does not support ${TransferFormat[n]}.`);if(i===HttpTransportType.WebSockets&&!this._options.WebSocket||i===HttpTransportType.ServerSentEvents&&!this._options.EventSource)return this._logger.log(LogLevel.Debug,`Skipping transport '${HttpTransportType[i]}' because it is not supported in your environment.'`),new UnsupportedTransportError(`'${HttpTransportType[i]}' is not supported in your environment.`,i);this._logger.log(LogLevel.Debug,`Selecting transport '${HttpTransportType[i]}'.`);try{return this._constructTransport(i)}catch(e){return e}}_isITransport(e){return e&&"object"==typeof e&&"connect"in e}_stopConnection(e){if(this._logger.log(LogLevel.Debug,`HttpConnection.stopConnection(${e}) called while in state ${this._connectionState}.`),this.transport=void 0,e=this._stopError||e,this._stopError=void 0,"Disconnected"!==this._connectionState){if("Connecting"===this._connectionState)throw this._logger.log(LogLevel.Warning,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is still in the connecting state.`),new Error(`HttpConnection.stopConnection(${e}) was called while the connection is still in the connecting state.`);if("Disconnecting"===this._connectionState&&this._stopPromiseResolver(),e?this._logger.log(LogLevel.Error,`Connection disconnected with error '${e}'.`):this._logger.log(LogLevel.Information,"Connection disconnected."),this._sendQueue&&(this._sendQueue.stop().catch((e=>{this._logger.log(LogLevel.Error,`TransportSendQueue.stop() threw error '${e}'.`)})),this._sendQueue=void 0),this.connectionId=void 0,this._connectionState="Disconnected",this._connectionStarted){this._connectionStarted=!1;try{this.onclose&&this.onclose(e)}catch(t){this._logger.log(LogLevel.Error,`HttpConnection.onclose(${e}) threw error '${t}'.`)}}}else this._logger.log(LogLevel.Debug,`Call to HttpConnection.stopConnection(${e}) was ignored because the connection is already in the disconnected state.`)}_resolveUrl(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if(!Platform.isBrowser)throw new Error(`Cannot resolve '${e}'.`);const t=window.document.createElement("a");return t.href=e,this._logger.log(LogLevel.Information,`Normalizing '${e}' to '${t.href}'.`),t.href}_resolveNegotiateUrl(e){const t=e.indexOf("?");let n=e.substring(0,-1===t?e.length:t);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===t?"":e.substring(t),-1===n.indexOf("negotiateVersion")&&(n+=-1===t?"?":"&",n+="negotiateVersion="+this._negotiateVersion),n}}function transportMatches(e,t){return!e||0!=(t&e)}class TransportSendQueue{constructor(e){this._transport=e,this._buffer=[],this._executing=!0,this._sendBufferedData=new PromiseSource,this._transportResult=new PromiseSource,this._sendLoopPromise=this._sendLoop()}send(e){return this._bufferData(e),this._transportResult||(this._transportResult=new PromiseSource),this._transportResult.promise}stop(){return this._executing=!1,this._sendBufferedData.resolve(),this._sendLoopPromise}_bufferData(e){if(this._buffer.length&&typeof this._buffer[0]!=typeof e)throw new Error(`Expected data to be of type ${typeof this._buffer} but was of type ${typeof e}`);this._buffer.push(e),this._sendBufferedData.resolve()}async _sendLoop(){for(;;){if(await this._sendBufferedData.promise,!this._executing){this._transportResult&&this._transportResult.reject("Connection stopped.");break}this._sendBufferedData=new PromiseSource;const e=this._transportResult;this._transportResult=void 0;const t="string"==typeof this._buffer[0]?this._buffer.join(""):TransportSendQueue._concatBuffers(this._buffer);this._buffer.length=0;try{await this._transport.send(t),e.resolve()}catch(t){e.reject(t)}}}static _concatBuffers(e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),n=new Uint8Array(t);let i=0;for(const t of e)n.set(new Uint8Array(t),i),i+=t.byteLength;return n.buffer}}class PromiseSource{constructor(){this.promise=new Promise(((e,t)=>[this._resolver,this._rejecter]=[e,t]))}resolve(){this._resolver()}reject(e){this._rejecter(e)}}const JSON_HUB_PROTOCOL_NAME="json";class JsonHubProtocol{constructor(){this.name=JSON_HUB_PROTOCOL_NAME,this.version=1,this.transferFormat=TransferFormat.Text}parseMessages(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=NullLogger.instance);const n=TextMessageFormat.parse(e),i=[];for(const e of n){const n=JSON.parse(e);if("number"!=typeof n.type)throw new Error("Invalid payload.");switch(n.type){case MessageType.Invocation:this._isInvocationMessage(n);break;case MessageType.StreamItem:this._isStreamItemMessage(n);break;case MessageType.Completion:this._isCompletionMessage(n);break;case MessageType.Ping:case MessageType.Close:break;default:t.log(LogLevel.Information,"Unknown message type '"+n.type+"' ignored.");continue}i.push(n)}return i}writeMessage(e){return TextMessageFormat.write(JSON.stringify(e))}_isInvocationMessage(e){this._assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this._assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")}_isStreamItemMessage(e){if(this._assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")}_isCompletionMessage(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this._assertNotEmptyString(e.error,"Invalid payload for Completion message."),this._assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")}_assertNotEmptyString(e,t){if("string"!=typeof e||""===e)throw new Error(t)}}const LogLevelNameMapping={trace:LogLevel.Trace,debug:LogLevel.Debug,info:LogLevel.Information,information:LogLevel.Information,warn:LogLevel.Warning,warning:LogLevel.Warning,error:LogLevel.Error,critical:LogLevel.Critical,none:LogLevel.None};function parseLogLevel(e){const t=LogLevelNameMapping[e.toLowerCase()];if(void 0!==t)return t;throw new Error(`Unknown log level: ${e}`)}class HubConnectionBuilder{configureLogging(e){if(Arg.isRequired(e,"logging"),isLogger(e))this.logger=e;else if("string"==typeof e){const t=parseLogLevel(e);this.logger=new ConsoleLogger(t)}else this.logger=new ConsoleLogger(e);return this}withUrl(e,t){return Arg.isRequired(e,"url"),Arg.isNotEmpty(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?{...this.httpConnectionOptions,...t}:{...this.httpConnectionOptions,transport:t},this}withHubProtocol(e){return Arg.isRequired(e,"protocol"),this.protocol=e,this}withAutomaticReconnect(e){if(this.reconnectPolicy)throw new Error("A reconnectPolicy has already been set.");return e?Array.isArray(e)?this.reconnectPolicy=new DefaultReconnectPolicy(e):this.reconnectPolicy=e:this.reconnectPolicy=new DefaultReconnectPolicy,this}build(){const e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");const t=new HttpConnection(this.url,e);return HubConnection.create(t,this.logger||NullLogger.instance,this.protocol||new JsonHubProtocol,this.reconnectPolicy)}}function isLogger(e){return void 0!==e.log}class WeavyClient{constructor(e){this.groups=[],this.connectionEvents=[],this.signalRAccessTokenRefresh=!1,this.token="",this.EVENT_NAMESPACE=".connection",this.EVENT_CLOSE="close",this.EVENT_RECONNECTING="reconnecting",this.EVENT_RECONNECTED="reconnected",this.url=e.url,this.tokenFactory=e.tokenFactory,this.tokenPromise=null,this.connection=(new HubConnectionBuilder).configureLogging(LogLevel.None).withUrl(this.url+"/hubs/rtm",{accessTokenFactory:async()=>{if(this.signalRAccessTokenRefresh){console.error("SignalR retrying with refreshed token.");const e=await this.tokenFactoryInternal(!0);return this.signalRAccessTokenRefresh=!1,e}return await this.tokenFactoryInternal()}}).withAutomaticReconnect().build(),this.connect(),this.connection.onclose((e=>this.triggerHandler(this.EVENT_CLOSE,e))),this.connection.onreconnecting((e=>this.triggerHandler(this.EVENT_RECONNECTING,e))),this.connection.onreconnected((e=>this.triggerHandler(this.EVENT_RECONNECTED,e)))}async connect(){try{this.isConnectionStarted=this.connection.start(),await this.isConnectionStarted}catch(e){console.log("Could not start SignalR."),this.signalRAccessTokenRefresh||(this.signalRAccessTokenRefresh=!0,this.isConnectionStarted=this.connection.start(),await this.isConnectionStarted)}this.signalRAccessTokenRefresh=!1,console.log("SignalR connected.")}async get(e,t=!0){const n=await fetch(this.url+e,{headers:{"content-type":"application/json",Authorization:"Bearer "+await this.tokenFactoryInternal()}});if(!n.ok){if((401===n.status||403===n.status)&&t)return await this.tokenFactoryInternal(!0),await this.get(e,!1);console.error(`Error calling endpoint ${e}`,n)}return n}async post(e,t,n,i="application/json",r=!0){let s={Authorization:"Bearer "+await this.tokenFactoryInternal()};""!==i&&(s["content-type"]=i);const o=await fetch(this.url+e,{method:t,body:n,headers:s});return o.ok||401!==o.status&&403!==o.status||!r?o:(await this.tokenFactoryInternal(!0),await this.post(e,t,n,i,!1))}async upload(e,t,n,i="application/json",r,s=!0){const o=this,a=await o.tokenFactoryInternal();return await new Promise((function(l,c){let h=new XMLHttpRequest;h.open(t,o.url+e,!0),h.setRequestHeader("Authorization","Bearer "+a),""!==i&&h.setRequestHeader("content-type",i),r&&h.upload.addEventListener("progress",(e=>{r(e.loaded/e.total*100||100)})),h.onload=a=>{!s||401!==h.status&&401!==h.status?l(new Response(h.response,{status:h.status,statusText:h.statusText})):o.tokenFactoryInternal(!0).then((()=>o.upload(e,t,n,i,r,!1))).then(l).catch(c)},h.onerror=c,h.send(n)}))}async getToken(e){return this.token&&!e||(this.token=await this.tokenFactory(!0)),this.token}async tokenFactoryInternal(e=!1){if(this.token&&!e)return this.token;if(this.tokenPromise)return this.tokenPromise;{this.tokenPromise=this.tokenFactory(e);let t=await this.tokenPromise;return this.tokenPromise=null,this.token=t,this.token}}async subscribe(e,t,n){await this.isConnectionStarted;try{var i=e?e+":"+t:t;await this.connection.invoke("Subscribe",i),this.groups.push(i),this.connection.on(i,n)}catch(e){console.warn("Error in Subscribe:",e)}}async unsubscribe(e,t,n){await this.isConnectionStarted;var i=e?e+":"+t:t;const r=this.groups.findIndex((e=>e===i));if(-1!==r){this.groups=this.groups.splice(r,1);try{this.groups.find((e=>e===i))||await this.connection.invoke("Unsubscribe",i)}catch(e){console.warn("Error in Unsubscribe:",e)}}this.connection.off(i,n)}destroy(){this.connection.stop()}triggerHandler(e,...t){e=e.endsWith(this.EVENT_NAMESPACE)?e:e+this.EVENT_NAMESPACE;let n=new CustomEvent(e,{cancelable:!1});if(console.debug("triggerHandler",e),this.connectionEvents.forEach((i=>{i.name===e&&i.handler(n,...t)})),e===this.EVENT_RECONNECTED+this.EVENT_NAMESPACE)for(var i=0;i<this.groups.length;i++)this.connection.invoke("Subscribe",this.groups[i])}}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _inheritsLoose(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,_setPrototypeOf(e,t)}var Subscribable=function(){function e(){this.listeners=[]}var t=e.prototype;return t.subscribe=function(e){var t=this,n=e||function(){};return this.listeners.push(n),this.onSubscribe(),function(){t.listeners=t.listeners.filter((function(e){return e!==n})),t.onUnsubscribe()}},t.hasListeners=function(){return this.listeners.length>0},t.onSubscribe=function(){},t.onUnsubscribe=function(){},e}();function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_extends$1.apply(this,arguments)}var isServer="undefined"==typeof window;function noop$1(){}function functionalUpdate(e,t){return"function"==typeof e?e(t):e}function isValidTimeout(e){return"number"==typeof e&&e>=0&&e!==1/0}function ensureQueryKeyArray(e){return Array.isArray(e)?e:[e]}function timeUntilStale(e,t){return Math.max(e+(t||0)-Date.now(),0)}function parseQueryArgs(e,t,n){return isQueryKey(e)?"function"==typeof t?_extends$1({},n,{queryKey:e,queryFn:t}):_extends$1({},t,{queryKey:e}):e}function parseMutationArgs(e,t,n){return isQueryKey(e)?"function"==typeof t?_extends$1({},n,{mutationKey:e,mutationFn:t}):_extends$1({},t,{mutationKey:e}):"function"==typeof e?_extends$1({},t,{mutationFn:e}):_extends$1({},e)}function parseFilterArgs(e,t,n){return isQueryKey(e)?[_extends$1({},t,{queryKey:e}),n]:[e||{},t]}function mapQueryStatusFilter(e,t){return!0===e&&!0===t||null==e&&null==t?"all":!1===e&&!1===t?"none":(null!=e?e:!t)?"active":"inactive"}function matchQuery(e,t){var n=e.active,i=e.exact,r=e.fetching,s=e.inactive,o=e.predicate,a=e.queryKey,l=e.stale;if(isQueryKey(a))if(i){if(t.queryHash!==hashQueryKeyByOptions(a,t.options))return!1}else if(!partialMatchKey(t.queryKey,a))return!1;var c=mapQueryStatusFilter(n,s);if("none"===c)return!1;if("all"!==c){var h=t.isActive();if("active"===c&&!h)return!1;if("inactive"===c&&h)return!1}return("boolean"!=typeof l||t.isStale()===l)&&(("boolean"!=typeof r||t.isFetching()===r)&&!(o&&!o(t)))}function matchMutation(e,t){var n=e.exact,i=e.fetching,r=e.predicate,s=e.mutationKey;if(isQueryKey(s)){if(!t.options.mutationKey)return!1;if(n){if(hashQueryKey(t.options.mutationKey)!==hashQueryKey(s))return!1}else if(!partialMatchKey(t.options.mutationKey,s))return!1}return("boolean"!=typeof i||"loading"===t.state.status===i)&&!(r&&!r(t))}function hashQueryKeyByOptions(e,t){return((null==t?void 0:t.queryKeyHashFn)||hashQueryKey)(e)}function hashQueryKey(e){return stableValueHash(ensureQueryKeyArray(e))}function stableValueHash(e){return JSON.stringify(e,(function(e,t){return isPlainObject$1(t)?Object.keys(t).sort().reduce((function(e,n){return e[n]=t[n],e}),{}):t}))}function partialMatchKey(e,t){return partialDeepEqual(ensureQueryKeyArray(e),ensureQueryKeyArray(t))}function partialDeepEqual(e,t){return e===t||typeof e==typeof t&&(!(!e||!t||"object"!=typeof e||"object"!=typeof t)&&!Object.keys(t).some((function(n){return!partialDeepEqual(e[n],t[n])})))}function replaceEqualDeep(e,t){if(e===t)return e;var n=Array.isArray(e)&&Array.isArray(t);if(n||isPlainObject$1(e)&&isPlainObject$1(t)){for(var i=n?e.length:Object.keys(e).length,r=n?t:Object.keys(t),s=r.length,o=n?[]:{},a=0,l=0;l<s;l++){var c=n?l:r[l];o[c]=replaceEqualDeep(e[c],t[c]),o[c]===e[c]&&a++}return i===s&&a===i?e:o}return t}function shallowEqualObjects(e,t){if(e&&!t||t&&!e)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}function isPlainObject$1(e){if(!hasObjectPrototype(e))return!1;var t=e.constructor;if(void 0===t)return!0;var n=t.prototype;return!!hasObjectPrototype(n)&&!!n.hasOwnProperty("isPrototypeOf")}function hasObjectPrototype(e){return"[object Object]"===Object.prototype.toString.call(e)}function isQueryKey(e){return"string"==typeof e||Array.isArray(e)}function sleep(e){return new Promise((function(t){setTimeout(t,e)}))}function scheduleMicrotask(e){Promise.resolve().then(e).catch((function(e){return setTimeout((function(){throw e}))}))}function getAbortController(){if("function"==typeof AbortController)return new AbortController}var FocusManager=function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!isServer&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("visibilitychange",n,!1),window.addEventListener("focus",n,!1),function(){window.removeEventListener("visibilitychange",n),window.removeEventListener("focus",n)}}},t}_inheritsLoose(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e((function(e){"boolean"==typeof e?n.setFocused(e):n.onFocus()}))},n.setFocused=function(e){this.focused=e,e&&this.onFocus()},n.onFocus=function(){this.listeners.forEach((function(e){e()}))},n.isFocused=function(){return"boolean"==typeof this.focused?this.focused:"undefined"==typeof document||[void 0,"visible","prerender"].includes(document.visibilityState)},t}(Subscribable),focusManager$1=new FocusManager,OnlineManager=function(e){function t(){var t;return(t=e.call(this)||this).setup=function(e){var t;if(!isServer&&(null==(t=window)?void 0:t.addEventListener)){var n=function(){return e()};return window.addEventListener("online",n,!1),window.addEventListener("offline",n,!1),function(){window.removeEventListener("online",n),window.removeEventListener("offline",n)}}},t}_inheritsLoose(t,e);var n=t.prototype;return n.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},n.onUnsubscribe=function(){var e;this.hasListeners()||(null==(e=this.cleanup)||e.call(this),this.cleanup=void 0)},n.setEventListener=function(e){var t,n=this;this.setup=e,null==(t=this.cleanup)||t.call(this),this.cleanup=e((function(e){"boolean"==typeof e?n.setOnline(e):n.onOnline()}))},n.setOnline=function(e){this.online=e,e&&this.onOnline()},n.onOnline=function(){this.listeners.forEach((function(e){e()}))},n.isOnline=function(){return"boolean"==typeof this.online?this.online:"undefined"==typeof navigator||void 0===navigator.onLine||navigator.onLine},t}(Subscribable),onlineManager=new OnlineManager;function defaultRetryDelay(e){return Math.min(1e3*Math.pow(2,e),3e4)}function isCancelable(e){return"function"==typeof(null==e?void 0:e.cancel)}var CancelledError=function(e){this.revert=null==e?void 0:e.revert,this.silent=null==e?void 0:e.silent};function isCancelledError(e){return e instanceof CancelledError}var Retryer=function(e){var t,n,i,r,s=this,o=!1;this.abort=e.abort,this.cancel=function(e){return null==t?void 0:t(e)},this.cancelRetry=function(){o=!0},this.continueRetry=function(){o=!1},this.continue=function(){return null==n?void 0:n()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise((function(e,t){i=e,r=t}));var a=function(t){s.isResolved||(s.isResolved=!0,null==e.onSuccess||e.onSuccess(t),null==n||n(),i(t))},l=function(t){s.isResolved||(s.isResolved=!0,null==e.onError||e.onError(t),null==n||n(),r(t))};!function i(){if(!s.isResolved){var r;try{r=e.fn()}catch(e){r=Promise.reject(e)}t=function(e){if(!s.isResolved&&(l(new CancelledError(e)),null==s.abort||s.abort(),isCancelable(r)))try{r.cancel()}catch(e){}},s.isTransportCancelable=isCancelable(r),Promise.resolve(r).then(a).catch((function(t){var r,a;if(!s.isResolved){var c=null!=(r=e.retry)?r:3,h=null!=(a=e.retryDelay)?a:defaultRetryDelay,d="function"==typeof h?h(s.failureCount,t):h,u=!0===c||"number"==typeof c&&s.failureCount<c||"function"==typeof c&&c(s.failureCount,t);!o&&u?(s.failureCount++,null==e.onFail||e.onFail(s.failureCount,t),sleep(d).then((function(){if(!focusManager$1.isFocused()||!onlineManager.isOnline())return new Promise((function(t){n=t,s.isPaused=!0,null==e.onPause||e.onPause()})).then((function(){n=void 0,s.isPaused=!1,null==e.onContinue||e.onContinue()}))})).then((function(){o?l(t):i()}))):l(t)}}))}}()},NotifyManager=function(){function e(){this.queue=[],this.transactions=0,this.notifyFn=function(e){e()},this.batchNotifyFn=function(e){e()}}var t=e.prototype;return t.batch=function(e){var t;this.transactions++;try{t=e()}finally{this.transactions--,this.transactions||this.flush()}return t},t.schedule=function(e){var t=this;this.transactions?this.queue.push(e):scheduleMicrotask((function(){t.notifyFn(e)}))},t.batchCalls=function(e){var t=this;return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.schedule((function(){e.apply(void 0,i)}))}},t.flush=function(){var e=this,t=this.queue;this.queue=[],t.length&&scheduleMicrotask((function(){e.batchNotifyFn((function(){t.forEach((function(t){e.notifyFn(t)}))}))}))},t.setNotifyFunction=function(e){this.notifyFn=e},t.setBatchNotifyFunction=function(e){this.batchNotifyFn=e},e}(),notifyManager=new NotifyManager,logger$1=console;function getLogger(){return logger$1}function setLogger(e){logger$1=e}var Query=function(){function e(e){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.cache=e.cache,this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.initialState=e.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=e.meta,this.scheduleGc()}var t=e.prototype;return t.setOptions=function(e){var t;this.options=_extends$1({},this.defaultOptions,e),this.meta=null==e?void 0:e.meta,this.cacheTime=Math.max(this.cacheTime||0,null!=(t=this.options.cacheTime)?t:3e5)},t.setDefaultOptions=function(e){this.defaultOptions=e},t.scheduleGc=function(){var e=this;this.clearGcTimeout(),isValidTimeout(this.cacheTime)&&(this.gcTimeout=setTimeout((function(){e.optionalRemove()}),this.cacheTime))},t.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},t.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},t.setData=function(e,t){var n,i,r=this.state.data,s=functionalUpdate(e,r);return(null==(n=(i=this.options).isDataEqual)?void 0:n.call(i,r,s))?s=r:!1!==this.options.structuralSharing&&(s=replaceEqualDeep(r,s)),this.dispatch({data:s,type:"success",dataUpdatedAt:null==t?void 0:t.updatedAt}),s},t.setState=function(e,t){this.dispatch({type:"setState",state:e,setStateOptions:t})},t.cancel=function(e){var t,n=this.promise;return null==(t=this.retryer)||t.cancel(e),n?n.then(noop$1).catch(noop$1):Promise.resolve()},t.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},t.reset=function(){this.destroy(),this.setState(this.initialState)},t.isActive=function(){return this.observers.some((function(e){return!1!==e.options.enabled}))},t.isFetching=function(){return this.state.isFetching},t.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some((function(e){return e.getCurrentResult().isStale}))},t.isStaleByTime=function(e){return void 0===e&&(e=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!timeUntilStale(this.state.dataUpdatedAt,e)},t.onFocus=function(){var e,t=this.observers.find((function(e){return e.shouldFetchOnWindowFocus()}));t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.onOnline=function(){var e,t=this.observers.find((function(e){return e.shouldFetchOnReconnect()}));t&&t.refetch(),null==(e=this.retryer)||e.continue()},t.addObserver=function(e){-1===this.observers.indexOf(e)&&(this.observers.push(e),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:e}))},t.removeObserver=function(e){-1!==this.observers.indexOf(e)&&(this.observers=this.observers.filter((function(t){return t!==e})),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:e}))},t.getObserversCount=function(){return this.observers.length},t.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},t.fetch=function(e,t){var n,i,r,s=this;if(this.state.isFetching)if(this.state.dataUpdatedAt&&(null==t?void 0:t.cancelRefetch))this.cancel({silent:!0});else if(this.promise){var o;return null==(o=this.retryer)||o.continueRetry(),this.promise}if(e&&this.setOptions(e),!this.options.queryFn){var a=this.observers.find((function(e){return e.options.queryFn}));a&&this.setOptions(a.options)}var l=ensureQueryKeyArray(this.queryKey),c=getAbortController(),h={queryKey:l,pageParam:void 0,meta:this.meta};Object.defineProperty(h,"signal",{enumerable:!0,get:function(){if(c)return s.abortSignalConsumed=!0,c.signal}});var d,u,p={fetchOptions:t,options:this.options,queryKey:l,state:this.state,fetchFn:function(){return s.options.queryFn?(s.abortSignalConsumed=!1,s.options.queryFn(h)):Promise.reject("Missing queryFn")},meta:this.meta};(null==(n=this.options.behavior)?void 0:n.onFetch)&&(null==(d=this.options.behavior)||d.onFetch(p));(this.revertState=this.state,this.state.isFetching&&this.state.fetchMeta===(null==(i=p.fetchOptions)?void 0:i.meta))||this.dispatch({type:"fetch",meta:null==(u=p.fetchOptions)?void 0:u.meta});return this.retryer=new Retryer({fn:p.fetchFn,abort:null==c||null==(r=c.abort)?void 0:r.bind(c),onSuccess:function(e){s.setData(e),null==s.cache.config.onSuccess||s.cache.config.onSuccess(e,s),0===s.cacheTime&&s.optionalRemove()},onError:function(e){isCancelledError(e)&&e.silent||s.dispatch({type:"error",error:e}),isCancelledError(e)||(null==s.cache.config.onError||s.cache.config.onError(e,s),getLogger().error(e)),0===s.cacheTime&&s.optionalRemove()},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay}),this.promise=this.retryer.promise,this.promise},t.dispatch=function(e){var t=this;this.state=this.reducer(this.state,e),notifyManager.batch((function(){t.observers.forEach((function(t){t.onQueryUpdate(e)})),t.cache.notify({query:t,type:"queryUpdated",action:e})}))},t.getDefaultState=function(e){var t="function"==typeof e.initialData?e.initialData():e.initialData,n=void 0!==e.initialData?"function"==typeof e.initialDataUpdatedAt?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0,i=void 0!==t;return{data:t,dataUpdateCount:0,dataUpdatedAt:i?null!=n?n:Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:i?"success":"idle"}},t.reducer=function(e,t){var n,i;switch(t.type){case"failed":return _extends$1({},e,{fetchFailureCount:e.fetchFailureCount+1});case"pause":return _extends$1({},e,{isPaused:!0});case"continue":return _extends$1({},e,{isPaused:!1});case"fetch":return _extends$1({},e,{fetchFailureCount:0,fetchMeta:null!=(n=t.meta)?n:null,isFetching:!0,isPaused:!1},!e.dataUpdatedAt&&{error:null,status:"loading"});case"success":return _extends$1({},e,{data:t.data,dataUpdateCount:e.dataUpdateCount+1,dataUpdatedAt:null!=(i=t.dataUpdatedAt)?i:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var r=t.error;return isCancelledError(r)&&r.revert&&this.revertState?_extends$1({},this.revertState):_extends$1({},e,{error:r,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return _extends$1({},e,{isInvalidated:!0});case"setState":return _extends$1({},e,t.state);default:return e}},e}(),QueryCache=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.queries=[],n.queriesMap={},n}_inheritsLoose(t,e);var n=t.prototype;return n.build=function(e,t,n){var i,r=t.queryKey,s=null!=(i=t.queryHash)?i:hashQueryKeyByOptions(r,t),o=this.get(s);return o||(o=new Query({cache:this,queryKey:r,queryHash:s,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(r),meta:t.meta}),this.add(o)),o},n.add=function(e){this.queriesMap[e.queryHash]||(this.queriesMap[e.queryHash]=e,this.queries.push(e),this.notify({type:"queryAdded",query:e}))},n.remove=function(e){var t=this.queriesMap[e.queryHash];t&&(e.destroy(),this.queries=this.queries.filter((function(t){return t!==e})),t===e&&delete this.queriesMap[e.queryHash],this.notify({type:"queryRemoved",query:e}))},n.clear=function(){var e=this;notifyManager.batch((function(){e.queries.forEach((function(t){e.remove(t)}))}))},n.get=function(e){return this.queriesMap[e]},n.getAll=function(){return this.queries},n.find=function(e,t){var n=parseFilterArgs(e,t)[0];return void 0===n.exact&&(n.exact=!0),this.queries.find((function(e){return matchQuery(n,e)}))},n.findAll=function(e,t){var n=parseFilterArgs(e,t)[0];return Object.keys(n).length>0?this.queries.filter((function(e){return matchQuery(n,e)})):this.queries},n.notify=function(e){var t=this;notifyManager.batch((function(){t.listeners.forEach((function(t){t(e)}))}))},n.onFocus=function(){var e=this;notifyManager.batch((function(){e.queries.forEach((function(e){e.onFocus()}))}))},n.onOnline=function(){var e=this;notifyManager.batch((function(){e.queries.forEach((function(e){e.onOnline()}))}))},t}(Subscribable),Mutation=function(){function e(e){this.options=_extends$1({},e.defaultOptions,e.options),this.mutationId=e.mutationId,this.mutationCache=e.mutationCache,this.observers=[],this.state=e.state||getDefaultState(),this.meta=e.meta}var t=e.prototype;return t.setState=function(e){this.dispatch({type:"setState",state:e})},t.addObserver=function(e){-1===this.observers.indexOf(e)&&this.observers.push(e)},t.removeObserver=function(e){this.observers=this.observers.filter((function(t){return t!==e}))},t.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(noop$1).catch(noop$1)):Promise.resolve()},t.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},t.execute=function(){var e,t=this,n="loading"===this.state.status,i=Promise.resolve();return n||(this.dispatch({type:"loading",variables:this.options.variables}),i=i.then((function(){null==t.mutationCache.config.onMutate||t.mutationCache.config.onMutate(t.state.variables,t)})).then((function(){return null==t.options.onMutate?void 0:t.options.onMutate(t.state.variables)})).then((function(e){e!==t.state.context&&t.dispatch({type:"loading",context:e,variables:t.state.variables})}))),i.then((function(){return t.executeMutation()})).then((function(n){e=n,null==t.mutationCache.config.onSuccess||t.mutationCache.config.onSuccess(e,t.state.variables,t.state.context,t)})).then((function(){return null==t.options.onSuccess?void 0:t.options.onSuccess(e,t.state.variables,t.state.context)})).then((function(){return null==t.options.onSettled?void 0:t.options.onSettled(e,null,t.state.variables,t.state.context)})).then((function(){return t.dispatch({type:"success",data:e}),e})).catch((function(e){return null==t.mutationCache.config.onError||t.mutationCache.config.onError(e,t.state.variables,t.state.context,t),getLogger().error(e),Promise.resolve().then((function(){return null==t.options.onError?void 0:t.options.onError(e,t.state.variables,t.state.context)})).then((function(){return null==t.options.onSettled?void 0:t.options.onSettled(void 0,e,t.state.variables,t.state.context)})).then((function(){throw t.dispatch({type:"error",error:e}),e}))}))},t.executeMutation=function(){var e,t=this;return this.retryer=new Retryer({fn:function(){return t.options.mutationFn?t.options.mutationFn(t.state.variables):Promise.reject("No mutationFn found")},onFail:function(){t.dispatch({type:"failed"})},onPause:function(){t.dispatch({type:"pause"})},onContinue:function(){t.dispatch({type:"continue"})},retry:null!=(e=this.options.retry)?e:0,retryDelay:this.options.retryDelay}),this.retryer.promise},t.dispatch=function(e){var t=this;this.state=reducer$1(this.state,e),notifyManager.batch((function(){t.observers.forEach((function(t){t.onMutationUpdate(e)})),t.mutationCache.notify(t)}))},e}();function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function reducer$1(e,t){switch(t.type){case"failed":return _extends$1({},e,{failureCount:e.failureCount+1});case"pause":return _extends$1({},e,{isPaused:!0});case"continue":return _extends$1({},e,{isPaused:!1});case"loading":return _extends$1({},e,{context:t.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:t.variables});case"success":return _extends$1({},e,{data:t.data,error:null,status:"success",isPaused:!1});case"error":return _extends$1({},e,{data:void 0,error:t.error,failureCount:e.failureCount+1,isPaused:!1,status:"error"});case"setState":return _extends$1({},e,t.state);default:return e}}var MutationCache=function(e){function t(t){var n;return(n=e.call(this)||this).config=t||{},n.mutations=[],n.mutationId=0,n}_inheritsLoose(t,e);var n=t.prototype;return n.build=function(e,t,n){var i=new Mutation({mutationCache:this,mutationId:++this.mutationId,options:e.defaultMutationOptions(t),state:n,defaultOptions:t.mutationKey?e.getMutationDefaults(t.mutationKey):void 0,meta:t.meta});return this.add(i),i},n.add=function(e){this.mutations.push(e),this.notify(e)},n.remove=function(e){this.mutations=this.mutations.filter((function(t){return t!==e})),e.cancel(),this.notify(e)},n.clear=function(){var e=this;notifyManager.batch((function(){e.mutations.forEach((function(t){e.remove(t)}))}))},n.getAll=function(){return this.mutations},n.find=function(e){return void 0===e.exact&&(e.exact=!0),this.mutations.find((function(t){return matchMutation(e,t)}))},n.findAll=function(e){return this.mutations.filter((function(t){return matchMutation(e,t)}))},n.notify=function(e){var t=this;notifyManager.batch((function(){t.listeners.forEach((function(t){t(e)}))}))},n.onFocus=function(){this.resumePausedMutations()},n.onOnline=function(){this.resumePausedMutations()},n.resumePausedMutations=function(){var e=this.mutations.filter((function(e){return e.state.isPaused}));return notifyManager.batch((function(){return e.reduce((function(e,t){return e.then((function(){return t.continue().catch(noop$1)}))}),Promise.resolve())}))},t}(Subscribable);function infiniteQueryBehavior(){return{onFetch:function(e){e.fetchFn=function(){var t,n,i,r,s,o,a,l=null==(t=e.fetchOptions)||null==(n=t.meta)?void 0:n.refetchPage,c=null==(i=e.fetchOptions)||null==(r=i.meta)?void 0:r.fetchMore,h=null==c?void 0:c.pageParam,d="forward"===(null==c?void 0:c.direction),u="backward"===(null==c?void 0:c.direction),p=(null==(s=e.state.data)?void 0:s.pages)||[],f=(null==(o=e.state.data)?void 0:o.pageParams)||[],m=getAbortController(),g=null==m?void 0:m.signal,O=f,y=!1,v=e.options.queryFn||function(){return Promise.reject("Missing queryFn")},b=function(e,t,n,i){return O=i?[t].concat(O):[].concat(O,[t]),i?[n].concat(e):[].concat(e,[n])},w=function(t,n,i,r){if(y)return Promise.reject("Cancelled");if(void 0===i&&!n&&t.length)return Promise.resolve(t);var s={queryKey:e.queryKey,signal:g,pageParam:i,meta:e.meta},o=v(s),a=Promise.resolve(o).then((function(e){return b(t,i,e,r)}));isCancelable(o)&&(a.cancel=o.cancel);return a};if(p.length)if(d){var S=void 0!==h,x=S?h:getNextPageParam(e.options,p);a=w(p,S,x)}else if(u){var C=void 0!==h,_=C?h:getPreviousPageParam(e.options,p);a=w(p,C,_,!0)}else!function(){O=[];var t=void 0===e.options.getNextPageParam,n=!l||!p[0]||l(p[0],0,p);a=n?w([],t,f[0]):Promise.resolve(b([],f[0],p[0]));for(var i=function(n){a=a.then((function(i){if(!l||!p[n]||l(p[n],n,p)){var r=t?f[n]:getNextPageParam(e.options,i);return w(i,t,r)}return Promise.resolve(b(i,f[n],p[n]))}))},r=1;r<p.length;r++)i(r)}();else a=w([]);var E=a.then((function(e){return{pages:e,pageParams:O}}));return E.cancel=function(){y=!0,null==m||m.abort(),isCancelable(a)&&a.cancel()},E}}}}function getNextPageParam(e,t){return null==e.getNextPageParam?void 0:e.getNextPageParam(t[t.length-1],t)}function getPreviousPageParam(e,t){return null==e.getPreviousPageParam?void 0:e.getPreviousPageParam(t[0],t)}function hasNextPage(e,t){if(e.getNextPageParam&&Array.isArray(t)){var n=getNextPageParam(e,t);return null!=n&&!1!==n}}function hasPreviousPage(e,t){if(e.getPreviousPageParam&&Array.isArray(t)){var n=getPreviousPageParam(e,t);return null!=n&&!1!==n}}var QueryClient=function(){function e(e){void 0===e&&(e={}),this.queryCache=e.queryCache||new QueryCache,this.mutationCache=e.mutationCache||new MutationCache,this.defaultOptions=e.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var t=e.prototype;return t.mount=function(){var e=this;this.unsubscribeFocus=focusManager$1.subscribe((function(){focusManager$1.isFocused()&&onlineManager.isOnline()&&(e.mutationCache.onFocus(),e.queryCache.onFocus())})),this.unsubscribeOnline=onlineManager.subscribe((function(){focusManager$1.isFocused()&&onlineManager.isOnline()&&(e.mutationCache.onOnline(),e.queryCache.onOnline())}))},t.unmount=function(){var e,t;null==(e=this.unsubscribeFocus)||e.call(this),null==(t=this.unsubscribeOnline)||t.call(this)},t.isFetching=function(e,t){var n=parseFilterArgs(e,t)[0];return n.fetching=!0,this.queryCache.findAll(n).length},t.isMutating=function(e){return this.mutationCache.findAll(_extends$1({},e,{fetching:!0})).length},t.getQueryData=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state.data},t.getQueriesData=function(e){return this.getQueryCache().findAll(e).map((function(e){return[e.queryKey,e.state.data]}))},t.setQueryData=function(e,t,n){var i=parseQueryArgs(e),r=this.defaultQueryOptions(i);return this.queryCache.build(this,r).setData(t,n)},t.setQueriesData=function(e,t,n){var i=this;return notifyManager.batch((function(){return i.getQueryCache().findAll(e).map((function(e){var r=e.queryKey;return[r,i.setQueryData(r,t,n)]}))}))},t.getQueryState=function(e,t){var n;return null==(n=this.queryCache.find(e,t))?void 0:n.state},t.removeQueries=function(e,t){var n=parseFilterArgs(e,t)[0],i=this.queryCache;notifyManager.batch((function(){i.findAll(n).forEach((function(e){i.remove(e)}))}))},t.resetQueries=function(e,t,n){var i=this,r=parseFilterArgs(e,t,n),s=r[0],o=r[1],a=this.queryCache,l=_extends$1({},s,{active:!0});return notifyManager.batch((function(){return a.findAll(s).forEach((function(e){e.reset()})),i.refetchQueries(l,o)}))},t.cancelQueries=function(e,t,n){var i=this,r=parseFilterArgs(e,t,n),s=r[0],o=r[1],a=void 0===o?{}:o;void 0===a.revert&&(a.revert=!0);var l=notifyManager.batch((function(){return i.queryCache.findAll(s).map((function(e){return e.cancel(a)}))}));return Promise.all(l).then(noop$1).catch(noop$1)},t.invalidateQueries=function(e,t,n){var i,r,s,o=this,a=parseFilterArgs(e,t,n),l=a[0],c=a[1],h=_extends$1({},l,{active:null==(i=null!=(r=l.refetchActive)?r:l.active)||i,inactive:null!=(s=l.refetchInactive)&&s});return notifyManager.batch((function(){return o.queryCache.findAll(l).forEach((function(e){e.invalidate()})),o.refetchQueries(h,c)}))},t.refetchQueries=function(e,t,n){var i=this,r=parseFilterArgs(e,t,n),s=r[0],o=r[1],a=notifyManager.batch((function(){return i.queryCache.findAll(s).map((function(e){return e.fetch(void 0,_extends$1({},o,{meta:{refetchPage:null==s?void 0:s.refetchPage}}))}))})),l=Promise.all(a).then(noop$1);return(null==o?void 0:o.throwOnError)||(l=l.catch(noop$1)),l},t.fetchQuery=function(e,t,n){var i=parseQueryArgs(e,t,n),r=this.defaultQueryOptions(i);void 0===r.retry&&(r.retry=!1);var s=this.queryCache.build(this,r);return s.isStaleByTime(r.staleTime)?s.fetch(r):Promise.resolve(s.state.data)},t.prefetchQuery=function(e,t,n){return this.fetchQuery(e,t,n).then(noop$1).catch(noop$1)},t.fetchInfiniteQuery=function(e,t,n){var i=parseQueryArgs(e,t,n);return i.behavior=infiniteQueryBehavior(),this.fetchQuery(i)},t.prefetchInfiniteQuery=function(e,t,n){return this.fetchInfiniteQuery(e,t,n).then(noop$1).catch(noop$1)},t.cancelMutations=function(){var e=this,t=notifyManager.batch((function(){return e.mutationCache.getAll().map((function(e){return e.cancel()}))}));return Promise.all(t).then(noop$1).catch(noop$1)},t.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},t.executeMutation=function(e){return this.mutationCache.build(this,e).execute()},t.getQueryCache=function(){return this.queryCache},t.getMutationCache=function(){return this.mutationCache},t.getDefaultOptions=function(){return this.defaultOptions},t.setDefaultOptions=function(e){this.defaultOptions=e},t.setQueryDefaults=function(e,t){var n=this.queryDefaults.find((function(t){return hashQueryKey(e)===hashQueryKey(t.queryKey)}));n?n.defaultOptions=t:this.queryDefaults.push({queryKey:e,defaultOptions:t})},t.getQueryDefaults=function(e){var t;return e?null==(t=this.queryDefaults.find((function(t){return partialMatchKey(e,t.queryKey)})))?void 0:t.defaultOptions:void 0},t.setMutationDefaults=function(e,t){var n=this.mutationDefaults.find((function(t){return hashQueryKey(e)===hashQueryKey(t.mutationKey)}));n?n.defaultOptions=t:this.mutationDefaults.push({mutationKey:e,defaultOptions:t})},t.getMutationDefaults=function(e){var t;return e?null==(t=this.mutationDefaults.find((function(t){return partialMatchKey(e,t.mutationKey)})))?void 0:t.defaultOptions:void 0},t.defaultQueryOptions=function(e){if(null==e?void 0:e._defaulted)return e;var t=_extends$1({},this.defaultOptions.queries,this.getQueryDefaults(null==e?void 0:e.queryKey),e,{_defaulted:!0});return!t.queryHash&&t.queryKey&&(t.queryHash=hashQueryKeyByOptions(t.queryKey,t)),t},t.defaultQueryObserverOptions=function(e){return this.defaultQueryOptions(e)},t.defaultMutationOptions=function(e){return(null==e?void 0:e._defaulted)?e:_extends$1({},this.defaultOptions.mutations,this.getMutationDefaults(null==e?void 0:e.mutationKey),e,{_defaulted:!0})},t.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},e}(),QueryObserver=function(e){function t(t,n){var i;return(i=e.call(this)||this).client=t,i.options=n,i.trackedProps=[],i.selectError=null,i.bindMethods(),i.setOptions(n),i}_inheritsLoose(t,e);var n=t.prototype;return n.bindMethods=function(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)},n.onSubscribe=function(){1===this.listeners.length&&(this.currentQuery.addObserver(this),shouldFetchOnMount(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())},n.onUnsubscribe=function(){this.listeners.length||this.destroy()},n.shouldFetchOnReconnect=function(){return shouldFetchOn(this.currentQuery,this.options,this.options.refetchOnReconnect)},n.shouldFetchOnWindowFocus=function(){return shouldFetchOn(this.currentQuery,this.options,this.options.refetchOnWindowFocus)},n.destroy=function(){this.listeners=[],this.clearTimers(),this.currentQuery.removeObserver(this)},n.setOptions=function(e,t){var n=this.options,i=this.currentQuery;if(this.options=this.client.defaultQueryObserverOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled)throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=n.queryKey),this.updateQuery();var r=this.hasListeners();r&&shouldFetchOptionally(this.currentQuery,i,this.options,n)&&this.executeFetch(),this.updateResult(t),!r||this.currentQuery===i&&this.options.enabled===n.enabled&&this.options.staleTime===n.staleTime||this.updateStaleTimeout();var s=this.computeRefetchInterval();!r||this.currentQuery===i&&this.options.enabled===n.enabled&&s===this.currentRefetchInterval||this.updateRefetchInterval(s)},n.getOptimisticResult=function(e){var t=this.client.defaultQueryObserverOptions(e),n=this.client.getQueryCache().build(this.client,t);return this.createResult(n,t)},n.getCurrentResult=function(){return this.currentResult},n.trackResult=function(e,t){var n=this,i={},r=function(e){n.trackedProps.includes(e)||n.trackedProps.push(e)};return Object.keys(e).forEach((function(t){Object.defineProperty(i,t,{configurable:!1,enumerable:!0,get:function(){return r(t),e[t]}})})),(t.useErrorBoundary||t.suspense)&&r("error"),i},n.getNextResult=function(e){var t=this;return new Promise((function(n,i){var r=t.subscribe((function(t){t.isFetching||(r(),t.isError&&(null==e?void 0:e.throwOnError)?i(t.error):n(t))}))}))},n.getCurrentQuery=function(){return this.currentQuery},n.remove=function(){this.client.getQueryCache().remove(this.currentQuery)},n.refetch=function(e){return this.fetch(_extends$1({},e,{meta:{refetchPage:null==e?void 0:e.refetchPage}}))},n.fetchOptimistic=function(e){var t=this,n=this.client.defaultQueryObserverOptions(e),i=this.client.getQueryCache().build(this.client,n);return i.fetch().then((function(){return t.createResult(i,n)}))},n.fetch=function(e){var t=this;return this.executeFetch(e).then((function(){return t.updateResult(),t.currentResult}))},n.executeFetch=function(e){this.updateQuery();var t=this.currentQuery.fetch(this.options,e);return(null==e?void 0:e.throwOnError)||(t=t.catch(noop$1)),t},n.updateStaleTimeout=function(){var e=this;if(this.clearStaleTimeout(),!isServer&&!this.currentResult.isStale&&isValidTimeout(this.options.staleTime)){var t=timeUntilStale(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout((function(){e.currentResult.isStale||e.updateResult()}),t)}},n.computeRefetchInterval=function(){var e;return"function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.currentResult.data,this.currentQuery):null!=(e=this.options.refetchInterval)&&e},n.updateRefetchInterval=function(e){var t=this;this.clearRefetchInterval(),this.currentRefetchInterval=e,!isServer&&!1!==this.options.enabled&&isValidTimeout(this.currentRefetchInterval)&&0!==this.currentRefetchInterval&&(this.refetchIntervalId=setInterval((function(){(t.options.refetchIntervalInBackground||focusManager$1.isFocused())&&t.executeFetch()}),this.currentRefetchInterval))},n.updateTimers=function(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())},n.clearTimers=function(){this.clearStaleTimeout(),this.clearRefetchInterval()},n.clearStaleTimeout=function(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)},n.clearRefetchInterval=function(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)},n.createResult=function(e,t){var n,i=this.currentQuery,r=this.options,s=this.currentResult,o=this.currentResultState,a=this.currentResultOptions,l=e!==i,c=l?e.state:this.currentQueryInitialState,h=l?this.currentResult:this.previousQueryResult,d=e.state,u=d.dataUpdatedAt,p=d.error,f=d.errorUpdatedAt,m=d.isFetching,g=d.status,O=!1,y=!1;if(t.optimisticResults){var v=this.hasListeners(),b=!v&&shouldFetchOnMount(e,t),w=v&&shouldFetchOptionally(e,i,t,r);(b||w)&&(m=!0,u||(g="loading"))}if(t.keepPreviousData&&!d.dataUpdateCount&&(null==h?void 0:h.isSuccess)&&"error"!==g)n=h.data,u=h.dataUpdatedAt,g=h.status,O=!0;else if(t.select&&void 0!==d.data)if(s&&d.data===(null==o?void 0:o.data)&&t.select===this.selectFn)n=this.selectResult;else try{this.selectFn=t.select,n=t.select(d.data),!1!==t.structuralSharing&&(n=replaceEqualDeep(null==s?void 0:s.data,n)),this.selectResult=n,this.selectError=null}catch(e){getLogger().error(e),this.selectError=e}else n=d.data;if(void 0!==t.placeholderData&&void 0===n&&("loading"===g||"idle"===g)){var S;if((null==s?void 0:s.isPlaceholderData)&&t.placeholderData===(null==a?void 0:a.placeholderData))S=s.data;else if(S="function"==typeof t.placeholderData?t.placeholderData():t.placeholderData,t.select&&void 0!==S)try{S=t.select(S),!1!==t.structuralSharing&&(S=replaceEqualDeep(null==s?void 0:s.data,S)),this.selectError=null}catch(e){getLogger().error(e),this.selectError=e}void 0!==S&&(g="success",n=S,y=!0)}return this.selectError&&(p=this.selectError,n=this.selectResult,f=Date.now(),g="error"),{status:g,isLoading:"loading"===g,isSuccess:"success"===g,isError:"error"===g,isIdle:"idle"===g,data:n,dataUpdatedAt:u,error:p,errorUpdatedAt:f,failureCount:d.fetchFailureCount,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:m,isRefetching:m&&"loading"!==g,isLoadingError:"error"===g&&0===d.dataUpdatedAt,isPlaceholderData:y,isPreviousData:O,isRefetchError:"error"===g&&0!==d.dataUpdatedAt,isStale:isStale(e,t),refetch:this.refetch,remove:this.remove}},n.shouldNotifyListeners=function(e,t){if(!t)return!0;var n=this.options,i=n.notifyOnChangeProps,r=n.notifyOnChangePropsExclusions;if(!i&&!r)return!0;if("tracked"===i&&!this.trackedProps.length)return!0;var s="tracked"===i?this.trackedProps:i;return Object.keys(e).some((function(n){var i=n,o=e[i]!==t[i],a=null==s?void 0:s.some((function(e){return e===n})),l=null==r?void 0:r.some((function(e){return e===n}));return o&&!l&&(!s||a)}))},n.updateResult=function(e){var t=this.currentResult;if(this.currentResult=this.createResult(this.currentQuery,this.options),this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,!shallowEqualObjects(this.currentResult,t)){var n={cache:!0};!1!==(null==e?void 0:e.listeners)&&this.shouldNotifyListeners(this.currentResult,t)&&(n.listeners=!0),this.notify(_extends$1({},n,e))}},n.updateQuery=function(){var e=this.client.getQueryCache().build(this.client,this.options);if(e!==this.currentQuery){var t=this.currentQuery;this.currentQuery=e,this.currentQueryInitialState=e.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(null==t||t.removeObserver(this),e.addObserver(this))}},n.onQueryUpdate=function(e){var t={};"success"===e.type?t.onSuccess=!0:"error"!==e.type||isCancelledError(e.error)||(t.onError=!0),this.updateResult(t),this.hasListeners()&&this.updateTimers()},n.notify=function(e){var t=this;notifyManager.batch((function(){e.onSuccess?(null==t.options.onSuccess||t.options.onSuccess(t.currentResult.data),null==t.options.onSettled||t.options.onSettled(t.currentResult.data,null)):e.onError&&(null==t.options.onError||t.options.onError(t.currentResult.error),null==t.options.onSettled||t.options.onSettled(void 0,t.currentResult.error)),e.listeners&&t.listeners.forEach((function(e){e(t.currentResult)})),e.cache&&t.client.getQueryCache().notify({query:t.currentQuery,type:"observerResultsUpdated"})}))},t}(Subscribable);function shouldLoadOnMount(e,t){return!(!1===t.enabled||e.state.dataUpdatedAt||"error"===e.state.status&&!1===t.retryOnMount)}function shouldFetchOnMount(e,t){return shouldLoadOnMount(e,t)||e.state.dataUpdatedAt>0&&shouldFetchOn(e,t,t.refetchOnMount)}function shouldFetchOn(e,t,n){if(!1!==t.enabled){var i="function"==typeof n?n(e):n;return"always"===i||!1!==i&&isStale(e,t)}return!1}function shouldFetchOptionally(e,t,n,i){return!1!==n.enabled&&(e!==t||!1===i.enabled)&&(!n.suspense||"error"!==e.state.status)&&isStale(e,n)}function isStale(e,t){return e.isStaleByTime(t.staleTime)}var InfiniteQueryObserver=function(e){function t(t,n){return e.call(this,t,n)||this}_inheritsLoose(t,e);var n=t.prototype;return n.bindMethods=function(){e.prototype.bindMethods.call(this),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)},n.setOptions=function(t,n){e.prototype.setOptions.call(this,_extends$1({},t,{behavior:infiniteQueryBehavior()}),n)},n.getOptimisticResult=function(t){return t.behavior=infiniteQueryBehavior(),e.prototype.getOptimisticResult.call(this,t)},n.fetchNextPage=function(e){var t;return this.fetch({cancelRefetch:null==(t=null==e?void 0:e.cancelRefetch)||t,throwOnError:null==e?void 0:e.throwOnError,meta:{fetchMore:{direction:"forward",pageParam:null==e?void 0:e.pageParam}}})},n.fetchPreviousPage=function(e){var t;return this.fetch({cancelRefetch:null==(t=null==e?void 0:e.cancelRefetch)||t,throwOnError:null==e?void 0:e.throwOnError,meta:{fetchMore:{direction:"backward",pageParam:null==e?void 0:e.pageParam}}})},n.createResult=function(t,n){var i,r,s,o,a,l,c=t.state;return _extends$1({},e.prototype.createResult.call(this,t,n),{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:hasNextPage(n,null==(i=c.data)?void 0:i.pages),hasPreviousPage:hasPreviousPage(n,null==(r=c.data)?void 0:r.pages),isFetchingNextPage:c.isFetching&&"forward"===(null==(s=c.fetchMeta)||null==(o=s.fetchMore)?void 0:o.direction),isFetchingPreviousPage:c.isFetching&&"backward"===(null==(a=c.fetchMeta)||null==(l=a.fetchMore)?void 0:l.direction)})},t}(QueryObserver),MutationObserver$1=function(e){function t(t,n){var i;return(i=e.call(this)||this).client=t,i.setOptions(n),i.bindMethods(),i.updateResult(),i}_inheritsLoose(t,e);var n=t.prototype;return n.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},n.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},n.onUnsubscribe=function(){var e;this.listeners.length||(null==(e=this.currentMutation)||e.removeObserver(this))},n.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)},n.getCurrentResult=function(){return this.currentResult},n.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},n.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,_extends$1({},this.options,{variables:void 0!==e?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},n.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:getDefaultState(),t=_extends$1({},e,{isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset});this.currentResult=t},n.notify=function(e){var t=this;notifyManager.batch((function(){t.mutateOptions&&(e.onSuccess?(null==t.mutateOptions.onSuccess||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(null==t.mutateOptions.onError||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),null==t.mutateOptions.onSettled||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach((function(e){e(t.currentResult)}))}))},t}(Subscribable),unstable_batchedUpdates=ReactDOM.unstable_batchedUpdates;notifyManager.setBatchNotifyFunction(unstable_batchedUpdates);var logger=console;setLogger(logger);var defaultContext=React.createContext(void 0),QueryClientSharingContext=React.createContext(!1);function getQueryClientContext(e){return e&&"undefined"!=typeof window?(window.ReactQueryClientContext||(window.ReactQueryClientContext=defaultContext),window.ReactQueryClientContext):defaultContext}var useQueryClient=function(){var e=React.useContext(getQueryClientContext(React.useContext(QueryClientSharingContext)));if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},QueryClientProvider=function(e){var t=e.client,n=e.contextSharing,i=void 0!==n&&n,r=e.children;React.useEffect((function(){return t.mount(),function(){t.unmount()}}),[t]);var s=getQueryClientContext(i);return React.createElement(QueryClientSharingContext.Provider,{value:i},React.createElement(s.Provider,{value:t},r))};function createValue(){var e=!1;return{clearReset:function(){e=!1},reset:function(){e=!0},isReset:function(){return e}}}var QueryErrorResetBoundaryContext=React.createContext(createValue()),useQueryErrorResetBoundary=function(){return React.useContext(QueryErrorResetBoundaryContext)};function shouldThrowError(e,t,n){return"function"==typeof t?t.apply(void 0,n):"boolean"==typeof t?t:!!e}function useMutation(e,t,n){var i=React.useRef(!1),r=React.useState(0)[1],s=parseMutationArgs(e,t,n),o=useQueryClient(),a=React.useRef();a.current?a.current.setOptions(s):a.current=new MutationObserver$1(o,s);var l=a.current.getCurrentResult();React.useEffect((function(){i.current=!0;var e=a.current.subscribe(notifyManager.batchCalls((function(){i.current&&r((function(e){return e+1}))})));return function(){i.current=!1,e()}}),[]);var c=React.useCallback((function(e,t){a.current.mutate(e,t).catch(noop$1)}),[]);if(l.error&&shouldThrowError(void 0,a.current.options.useErrorBoundary,[l.error]))throw l.error;return _extends$1({},l,{mutate:c,mutateAsync:l.mutate})}function useBaseQuery(e,t){var n=React.useRef(!1),i=React.useState(0)[1],r=useQueryClient(),s=useQueryErrorResetBoundary(),o=r.defaultQueryObserverOptions(e);o.optimisticResults=!0,o.onError&&(o.onError=notifyManager.batchCalls(o.onError)),o.onSuccess&&(o.onSuccess=notifyManager.batchCalls(o.onSuccess)),o.onSettled&&(o.onSettled=notifyManager.batchCalls(o.onSettled)),o.suspense&&("number"!=typeof o.staleTime&&(o.staleTime=1e3),0===o.cacheTime&&(o.cacheTime=1)),(o.suspense||o.useErrorBoundary)&&(s.isReset()||(o.retryOnMount=!1));var a=React.useState((function(){return new t(r,o)}))[0],l=a.getOptimisticResult(o);if(React.useEffect((function(){n.current=!0,s.clearReset();var e=a.subscribe(notifyManager.batchCalls((function(){n.current&&i((function(e){return e+1}))})));return a.updateResult(),function(){n.current=!1,e()}}),[s,a]),React.useEffect((function(){a.setOptions(o,{listeners:!1})}),[o,a]),o.suspense&&l.isLoading)throw a.fetchOptimistic(o).then((function(e){var t=e.data;null==o.onSuccess||o.onSuccess(t),null==o.onSettled||o.onSettled(t,null)})).catch((function(e){s.clearReset(),null==o.onError||o.onError(e),null==o.onSettled||o.onSettled(void 0,e)}));if(l.isError&&!s.isReset()&&!l.isFetching&&shouldThrowError(o.suspense,o.useErrorBoundary,[l.error,a.getCurrentQuery()]))throw l.error;return"tracked"===o.notifyOnChangeProps&&(l=a.trackResult(l,o)),l}function useQuery(e,t,n){return useBaseQuery(parseQueryArgs(e,t,n),QueryObserver)}function useInfiniteQuery(e,t,n){return useBaseQuery(parseQueryArgs(e,t,n),InfiniteQueryObserver)}function useUser(e){if(!e)throw new Error("useUser must be used within an WeavyProvider");return useQuery("user",(async()=>{try{const t=await e.get("/api/user");return t.ok?await t.json():(console.error("Could not load Weavy user data..."),null)}catch(t){console.error(`Could not connect to the Weavy backend. Please make sure ${e.url} is up and running!`)}}))}const UserContext=React.createContext({user:{id:-1,uid:"",username:"anonymous",name:"Anonymous",email:"",display_name:"",presence:"",avatar_url:""}}),UserProvider=({children:e,client:t})=>{const{isLoading:n,data:i}=useUser(t);return React.createElement(React.Fragment,null,!n&&i&&React.createElement(UserContext.Provider,{value:{user:i}},e))};var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var i=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,i.get?i:{enumerable:!0,get:function(){return e[t]}})})),n}var dayjs_min={exports:{}};dayjs_min.exports=function(){var e=1e3,t=6e4,n=36e5,i="millisecond",r="second",s="minute",o="hour",a="day",l="week",c="month",h="quarter",d="year",u="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},O=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},y={s:O,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+O(i,2,"0")+":"+O(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,c),s=n-r<0,o=t.clone().add(i+(s?-1:1),c);return+(-(i+(n-r)/(s?r-o:o-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:a,D:u,h:o,m:s,s:r,ms:i,Q:h}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",b={};b[v]=g;var w="$isDayjsObject",S=function(e){return e instanceof E||!(!e||!e[w])},x=function e(t,n,i){var r;if(!t)return v;if("string"==typeof t){var s=t.toLowerCase();b[s]&&(r=s),n&&(b[s]=n,r=s);var o=t.split("-");if(!r&&o.length>1)return e(o[0])}else{var a=t.name;b[a]=t,r=a}return!i&&r&&(v=r),r||!i&&v},C=function(e,t){if(S(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new E(n)},_=y;_.l=x,_.i=S,_.w=function(e,t){return C(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var E=function(){function g(e){this.$L=x(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var O=g.prototype;return O.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(_.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(f);if(i){var r=i[2]-1||0,s=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.init()},O.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},O.$utils=function(){return _},O.isValid=function(){return!(this.$d.toString()===p)},O.isSame=function(e,t){var n=C(e);return this.startOf(t)<=n&&n<=this.endOf(t)},O.isAfter=function(e,t){return C(e)<this.startOf(t)},O.isBefore=function(e,t){return this.endOf(t)<C(e)},O.$g=function(e,t,n){return _.u(e)?this[t]:this.set(n,e)},O.unix=function(){return Math.floor(this.valueOf()/1e3)},O.valueOf=function(){return this.$d.getTime()},O.startOf=function(e,t){var n=this,i=!!_.u(t)||t,h=_.p(e),p=function(e,t){var r=_.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?r:r.endOf(a)},f=function(e,t){return _.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},m=this.$W,g=this.$M,O=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case d:return i?p(1,0):p(31,11);case c:return i?p(1,g):p(0,g+1);case l:var v=this.$locale().weekStart||0,b=(m<v?m+7:m)-v;return p(i?O-b:O+(6-b),g);case a:case u:return f(y+"Hours",0);case o:return f(y+"Minutes",1);case s:return f(y+"Seconds",2);case r:return f(y+"Milliseconds",3);default:return this.clone()}},O.endOf=function(e){return this.startOf(e,!1)},O.$set=function(e,t){var n,l=_.p(e),h="set"+(this.$u?"UTC":""),p=(n={},n[a]=h+"Date",n[u]=h+"Date",n[c]=h+"Month",n[d]=h+"FullYear",n[o]=h+"Hours",n[s]=h+"Minutes",n[r]=h+"Seconds",n[i]=h+"Milliseconds",n)[l],f=l===a?this.$D+(t-this.$W):t;if(l===c||l===d){var m=this.clone().set(u,1);m.$d[p](f),m.init(),this.$d=m.set(u,Math.min(this.$D,m.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},O.set=function(e,t){return this.clone().$set(e,t)},O.get=function(e){return this[_.p(e)]()},O.add=function(i,h){var u,p=this;i=Number(i);var f=_.p(h),m=function(e){var t=C(p);return _.w(t.date(t.date()+Math.round(e*i)),p)};if(f===c)return this.set(c,this.$M+i);if(f===d)return this.set(d,this.$y+i);if(f===a)return m(1);if(f===l)return m(7);var g=(u={},u[s]=t,u[o]=n,u[r]=e,u)[f]||1,O=this.$d.getTime()+i*g;return _.w(O,this)},O.subtract=function(e,t){return this.add(-1*e,t)},O.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=_.z(this),s=this.$H,o=this.$m,a=this.$M,l=n.weekdays,c=n.months,h=n.meridiem,d=function(e,n,r,s){return e&&(e[n]||e(t,i))||r[n].slice(0,s)},u=function(e){return _.s(s%12||12,e,"0")},f=h||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i};return i.replace(m,(function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return _.s(t.$y,4,"0");case"M":return a+1;case"MM":return _.s(a+1,2,"0");case"MMM":return d(n.monthsShort,a,c,3);case"MMMM":return d(c,a);case"D":return t.$D;case"DD":return _.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(n.weekdaysMin,t.$W,l,2);case"ddd":return d(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(s);case"HH":return _.s(s,2,"0");case"h":return u(1);case"hh":return u(2);case"a":return f(s,o,!0);case"A":return f(s,o,!1);case"m":return String(o);case"mm":return _.s(o,2,"0");case"s":return String(t.$s);case"ss":return _.s(t.$s,2,"0");case"SSS":return _.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")}))},O.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},O.diff=function(i,u,p){var f,m=this,g=_.p(u),O=C(i),y=(O.utcOffset()-this.utcOffset())*t,v=this-O,b=function(){return _.m(m,O)};switch(g){case d:f=b()/12;break;case c:f=b();break;case h:f=b()/3;break;case l:f=(v-y)/6048e5;break;case a:f=(v-y)/864e5;break;case o:f=v/n;break;case s:f=v/t;break;case r:f=v/e;break;default:f=v}return p?f:_.a(f)},O.daysInMonth=function(){return this.endOf(c).$D},O.$locale=function(){return b[this.$L]},O.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=x(e,t,!0);return i&&(n.$L=i),n},O.clone=function(){return _.w(this.$d,this)},O.toDate=function(){return new Date(this.valueOf())},O.toJSON=function(){return this.isValid()?this.toISOString():null},O.toISOString=function(){return this.$d.toISOString()},O.toString=function(){return this.$d.toUTCString()},g}(),P=E.prototype;return C.prototype=P,[["$ms",i],["$s",r],["$m",s],["$H",o],["$W",a],["$M",c],["$y",d],["$D",u]].forEach((function(e){P[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),C.extend=function(e,t){return e.$i||(e(t,E,C),e.$i=!0),C},C.locale=x,C.isDayjs=S,C.unix=function(e){return C(1e3*e)},C.en=b[v],C.Ls=b,C.p={},C}();var dayjs_minExports=dayjs_min.exports,dayjs=getDefaultExportFromCjs(dayjs_minExports),relativeTime$1={exports:{}};relativeTime$1.exports=function(e,t,n){e=e||{};var i=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(e,t,n,r){return i.fromToBase(e,t,n,r)}n.en.relativeTime=r,i.fromToBase=function(t,i,s,o,a){for(var l,c,h,d=s.$locale().relativeTime||r,u=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=u.length,f=0;f<p;f+=1){var m=u[f];m.d&&(l=o?n(t).diff(s,m.d,!0):s.diff(t,m.d,!0));var g=(e.rounding||Math.round)(Math.abs(l));if(h=l>0,g<=m.r||!m.r){g<=1&&f>0&&(m=u[f-1]);var O=d[m.l];a&&(g=a(""+g)),c="string"==typeof O?O.replace("%d",g):O(g,i,m.l,h);break}}if(i)return c;var y=h?d.future:d.past;return"function"==typeof y?y(c):y.replace("%s",c)},i.to=function(e,t){return s(e,t,this,!0)},i.from=function(e,t){return s(e,t,this)};var o=function(e){return e.$u?n.utc():n()};i.toNow=function(e){return this.to(o(this),e)},i.fromNow=function(e){return this.from(o(this),e)}};var relativeTimeExports=relativeTime$1.exports,relativeTime=getDefaultExportFromCjs(relativeTimeExports),utc$1={exports:{}};utc$1.exports=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,n=/([+-]|\d\d)/g;return function(i,r,s){var o=r.prototype;s.utc=function(e){return new r({date:e,utc:!0,args:arguments})},o.utc=function(t){var n=s(this.toDate(),{locale:this.$L,utc:!0});return t?n.add(this.utcOffset(),e):n},o.local=function(){return s(this.toDate(),{locale:this.$L,utc:!1})};var a=o.parse;o.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),a.call(this,e)};var l=o.init;o.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else l.call(this)};var c=o.utcOffset;o.utcOffset=function(i,r){var s=this.$utils().u;if(s(i))return this.$u?0:s(this.$offset)?c.call(this):this.$offset;if("string"==typeof i&&(i=function(e){void 0===e&&(e="");var i=e.match(t);if(!i)return null;var r=(""+i[0]).match(n)||["-",0,0],s=r[0],o=60*+r[1]+ +r[2];return 0===o?0:"+"===s?o:-o}(i),null===i))return this;var o=Math.abs(i)<=16?60*i:i,a=this;if(r)return a.$offset=o,a.$u=0===i,a;if(0!==i){var l=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(a=this.local().add(o+l,e)).$offset=o,a.$x.$localOffset=l}else a=this.utc();return a};var h=o.format;o.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,t)},o.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},o.isUTC=function(){return!!this.$u},o.toISOString=function(){return this.toDate().toISOString()},o.toString=function(){return this.toDate().toUTCString()};var d=o.toDate;o.toDate=function(e){return"s"===e&&this.$offset?s(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var u=o.diff;o.diff=function(e,t,n){if(e&&this.$u===e.$u)return u.call(this,e,t,n);var i=this.local(),r=s(e).local();return u.call(i,r,t,n)}}}();var utcExports=utc$1.exports,utc=getDefaultExportFromCjs(utcExports),timezone$1={exports:{}};timezone$1.exports=function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(n,i,r){var s,o=function(e,n,i){void 0===i&&(i={});var r=new Date(e),s=function(e,n){void 0===n&&(n={});var i=n.timeZoneName||"short",r=e+"|"+i,s=t[r];return s||(s=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:i}),t[r]=s),s}(n,i);return s.formatToParts(r)},a=function(t,n){for(var i=o(t,n),s=[],a=0;a<i.length;a+=1){var l=i[a],c=l.type,h=l.value,d=e[c];d>=0&&(s[d]=parseInt(h,10))}var u=s[3],p=24===u?0:u,f=s[0]+"-"+s[1]+"-"+s[2]+" "+p+":"+s[4]+":"+s[5]+":000",m=+t;return(r.utc(f).valueOf()-(m-=m%1e3))/6e4},l=i.prototype;l.tz=function(e,t){void 0===e&&(e=s);var n=this.utcOffset(),i=this.toDate(),o=i.toLocaleString("en-US",{timeZone:e}),a=Math.round((i-new Date(o))/1e3/60),l=r(o,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(i.getTimezoneOffset()/15)-a,!0);if(t){var c=l.utcOffset();l=l.add(n-c,"minute")}return l.$x.$timezone=e,l},l.offsetName=function(e){var t=this.$x.$timezone||r.tz.guess(),n=o(this.valueOf(),t,{timeZoneName:e}).find((function(e){return"timezonename"===e.type.toLowerCase()}));return n&&n.value};var c=l.startOf;l.startOf=function(e,t){if(!this.$x||!this.$x.$timezone)return c.call(this,e,t);var n=r(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return c.call(n,e,t).tz(this.$x.$timezone,!0)},r.tz=function(e,t,n){var i=n&&t,o=n||t||s,l=a(+r(),o);if("string"!=typeof e)return r(e).tz(o);var c=function(e,t,n){var i=e-60*t*1e3,r=a(i,n);if(t===r)return[i,t];var s=a(i-=60*(r-t)*1e3,n);return r===s?[i,r]:[e-60*Math.min(r,s)*1e3,Math.max(r,s)]}(r.utc(e,i).valueOf(),l,o),h=c[0],d=c[1],u=r(h).utcOffset(d);return u.$x.$timezone=o,u},r.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},r.tz.setDefault=function(e){s=e}}}();var timezoneExports=timezone$1.exports,timezone=getDefaultExportFromCjs(timezoneExports),localizedFormat$1={exports:{}},e;localizedFormat$1.exports=(e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},function(t,n,i){var r=n.prototype,s=r.format;i.en.formats=e,r.format=function(t){void 0===t&&(t="YYYY-MM-DDTHH:mm:ssZ");var n=this.$locale().formats,i=function(t,n){return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,i,r){var s=r&&r.toUpperCase();return i||n[r]||e[r]||n[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))}(t,void 0===n?{}:n);return s.call(this,i)}});var localizedFormatExports=localizedFormat$1.exports,localizedFormat=getDefaultExportFromCjs(localizedFormatExports),lib={exports:{}},Modal$2={},propTypes={exports:{}},reactIs={exports:{}},reactIs_production_min={},hasRequiredReactIs_production_min;function requireReactIs_production_min(){if(hasRequiredReactIs_production_min)return reactIs_production_min;hasRequiredReactIs_production_min=1;var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,i=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,a=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,u=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,O=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function v(e){if("object"==typeof e&&null!==e){var u=e.$$typeof;switch(u){case t:switch(e=e.type){case l:case c:case i:case s:case r:case d:return e;default:switch(e=e&&e.$$typeof){case a:case h:case f:case p:case o:return e;default:return u}}case n:return u}}}function b(e){return v(e)===c}return reactIs_production_min.AsyncMode=l,reactIs_production_min.ConcurrentMode=c,reactIs_production_min.ContextConsumer=a,reactIs_production_min.ContextProvider=o,reactIs_production_min.Element=t,reactIs_production_min.ForwardRef=h,reactIs_production_min.Fragment=i,reactIs_production_min.Lazy=f,reactIs_production_min.Memo=p,reactIs_production_min.Portal=n,reactIs_production_min.Profiler=s,reactIs_production_min.StrictMode=r,reactIs_production_min.Suspense=d,reactIs_production_min.isAsyncMode=function(e){return b(e)||v(e)===l},reactIs_production_min.isConcurrentMode=b,reactIs_production_min.isContextConsumer=function(e){return v(e)===a},reactIs_production_min.isContextProvider=function(e){return v(e)===o},reactIs_production_min.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},reactIs_production_min.isForwardRef=function(e){return v(e)===h},reactIs_production_min.isFragment=function(e){return v(e)===i},reactIs_production_min.isLazy=function(e){return v(e)===f},reactIs_production_min.isMemo=function(e){return v(e)===p},reactIs_production_min.isPortal=function(e){return v(e)===n},reactIs_production_min.isProfiler=function(e){return v(e)===s},reactIs_production_min.isStrictMode=function(e){return v(e)===r},reactIs_production_min.isSuspense=function(e){return v(e)===d},reactIs_production_min.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===c||e===s||e===r||e===d||e===u||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===p||e.$$typeof===o||e.$$typeof===a||e.$$typeof===h||e.$$typeof===g||e.$$typeof===O||e.$$typeof===y||e.$$typeof===m)},reactIs_production_min.typeOf=v,reactIs_production_min}var reactIs_development={},hasRequiredReactIs_development,hasRequiredReactIs,objectAssign,hasRequiredObjectAssign,ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret,has,hasRequiredHas,checkPropTypes_1,hasRequiredCheckPropTypes,factoryWithTypeCheckers,hasRequiredFactoryWithTypeCheckers,factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims,hasRequiredPropTypes;
/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function requireReactIs_development(){return hasRequiredReactIs_development||(hasRequiredReactIs_development=1,"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,t=e?Symbol.for("react.element"):60103,n=e?Symbol.for("react.portal"):60106,i=e?Symbol.for("react.fragment"):60107,r=e?Symbol.for("react.strict_mode"):60108,s=e?Symbol.for("react.profiler"):60114,o=e?Symbol.for("react.provider"):60109,a=e?Symbol.for("react.context"):60110,l=e?Symbol.for("react.async_mode"):60111,c=e?Symbol.for("react.concurrent_mode"):60111,h=e?Symbol.for("react.forward_ref"):60112,d=e?Symbol.for("react.suspense"):60113,u=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,f=e?Symbol.for("react.lazy"):60116,m=e?Symbol.for("react.block"):60121,g=e?Symbol.for("react.fundamental"):60117,O=e?Symbol.for("react.responder"):60118,y=e?Symbol.for("react.scope"):60119;function v(e){if("object"==typeof e&&null!==e){var u=e.$$typeof;switch(u){case t:var m=e.type;switch(m){case l:case c:case i:case s:case r:case d:return m;default:var g=m&&m.$$typeof;switch(g){case a:case h:case f:case p:case o:return g;default:return u}}case n:return u}}}var b=l,w=c,S=a,x=o,C=t,_=h,E=i,P=f,k=p,T=n,A=s,R=r,M=d,I=!1;function L(e){return v(e)===c}reactIs_development.AsyncMode=b,reactIs_development.ConcurrentMode=w,reactIs_development.ContextConsumer=S,reactIs_development.ContextProvider=x,reactIs_development.Element=C,reactIs_development.ForwardRef=_,reactIs_development.Fragment=E,reactIs_development.Lazy=P,reactIs_development.Memo=k,reactIs_development.Portal=T,reactIs_development.Profiler=A,reactIs_development.StrictMode=R,reactIs_development.Suspense=M,reactIs_development.isAsyncMode=function(e){return I||(I=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),L(e)||v(e)===l},reactIs_development.isConcurrentMode=L,reactIs_development.isContextConsumer=function(e){return v(e)===a},reactIs_development.isContextProvider=function(e){return v(e)===o},reactIs_development.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},reactIs_development.isForwardRef=function(e){return v(e)===h},reactIs_development.isFragment=function(e){return v(e)===i},reactIs_development.isLazy=function(e){return v(e)===f},reactIs_development.isMemo=function(e){return v(e)===p},reactIs_development.isPortal=function(e){return v(e)===n},reactIs_development.isProfiler=function(e){return v(e)===s},reactIs_development.isStrictMode=function(e){return v(e)===r},reactIs_development.isSuspense=function(e){return v(e)===d},reactIs_development.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===c||e===s||e===r||e===d||e===u||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===p||e.$$typeof===o||e.$$typeof===a||e.$$typeof===h||e.$$typeof===g||e.$$typeof===O||e.$$typeof===y||e.$$typeof===m)},reactIs_development.typeOf=v}()),reactIs_development}function requireReactIs(){return hasRequiredReactIs||(hasRequiredReactIs=1,"production"===process.env.NODE_ENV?reactIs.exports=requireReactIs_production_min():reactIs.exports=requireReactIs_development()),reactIs.exports}
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/function requireObjectAssign(){if(hasRequiredObjectAssign)return objectAssign;hasRequiredObjectAssign=1;var e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;return objectAssign=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(i,r){for(var s,o,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(i),l=1;l<arguments.length;l++){for(var c in s=Object(arguments[l]))t.call(s,c)&&(a[c]=s[c]);if(e){o=e(s);for(var h=0;h<o.length;h++)n.call(s,o[h])&&(a[o[h]]=s[o[h]])}}return a},objectAssign}function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;return ReactPropTypesSecret_1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}function requireHas(){return hasRequiredHas?has:(hasRequiredHas=1,has=Function.call.bind(Object.prototype.hasOwnProperty))}function requireCheckPropTypes(){if(hasRequiredCheckPropTypes)return checkPropTypes_1;hasRequiredCheckPropTypes=1;var e=function(){};if("production"!==process.env.NODE_ENV){var t=requireReactPropTypesSecret(),n={},i=requireHas();e=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function r(r,s,o,a,l){if("production"!==process.env.NODE_ENV)for(var c in r)if(i(r,c)){var h;try{if("function"!=typeof r[c]){var d=Error((a||"React class")+": "+o+" type `"+c+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof r[c]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw d.name="Invariant Violation",d}h=r[c](s,c,a,o,null,t)}catch(e){h=e}if(!h||h instanceof Error||e((a||"React class")+": type specification of "+o+" `"+c+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof h+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),h instanceof Error&&!(h.message in n)){n[h.message]=!0;var u=l?l():"";e("Failed "+o+" type: "+h.message+(null!=u?u:""))}}}return r.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(n={})},checkPropTypes_1=r}function requireFactoryWithTypeCheckers(){if(hasRequiredFactoryWithTypeCheckers)return factoryWithTypeCheckers;hasRequiredFactoryWithTypeCheckers=1;var e=requireReactIs(),t=requireObjectAssign(),n=requireReactPropTypesSecret(),i=requireHas(),r=requireCheckPropTypes(),s=function(){};function o(){return null}return"production"!==process.env.NODE_ENV&&(s=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),factoryWithTypeCheckers=function(a,l){var c="function"==typeof Symbol&&Symbol.iterator,h="@@iterator";var d="<<anonymous>>",u={array:g("array"),bigint:g("bigint"),bool:g("boolean"),func:g("function"),number:g("number"),object:g("object"),string:g("string"),symbol:g("symbol"),any:m(o),arrayOf:function(e){return m((function(t,i,r,s,o){if("function"!=typeof e)return new f("Property `"+o+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var a=t[i];if(!Array.isArray(a))return new f("Invalid "+s+" `"+o+"` of type `"+v(a)+"` supplied to `"+r+"`, expected an array.");for(var l=0;l<a.length;l++){var c=e(a,l,r,s,o+"["+l+"]",n);if(c instanceof Error)return c}return null}))},element:m((function(e,t,n,i,r){var s=e[t];return a(s)?null:new f("Invalid "+i+" `"+r+"` of type `"+v(s)+"` supplied to `"+n+"`, expected a single ReactElement.")})),elementType:m((function(t,n,i,r,s){var o=t[n];return e.isValidElementType(o)?null:new f("Invalid "+r+" `"+s+"` of type `"+v(o)+"` supplied to `"+i+"`, expected a single ReactElement type.")})),instanceOf:function(e){return m((function(t,n,i,r,s){if(!(t[n]instanceof e)){var o=e.name||d;return new f("Invalid "+r+" `"+s+"` of type `"+(((a=t[n]).constructor&&a.constructor.name?a.constructor.name:d)+"` supplied to `")+i+"`, expected instance of `"+o+"`.")}var a;return null}))},node:m((function(e,t,n,i,r){return y(e[t])?null:new f("Invalid "+i+" `"+r+"` supplied to `"+n+"`, expected a ReactNode.")})),objectOf:function(e){return m((function(t,r,s,o,a){if("function"!=typeof e)return new f("Property `"+a+"` of component `"+s+"` has invalid PropType notation inside objectOf.");var l=t[r],c=v(l);if("object"!==c)return new f("Invalid "+o+" `"+a+"` of type `"+c+"` supplied to `"+s+"`, expected an object.");for(var h in l)if(i(l,h)){var d=e(l,h,s,o,a+"."+h,n);if(d instanceof Error)return d}return null}))},oneOf:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&s(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),o;return m((function(t,n,i,r,s){for(var o=t[n],a=0;a<e.length;a++)if(p(o,e[a]))return null;var l=JSON.stringify(e,(function(e,t){return"symbol"===b(t)?String(t):t}));return new f("Invalid "+r+" `"+s+"` of value `"+String(o)+"` supplied to `"+i+"`, expected one of "+l+".")}))},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&s("Invalid argument supplied to oneOfType, expected an instance of array."),o;for(var t=0;t<e.length;t++){var r=e[t];if("function"!=typeof r)return s("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+w(r)+" at index "+t+"."),o}return m((function(t,r,s,o,a){for(var l=[],c=0;c<e.length;c++){var h=(0,e[c])(t,r,s,o,a,n);if(null==h)return null;h.data&&i(h.data,"expectedType")&&l.push(h.data.expectedType)}return new f("Invalid "+o+" `"+a+"` supplied to `"+s+"`"+(l.length>0?", expected one of type ["+l.join(", ")+"]":"")+".")}))},shape:function(e){return m((function(t,i,r,s,o){var a=t[i],l=v(a);if("object"!==l)return new f("Invalid "+s+" `"+o+"` of type `"+l+"` supplied to `"+r+"`, expected `object`.");for(var c in e){var h=e[c];if("function"!=typeof h)return O(r,s,o,c,b(h));var d=h(a,c,r,s,o+"."+c,n);if(d)return d}return null}))},exact:function(e){return m((function(r,s,o,a,l){var c=r[s],h=v(c);if("object"!==h)return new f("Invalid "+a+" `"+l+"` of type `"+h+"` supplied to `"+o+"`, expected `object`.");var d=t({},r[s],e);for(var u in d){var p=e[u];if(i(e,u)&&"function"!=typeof p)return O(o,a,l,u,b(p));if(!p)return new f("Invalid "+a+" `"+l+"` key `"+u+"` supplied to `"+o+"`.\nBad object: "+JSON.stringify(r[s],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var m=p(c,u,o,a,l+"."+u,n);if(m)return m}return null}))}};function p(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function f(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function m(e){if("production"!==process.env.NODE_ENV)var t={},i=0;function r(r,o,a,c,h,u,p){if(c=c||d,u=u||a,p!==n){if(l){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}if("production"!==process.env.NODE_ENV&&"undefined"!=typeof console){var g=c+":"+a;!t[g]&&i<3&&(s("You are manually calling a React.PropTypes validation function for the `"+u+"` prop on `"+c+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),t[g]=!0,i++)}}return null==o[a]?r?null===o[a]?new f("The "+h+" `"+u+"` is marked as required in `"+c+"`, but its value is `null`."):new f("The "+h+" `"+u+"` is marked as required in `"+c+"`, but its value is `undefined`."):null:e(o,a,c,h,u)}var o=r.bind(null,!1);return o.isRequired=r.bind(null,!0),o}function g(e){return m((function(t,n,i,r,s,o){var a=t[n];return v(a)!==e?new f("Invalid "+r+" `"+s+"` of type `"+b(a)+"` supplied to `"+i+"`, expected `"+e+"`.",{expectedType:e}):null}))}function O(e,t,n,i,r){return new f((e||"React class")+": "+t+" type `"+n+"."+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+r+"`.")}function y(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(y);if(null===e||a(e))return!0;var t=function(e){var t=e&&(c&&e[c]||e[h]);if("function"==typeof t)return t}(e);if(!t)return!1;var n,i=t.call(e);if(t!==e.entries){for(;!(n=i.next()).done;)if(!y(n.value))return!1}else for(;!(n=i.next()).done;){var r=n.value;if(r&&!y(r[1]))return!1}return!0;default:return!1}}function v(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function b(e){if(null==e)return""+e;var t=v(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function w(e){var t=b(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return f.prototype=Error.prototype,u.checkPropTypes=r,u.resetWarningCache=r.resetWarningCache,u.PropTypes=u,u},factoryWithTypeCheckers}function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var e=requireReactPropTypesSecret();function t(){}function n(){}return n.resetWarningCache=t,factoryWithThrowingShims=function(){function i(t,n,i,r,s,o){if(o!==e){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function r(){return i}i.isRequired=i;var s={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:r,element:i,elementType:i,instanceOf:r,node:i,objectOf:r,oneOf:r,oneOfType:r,shape:r,exact:r,checkPropTypes:n,resetWarningCache:t};return s.PropTypes=s,s}}function requirePropTypes(){if(hasRequiredPropTypes)return propTypes.exports;if(hasRequiredPropTypes=1,"production"!==process.env.NODE_ENV){var e=requireReactIs();propTypes.exports=requireFactoryWithTypeCheckers()(e.isElement,!0)}else propTypes.exports=requireFactoryWithThrowingShims()();return propTypes.exports}var ModalPortal={exports:{}},focusManager={},tabbable={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var n=[].slice.call(t.querySelectorAll("*"),0).reduce((function(t,n){return t.concat(n.shadowRoot?e(n.shadowRoot):[n])}),[]);return n.filter(a)};
/*!
	 * Adapted from jQuery UI core
	 *
	 * http://jqueryui.com
	 *
	 * Copyright 2014 jQuery Foundation and other contributors
	 * Released under the MIT license.
	 * http://jquery.org/license
	 *
	 * http://api.jqueryui.com/category/ui-core/
	 */
var n="none",i="contents",r=/input|select|textarea|button|object|iframe/;function s(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0;if(t&&!e.innerHTML)return!0;try{var r=window.getComputedStyle(e),s=r.getPropertyValue("display");return t?s!==i&&function(e,t){return"visible"!==t.getPropertyValue("overflow")||e.scrollWidth<=0&&e.scrollHeight<=0}(e,r):s===n}catch(e){return console.warn("Failed to inspect element style"),!1}}function o(e,t){var n=e.nodeName.toLowerCase();return(r.test(n)&&!e.disabled||"a"===n&&e.href||t)&&function(e){for(var t=e,n=e.getRootNode&&e.getRootNode();t&&t!==document.body;){if(n&&t===n&&(t=n.host.parentNode),s(t))return!1;t=t.parentNode}return!0}(e)}function a(e){var t=e.getAttribute("tabindex");null===t&&(t=void 0);var n=isNaN(t);return(n||t>=0)&&o(e,!n)}e.exports=t.default}(tabbable,tabbable.exports);var tabbableExports=tabbable.exports;Object.defineProperty(focusManager,"__esModule",{value:!0}),focusManager.resetState=resetState$4,focusManager.log=log$4,focusManager.handleBlur=handleBlur,focusManager.handleFocus=handleFocus,focusManager.markForFocusLater=markForFocusLater,focusManager.returnFocus=returnFocus,focusManager.popWithoutFocus=popWithoutFocus,focusManager.setupScopedFocus=setupScopedFocus,focusManager.teardownScopedFocus=teardownScopedFocus;var _tabbable=tabbableExports,_tabbable2=_interopRequireDefault$4(_tabbable);function _interopRequireDefault$4(e){return e&&e.__esModule?e:{default:e}}var focusLaterElements=[],modalElement=null,needToFocus=!1;function resetState$4(){focusLaterElements=[]}function log$4(){"production"!==process.env.NODE_ENV&&(console.log("focusManager ----------"),focusLaterElements.forEach((function(e){var t=e||{};console.log(t.nodeName,t.className,t.id)})),console.log("end focusManager ----------"))}function handleBlur(){needToFocus=!0}function handleFocus(){if(needToFocus){if(needToFocus=!1,!modalElement)return;setTimeout((function(){modalElement.contains(document.activeElement)||((0,_tabbable2.default)(modalElement)[0]||modalElement).focus()}),0)}}function markForFocusLater(){focusLaterElements.push(document.activeElement)}function returnFocus(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=null;try{return void(0!==focusLaterElements.length&&(t=focusLaterElements.pop()).focus({preventScroll:e}))}catch(e){console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function popWithoutFocus(){focusLaterElements.length>0&&focusLaterElements.pop()}function setupScopedFocus(e){modalElement=e,window.addEventListener?(window.addEventListener("blur",handleBlur,!1),document.addEventListener("focus",handleFocus,!0)):(window.attachEvent("onBlur",handleBlur),document.attachEvent("onFocus",handleFocus))}function teardownScopedFocus(){modalElement=null,window.addEventListener?(window.removeEventListener("blur",handleBlur),document.removeEventListener("focus",handleFocus)):(window.detachEvent("onBlur",handleBlur),document.detachEvent("onFocus",handleFocus))}var scopeTab={exports:{}};!function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(0,i.default)(e);if(!n.length)return void t.preventDefault();var s=void 0,o=t.shiftKey,a=n[0],l=n[n.length-1],c=r();if(e===c){if(!o)return;s=l}l!==c||o||(s=a);a===c&&o&&(s=l);if(s)return t.preventDefault(),void s.focus();var h=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null==h||"Chrome"==h[1]||null!=/\biPod\b|\biPad\b/g.exec(navigator.userAgent))return;var d=n.indexOf(c);d>-1&&(d+=o?-1:1);if(s=n[d],void 0===s)return t.preventDefault(),void(s=o?l:a).focus();t.preventDefault(),s.focus()};var n,i=(n=tabbableExports)&&n.__esModule?n:{default:n};function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.activeElement.shadowRoot?r(e.activeElement.shadowRoot):e.activeElement}e.exports=t.default}(scopeTab,scopeTab.exports);var scopeTabExports=scopeTab.exports,ariaAppHider$1={},__DEV__="production"!==process.env.NODE_ENV,warning=function(){};if(__DEV__){var printWarning=function(e,t){var n=arguments.length;t=new Array(n>1?n-1:0);for(var i=1;i<n;i++)t[i-1]=arguments[i];var r=0,s="Warning: "+e.replace(/%s/g,(function(){return t[r++]}));"undefined"!=typeof console&&console.error(s);try{throw new Error(s)}catch(e){}};warning=function(e,t,n){var i=arguments.length;n=new Array(i>2?i-2:0);for(var r=2;r<i;r++)n[r-2]=arguments[r];if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");e||printWarning.apply(null,[t].concat(n))}}var warning_1=warning,safeHTMLElement={},exenv={exports:{}},module,canUseDOM,ExecutionEnvironment;
/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/
module=exenv,canUseDOM=!("undefined"==typeof window||!window.document||!window.document.createElement),ExecutionEnvironment={canUseDOM:canUseDOM,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:canUseDOM&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:canUseDOM&&!!window.screen},module.exports?module.exports=ExecutionEnvironment:window.ExecutionEnvironment=ExecutionEnvironment;var exenvExports=exenv.exports;Object.defineProperty(safeHTMLElement,"__esModule",{value:!0}),safeHTMLElement.canUseDOM=safeHTMLElement.SafeNodeList=safeHTMLElement.SafeHTMLCollection=void 0;var _exenv=exenvExports,_exenv2=_interopRequireDefault$3(_exenv);function _interopRequireDefault$3(e){return e&&e.__esModule?e:{default:e}}var EE=_exenv2.default,SafeHTMLElement=EE.canUseDOM?window.HTMLElement:{};safeHTMLElement.SafeHTMLCollection=EE.canUseDOM?window.HTMLCollection:{},safeHTMLElement.SafeNodeList=EE.canUseDOM?window.NodeList:{},safeHTMLElement.canUseDOM=EE.canUseDOM,safeHTMLElement.default=SafeHTMLElement,Object.defineProperty(ariaAppHider$1,"__esModule",{value:!0}),ariaAppHider$1.resetState=resetState$3,ariaAppHider$1.log=log$3,ariaAppHider$1.assertNodeList=assertNodeList,ariaAppHider$1.setElement=setElement,ariaAppHider$1.validateElement=validateElement,ariaAppHider$1.hide=hide$2,ariaAppHider$1.show=show,ariaAppHider$1.documentNotReadyOrSSRTesting=documentNotReadyOrSSRTesting;var _warning=warning_1,_warning2=_interopRequireDefault$2(_warning),_safeHTMLElement$1=safeHTMLElement;function _interopRequireDefault$2(e){return e&&e.__esModule?e:{default:e}}var globalElement=null;function resetState$3(){globalElement&&(globalElement.removeAttribute?globalElement.removeAttribute("aria-hidden"):null!=globalElement.length?globalElement.forEach((function(e){return e.removeAttribute("aria-hidden")})):document.querySelectorAll(globalElement).forEach((function(e){return e.removeAttribute("aria-hidden")}))),globalElement=null}function log$3(){if("production"!==process.env.NODE_ENV){var e=globalElement||{};console.log("ariaAppHider ----------"),console.log(e.nodeName,e.className,e.id),console.log("end ariaAppHider ----------")}}function assertNodeList(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function setElement(e){var t=e;if("string"==typeof t&&_safeHTMLElement$1.canUseDOM){var n=document.querySelectorAll(t);assertNodeList(n,t),t=n}return globalElement=t||globalElement}function validateElement(e){var t=e||globalElement;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,_warning2.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function hide$2(e){var t=!0,n=!1,i=void 0;try{for(var r,s=validateElement(e)[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){r.value.setAttribute("aria-hidden","true")}}catch(e){n=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw i}}}function show(e){var t=!0,n=!1,i=void 0;try{for(var r,s=validateElement(e)[Symbol.iterator]();!(t=(r=s.next()).done);t=!0){r.value.removeAttribute("aria-hidden")}}catch(e){n=!0,i=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw i}}}function documentNotReadyOrSSRTesting(){globalElement=null}var classList={};Object.defineProperty(classList,"__esModule",{value:!0}),classList.resetState=resetState$2,classList.log=log$2;var htmlClassList={},docBodyClassList={};function removeClass(e,t){e.classList.remove(t)}function resetState$2(){var e=document.getElementsByTagName("html")[0];for(var t in htmlClassList)removeClass(e,htmlClassList[t]);var n=document.body;for(var i in docBodyClassList)removeClass(n,docBodyClassList[i]);htmlClassList={},docBodyClassList={}}function log$2(){if("production"!==process.env.NODE_ENV){var e=document.getElementsByTagName("html")[0].className,t="Show tracked classes:\n\n";for(var n in t+="<html /> ("+e+"):\n  ",htmlClassList)t+="  "+n+" "+htmlClassList[n]+"\n  ";for(var i in t+="\n\ndoc.body ("+(e=document.body.className)+"):\n  ",docBodyClassList)t+="  "+i+" "+docBodyClassList[i]+"\n  ";t+="\n",console.log(t)}}var incrementReference=function(e,t){return e[t]||(e[t]=0),e[t]+=1,t},decrementReference=function(e,t){return e[t]&&(e[t]-=1),t},trackClass=function(e,t,n){n.forEach((function(n){incrementReference(t,n),e.add(n)}))},untrackClass=function(e,t,n){n.forEach((function(n){decrementReference(t,n),0===t[n]&&e.remove(n)}))};classList.add=function(e,t){return trackClass(e.classList,"html"==e.nodeName.toLowerCase()?htmlClassList:docBodyClassList,t.split(" "))},classList.remove=function(e,t){return untrackClass(e.classList,"html"==e.nodeName.toLowerCase()?htmlClassList:docBodyClassList,t.split(" "))};var portalOpenInstances$1={};function _classCallCheck$1(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(portalOpenInstances$1,"__esModule",{value:!0}),portalOpenInstances$1.log=log$1,portalOpenInstances$1.resetState=resetState$1;var PortalOpenInstances=function e(){var t=this;_classCallCheck$1(this,e),this.register=function(e){-1===t.openInstances.indexOf(e)?(t.openInstances.push(e),t.emit("register")):"production"!==process.env.NODE_ENV&&console.warn("React-Modal: Cannot register modal instance that's already open")},this.deregister=function(e){var n=t.openInstances.indexOf(e);-1!==n?(t.openInstances.splice(n,1),t.emit("deregister")):"production"!==process.env.NODE_ENV&&console.warn("React-Modal: Unable to deregister "+e+" as it was never registered")},this.subscribe=function(e){t.subscribers.push(e)},this.emit=function(e){t.subscribers.forEach((function(n){return n(e,t.openInstances.slice())}))},this.openInstances=[],this.subscribers=[]},portalOpenInstances=new PortalOpenInstances;function log$1(){console.log("portalOpenInstances ----------"),console.log(portalOpenInstances.openInstances.length),portalOpenInstances.openInstances.forEach((function(e){return console.log(e)})),console.log("end portalOpenInstances ----------")}function resetState$1(){portalOpenInstances=new PortalOpenInstances}portalOpenInstances$1.default=portalOpenInstances;var bodyTrap$1={};Object.defineProperty(bodyTrap$1,"__esModule",{value:!0}),bodyTrap$1.resetState=resetState,bodyTrap$1.log=log;var _portalOpenInstances=portalOpenInstances$1,_portalOpenInstances2=_interopRequireDefault$1(_portalOpenInstances);function _interopRequireDefault$1(e){return e&&e.__esModule?e:{default:e}}var before=void 0,after=void 0,instances=[];function resetState(){for(var e=[before,after],t=0;t<e.length;t++){var n=e[t];n&&(n.parentNode&&n.parentNode.removeChild(n))}before=after=null,instances=[]}function log(){console.log("bodyTrap ----------"),console.log(instances.length);for(var e=[before,after],t=0;t<e.length;t++){var n=e[t]||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")}function focusContent(){0!==instances.length?instances[instances.length-1].focusContent():"production"!==process.env.NODE_ENV&&console.warn("React-Modal: Open instances > 0 expected")}function bodyTrap(e,t){before||after||((before=document.createElement("div")).setAttribute("data-react-modal-body-trap",""),before.style.position="absolute",before.style.opacity="0",before.setAttribute("tabindex","0"),before.addEventListener("focus",focusContent),(after=before.cloneNode()).addEventListener("focus",focusContent)),(instances=t).length>0?(document.body.firstChild!==before&&document.body.insertBefore(before,document.body.firstChild),document.body.lastChild!==after&&document.body.appendChild(after)):(before.parentElement&&before.parentElement.removeChild(before),after.parentElement&&after.parentElement.removeChild(after))}_portalOpenInstances2.default.subscribe(bodyTrap),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=React,o=m(requirePropTypes()),a=f(focusManager),l=m(scopeTabExports),c=f(ariaAppHider$1),h=f(classList),d=safeHTMLElement,u=m(d),p=m(portalOpenInstances$1);function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}var g={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},O=0,y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOverlayRef=function(e){n.overlay=e,n.props.overlayRef&&n.props.overlayRef(e)},n.setContentRef=function(e){n.content=e,n.props.contentRef&&n.props.contentRef(e)},n.afterClose=function(){var e=n.props,t=e.appElement,i=e.ariaHideApp,r=e.htmlOpenClassName,s=e.bodyOpenClassName,o=e.parentSelector,l=o&&o().ownerDocument||document;s&&h.remove(l.body,s),r&&h.remove(l.getElementsByTagName("html")[0],r),i&&O>0&&0===(O-=1)&&c.show(t),n.props.shouldFocusAfterRender&&(n.props.shouldReturnFocusAfterClose?(a.returnFocus(n.props.preventScroll),a.teardownScopedFocus()):a.popWithoutFocus()),n.props.onAfterClose&&n.props.onAfterClose(),p.default.deregister(n)},n.open=function(){n.beforeOpen(),n.state.afterOpen&&n.state.beforeClose?(clearTimeout(n.closeTimer),n.setState({beforeClose:!1})):(n.props.shouldFocusAfterRender&&(a.setupScopedFocus(n.node),a.markForFocusLater()),n.setState({isOpen:!0},(function(){n.openAnimationFrame=requestAnimationFrame((function(){n.setState({afterOpen:!0}),n.props.isOpen&&n.props.onAfterOpen&&n.props.onAfterOpen({overlayEl:n.overlay,contentEl:n.content})}))})))},n.close=function(){n.props.closeTimeoutMS>0?n.closeWithTimeout():n.closeWithoutTimeout()},n.focusContent=function(){return n.content&&!n.contentHasFocus()&&n.content.focus({preventScroll:!0})},n.closeWithTimeout=function(){var e=Date.now()+n.props.closeTimeoutMS;n.setState({beforeClose:!0,closesAt:e},(function(){n.closeTimer=setTimeout(n.closeWithoutTimeout,n.state.closesAt-Date.now())}))},n.closeWithoutTimeout=function(){n.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},n.afterClose)},n.handleKeyDown=function(e){(function(e){return"Tab"===e.code||9===e.keyCode})(e)&&(0,l.default)(n.content,e),n.props.shouldCloseOnEsc&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&(e.stopPropagation(),n.requestClose(e))},n.handleOverlayOnClick=function(e){null===n.shouldClose&&(n.shouldClose=!0),n.shouldClose&&n.props.shouldCloseOnOverlayClick&&(n.ownerHandlesClose()?n.requestClose(e):n.focusContent()),n.shouldClose=null},n.handleContentOnMouseUp=function(){n.shouldClose=!1},n.handleOverlayOnMouseDown=function(e){n.props.shouldCloseOnOverlayClick||e.target!=n.overlay||e.preventDefault()},n.handleContentOnClick=function(){n.shouldClose=!1},n.handleContentOnMouseDown=function(){n.shouldClose=!1},n.requestClose=function(e){return n.ownerHandlesClose()&&n.props.onRequestClose(e)},n.ownerHandlesClose=function(){return n.props.onRequestClose},n.shouldBeClosed=function(){return!n.state.isOpen&&!n.state.beforeClose},n.contentHasFocus=function(){return document.activeElement===n.content||n.content.contains(document.activeElement)},n.buildClassName=function(e,t){var r="object"===(void 0===t?"undefined":i(t))?t:{base:g[e],afterOpen:g[e]+"--after-open",beforeClose:g[e]+"--before-close"},s=r.base;return n.state.afterOpen&&(s=s+" "+r.afterOpen),n.state.beforeClose&&(s=s+" "+r.beforeClose),"string"==typeof t&&t?s+" "+t:s},n.attributesFromObject=function(e,t){return Object.keys(t).reduce((function(n,i){return n[e+"-"+i]=t[i],n}),{})},n.state={afterOpen:!1,beforeClose:!1},n.shouldClose=null,n.moveFromContentToOverlay=null,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(e,t){"production"!==process.env.NODE_ENV&&(e.bodyOpenClassName!==this.props.bodyOpenClassName&&console.warn('React-Modal: "bodyOpenClassName" prop has been modified. This may cause unexpected behavior when multiple modals are open.'),e.htmlOpenClassName!==this.props.htmlOpenClassName&&console.warn('React-Modal: "htmlOpenClassName" prop has been modified. This may cause unexpected behavior when multiple modals are open.')),this.props.isOpen&&!e.isOpen?this.open():!this.props.isOpen&&e.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!t.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var e=this.props,t=e.appElement,n=e.ariaHideApp,i=e.htmlOpenClassName,r=e.bodyOpenClassName,s=e.parentSelector,o=s&&s().ownerDocument||document;r&&h.add(o.body,r),i&&h.add(o.getElementsByTagName("html")[0],i),n&&(O+=1,c.hide(t)),p.default.register(this)}},{key:"render",value:function(){var e=this.props,t=e.id,i=e.className,r=e.overlayClassName,s=e.defaultStyles,o=e.children,a=i?{}:s.content,l=r?{}:s.overlay;if(this.shouldBeClosed())return null;var c={ref:this.setOverlayRef,className:this.buildClassName("overlay",r),style:n({},l,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},h=n({id:t,ref:this.setContentRef,style:n({},a,this.props.style.content),className:this.buildClassName("content",i),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",n({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),d=this.props.contentElement(h,o);return this.props.overlayElement(c,d)}}]),t}(s.Component);y.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},y.propTypes={isOpen:o.default.bool.isRequired,defaultStyles:o.default.shape({content:o.default.object,overlay:o.default.object}),style:o.default.shape({content:o.default.object,overlay:o.default.object}),className:o.default.oneOfType([o.default.string,o.default.object]),overlayClassName:o.default.oneOfType([o.default.string,o.default.object]),parentSelector:o.default.func,bodyOpenClassName:o.default.string,htmlOpenClassName:o.default.string,ariaHideApp:o.default.bool,appElement:o.default.oneOfType([o.default.instanceOf(u.default),o.default.instanceOf(d.SafeHTMLCollection),o.default.instanceOf(d.SafeNodeList),o.default.arrayOf(o.default.instanceOf(u.default))]),onAfterOpen:o.default.func,onAfterClose:o.default.func,onRequestClose:o.default.func,closeTimeoutMS:o.default.number,shouldFocusAfterRender:o.default.bool,shouldCloseOnOverlayClick:o.default.bool,shouldReturnFocusAfterClose:o.default.bool,preventScroll:o.default.bool,role:o.default.string,contentLabel:o.default.string,aria:o.default.object,data:o.default.object,children:o.default.node,shouldCloseOnEsc:o.default.bool,overlayRef:o.default.func,contentRef:o.default.func,id:o.default.string,overlayElement:o.default.func,contentElement:o.default.func,testId:o.default.string},t.default=y,e.exports=t.default}(ModalPortal,ModalPortal.exports);var ModalPortalExports=ModalPortal.exports;function componentWillMount(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function componentWillReceiveProps(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!=n?n:null}.bind(this))}function componentWillUpdate(e,t){try{var n=this.props,i=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,i)}finally{this.props=n,this.state=i}}function polyfill(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,i=null,r=null;if("function"==typeof t.componentWillMount?n="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"==typeof t.componentWillReceiveProps?i="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(i="UNSAFE_componentWillReceiveProps"),"function"==typeof t.componentWillUpdate?r="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(r="UNSAFE_componentWillUpdate"),null!==n||null!==i||null!==r){var s=e.displayName||e.name,o="function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+s+" uses "+o+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==i?"\n  "+i:"")+(null!==r?"\n  "+r:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof e.getDerivedStateFromProps&&(t.componentWillMount=componentWillMount,t.componentWillReceiveProps=componentWillReceiveProps),"function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=componentWillUpdate;var a=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var i=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;a.call(this,e,t,i)}}return e}componentWillMount.__suppressDeprecationWarning=!0,componentWillReceiveProps.__suppressDeprecationWarning=!0,componentWillUpdate.__suppressDeprecationWarning=!0;var reactLifecyclesCompat_es=Object.freeze({__proto__:null,polyfill:polyfill}),require$$6=getAugmentedNamespace(reactLifecyclesCompat_es);Object.defineProperty(Modal$2,"__esModule",{value:!0}),Modal$2.bodyOpenClassName=Modal$2.portalClassName=void 0;var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_react=React,_react2=_interopRequireDefault(_react),_reactDom=ReactDOM,_reactDom2=_interopRequireDefault(_reactDom),_propTypes=requirePropTypes(),_propTypes2=_interopRequireDefault(_propTypes),_ModalPortal=ModalPortalExports,_ModalPortal2=_interopRequireDefault(_ModalPortal),_ariaAppHider=ariaAppHider$1,ariaAppHider=_interopRequireWildcard(_ariaAppHider),_safeHTMLElement=safeHTMLElement,_safeHTMLElement2=_interopRequireDefault(_safeHTMLElement),_reactLifecyclesCompat=require$$6;function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var portalClassName=Modal$2.portalClassName="ReactModalPortal",bodyOpenClassName=Modal$2.bodyOpenClassName="ReactModal__Body--open",isReact16=_safeHTMLElement.canUseDOM&&void 0!==_reactDom2.default.createPortal,createHTMLElement=function(e){return document.createElement(e)},getCreatePortal=function(){return isReact16?_reactDom2.default.createPortal:_reactDom2.default.unstable_renderSubtreeIntoContainer};function getParentElement(e){return e()}var Modal$1=function(e){function t(){var e,n,i;_classCallCheck(this,t);for(var r=arguments.length,s=Array(r),o=0;o<r;o++)s[o]=arguments[o];return n=i=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.removePortal=function(){!isReact16&&_reactDom2.default.unmountComponentAtNode(i.node);var e=getParentElement(i.props.parentSelector);e&&e.contains(i.node)?e.removeChild(i.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},i.portalRef=function(e){i.portal=e},i.renderPortal=function(e){var n=getCreatePortal()(i,_react2.default.createElement(_ModalPortal2.default,_extends({defaultStyles:t.defaultStyles},e)),i.node);i.portalRef(n)},_possibleConstructorReturn(i,n)}return _inherits(t,_react.Component),_createClass(t,[{key:"componentDidMount",value:function(){_safeHTMLElement.canUseDOM&&(isReact16||(this.node=createHTMLElement("div")),this.node.className=this.props.portalClassName,getParentElement(this.props.parentSelector).appendChild(this.node),!isReact16&&this.renderPortal(this.props))}},{key:"getSnapshotBeforeUpdate",value:function(e){return{prevParent:getParentElement(e.parentSelector),nextParent:getParentElement(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(e,t,n){if(_safeHTMLElement.canUseDOM){var i=this.props,r=i.isOpen,s=i.portalClassName;e.portalClassName!==s&&(this.node.className=s);var o=n.prevParent,a=n.nextParent;a!==o&&(o.removeChild(this.node),a.appendChild(this.node)),(e.isOpen||r)&&!isReact16&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(_safeHTMLElement.canUseDOM&&this.node&&this.portal){var e=this.portal.state,t=Date.now(),n=e.isOpen&&this.props.closeTimeoutMS&&(e.closesAt||t+this.props.closeTimeoutMS);n?(e.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,n-t)):this.removePortal()}}},{key:"render",value:function(){return _safeHTMLElement.canUseDOM&&isReact16?(!this.node&&isReact16&&(this.node=createHTMLElement("div")),getCreatePortal()(_react2.default.createElement(_ModalPortal2.default,_extends({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(e){ariaAppHider.setElement(e)}}]),t}();Modal$1.propTypes={isOpen:_propTypes2.default.bool.isRequired,style:_propTypes2.default.shape({content:_propTypes2.default.object,overlay:_propTypes2.default.object}),portalClassName:_propTypes2.default.string,bodyOpenClassName:_propTypes2.default.string,htmlOpenClassName:_propTypes2.default.string,className:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.shape({base:_propTypes2.default.string.isRequired,afterOpen:_propTypes2.default.string.isRequired,beforeClose:_propTypes2.default.string.isRequired})]),overlayClassName:_propTypes2.default.oneOfType([_propTypes2.default.string,_propTypes2.default.shape({base:_propTypes2.default.string.isRequired,afterOpen:_propTypes2.default.string.isRequired,beforeClose:_propTypes2.default.string.isRequired})]),appElement:_propTypes2.default.oneOfType([_propTypes2.default.instanceOf(_safeHTMLElement2.default),_propTypes2.default.instanceOf(_safeHTMLElement.SafeHTMLCollection),_propTypes2.default.instanceOf(_safeHTMLElement.SafeNodeList),_propTypes2.default.arrayOf(_propTypes2.default.instanceOf(_safeHTMLElement2.default))]),onAfterOpen:_propTypes2.default.func,onRequestClose:_propTypes2.default.func,closeTimeoutMS:_propTypes2.default.number,ariaHideApp:_propTypes2.default.bool,shouldFocusAfterRender:_propTypes2.default.bool,shouldCloseOnOverlayClick:_propTypes2.default.bool,shouldReturnFocusAfterClose:_propTypes2.default.bool,preventScroll:_propTypes2.default.bool,parentSelector:_propTypes2.default.func,aria:_propTypes2.default.object,data:_propTypes2.default.object,role:_propTypes2.default.string,contentLabel:_propTypes2.default.string,shouldCloseOnEsc:_propTypes2.default.bool,overlayRef:_propTypes2.default.func,contentRef:_propTypes2.default.func,id:_propTypes2.default.string,overlayElement:_propTypes2.default.func,contentElement:_propTypes2.default.func},Modal$1.defaultProps={isOpen:!1,portalClassName:portalClassName,bodyOpenClassName:bodyOpenClassName,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(e,t){return _react2.default.createElement("div",e,t)},contentElement:function(e,t){return _react2.default.createElement("div",e,t)}},Modal$1.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,_reactLifecyclesCompat.polyfill)(Modal$1),"production"!==process.env.NODE_ENV&&(Modal$1.setCreateHTMLElement=function(e){return createHTMLElement=e}),Modal$2.default=Modal$1,function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=Modal$2)&&n.__esModule?n:{default:n};t.default=i.default,e.exports=t.default}(lib,lib.exports);var libExports=lib.exports,Modal=getDefaultExportFromCjs(libExports),classnames={exports:{}};
/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/
!function(e){!function(){var t={}.hasOwnProperty;function n(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=r(e,i(n)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return n.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var i="";for(var s in e)t.call(e,s)&&e[s]&&(i=r(i,s));return i}function r(e,t){return t?e?e+" "+t:e+t:e}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(classnames);var classnamesExports=classnames.exports,classNames=getDefaultExportFromCjs(classnamesExports);const OverlayImpl=({children:e,className:t="",isOpen:n,style:i,closeOnEsc:r,onClose:s})=>{const[o,a]=React.useState(!1);return React.createElement(Modal,{isOpen:n,ariaHideApp:!1,onAfterOpen:()=>{a(!0)},onRequestClose:()=>{a(!1)},onAfterClose:()=>s&&s(),className:classNames("wy-panel wy-overlay wy-transition",t,{"wy-open":o}),overlayClassName:"wy-overlays wy-viewport",contentLabel:"Example Modal",style:i,shouldCloseOnEsc:r},e)},UIOverlay={UI:OverlayImpl};function __rest(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function __awaiter(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}function __generator(e,t){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function __read(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function __spreadArray(e,t,n){if(n||2===arguments.length)for(var i,r=0,s=t.length;r<s;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}"function"==typeof SuppressedError&&SuppressedError;var mdiAccountMinus="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M1,10V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",mdiAccountPlus="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z",mdiAlert="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z",mdiAlertCircle="M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",mdiAlertOctagon="M13 13H11V7H13M11 15H13V17H11M15.73 3H8.27L3 8.27V15.73L8.27 21H15.73L21 15.73V8.27L15.73 3Z",mdiArrowLeft="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z",mdiArrowRight="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z",mdiAttachment="M7.5,18A5.5,5.5 0 0,1 2,12.5A5.5,5.5 0 0,1 7.5,7H18A4,4 0 0,1 22,11A4,4 0 0,1 18,15H9.5A2.5,2.5 0 0,1 7,12.5A2.5,2.5 0 0,1 9.5,10H17V11.5H9.5A1,1 0 0,0 8.5,12.5A1,1 0 0,0 9.5,13.5H18A2.5,2.5 0 0,0 20.5,11A2.5,2.5 0 0,0 18,8.5H7.5A4,4 0 0,0 3.5,12.5A4,4 0 0,0 7.5,16.5H17V18H7.5Z",mdiBackupRestore="M12,3A9,9 0 0,0 3,12H0L4,16L8,12H5A7,7 0 0,1 12,5A7,7 0 0,1 19,12A7,7 0 0,1 12,19C10.5,19 9.09,18.5 7.94,17.7L6.5,19.14C8.04,20.3 9.94,21 12,21A9,9 0 0,0 21,12A9,9 0 0,0 12,3M14,12A2,2 0 0,0 12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12Z",mdiBell="M21,19V20H3V19L5,17V11C5,7.9 7.03,5.17 10,4.29C10,4.19 10,4.1 10,4A2,2 0 0,1 12,2A2,2 0 0,1 14,4C14,4.1 14,4.19 14,4.29C16.97,5.17 19,7.9 19,11V17L21,19M14,21A2,2 0 0,1 12,23A2,2 0 0,1 10,21",mdiBellOff="M20.84,22.73L18.11,20H3V19L5,17V11C5,9.86 5.29,8.73 5.83,7.72L1.11,3L2.39,1.73L22.11,21.46L20.84,22.73M19,15.8V11C19,7.9 16.97,5.17 14,4.29C14,4.19 14,4.1 14,4A2,2 0 0,0 12,2A2,2 0 0,0 10,4C10,4.1 10,4.19 10,4.29C9.39,4.47 8.8,4.74 8.26,5.09L19,15.8M12,23A2,2 0 0,0 14,21H10A2,2 0 0,0 12,23Z",mdiBox="M15.39,14.04V14.04C15.39,12.62 14.24,11.47 12.82,11.47C11.41,11.47 10.26,12.62 10.26,14.04V14.04C10.26,15.45 11.41,16.6 12.82,16.6C14.24,16.6 15.39,15.45 15.39,14.04M17.1,14.04C17.1,16.4 15.18,18.31 12.82,18.31C11.19,18.31 9.77,17.39 9.05,16.04C8.33,17.39 6.91,18.31 5.28,18.31C2.94,18.31 1.04,16.43 1,14.11V14.11H1V7H1V7C1,6.56 1.39,6.18 1.86,6.18C2.33,6.18 2.7,6.56 2.71,7V7H2.71V10.62C3.43,10.08 4.32,9.76 5.28,9.76C6.91,9.76 8.33,10.68 9.05,12.03C9.77,10.68 11.19,9.76 12.82,9.76C15.18,9.76 17.1,11.68 17.1,14.04V14.04M7.84,14.04V14.04C7.84,12.62 6.69,11.47 5.28,11.47C3.86,11.47 2.71,12.62 2.71,14.04V14.04C2.71,15.45 3.86,16.6 5.28,16.6C6.69,16.6 7.84,15.45 7.84,14.04M22.84,16.96V16.96C22.95,17.12 23,17.3 23,17.47C23,17.73 22.88,18 22.66,18.15C22.5,18.26 22.33,18.32 22.15,18.32C21.9,18.32 21.65,18.21 21.5,18L19.59,15.47L17.7,18V18C17.53,18.21 17.28,18.32 17.03,18.32C16.85,18.32 16.67,18.26 16.5,18.15C16.29,18 16.17,17.72 16.17,17.46C16.17,17.29 16.23,17.11 16.33,16.96V16.96H16.33V16.96L18.5,14.04L16.33,11.11V11.11H16.33V11.11C16.22,10.96 16.17,10.79 16.17,10.61C16.17,10.35 16.29,10.1 16.5,9.93C16.89,9.65 17.41,9.72 17.7,10.09V10.09L19.59,12.61L21.5,10.09C21.76,9.72 22.29,9.65 22.66,9.93C22.89,10.1 23,10.36 23,10.63C23,10.8 22.95,10.97 22.84,11.11V11.11H22.84V11.11L20.66,14.04L22.84,16.96V16.96H22.84Z",mdiChartBox="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M9 17H7V10H9V17M13 17H11V7H13V17M17 17H15V13H17V17Z",mdiCheck="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z",mdiCheckCircle="M12 2C6.5 2 2 6.5 2 12S6.5 22 12 22 22 17.5 22 12 17.5 2 12 2M10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z",mdiCheckboxBlankOutline="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,5V19H5V5H19Z",mdiCheckboxMarkedOutline="M19,19H5V5H15V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V11H19M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z",mdiCircleOutline="M12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",mdiClose="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",mdiCloseCircle="M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z",mdiCloud="M6.5 20Q4.22 20 2.61 18.43 1 16.85 1 14.58 1 12.63 2.17 11.1 3.35 9.57 5.25 9.15 5.88 6.85 7.75 5.43 9.63 4 12 4 14.93 4 16.96 6.04 19 8.07 19 11 20.73 11.2 21.86 12.5 23 13.78 23 15.5 23 17.38 21.69 18.69 20.38 20 18.5 20Z",mdiComment="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9Z",mdiCommentOutline="M9,22A1,1 0 0,1 8,21V18H4A2,2 0 0,1 2,16V4C2,2.89 2.9,2 4,2H20A2,2 0 0,1 22,4V16A2,2 0 0,1 20,18H13.9L10.2,21.71C10,21.9 9.75,22 9.5,22V22H9M10,16V19.08L13.08,16H20V4H4V16H10Z",mdiContentSave="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z",mdiDelete="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z",mdiDeleteForever="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8.46,11.88L9.87,10.47L12,12.59L14.12,10.47L15.53,11.88L13.41,14L15.53,16.12L14.12,17.53L12,15.41L9.88,17.53L8.47,16.12L10.59,14L8.46,11.88M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z",mdiDeleteRestore="M14,14H16L12,10L8,14H10V18H14V14M6,7H18V19C18,19.5 17.8,20 17.39,20.39C17,20.8 16.5,21 16,21H8C7.5,21 7,20.8 6.61,20.39C6.2,20 6,19.5 6,19V7M19,4V6H5V4H8.5L9.5,3H14.5L15.5,4H19Z",mdiDotsVertical="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",mdiDownload="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",mdiDropbox="M3 6.2L8 9.39L13 6.2L8 3L3 6.2M13 6.2L18 9.39L23 6.2L18 3L13 6.2M3 12.55L8 15.74L13 12.55L8 9.35L3 12.55M18 9.35L13 12.55L18 15.74L23 12.55L18 9.35M8.03 16.8L13.04 20L18.04 16.8L13.04 13.61L8.03 16.8Z",mdiEmail="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z",mdiFile="M13,9V3.5L18.5,9M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6Z",mdiFileCode="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M6.12,15.5L9.86,19.24L11.28,17.83L8.95,15.5L11.28,13.17L9.86,11.76L6.12,15.5M17.28,15.5L13.54,11.76L12.12,13.17L14.45,15.5L12.12,17.83L13.54,19.24L17.28,15.5Z",mdiFileDocument="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M15,18V16H6V18H15M18,14V12H6V14H18Z",mdiFileExcel="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M15.8,20H14L12,16.6L10,20H8.2L11.1,15.5L8.2,11H10L12,14.4L14,11H15.8L12.9,15.5L15.8,20M13,9V3.5L18.5,9H13Z",mdiFileImage="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M6,20H15L18,20V12L14,16L12,14L6,20M8,9A2,2 0 0,0 6,11A2,2 0 0,0 8,13A2,2 0 0,0 10,11A2,2 0 0,0 8,9Z",mdiFileMusic="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13,13H11V18A2,2 0 0,1 9,20A2,2 0 0,1 7,18A2,2 0 0,1 9,16C9.4,16 9.7,16.1 10,16.3V11H13V13M13,9V3.5L18.5,9H13Z",mdiFilePowerpoint="M12.6,12.3H10.6V15.5H12.7C13.3,15.5 13.6,15.3 13.9,15C14.2,14.7 14.3,14.4 14.3,13.9C14.3,13.4 14.2,13.1 13.9,12.8C13.6,12.5 13.2,12.3 12.6,12.3M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M15.2,16C14.6,16.5 14.1,16.7 12.8,16.7H10.6V20H9V11H12.8C14.1,11 14.7,11.3 15.2,11.8C15.8,12.4 16,13 16,13.9C16,14.8 15.8,15.5 15.2,16M13,9V3.5L18.5,9H13Z",mdiFileVideo="M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M17,19V13L14,15.2V13H7V19H14V16.8L17,19Z",mdiFileWord="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M15.2,20H13.8L12,13.2L10.2,20H8.8L6.6,11H8.1L9.5,17.8L11.3,11H12.6L14.4,17.8L15.8,11H17.3L15.2,20M13,9V3.5L18.5,9H13Z",mdiFitToPage="M20,2H4C2.89,2 2,2.89 2,4V20C2,21.11 2.89,22 4,22H20C21.11,22 22,21.11 22,20V4C22,2.89 21.11,2 20,2M12,4L15,7H13V9H11V7H9M7,15L4,12L7,9V11H9V13H7M12,20L9,17H11V15H13V17H15M17,15V13H15V11H17V9L20,12",mdiFitToScreen="M17 4H20C21.1 4 22 4.9 22 6V8H20V6H17V4M4 8V6H7V4H4C2.9 4 2 4.9 2 6V8H4M20 16V18H17V20H20C21.1 20 22 19.1 22 18V16H20M7 18H4V16H2V18C2 19.1 2.9 20 4 20H7V18M18 8H6V16H18V8Z",mdiFolderZip="M20 6H12L10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6M18 12H16V14H18V16H16V18H14V16H16V14H14V12H16V10H14V8H16V10H18V12Z",mdiFormTextbox="M17,7H22V17H17V19A1,1 0 0,0 18,20H20V22H17.5C16.95,22 16,21.55 16,21C16,21.55 15.05,22 14.5,22H12V20H14A1,1 0 0,0 15,19V5A1,1 0 0,0 14,4H12V2H14.5C15.05,2 16,2.45 16,3C16,2.45 16.95,2 17.5,2H20V4H18A1,1 0 0,0 17,5V7M2,7H13V9H4V15H13V17H2V7M20,15V9H17V15H20Z",mdiGoogleDrive="M7.71,3.5L1.15,15L4.58,21L11.13,9.5M9.73,15L6.3,21H19.42L22.85,15M22.28,14L15.42,2H8.58L8.57,2L15.43,14H22.28Z",mdiHelpCircle="M15.07,11.25L14.17,12.17C13.45,12.89 13,13.5 13,15H11V14.5C11,13.39 11.45,12.39 12.17,11.67L13.41,10.41C13.78,10.05 14,9.55 14,9C14,7.89 13.1,7 12,7A2,2 0 0,0 10,9H8A4,4 0 0,1 12,5A4,4 0 0,1 16,9C16,9.88 15.64,10.67 15.07,11.25M13,19H11V17H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12C22,6.47 17.5,2 12,2Z",mdiInformationOutline="M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M11,17H13V11H11V17Z",mdiMagnify="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z",mdiMenuDown="M7,10L12,15L17,10H7Z",mdiMenuUp="M7,15L12,10L17,15H7Z",mdiMessageBadge="M22 7V16C22 17.1 21.1 18 20 18H6L2 22V4C2 2.9 2.9 2 4 2H14.1C14 2.3 14 2.7 14 3C14 5.8 16.2 8 19 8C20.1 8 21.2 7.6 22 7M16 3C16 4.7 17.3 6 19 6S22 4.7 22 3 20.7 0 19 0 16 1.3 16 3Z",mdiMicrosoftOnedrive="M18.21 10.29Q19 10.34 19.7 10.68 20.39 11 20.9 11.57 21.41 12.12 21.71 12.83 22 13.54 22 14.34 22 15.18 21.68 15.92 21.36 16.66 20.8 17.21 20.25 17.76 19.5 18.08 18.78 18.41 17.94 18.41H7Q5.97 18.41 5.06 18 4.15 17.61 3.47 16.94 2.79 16.26 2.4 15.35 2 14.44 2 13.41 2 12.59 2.26 11.83 2.5 11.08 3 10.45 3.44 9.82 4.08 9.35 4.72 8.88 5.5 8.63 5.87 8.5 6.21 8.5 6.56 8.43 6.93 8.41H6.94Q7.37 7.75 7.95 7.23 8.5 6.71 9.2 6.34 9.87 6 10.62 5.78 11.37 5.59 12.16 5.59 13.22 5.59 14.2 5.94 15.18 6.29 16 6.91 16.8 7.53 17.37 8.39 17.95 9.26 18.21 10.29M12.16 6.84Q11.05 6.84 10.06 7.3 9.06 7.75 8.36 8.6 8.73 8.7 9.07 8.85 9.4 9 9.73 9.2L13.71 11.58L16 10.62Q16.21 10.53 16.44 10.45 16.67 10.38 16.92 10.33 16.68 9.55 16.21 8.91 15.74 8.27 15.11 7.81 14.5 7.35 13.73 7.1 13 6.84 12.16 6.84M4 15.66L12.27 12.18L9.08 10.26Q8.59 9.97 8.06 9.81 7.5 9.66 6.95 9.66 6.19 9.66 5.5 9.96 4.84 10.26 4.34 10.77 3.84 11.29 3.54 11.97 3.25 12.65 3.25 13.41 3.25 14 3.45 14.59 3.64 15.19 4 15.66M17.94 17.16Q18.41 17.16 18.84 17 19.27 16.86 19.64 16.58L13.61 13L5.03 16.59Q5.47 16.86 5.97 17 6.47 17.16 7 17.16M20.45 15.61Q20.75 15 20.75 14.34 20.75 13.7 20.5 13.17 20.26 12.65 19.85 12.28 19.43 11.91 18.88 11.71 18.32 11.5 17.7 11.5 17.35 11.5 17 11.6 16.66 11.68 16.33 11.81 16 11.93 15.67 12.08 15.35 12.23 15.04 12.37Z",mdiMinus="M19,13H5V11H19V13Z",mdiOpenInNew="M14,3V5H17.59L7.76,14.83L9.17,16.24L19,6.41V10H21V3M19,19H5V5H12V3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V12H19V19Z",mdiPencil="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z",mdiPin="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z",mdiPinOff="M2,5.27L3.28,4L20,20.72L18.73,22L12.8,16.07V22H11.2V16H6V14L8,12V11.27L2,5.27M16,12L18,14V16H17.82L8,6.18V4H7V2H17V4H16V12Z",mdiPlus="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z",mdiPlusCircleOutline="M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z",mdiRestore="M13,3A9,9 0 0,0 4,12H1L4.89,15.89L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3Z",mdiSend="M2,21L23,12L2,3V10L17,12L2,14V21Z",mdiSort="M18 21L14 17H17V7H14L18 3L22 7H19V17H22M2 19V17H12V19M2 13V11H9V13M2 7V5H6V7H2Z",mdiStar="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",mdiStarOff="M20.8 22.7L17.9 19.8L18.2 21L12 17.3L5.8 21L7.4 14L2 9.2L6.9 8.8L1.1 3L2.4 1.7L22.1 21.4L20.8 22.7M22 9.2L14.8 8.6L12 2L10 6.8L16.9 13.7L22 9.2Z",mdiSwapHorizontal="M21,9L17,5V8H10V10H17V13M7,11L3,15L7,19V16H14V14H7V11Z",mdiThumbUp="M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z",mdiThumbUpOutline="M5,9V21H1V9H5M9,21A2,2 0 0,1 7,19V9C7,8.45 7.22,7.95 7.59,7.59L14.17,1L15.23,2.06C15.5,2.33 15.67,2.7 15.67,3.11L15.64,3.43L14.69,8H21C22.11,8 23,8.9 23,10V12C23,12.26 22.95,12.5 22.86,12.73L19.84,19.78C19.54,20.5 18.83,21 18,21H9M9,19H18.03L21,12V10H12.21L13.34,4.68L9,9.03V19Z",mdiTrashCan="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z",mdiVideo="M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z",mdiViewListOutline="M3 5V19H20V5H3M7 7V9H5V7H7M5 13V11H7V13H5M5 15H7V17H5V15M18 17H9V15H18V17M18 13H9V11H18V13M18 9H9V7H18V9Z",mdiViewModuleOutline="M4 5V18H21V5H4M14 7V10.5H11V7H14M6 7H9V10.5H6V7M6 16V12.5H9V16H6M11 16V12.5H14V16H11M19 16H16V12.5H19V16M16 10.5V7H19V10.5H16Z",Icon$1=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t){e.exports=requirePropTypes()},function(e,t){e.exports=React},function(e,t,n){n.r(t);var i=n(1),r=n(0),s=function(){return(s=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=0,a=i.forwardRef((function(e,t){var n=e.title,r=void 0===n?null:n,a=e.description,l=void 0===a?null:a,c=e.size,h=void 0===c?null:c,d=e.color,u=void 0===d?"currentColor":d,p=e.horizontal,f=void 0===p?null:p,m=e.vertical,g=void 0===m?null:m,O=e.rotate,y=void 0===O?null:O,v=e.spin,b=void 0===v?null:v,w=e.style,S=void 0===w?{}:w,x=e.children,C=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["title","description","size","color","horizontal","vertical","rotate","spin","style","children"]);o++;var _,E=null!==b&&b,P=i.Children.map(x,(function(e){var t=e;!0!==E&&(E=!0===(null===b?t.props.spin:b));var n=t.props.size;"number"==typeof h&&"number"==typeof t.props.size&&(n=t.props.size/h);var r={size:n,color:null===u?t.props.color:u,horizontal:null===f?t.props.horizontal:f,vertical:null===g?t.props.vertical:g,rotate:null===y?t.props.rotate:y,spin:null===b?t.props.spin:b,inStack:!0};return i.cloneElement(t,r)}));null!==h&&(S.width="string"==typeof h?h:1.5*h+"rem");var k,T="stack_labelledby_"+o,A="stack_describedby_"+o;if(r)_=l?T+" "+A:T;else if(k="presentation",l)throw new Error("title attribute required when description is set");return i.createElement("svg",s({ref:t,viewBox:"0 0 24 24",style:S,role:k,"aria-labelledby":_},C),r&&i.createElement("title",{id:T},r),l&&i.createElement("desc",{id:A},l),E&&i.createElement("style",null,"@keyframes spin { from { transform: rotate(0deg) } to { transform: rotate(360deg) } }","@keyframes spin-inverse { from { transform: rotate(0deg) } to { transform: rotate(-360deg) } }"),P)}));a.displayName="Stack",a.propTypes={size:r.oneOfType([r.number,r.string]),color:r.string,horizontal:r.bool,vertical:r.bool,rotate:r.number,spin:r.oneOfType([r.bool,r.number]),children:r.oneOfType([r.arrayOf(r.node),r.node]).isRequired,className:r.string,style:r.object},a.defaultProps={size:null,color:null,horizontal:null,vertical:null,rotate:null,spin:null};var l=a;n.d(t,"Icon",(function(){return d})),n.d(t,"Stack",(function(){return l}));var c=function(){return(c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},h=0,d=i.forwardRef((function(e,t){var n=e.path,r=e.id,s=void 0===r?++h:r,o=e.title,a=void 0===o?null:o,l=e.description,d=void 0===l?null:l,u=e.size,p=void 0===u?null:u,f=e.color,m=void 0===f?"currentColor":f,g=e.horizontal,O=void 0!==g&&g,y=e.vertical,v=void 0!==y&&y,b=e.rotate,w=void 0===b?0:b,S=e.spin,x=void 0!==S&&S,C=e.style,_=void 0===C?{}:C,E=e.inStack,P=void 0!==E&&E,k=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}(e,["path","id","title","description","size","color","horizontal","vertical","rotate","spin","style","inStack"]),T={},A=[];null!==p&&(P?A.push("scale("+p+")"):(_.width="string"==typeof p?p:1.5*p+"rem",_.height=_.width)),O&&A.push("scaleX(-1)"),v&&A.push("scaleY(-1)"),0!==w&&A.push("rotate("+w+"deg)"),null!==m&&(T.fill=m);var R=i.createElement("path",c({d:n,style:T},P?k:{})),M=R;A.length>0&&(_.transform=A.join(" "),_.transformOrigin="center",P&&(M=i.createElement("g",{style:_},R,i.createElement("rect",{width:"24",height:"24",fill:"transparent"}))));var I,L=M,$=!0===x||"number"!=typeof x?2:x,D=!P&&(O||v);if($<0&&(D=!D),x&&(L=i.createElement("g",{style:{animation:"spin"+(D?"-inverse":"")+" linear "+Math.abs($)+"s infinite",transformOrigin:"center"}},M,!(O||v||0!==w)&&i.createElement("rect",{width:"24",height:"24",fill:"transparent"}))),P)return L;var N,Q="icon_labelledby_"+s,F="icon_describedby_"+s;if(a)I=d?Q+" "+F:Q;else if(N="presentation",d)throw new Error("title attribute required when description is set");return i.createElement("svg",c({ref:t,viewBox:"0 0 24 24",style:_,role:N,"aria-labelledby":I},k),a&&i.createElement("title",{id:Q},a),d&&i.createElement("desc",{id:F},d),!P&&x&&(D?i.createElement("style",null,"@keyframes spin-inverse { from { transform: rotate(0deg) } to { transform: rotate(-360deg) } }"):i.createElement("style",null,"@keyframes spin { from { transform: rotate(0deg) } to { transform: rotate(360deg) } }")),L)}));d.displayName="Icon",d.propTypes={path:r.string.isRequired,size:r.oneOfType([r.number,r.string]),color:r.string,horizontal:r.bool,vertical:r.bool,rotate:r.number,spin:r.oneOfType([r.bool,r.number]),style:r.object,inStack:r.bool,className:r.string},d.defaultProps={size:null,color:"currentColor",horizontal:!1,vertical:!1,rotate:0,spin:!1},t.default=d}]),MdiIcon=getDefaultExportFromCjs(Icon$1);const iconMapping={"account-minus":mdiAccountMinus,"account-plus":mdiAccountPlus,alert:mdiAlert,"alert-circle":mdiAlertCircle,"alert-octagon":mdiAlertOctagon,attachment:mdiAttachment,back:mdiArrowLeft,"backup-restore":mdiBackupRestore,bell:mdiBell,"bell-off":mdiBellOff,check:mdiCheck,"checkbox-blank":mdiCheckboxBlankOutline,"checkbox-marked":mdiCheckboxMarkedOutline,"circle-outline":mdiCircleOutline,"check-circle":mdiCheckCircle,close:mdiClose,"close-circle":mdiCloseCircle,comment:mdiComment,"comment-outline":mdiCommentOutline,"content-save":mdiContentSave,delete:mdiDelete,"delete-restore":mdiDeleteRestore,"delete-forever":mdiDeleteForever,"dots-vertical":mdiDotsVertical,download:mdiDownload,"emoticon-plus":"M 19 0 L 19 3 L 16 3 L 16 5 L 19 5 L 19 8 L 21 8 L 21 5 L 24 5 L 24 3 L 21 3 L 21 0 L 19 0 z M 12 2 C 6.5 2 2 6.5 2 12 C 2 17.5 6.5 22 12 22 C 17.5 22 22 17.5 22 12 L 20 12 C 20 16.4 16.4 20 12 20 C 7.6 20 4 16.4 4 12 C 4 7.6 7.6 4 12 4 L 12 2 z M 8.5 8 C 7.7 8 7 8.7 7 9.5 C 7 10.3 7.7 11 8.5 11 C 9.3 11 10 10.3 10 9.5 C 10 8.7 9.3 8 8.5 8 z M 15.5 8 C 14.7 8 14 8.7 14 9.5 C 14 10.3 14.7 11 15.5 11 C 16.3 11 17 10.3 17 9.5 C 17 8.7 16.3 8 15.5 8 z M 6.9 14 C 7.7 16 9.7 17.5 12 17.5 C 14.3 17.5 16.3 16 17.1 14 L 6.9 14 z","fit-screen":mdiFitToScreen,"fit-width":mdiFitToPage,"help-circle":mdiHelpCircle,information:mdiInformationOutline,magnify:mdiMagnify,"menu-down":mdiMenuDown,"menu-up":mdiMenuUp,minus:mdiMinus,next:mdiArrowRight,"open-in-new":mdiOpenInNew,pencil:mdiPencil,pin:mdiPin,unpin:mdiPinOff,plus:mdiPlus,"plus-circle-outline":mdiPlusCircleOutline,poll:mdiChartBox,previous:mdiArrowLeft,read:mdiMessageBadge,restore:mdiRestore,unread:mdiCheck,send:mdiSend,sort:mdiSort,star:mdiStar,unstar:mdiStarOff,"swap-horizontal":mdiSwapHorizontal,textbox:mdiFormTextbox,"thumb-up":mdiThumbUp,"thumb-up-outline":mdiThumbUpOutline,trashcan:mdiTrashCan,video:mdiVideo,"view-list-outline":mdiViewListOutline,"view-module-outline":mdiViewModuleOutline,email:mdiEmail,file:mdiFile,"file-music":mdiFileMusic,"file-image":mdiFileImage,"file-video":mdiFileVideo,"file-code":mdiFileCode,"file-xml":mdiFileCode,"file-document":mdiFileDocument,"file-word":mdiFileWord,"file-excel":mdiFileExcel,"file-pdf":mdiFileDocument,"file-powerpoint":mdiFilePowerpoint,"file-compressed":mdiFolderZip,dropbox:mdiDropbox,onedrive:mdiMicrosoftOnedrive,box:mdiBox,"google-drive":mdiGoogleDrive,zoom:"m12 2c-5.6 0-10 4.5-10 10 0 5.6 4.5 10 10 10 5.5 0 9.9-4.5 9.9-10 .1-5.6-4.4-10-9.9-10zm2.6 13.1c0 .2-.1.3-.3.3h-6.9c-1.1 0-1.9-.8-1.9-1.9v-4.6c0-.2.1-.3.3-.3h6.9c1 0 1.9.8 1.9 1.9zm3.8.1c0 .4-.2.4-.5.2l-2.8-2.1v-2.6l2.8-2.1c.2-.2.5-.1.5.2z",cloud:mdiCloud},nativeColors={dropbox:"#0061fe",onedrive:"#0078d4",box:"#0161d5","google-drive":"#1a73e8",zoom:"#4a8cff"};function getIconName(e){return e.split("+")}function getIconMapping(e){return e in iconMapping?iconMapping[e]:""}const Icon=e=>{var{name:t,color:n="",size:i,className:r,title:s=""}=e,o=__rest(e,["name","color","size","className","title"]);let[a,l]=getIconName(t),c=getIconMapping(a),h=getIconMapping(l),d="native"===n&&nativeColors[a]||"",u=l&&nativeColors[l]||"";null!=s||(s=t.split("+").join(" "));let p=i?i/16:void 0,f=p?p/1.5:void 0;return c?h?React.createElement("span",{className:"wy-icon-stack",style:{width:p&&p+"rem",height:p&&p+"rem"},title:s},React.createElement(MdiIcon,Object.assign({className:classNames("wy-icon",n?"wy-icon-"+n:"",r),color:d,path:c,size:f||"","data-icon":a},o)),React.createElement(MdiIcon,{color:u,path:h,className:classNames("wy-icon","wy-icon-overlay",`wy-icon-${l}`),size:(f||1)/2,"data-icon":l})):React.createElement(MdiIcon,Object.assign({className:classNames("wy-icon",n?"wy-icon-"+n:"",r),color:d,path:c,size:f||"",title:s,"data-icon":a},o)):React.createElement(React.Fragment,null,t)},IconActiveStack=({className:e,children:t})=>React.createElement("div",{className:classNames("wy-icon-active-stack",e)},t),UIIcon={UI:Icon,ActiveStack:IconActiveStack},SpinnerImpl=({spin:e=!0,size:t=24,overlay:n=!1,progress:i})=>{var r=!e&&i&&100-i||void 0;return void 0!==r?React.createElement("svg",{viewBox:"0 0 24 24",width:t,height:t,transform:"rotate(-90)","data-icon":"progress",className:"wy-icon wy-icon-primary"},React.createElement("circle",{cx:"12",cy:"12",r:"10",strokeLinecap:"butt",strokeWidth:"2",fill:"none",stroke:"#eee"}),React.createElement("circle",{cx:"12",cy:"12",r:"10",strokeDasharray:"100",strokeDashoffset:r,strokeLinecap:"butt",strokeWidth:"2",fill:"none",stroke:"currentColor",pathLength:"100"})):React.createElement("svg",{className:classNames("wy-spinner",{"wy-spin":e,"wy-spinner-overlay":n}),width:t,height:t,viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},React.createElement("circle",{fill:"none",cx:"12",cy:"12",r:"11",strokeLinecap:"butt",strokeWidth:"2"}))},UISpinner={UI:SpinnerImpl},Button=React.forwardRef(((e,t)=>{var{active:n=!1,type:i="button",onClick:r,className:s="",children:o}=e,a=__rest(e,["active","type","onClick","className","children"]);let l=1===React.Children.count(o)&&React.Children.toArray(o).pop(),c=classNames("wy-button",s,{"wy-active":n,"wy-button-icon":(null==l?void 0:l.type)===UIIcon.UI||(null==l?void 0:l.type)===UIIcon.ActiveStack||(null==l?void 0:l.type)===UISpinner.UI});return React.createElement("button",Object.assign({ref:t,type:i,className:c,onClick:r},a),o)})),UIButton={UI:Button};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}},_nodeResolve_empty={},_nodeResolve_empty$1=Object.freeze({__proto__:null,default:_nodeResolve_empty}),require$$5=getAugmentedNamespace(_nodeResolve_empty$1);
/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2023 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */
(function(module,exports){!function(e,t){module.exports=e.pdfjsLib=t()}(globalThis,(()=>(()=>{var __webpack_modules__=[,(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=function(e,t){e||o(t)},t.bytesToString=c,t.createValidAbsoluteUrl=function(e,t=null,n=null){if(!e)return null;try{if(n&&"string"==typeof e){if(n.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);t?.length>=2&&(e=`http://${e}`)}if(n.tryConvertEncoding)try{e=p(e)}catch{}}const i=t?new URL(e,t):new URL(e);if(function(e){switch(e?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(i))return i}catch{}return null},t.getModificationDate=function(e=new Date){return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),e.getUTCDate().toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getUuid=function(){if("undefined"!=typeof crypto&&"function"==typeof crypto?.randomUUID)return crypto.randomUUID();const e=new Uint8Array(32);if("undefined"!=typeof crypto&&"function"==typeof crypto?.getRandomValues)crypto.getRandomValues(e);else for(let t=0;t<32;t++)e[t]=Math.floor(255*Math.random());return c(e)},t.getVerbosityLevel=function(){return r},t.info=function(e){r>=i.INFOS&&console.log(`Info: ${e}`)},t.isArrayBuffer=function(e){return"object"==typeof e&&void 0!==e?.byteLength},t.isArrayEqual=function(e,t){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0},t.isNodeJS=void 0,t.normalizeUnicode=function(e){f||(f=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,m=new Map([["","t"]]));return e.replaceAll(f,((e,t,n)=>t?t.normalize("NFKC"):m.get(n)))},t.objectFromMap=function(e){const t=Object.create(null);for(const[n,i]of e)t[n]=i;return t},t.objectSize=function(e){return Object.keys(e).length},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(r=e)},t.shadow=a,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=h,t.stringToPDFString=function(e){if(e[0]>=""){let t;if(""===e[0]&&""===e[1]?t="utf-16be":""===e[0]&&""===e[1]?t="utf-16le":""===e[0]&&""===e[1]&&""===e[2]&&(t="utf-8"),t)try{const n=new TextDecoder(t,{fatal:!0}),i=h(e);return n.decode(i)}catch(e){s(`stringToPDFString: "${e}".`)}}const t=[];for(let n=0,i=e.length;n<i;n++){const i=u[e.charCodeAt(n)];t.push(i?String.fromCharCode(i):e.charAt(n))}return t.join("")},t.stringToUTF8String=p,t.unreachable=o,t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=s;const n=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=n;t.IDENTITY_MATRIX=[1,0,0,1,0,0];t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0];t.MAX_IMAGE_SIZE_TO_CACHE=1e7;t.LINE_FACTOR=1.35;t.LINE_DESCENT_FACTOR=.35;t.BASELINE_FACTOR=.25925925925925924;t.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationEditorPrefix="pdfjs_internal_editor_";t.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorParamsType={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationReplyType={GROUP:"Group",REPLY:"R"};t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.PageActionEventType={O:"PageOpen",C:"PageClose"};const i={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=i;t.CMapCompressionType={NONE:0,BINARY:1};t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let r=i.WARNINGS;function s(e){r>=i.WARNINGS&&console.log(`Warning: ${e}`)}function o(e){throw new Error(e)}function a(e,t,n,i=!1){return Object.defineProperty(e,t,{value:n,enumerable:!i,configurable:!0,writable:!1}),n}const l=function(){function e(t,n){this.constructor===e&&o("Cannot initialize BaseException."),this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e}();t.BaseException=l;t.PasswordException=class extends l{constructor(e,t){super(e,"PasswordException"),this.code=t}};t.UnknownErrorException=class extends l{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}};t.InvalidPDFException=class extends l{constructor(e){super(e,"InvalidPDFException")}};t.MissingPDFException=class extends l{constructor(e){super(e,"MissingPDFException")}};t.UnexpectedResponseException=class extends l{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}};t.FormatError=class extends l{constructor(e){super(e,"FormatError")}};function c(e){"object"==typeof e&&void 0!==e?.length||o("Invalid argument for bytesToString");const t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);const i=[];for(let r=0;r<t;r+=n){const s=Math.min(r+n,t),o=e.subarray(r,s);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function h(e){"string"!=typeof e&&o("Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}t.AbortException=class extends l{constructor(e){super(e,"AbortException")}};t.FeatureTest=class{static get isLittleEndian(){return a(this,"isLittleEndian",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}static get isEvalSupported(){return a(this,"isEvalSupported",function(){try{return new Function(""),!0}catch{return!1}}())}static get isOffscreenCanvasSupported(){return a(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}static get platform(){return"undefined"==typeof navigator?a(this,"platform",{isWin:!1,isMac:!1}):a(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return a(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}};const d=[...Array(256).keys()].map((e=>e.toString(16).padStart(2,"0")));t.Util=class{static makeHexColor(e,t,n){return`#${d[e]}${d[t]}${d[n]}`}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[1],t[1]=n),t[0]*=e[0],t[1]*=e[0],e[3]<0&&(n=t[2],t[2]=t[3],t[3]=n),t[2]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[2],t[2]=n,n=t[1],t[1]=t[3],t[3]=n,e[1]<0&&(n=t[2],t[2]=t[3],t[3]=n),t[2]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[1],t[1]=n),t[0]*=e[2],t[1]*=e[2]),t[0]+=e[4],t[1]+=e[4],t[2]+=e[5],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]}static getAxialAlignedBoundingBox(e,t){const n=this.applyTransform(e,t),i=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),s=this.applyTransform([e[2],e[1]],t);return[Math.min(n[0],i[0],r[0],s[0]),Math.min(n[1],i[1],r[1],s[1]),Math.max(n[0],i[0],r[0],s[0]),Math.max(n[1],i[1],r[1],s[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],s=e[2]*t[1]+e[3]*t[3],o=(n+s)/2,a=Math.sqrt((n+s)**2-4*(n*s-r*i))/2,l=o+a||1,c=o-a||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),s=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>s?null:[n,r,i,s]}static bezierBoundingBox(e,t,n,i,r,s,o,a){const l=[],c=[[],[]];let h,d,u,p,f,m,g,O;for(let c=0;c<2;++c)if(0===c?(d=6*e-12*n+6*r,h=-3*e+9*n-9*r+3*o,u=3*n-3*e):(d=6*t-12*i+6*s,h=-3*t+9*i-9*s+3*a,u=3*i-3*t),Math.abs(h)<1e-12){if(Math.abs(d)<1e-12)continue;p=-u/d,0<p&&p<1&&l.push(p)}else g=d*d-4*u*h,O=Math.sqrt(g),g<0||(f=(-d+O)/(2*h),0<f&&f<1&&l.push(f),m=(-d-O)/(2*h),0<m&&m<1&&l.push(m));let y,v=l.length;const b=v;for(;v--;)p=l[v],y=1-p,c[0][v]=y*y*y*e+3*y*y*p*n+3*y*p*p*r+p*p*p*o,c[1][v]=y*y*y*t+3*y*y*p*i+3*y*p*p*s+p*p*p*a;return c[0][b]=e,c[1][b]=t,c[0][b+1]=o,c[1][b+1]=a,c[0].length=c[1].length=b+2,[Math.min(...c[0]),Math.min(...c[1]),Math.max(...c[0]),Math.max(...c[1])]}};const u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function p(e){return decodeURIComponent(escape(e))}t.PromiseCapability=class{#e=!1;constructor(){this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.#e=!0,e(t)},this.reject=e=>{this.#e=!0,t(e)}}))}get settled(){return this.#e}};let f=null,m=null;t.AnnotationPrefix="pdfjs_internal_id_"},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;function getDocument(e){if("string"==typeof e||e instanceof URL?e={url:e}:(0,_util.isArrayBuffer)(e)&&(e={data:e}),"object"!=typeof e)throw new Error("Invalid parameter in getDocument, need parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new PDFDocumentLoadingTask,{docId:n}=t,i=e.url?getUrlProp(e.url):null,r=e.data?getDataProp(e.data):null,s=e.httpHeaders||null,o=!0===e.withCredentials,a=e.password??null,l=e.range instanceof PDFDataRangeTransport?e.range:null,c=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let h=e.worker instanceof PDFWorker?e.worker:null;const d=e.verbosity,u="string"!=typeof e.docBaseUrl||(0,_display_utils.isDataScheme)(e.docBaseUrl)?null:e.docBaseUrl,p="string"==typeof e.cMapUrl?e.cMapUrl:null,f=!1!==e.cMapPacked,m=e.CMapReaderFactory||DefaultCMapReaderFactory,g="string"==typeof e.standardFontDataUrl?e.standardFontDataUrl:null,O=e.StandardFontDataFactory||DefaultStandardFontDataFactory,y=!0!==e.stopAtErrors,v=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,b=!1!==e.isEvalSupported,w="boolean"==typeof e.isOffscreenCanvasSupported?e.isOffscreenCanvasSupported:!_util.isNodeJS,S=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,x="boolean"==typeof e.disableFontFace?e.disableFontFace:_util.isNodeJS,C=!0===e.fontExtraProperties,_=!0===e.enableXfa,E=e.ownerDocument||globalThis.document,P=!0===e.disableRange,k=!0===e.disableStream,T=!0===e.disableAutoFetch,A=!0===e.pdfBug,R=l?l.length:e.length??NaN,M="boolean"==typeof e.useSystemFonts?e.useSystemFonts:!_util.isNodeJS&&!x,I="boolean"==typeof e.useWorkerFetch?e.useWorkerFetch:m===_display_utils.DOMCMapReaderFactory&&O===_display_utils.DOMStandardFontDataFactory&&p&&g&&(0,_display_utils.isValidFetchUrl)(p,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(g,document.baseURI),L=e.canvasFactory||new DefaultCanvasFactory({ownerDocument:E}),$=e.filterFactory||new DefaultFilterFactory({docId:n,ownerDocument:E});(0,_util.setVerbosityLevel)(d);const D={canvasFactory:L,filterFactory:$};if(I||(D.cMapReaderFactory=new m({baseUrl:p,isCompressed:f}),D.standardFontDataFactory=new O({baseUrl:g})),!h){const e={verbosity:d,port:_worker_options.GlobalWorkerOptions.workerPort};h=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=h}const N={docId:n,apiVersion:"3.11.174",data:r,password:a,disableAutoFetch:T,rangeChunkSize:c,length:R,docBaseUrl:u,enableXfa:_,evaluatorOptions:{maxImageSize:v,disableFontFace:x,ignoreErrors:y,isEvalSupported:b,isOffscreenCanvasSupported:w,canvasMaxAreaInBytes:S,fontExtraProperties:C,useSystemFonts:M,cMapUrl:I?p:null,standardFontDataUrl:I?g:null}},Q={ignoreErrors:y,isEvalSupported:b,disableFontFace:x,fontExtraProperties:C,enableXfa:_,ownerDocument:E,disableAutoFetch:T,pdfBug:A,styleElement:null};return h.promise.then((function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(h,N),a=new Promise((function(e){let t;if(l)t=new _transport_stream.PDFDataTransportStream({length:R,initialData:l.initialData,progressiveDone:l.progressiveDone,contentDispositionFilename:l.contentDispositionFilename,disableRange:P,disableStream:k},l);else if(!r){t=(e=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(e):(0,_display_utils.isValidFetchUrl)(e.url)?new _displayFetch_stream.PDFFetchStream(e):new _displayNetwork.PDFNetworkStream(e))({url:i,length:R,httpHeaders:s,withCredentials:o,rangeChunkSize:c,disableRange:P,disableStream:k})}e(t)}));return Promise.all([e,a]).then((function([e,i]){if(t.destroyed)throw new Error("Loading aborted");const r=new _message_handler.MessageHandler(n,e,h.port),s=new WorkerTransport(r,t,i,Q,D);t._transport=s,r.send("Ready",null)}))})).catch(t._capability.reject),t}async function _fetchDocument(e,t){if(e.destroyed)throw new Error("Worker was destroyed");const n=await e.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(e.destroyed)throw new Error("Worker was destroyed");return n}function getUrlProp(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(_util.isNodeJS&&"string"==typeof e)return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(e){if(_util.isNodeJS&&"undefined"!=typeof Buffer&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if("string"==typeof e)return(0,_util.stringToBytes)(e);if("object"==typeof e&&!isNaN(e?.length)||(0,_util.isArrayBuffer)(e))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#t++,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await(this._transport?.destroy())}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then((()=>{for(const n of this._progressListeners)n(e,t)}))}onDataProgressiveRead(e){this._readyCapability.promise.then((()=>{for(const t of this._progressiveReadListeners)t(e)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const e of this._progressiveDoneListeners)e()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then((e=>{if(!e)return e;const t=[];for(const n in e)t.push(...e[n]);return t})))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#n=null;#i=!1;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:r=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}getAnnotations({intent:e="display"}={}){const t=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:r=null,background:s=null,optionalContentConfigPromise:o=null,annotationCanvasMap:a=null,pageColors:l=null,printAnnotationStorage:c=null}){this._stats?.time("Overall");const h=this._transport.getRenderingIntent(n,i,c);this.#i=!1,this.#r(),o||(o=this._transport.getOptionalContentConfig());let d=this._intentStates.get(h.cacheKey);d||(d=Object.create(null),this._intentStates.set(h.cacheKey,d)),d.streamReaderCancelTimeout&&(clearTimeout(d.streamReaderCancelTimeout),d.streamReaderCancelTimeout=null);const u=!!(h.renderingIntent&_util.RenderingIntentFlag.PRINT);d.displayReadyCapability||(d.displayReadyCapability=new _util.PromiseCapability,d.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(h));const p=e=>{d.renderTasks.delete(f),(this._maybeCleanupAfterRender||u)&&(this.#i=!0),this.#s(!u),e?(f.capability.reject(e),this._abortOperatorList({intentState:d,reason:e instanceof Error?e:new Error(e)})):f.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},f=new InternalRenderTask({callback:p,params:{canvasContext:e,viewport:t,transform:r,background:s},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:a,operatorList:d.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!u,pdfBug:this._pdfBug,pageColors:l});(d.renderTasks||=new Set).add(f);const m=f.task;return Promise.all([d.displayReadyCapability.promise,o]).then((([e,t])=>{this.destroyed?p():(this._stats?.time("Rendering"),f.initializeGraphics({transparency:e,optionalContentConfig:t}),f.operatorListChanged())})).catch(p),m}getOperatorList({intent:e="display",annotationMode:t=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){const i=this._transport.getRenderingIntent(e,t,n,!0);let r,s=this._intentStates.get(i.cacheKey);return s||(s=Object.create(null),this._intentStates.set(i.cacheKey,s)),s.opListReadCapability||(r=Object.create(null),r.operatorListChanged=function(){s.operatorList.lastChunk&&(s.opListReadCapability.resolve(s.operatorList),s.renderTasks.delete(r))},s.opListReadCapability=new _util.PromiseCapability,(s.renderTasks||=new Set).add(r),s.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(i)),s.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:!0===e,disableNormalization:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then((e=>_xfa_text.XfaText.textContent(e)));const t=this.streamTextContent(e);return new Promise((function(e,n){const i=t.getReader(),r={items:[],styles:Object.create(null)};!function t(){i.read().then((function({value:n,done:i}){i?e(r):(Object.assign(r.styles,n.styles),r.items.push(...n.items),t())}),n)}()}))}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#i=!1,this.#r(),Promise.all(e)}cleanup(e=!1){this.#i=!0;const t=this.#s(!1);return e&&t&&(this._stats&&=new _display_utils.StatTimer),t}#s(e=!1){if(this.#r(),!this.#i||this.destroyed)return!1;if(e)return this.#n=setTimeout((()=>{this.#n=null,this.#s(!1)}),DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#i=!1,!0}#r(){this.#n&&(clearTimeout(this.#n),this.#n=null)}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const e of t.renderTasks)e.operatorListChanged();e.lastChunk&&this.#s(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n}){const{map:i,transfers:r}=n,s=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i},r).getReader(),o=this._intentStates.get(t);o.streamReader=s;const a=()=>{s.read().then((({value:e,done:t})=>{t?o.streamReader=null:this._transport.destroyed||(this._renderPageChunk(e,o),a())}),(e=>{if(o.streamReader=null,!this._transport.destroyed){if(o.operatorList){o.operatorList.lastChunk=!0;for(const e of o.renderTasks)e.operatorListChanged();this.#s(!0)}if(o.displayReadyCapability)o.displayReadyCapability.reject(e);else{if(!o.opListReadCapability)throw e;o.opListReadCapability.reject(e)}}}))};a()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException){let n=RENDERING_CANCELLED_TIMEOUT;return t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),void(e.streamReaderCancelTimeout=setTimeout((()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})}),n))}}if(e.streamReader.cancel(new _util.AbortException(t.message)).catch((()=>{})),e.streamReader=null,!this._transport.destroyed){for(const[t,n]of this._intentStates)if(n===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#o=new Set;#a=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#a.then((()=>{for(const e of this.#o)e.call(this,n)}))}addEventListener(e,t){this.#o.add(t)}removeEventListener(e,t){this.#o.delete(t)}terminate(){this.#o.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_util.isNodeJS&&"function"==typeof commonjsRequire)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const e=document?.currentScript?.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,t){let n;try{if(n=new URL(e),!n.origin||"null"===n.origin)return!1}catch{return!1}const i=new URL(t,n);return n.origin===i.origin},PDFWorkerUtil.createCDNWrapper=function(e){const t=`importScripts("${e}");`;return URL.createObjectURL(new Blob([t]))};class PDFWorker{static#l;constructor({name:e=null,port:t=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){if(PDFWorker.#l?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");return(PDFWorker.#l||=new WeakMap).set(t,this),void this._initializeFromPort(t)}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:e}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,e)||(e=PDFWorkerUtil.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e),n=new _message_handler.MessageHandler("main","worker",t),i=()=>{t.removeEventListener("error",r),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||i()};t.addEventListener("error",r),n.on("test",(e=>{t.removeEventListener("error",r),this.destroyed?i():e?(this._messageHandler=n,this._port=t,this._webWorker=t,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),t.terminate())})),n.on("ready",(e=>{if(t.removeEventListener("error",r),this.destroyed)i();else try{s()}catch{this._setupFakeWorker()}}));const s=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};return void s()}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then((e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new LoopbackPort;this._port=t;const n="fake"+PDFWorkerUtil.fakeWorkerId++,i=new _message_handler.MessageHandler(n+"_worker",n,t);e.setup(i,t);const r=new _message_handler.MessageHandler(n,n+"_worker",t);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})})).catch((e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#l?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#l?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&"function"==typeof commonjsRequire){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#c=new Map;#h=new Map;#d=new Map;#u=null;constructor(e,t,n,i,r){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#p(e,t=null){const n=this.#c.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return this.#c.set(e,i),i}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,t=_util.AnnotationMode.ENABLE,n=null,i=!1){let r=_util.RenderingIntentFlag.DISPLAY,s=_annotation_storage.SerializableEmpty;switch(e){case"any":r=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":r=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(t){case _util.AnnotationMode.DISABLE:r+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:r+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:r+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE;s=(r&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return i&&(r+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:r,cacheKey:`${r}_${s.hash}`,annotationStorageSerializable:s}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#u?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const t of this.#h.values())e.push(t._destroy());this.#h.clear(),this.#d.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then((()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#c.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",((e,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then((function({value:e,done:n}){n?t.close():((0,_util.assert)(e instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}})),e.on("ReaderHeadersReady",(e=>{const n=new _util.PromiseCapability,i=this._fullReader;return i.headersReady.then((()=>{i.isStreamingSupported&&i.isRangeSupported||(this._lastProgress&&t.onProgress?.(this._lastProgress),i.onProgress=e=>{t.onProgress?.({loaded:e.loaded,total:e.total})}),n.resolve({isStreamingSupported:i.isStreamingSupported,isRangeSupported:i.isRangeSupported,contentLength:i.contentLength})}),n.reject),n.promise})),e.on("GetRangeReader",((e,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then((function({value:e,done:n}){n?t.close():((0,_util.assert)(e instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{n.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}):t.close()})),e.on("GetDoc",(({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(e,this))})),e.on("DocException",(function(e){let n;switch(e.name){case"PasswordException":n=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":n=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":n=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":n=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":n=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(n)})),e.on("PasswordRequest",(e=>{if(this.#u=new _util.PromiseCapability,t.onPassword){const n=e=>{e instanceof Error?this.#u.reject(e):this.#u.resolve({password:e})};try{t.onPassword(n,e.code)}catch(e){this.#u.reject(e)}}else this.#u.reject(new _util.PasswordException(e.message,e.code));return this.#u.promise})),e.on("DataLoaded",(e=>{t.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)})),e.on("StartRenderPage",(e=>{if(this.destroyed)return;this.#h.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)})),e.on("commonobj",(([t,n,i])=>{if(!this.destroyed&&!this.commonObjs.has(t))switch(n){case"Font":const r=this._params;if("error"in i){const e=i.error;(0,_util.warn)(`Error during font loading: ${e}`),this.commonObjs.resolve(t,e);break}const s=r.pdfBug&&globalThis.FontInspector?.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,o=new _font_loader.FontFaceObject(i,{isEvalSupported:r.isEvalSupported,disableFontFace:r.disableFontFace,ignoreErrors:r.ignoreErrors,inspectFont:s});this.fontLoader.bind(o).catch((n=>e.sendWithPromise("FontFallback",{id:t}))).finally((()=>{!r.fontExtraProperties&&o.data&&(o.data=null),this.commonObjs.resolve(t,o)}));break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(t,i);break;default:throw new Error(`Got unknown common object type ${n}`)}})),e.on("obj",(([e,t,n,i])=>{if(this.destroyed)return;const r=this.#h.get(t);if(!r.objs.has(e))switch(n){case"Image":if(r.objs.resolve(e,i),i){let e;if(i.bitmap){const{width:t,height:n}=i;e=t*n*4}else e=i.data?.length||0;e>_util.MAX_IMAGE_SIZE_TO_CACHE&&(r._maybeCleanupAfterRender=!0)}break;case"Pattern":r.objs.resolve(e,i);break;default:throw new Error(`Got unknown object type ${n}`)}})),e.on("DocProgress",(e=>{this.destroyed||t.onProgress?.({loaded:e.loaded,total:e.total})})),e.on("FetchBuiltInCMap",(e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.")))),e.on("FetchStandardFontData",(e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfers:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally((()=>{this.annotationStorage.resetModified()}))}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#d.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then((e=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(t,e,this,this._params.pdfBug);return this.#h.set(t,n),n}));return this.#d.set(t,i),i}getPageIndex(e){return"object"!=typeof e||null===e||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#p("GetFieldObjects")}hasJSActions(){return this.#p("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#p("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then((e=>new _optional_content_config.OptionalContentConfig(e)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#c.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then((e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null})));return this.#c.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#h.values()){if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`)}this.commonObjs.clear(),e||this.fontLoader.clear(),this.#c.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:e,enableXfa:t}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:t})}}class PDFObjects{#f=Object.create(null);#m(e){return this.#f[e]||={capability:new _util.PromiseCapability,data:null}}get(e,t=null){if(t){const n=this.#m(e);return n.capability.promise.then((()=>t(n.data))),null}const n=this.#f[e];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#f[e];return t?.capability.settled||!1}resolve(e,t=null){const n=this.#m(e);n.data=t,n.capability.resolve()}clear(){for(const e in this.#f){const{data:t}=this.#f[e];t?.bitmap?.close()}this.#f=Object.create(null)}}class RenderTask{#g=null;constructor(e){this.#g=e,this.onContinue=null}get promise(){return this.#g.capability.promise}cancel(e=0){this.#g.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#g.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#g;return e.form||e.canvas&&t?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#O=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:r,operatorList:s,pageIndex:o,canvasFactory:a,filterFactory:l,useRequestAnimationFrame:c=!1,pdfBug:h=!1,pageColors:d=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=o,this.canvasFactory=a,this.filterFactory=l,this._pdfBug=h,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!=typeof window,this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#O.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#O.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:r,background:s}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#O.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){this.graphicsReady?(this.stepper?.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||=this._continueBound}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame((()=>{this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#O.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var i=n(1),r=n(4),s=n(8);const o=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=o;class a{#y=!1;#v=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#v.get(e);return void 0===n?t:Object.assign(t,n)}getRawValue(e){return this.#v.get(e)}remove(e){if(this.#v.delete(e),0===this.#v.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const e of this.#v.values())if(e instanceof r.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#v.get(e);let i=!1;if(void 0!==n)for(const[e,r]of Object.entries(t))n[e]!==r&&(i=!0,n[e]=r);else i=!0,this.#v.set(e,t);i&&this.#b(),t instanceof r.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return this.#v.has(e)}getAll(){return this.#v.size>0?(0,i.objectFromMap)(this.#v):null}setAll(e){for(const[t,n]of Object.entries(e))this.setValue(t,n)}get size(){return this.#v.size}#b(){this.#y||(this.#y=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this.#y&&(this.#y=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new l(this)}get serializable(){if(0===this.#v.size)return o;const e=new Map,t=new s.MurmurHash3_64,n=[],i=Object.create(null);let a=!1;for(const[n,s]of this.#v){const o=s instanceof r.AnnotationEditor?s.serialize(!1,i):s;o&&(e.set(n,o),t.update(`${n}:${JSON.stringify(o)}`),a||=!!o.bitmap)}if(a)for(const t of e.values())t.bitmap&&n.push(t.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfers:n}:o}}t.AnnotationStorage=a;class l extends a{#w;constructor(e){super();const{map:t,hash:n,transfers:i}=e.serializable,r=structuredClone(t,i?{transfer:i}:null);this.#w={map:r,hash:n,transfers:i}}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#w}}t.PrintAnnotationStorage=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var i=n(5),r=n(1),s=n(6);class o{#S="";#x=!1;#C=null;#_=null;#E=null;#P=!1;#k=null;#T=this.focusin.bind(this);#A=this.focusout.bind(this);#R=!1;#M=!1;#I=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#L=!1;#$=o._zIndex++;static _borderLineWidth=-1;static _colorManager=new i.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(e){this.constructor===o&&(0,r.unreachable)("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,a];const[l,c]=this.parentDimensions;this.x=e.x/l,this.y=e.y/c,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,r.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new a({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t=null){if(o._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map((t=>[t,e.get(t)]))),t?.strings)for(const n of t.strings)o._l10nPromise.set(n,e.get(n));if(-1!==o._borderLineWidth)return;const n=getComputedStyle(document.documentElement);o._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){(0,r.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#L}set _isDraggable(e){this.#L=e,this.div?.classList.toggle("draggable",e)}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(2*e),this.y+=this.width*e/(2*t);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(2*e),this.y-=this.width*e/(2*t);break;default:this.x-=this.width/2,this.y-=this.height/2}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#$}setParent(e){null!==e&&(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#R?this.#R=!1:this.parent.setSelected(this))}focusout(e){if(!this._focusEventsAllowed)return;if(!this.isAttachedToDOM)return;const t=e.relatedTarget;t?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[r,s]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/r,this.y=(t+i)/s,this.fixAndSetPosition()}#D([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this.fixAndSetPosition()}translate(e,t){this.#D(this.parentDimensions,e,t)}translateInPage(e,t){this.#D(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){const[n,i]=this.parentDimensions;if(this.x+=e/n,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:r,y:s}=this;const[o,a]=this.#N();r+=o,s+=a,this.div.style.left=`${(100*r).toFixed(2)}%`,this.div.style.top=`${(100*s).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#N(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=o,i=n/e,r=n/t;switch(this.rotation){case 90:return[-i,r];case 180:return[i,r];case 270:return[i,-r];default:return[-i,-r]}}fixAndSetPosition(){const[e,t]=this.pageDimensions;let{x:n,y:i,width:r,height:s}=this;switch(r*=e,s*=t,n*=e,i*=t,this.rotation){case 0:n=Math.max(0,Math.min(e-r,n)),i=Math.max(0,Math.min(t-s,i));break;case 90:n=Math.max(0,Math.min(e-s,n)),i=Math.min(t,Math.max(r,i));break;case 180:n=Math.min(e,Math.max(r,n)),i=Math.min(t,Math.max(s,i));break;case 270:n=Math.min(e,Math.max(s,n)),i=Math.max(0,Math.min(t-r,i))}this.x=n/=e,this.y=i/=t;const[o,a]=this.#N();n+=o,i+=a;const{style:l}=this.div;l.left=`${(100*n).toFixed(2)}%`,l.top=`${(100*i).toFixed(2)}%`,this.moveInDOM()}static#Q(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return o.#Q(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return o.#Q(e,t,360-this.parentRotation)}#F(e){switch(e){case 90:{const[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this,i=t*e,s=n*e;return r.FeatureTest.isCSSRoundSupported?[Math.round(i),Math.round(s)]:[i,s]}setDims(e,t){const[n,i]=this.parentDimensions;this.div.style.width=`${(100*e/n).toFixed(2)}%`,this.#P||(this.div.style.height=`${(100*t/i).toFixed(2)}%`),this.#C?.classList.toggle("small",e<o.SMALL_EDITOR_SIZE||t<o.SMALL_EDITOR_SIZE)}fixDims(){const{style:e}=this.div,{height:t,width:n}=e,i=n.endsWith("%"),r=!this.#P&&t.endsWith("%");if(i&&r)return;const[s,o]=this.parentDimensions;i||(e.width=`${(100*parseFloat(n)/s).toFixed(2)}%`),this.#P||r||(e.height=`${(100*parseFloat(t)/o).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#B(){if(this.#k)return;this.#k=document.createElement("div"),this.#k.classList.add("resizers");const e=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||e.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of e){const e=document.createElement("div");this.#k.append(e),e.classList.add("resizer",t),e.addEventListener("pointerdown",this.#j.bind(this,t)),e.addEventListener("contextmenu",s.noContextMenu)}this.div.prepend(this.#k)}#j(e,t){t.preventDefault();const{isMac:n}=r.FeatureTest.platform;if(0!==t.button||t.ctrlKey&&n)return;const i=this.#V.bind(this,e),s=this._isDraggable;this._isDraggable=!1;const o={passive:!0,capture:!0};window.addEventListener("pointermove",i,o);const a=this.x,l=this.y,c=this.width,h=this.height,d=this.parent.div.style.cursor,u=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{this._isDraggable=s,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",i,o),this.parent.div.style.cursor=d,this.div.style.cursor=u;const e=this.x,t=this.y,n=this.width,r=this.height;e===a&&t===l&&n===c&&r===h||this.addCommands({cmd:()=>{this.width=n,this.height=r,this.x=e,this.y=t;const[i,s]=this.parentDimensions;this.setDims(i*n,s*r),this.fixAndSetPosition()},undo:()=>{this.width=c,this.height=h,this.x=a,this.y=l;const[e,t]=this.parentDimensions;this.setDims(e*c,t*h),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}#V(e,t){const[n,i]=this.parentDimensions,r=this.x,s=this.y,a=this.width,l=this.height,c=o.MIN_SIZE/n,h=o.MIN_SIZE/i,d=e=>Math.round(1e4*e)/1e4,u=this.#F(this.rotation),p=(e,t)=>[u[0]*e+u[2]*t,u[1]*e+u[3]*t],f=this.#F(360-this.rotation);let m,g,O=!1,y=!1;switch(e){case"topLeft":O=!0,m=(e,t)=>[0,0],g=(e,t)=>[e,t];break;case"topMiddle":m=(e,t)=>[e/2,0],g=(e,t)=>[e/2,t];break;case"topRight":O=!0,m=(e,t)=>[e,0],g=(e,t)=>[0,t];break;case"middleRight":y=!0,m=(e,t)=>[e,t/2],g=(e,t)=>[0,t/2];break;case"bottomRight":O=!0,m=(e,t)=>[e,t],g=(e,t)=>[0,0];break;case"bottomMiddle":m=(e,t)=>[e/2,t],g=(e,t)=>[e/2,0];break;case"bottomLeft":O=!0,m=(e,t)=>[0,t],g=(e,t)=>[e,0];break;case"middleLeft":y=!0,m=(e,t)=>[0,t/2],g=(e,t)=>[e,t/2]}const v=m(a,l),b=g(a,l);let w=p(...b);const S=d(r+w[0]),x=d(s+w[1]);let C=1,_=1,[E,P]=this.screenToPageTranslation(t.movementX,t.movementY);var k,T;if([E,P]=(k=E/n,T=P/i,[f[0]*k+f[2]*T,f[1]*k+f[3]*T]),O){const e=Math.hypot(a,l);C=_=Math.max(Math.min(Math.hypot(b[0]-v[0]-E,b[1]-v[1]-P)/e,1/a,1/l),c/a,h/l)}else y?C=Math.max(c,Math.min(1,Math.abs(b[0]-v[0]-E)))/a:_=Math.max(h,Math.min(1,Math.abs(b[1]-v[1]-P)))/l;const A=d(a*C),R=d(l*_);w=p(...g(A,R));const M=S-w[0],I=x-w[1];this.width=A,this.height=R,this.x=M,this.y=I,this.setDims(n*A,i*R),this.fixAndSetPosition()}async addAltTextButton(){if(this.#C)return;const e=this.#C=document.createElement("button");e.className="altText";const t=await o._l10nPromise.get("editor_alt_text_button_label");if(e.textContent=t,e.setAttribute("aria-label",t),e.tabIndex="0",e.addEventListener("contextmenu",s.noContextMenu),e.addEventListener("pointerdown",(e=>e.stopPropagation())),e.addEventListener("click",(e=>{e.preventDefault(),this._uiManager.editAltText(this)}),{capture:!0}),e.addEventListener("keydown",(t=>{t.target===e&&"Enter"===t.key&&(t.preventDefault(),this._uiManager.editAltText(this))})),this.#U(),this.div.append(e),!o.SMALL_EDITOR_SIZE){const t=40;o.SMALL_EDITOR_SIZE=Math.min(128,Math.round(e.getBoundingClientRect().width*(1+t/100)))}}async#U(){const e=this.#C;if(!e)return;if(!this.#S&&!this.#x)return e.classList.remove("done"),void this.#_?.remove();o._l10nPromise.get("editor_alt_text_edit_button_label").then((t=>{e.setAttribute("aria-label",t)}));let t=this.#_;if(!t){this.#_=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const n=t.id=`alt-text-tooltip-${this.id}`;e.setAttribute("aria-describedby",n);const i=100;e.addEventListener("mouseenter",(()=>{this.#E=setTimeout((()=>{this.#E=null,this.#_.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})}),i)})),e.addEventListener("mouseleave",(()=>{clearTimeout(this.#E),this.#E=null,this.#_?.classList.remove("show")}))}e.classList.add("done"),t.innerText=this.#x?await o._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#S,t.parentNode||e.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#S,decorative:this.#x}}set altTextData({altText:e,decorative:t}){this.#S===e&&this.#x===t||(this.#S=e,this.#x=t,this.#U())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#T),this.div.addEventListener("focusout",this.#A);const[e,t]=this.parentDimensions;this.parentRotation%180!=0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[n,r]=this.getInitialTranslation();return this.translate(n,r),(0,i.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(e){const{isMac:t}=r.FeatureTest.platform;0!==e.button||e.ctrlKey&&t?e.preventDefault():(this.#R=!0,this.#W(e))}#W(e){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);let n,i;this._uiManager.setUpDragSession(),t&&(n={passive:!0,capture:!0},i=e=>{const[t,n]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(t,n)},window.addEventListener("pointermove",i,n));const s=()=>{if(window.removeEventListener("pointerup",s),window.removeEventListener("blur",s),t&&window.removeEventListener("pointermove",i,n),this.#R=!1,!this._uiManager.endDragSession()){const{isMac:t}=r.FeatureTest.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",s),window.addEventListener("blur",s)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition()}getRect(e,t){const n=this.parentScale,[i,r]=this.pageDimensions,[s,o]=this.pageTranslation,a=e/n,l=t/n,c=this.x*i,h=this.y*r,d=this.width*i,u=this.height*r;switch(this.rotation){case 0:return[c+a+s,r-h-l-u+o,c+a+d+s,r-h-l+o];case 90:return[c+l+s,r-h+a+o,c+l+u+s,r-h+a+d+o];case 180:return[c-a-d+s,r-h+l+o,c-a+s,r-h+l+u+o];case 270:return[c-l-u+s,r-h-a-d+o,c-l+s,r-h-a+o];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,r,s]=e,o=r-n,a=s-i;switch(this.rotation){case 0:return[n,t-s,o,a];case 90:return[n,t-i,a,o];case 180:return[r,t-i,o,a];case 270:return[r,t-s,a,o];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#I=!0}disableEditMode(){this.#I=!1}isInEditMode(){return this.#I}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#T),this.div?.addEventListener("focusout",this.#A)}serialize(e=!1,t=null){(0,r.unreachable)("An editor must be serializable")}static deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n});i.rotation=e.rotation;const[r,s]=i.pageDimensions,[o,a,l,c]=i.getRectInCurrentCoords(e.rect,s);return i.x=o/r,i.y=a/s,i.width=l/r,i.height=c/s,i}remove(){this.div.removeEventListener("focusin",this.#T),this.div.removeEventListener("focusout",this.#A),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#C?.remove(),this.#C=null,this.#_=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#B(),this.#k.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#k?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(e,t){}disableEditing(){this.#C&&(this.#C.hidden=!0)}enableEditing(){this.#C&&(this.#C.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#M}set isEditing(e){this.#M=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){this.#P=!0;const n=e/t,{style:i}=this.div;i.aspectRatio=n,i.height="auto"}static get MIN_SIZE(){return 16}}t.AnnotationEditor=o;class a extends o{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=function(e,t,n){for(const i of n)t.addEventListener(i,e[i].bind(e))},t.opacityToHex=function(e){return Math.round(Math.min(255,Math.max(1,255*e))).toString(16).padStart(2,"0")};var i=n(1),r=n(6);class s{#Z=0;getId(){return`${i.AnnotationEditorPrefix}${this.#Z++}`}}class o{#H=(0,i.getUuid)();#Z=0;#q=null;static get _isSVGFittingCanvas(){const e=new OffscreenCanvas(1,3).getContext("2d"),t=new Image;t.src='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>';const n=t.decode().then((()=>(e.drawImage(t,0,0,1,1,0,0,1,3),0===new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0])));return(0,i.shadow)(this,"_isSVGFittingCanvas",n)}async#X(e,t){this.#q||=new Map;let n=this.#q.get(e);if(null===n)return null;if(n?.bitmap)return n.refCounter+=1,n;try{let e;if(n||={bitmap:null,id:`image_${this.#H}_${this.#Z++}`,refCounter:0,isSvg:!1},"string"==typeof t){n.url=t;const i=await fetch(t);if(!i.ok)throw new Error(i.statusText);e=await i.blob()}else e=n.file=t;if("image/svg+xml"===e.type){const t=o._isSVGFittingCanvas,i=new FileReader,r=new Image,s=new Promise(((e,s)=>{r.onload=()=>{n.bitmap=r,n.isSvg=!0,e()},i.onload=async()=>{const e=n.svgUrl=i.result;r.src=await t?`${e}#svgView(preserveAspectRatio(none))`:e},r.onerror=i.onerror=s}));i.readAsDataURL(e),await s}else n.bitmap=await createImageBitmap(e);n.refCounter=1}catch(e){console.error(e),n=null}return this.#q.set(e,n),n&&this.#q.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:i,type:r}=e;return this.#X(`${t}_${n}_${i}_${r}`,e)}async getFromUrl(e){return this.#X(e,e)}async getFromId(e){this.#q||=new Map;const t=this.#q.get(e);return t?t.bitmap?(t.refCounter+=1,t):t.file?this.getFromFile(t.file):this.getFromUrl(t.url):null}getSvgUrl(e){const t=this.#q.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#q||=new Map;const t=this.#q.get(e);t&&(t.refCounter-=1,0===t.refCounter&&(t.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#H}_`)}}class a{#z=[];#Y=!1;#G;#K=-1;constructor(e=128){this.#G=e}add({cmd:e,undo:t,mustExec:n,type:i=NaN,overwriteIfSameType:r=!1,keepUndo:s=!1}){if(n&&e(),this.#Y)return;const o={cmd:e,undo:t,type:i};if(-1===this.#K)return this.#z.length>0&&(this.#z.length=0),this.#K=0,void this.#z.push(o);if(r&&this.#z[this.#K].type===i)return s&&(o.undo=this.#z[this.#K].undo),void(this.#z[this.#K]=o);const a=this.#K+1;a===this.#G?this.#z.splice(0,1):(this.#K=a,a<this.#z.length&&this.#z.splice(a)),this.#z.push(o)}undo(){-1!==this.#K&&(this.#Y=!0,this.#z[this.#K].undo(),this.#Y=!1,this.#K-=1)}redo(){this.#K<this.#z.length-1&&(this.#K+=1,this.#Y=!0,this.#z[this.#K].cmd(),this.#Y=!1)}hasSomethingToUndo(){return-1!==this.#K}hasSomethingToRedo(){return this.#K<this.#z.length-1}destroy(){this.#z=null}}t.CommandManager=a;class l{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=i.FeatureTest.platform;for(const[n,i,r={}]of e)for(const e of n){const n=e.startsWith("mac+");t&&n?(this.callbacks.set(e.slice(4),{callback:i,options:r}),this.allKeys.add(e.split("+").at(-1))):t||n||(this.callbacks.set(e,{callback:i,options:r}),this.allKeys.add(e.split("+").at(-1)))}}#J(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#J(t));if(!n)return;const{callback:i,options:{bubbles:r=!1,args:s=[],checker:o=null}}=n;o&&!o(e,t)||(i.bind(e,...s)(),r||(t.stopPropagation(),t.preventDefault()))}}t.KeyboardManager=l;class c{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,r.getColorValues)(e),(0,i.shadow)(this,"_colors",e)}convert(e){const t=(0,r.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[e,n]of this._colors)if(n.every(((e,n)=>e===t[n])))return c._colorsMapping.get(e);return t}getHexCode(e){const t=this._colors.get(e);return t?i.Util.makeHexColor(...t):e}}t.ColorManager=c;class h{#ee=null;#te=new Map;#ne=new Map;#ie=null;#re=null;#se=new a;#oe=0;#ae=new Set;#le=null;#ce=null;#he=new Set;#de=null;#ue=new s;#pe=!1;#fe=!1;#me=null;#ge=i.AnnotationEditorType.NONE;#Oe=new Set;#ye=null;#ve=this.blur.bind(this);#be=this.focus.bind(this);#we=this.copy.bind(this);#Se=this.cut.bind(this);#xe=this.paste.bind(this);#Ce=this.keydown.bind(this);#_e=this.onEditingAction.bind(this);#Ee=this.onPageChanging.bind(this);#Pe=this.onScaleChanging.bind(this);#ke=this.onRotationChanging.bind(this);#Te={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#Ae=[0,0];#Re=null;#Me=null;#Ie=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=h.prototype,t=e=>{const{activeElement:t}=document;return t&&e.#Me.contains(t)&&e.hasSomethingToControl()},n=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new l([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}constructor(e,t,n,i,s,o){this.#Me=e,this.#Ie=t,this.#ie=n,this._eventBus=i,this._eventBus._on("editingaction",this.#_e),this._eventBus._on("pagechanging",this.#Ee),this._eventBus._on("scalechanging",this.#Pe),this._eventBus._on("rotationchanging",this.#ke),this.#re=s.annotationStorage,this.#de=s.filterFactory,this.#ye=o,this.viewParameters={realScale:r.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#Le(),this.#$e(),this._eventBus._off("editingaction",this.#_e),this._eventBus._off("pagechanging",this.#Ee),this._eventBus._off("scalechanging",this.#Pe),this._eventBus._off("rotationchanging",this.#ke);for(const e of this.#ne.values())e.destroy();this.#ne.clear(),this.#te.clear(),this.#he.clear(),this.#ee=null,this.#Oe.clear(),this.#se.destroy(),this.#ie.destroy()}get hcmFilter(){return(0,i.shadow)(this,"hcmFilter",this.#ye?this.#de.addHCMFilter(this.#ye.foreground,this.#ye.background):"none")}get direction(){return(0,i.shadow)(this,"direction",getComputedStyle(this.#Me).direction)}editAltText(e){this.#ie?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#oe=e-1}focusMainContainer(){this.#Me.focus()}findParent(e,t){for(const n of this.#ne.values()){const{x:i,y:r,width:s,height:o}=n.div.getBoundingClientRect();if(e>=i&&e<=i+s&&t>=r&&t<=r+o)return n}return null}disableUserSelect(e=!1){this.#Ie.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#he.add(e)}removeShouldRescale(e){this.#he.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*r.PixelsPerInch.PDF_TO_CSS_UNITS;for(const e of this.#he)e.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){e.isEmpty()||!this.#re||this.#re.has(e.id)||this.#re.setValue(e.id,e)}#De(){window.addEventListener("focus",this.#be),window.addEventListener("blur",this.#ve)}#$e(){window.removeEventListener("focus",this.#be),window.removeEventListener("blur",this.#ve)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#Oe)if(t.div.contains(e)){this.#me=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#me)return;const[e,t]=this.#me;this.#me=null,t.addEventListener("focusin",(()=>{e._focusEventsAllowed=!0}),{once:!0}),t.focus()}#Ne(){window.addEventListener("keydown",this.#Ce,{capture:!0})}#Le(){window.removeEventListener("keydown",this.#Ce,{capture:!0})}#Qe(){document.addEventListener("copy",this.#we),document.addEventListener("cut",this.#Se),document.addEventListener("paste",this.#xe)}#Fe(){document.removeEventListener("copy",this.#we),document.removeEventListener("cut",this.#Se),document.removeEventListener("paste",this.#xe)}addEditListeners(){this.#Ne(),this.#Qe()}removeEditListeners(){this.#Le(),this.#Fe()}copy(e){if(e.preventDefault(),this.#ee?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const e of this.#Oe){const n=e.serialize(!0);n&&t.push(n)}0!==t.length&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:t}=e;for(const e of t.items)for(const t of this.#ce)if(t.isHandlingMimeForPasting(e.type))return void t.paste(e,this.currentLayer);let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(e){return void(0,i.warn)(`paste: "${e.message}".`)}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const e=[];for(const t of n){const n=r.deserialize(t);if(!n)return;e.push(n)}const t=()=>{for(const t of e)this.#Be(t);this.#je(e)},i=()=>{for(const t of e)t.remove()};this.addCommands({cmd:t,undo:i,mustExec:!0})}catch(e){(0,i.warn)(`paste: "${e.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||h._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#Ve(e){Object.entries(e).some((([e,t])=>this.#Te[e]!==t))&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Te,e)})}#Ue(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#De(),this.#Ne(),this.#Qe(),this.#Ve({isEditing:this.#ge!==i.AnnotationEditorType.NONE,isEmpty:this.#We(),hasSomethingToUndo:this.#se.hasSomethingToUndo(),hasSomethingToRedo:this.#se.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#$e(),this.#Le(),this.#Fe(),this.#Ve({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#ce){this.#ce=e;for(const e of this.#ce)this.#Ue(e.defaultPropertiesToUpdate)}}getId(){return this.#ue.getId()}get currentLayer(){return this.#ne.get(this.#oe)}getLayer(e){return this.#ne.get(e)}get currentPageIndex(){return this.#oe}addLayer(e){this.#ne.set(e.pageIndex,e),this.#pe?e.enable():e.disable()}removeLayer(e){this.#ne.delete(e.pageIndex)}updateMode(e,t=null){if(this.#ge!==e){if(this.#ge=e,e===i.AnnotationEditorType.NONE)return this.setEditingState(!1),void this.#Ze();this.setEditingState(!0),this.#He(),this.unselectAll();for(const t of this.#ne.values())t.updateMode(e);if(t)for(const e of this.#te.values())if(e.annotationElementId===t){this.setSelected(e),e.enterInEditMode();break}}}updateToolbar(e){e!==this.#ge&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){if(this.#ce)if(e!==i.AnnotationEditorParamsType.CREATE){for(const n of this.#Oe)n.updateParams(e,t);for(const n of this.#ce)n.updateDefaultParams(e,t)}else this.currentLayer.addNewEditor(e)}enableWaiting(e=!1){if(this.#fe!==e){this.#fe=e;for(const t of this.#ne.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}#He(){if(!this.#pe){this.#pe=!0;for(const e of this.#ne.values())e.enable()}}#Ze(){if(this.unselectAll(),this.#pe){this.#pe=!1;for(const e of this.#ne.values())e.disable()}}getEditors(e){const t=[];for(const n of this.#te.values())n.pageIndex===e&&t.push(n);return t}getEditor(e){return this.#te.get(e)}addEditor(e){this.#te.set(e.id,e)}removeEditor(e){this.#te.delete(e.id),this.unselect(e),e.annotationElementId&&this.#ae.has(e.annotationElementId)||this.#re?.remove(e.id)}addDeletedAnnotationElement(e){this.#ae.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#ae.has(e)}removeDeletedAnnotationElement(e){this.#ae.delete(e.annotationElementId),e.deleted=!1}#Be(e){const t=this.#ne.get(e.pageIndex);t?t.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#ee!==e&&(this.#ee=e,e&&this.#Ue(e.propertiesToUpdate))}toggleSelected(e){if(this.#Oe.has(e))return this.#Oe.delete(e),e.unselect(),void this.#Ve({hasSelectedEditor:this.hasSelection});this.#Oe.add(e),e.select(),this.#Ue(e.propertiesToUpdate),this.#Ve({hasSelectedEditor:!0})}setSelected(e){for(const t of this.#Oe)t!==e&&t.unselect();this.#Oe.clear(),this.#Oe.add(e),e.select(),this.#Ue(e.propertiesToUpdate),this.#Ve({hasSelectedEditor:!0})}isSelected(e){return this.#Oe.has(e)}unselect(e){e.unselect(),this.#Oe.delete(e),this.#Ve({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==this.#Oe.size}undo(){this.#se.undo(),this.#Ve({hasSomethingToUndo:this.#se.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#We()})}redo(){this.#se.redo(),this.#Ve({hasSomethingToUndo:!0,hasSomethingToRedo:this.#se.hasSomethingToRedo(),isEmpty:this.#We()})}addCommands(e){this.#se.add(e),this.#Ve({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#We()})}#We(){if(0===this.#te.size)return!0;if(1===this.#te.size)for(const e of this.#te.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#Oe];this.addCommands({cmd:()=>{for(const t of e)t.remove()},undo:()=>{for(const t of e)this.#Be(t)},mustExec:!0})}commitOrRemove(){this.#ee?.commitOrRemove()}hasSomethingToControl(){return this.#ee||this.hasSelection}#je(e){this.#Oe.clear();for(const t of e)t.isEmpty()||(this.#Oe.add(t),t.select());this.#Ve({hasSelectedEditor:!0})}selectAll(){for(const e of this.#Oe)e.commit();this.#je(this.#te.values())}unselectAll(){if(this.#ee)this.#ee.commitOrRemove();else if(this.hasSelection){for(const e of this.#Oe)e.unselect();this.#Oe.clear(),this.#Ve({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#Ae[0]+=e,this.#Ae[1]+=t;const[i,r]=this.#Ae,s=[...this.#Oe];this.#Re&&clearTimeout(this.#Re),this.#Re=setTimeout((()=>{this.#Re=null,this.#Ae[0]=this.#Ae[1]=0,this.addCommands({cmd:()=>{for(const e of s)this.#te.has(e.id)&&e.translateInPage(i,r)},undo:()=>{for(const e of s)this.#te.has(e.id)&&e.translateInPage(-i,-r)},mustExec:!1})}),1e3);for(const n of s)n.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#le=new Map;for(const e of this.#Oe)this.#le.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#le)return!1;this.disableUserSelect(!1);const e=this.#le;this.#le=null;let t=!1;for(const[{x:n,y:i,pageIndex:r},s]of e)s.newX=n,s.newY=i,s.newPageIndex=r,t||=n!==s.savedX||i!==s.savedY||r!==s.savedPageIndex;if(!t)return!1;const n=(e,t,n,i)=>{if(this.#te.has(e.id)){const r=this.#ne.get(i);r?e._setParentAndPosition(r,t,n):(e.pageIndex=i,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(const[t,{newX:i,newY:r,newPageIndex:s}]of e)n(t,i,r,s)},undo:()=>{for(const[t,{savedX:i,savedY:r,savedPageIndex:s}]of e)n(t,i,r,s)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#le)for(const n of this.#le.keys())n.drag(e,t)}rebuild(e){if(null===e.parent){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#ee===e}getActive(){return this.#ee}getMode(){return this.#ge}get imageManager(){return(0,i.shadow)(this,"imageManager",new o)}}t.AnnotationEditorUIManager=h},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getColorValues=function(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const n of e.keys()){t.style.color=n;const i=window.getComputedStyle(t).color;e.set(n,y(i))}t.remove()},t.getCurrentTransform=function(e){const{a:t,b:n,c:i,d:r,e:s,f:o}=e.getTransform();return[t,n,i,r,s,o]},t.getCurrentTransformInverse=function(e){const{a:t,b:n,c:i,d:r,e:s,f:o}=e.getTransform().invertSelf();return[t,n,i,r,s,o]},t.getFilenameFromUrl=function(e,t=!1){t||([e]=e.split(/[#?]/,1));return e.substring(e.lastIndexOf("/")+1)},t.getPdfFilenameFromUrl=function(e,t="document.pdf"){if("string"!=typeof e)return t;if(m(e))return(0,r.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let s=n.exec(i[1])||n.exec(i[2])||n.exec(i[3]);if(s&&(s=s[0],s.includes("%")))try{s=n.exec(decodeURIComponent(s))[0]}catch{}return s||t},t.getRGB=y,t.getXfaPageViewport=function(e,{scale:t=1,rotation:n=0}){const{width:i,height:r}=e.attributes.style,s=[0,0,parseInt(i),parseInt(r)];return new p({viewBox:s,scale:t,rotation:n})},t.isDataScheme=m,t.isPdfFile=function(e){return"string"==typeof e&&/\.pdf$/i.test(e)},t.isValidFetchUrl=g,t.loadScript=function(e,t=!1){return new Promise(((n,i)=>{const r=document.createElement("script");r.src=e,r.onload=function(e){t&&r.remove(),n(e)},r.onerror=function(){i(new Error(`Cannot load script at: ${r.src}`))},(document.head||document.documentElement).append(r)}))},t.noContextMenu=function(e){e.preventDefault()},t.setLayerDimensions=function(e,t,n=!1,i=!0){if(t instanceof p){const{pageWidth:i,pageHeight:s}=t.rawDims,{style:o}=e,a=r.FeatureTest.isCSSRoundSupported,l=`var(--scale-factor) * ${i}px`,c=`var(--scale-factor) * ${s}px`,h=a?`round(${l}, 1px)`:`calc(${l})`,d=a?`round(${c}, 1px)`:`calc(${c})`;n&&t.rotation%180!=0?(o.width=d,o.height=h):(o.width=h,o.height=d)}i&&e.setAttribute("data-main-rotation",t.rotation)};var i=n(7),r=n(1);const s="http://www.w3.org/2000/svg";class o{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}t.PixelsPerInch=o;class a extends i.BaseFilterFactory{#qe;#Xe;#t;#ze;#Ye;#Ge;#Ke;#Je;#et;#tt;#Z=0;constructor({docId:e,ownerDocument:t=globalThis.document}={}){super(),this.#t=e,this.#ze=t}get#q(){return this.#qe||=new Map}get#nt(){if(!this.#Xe){const e=this.#ze.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#ze.createElementNS(s,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#Xe=this.#ze.createElementNS(s,"defs"),e.append(n),n.append(this.#Xe),this.#ze.body.append(e)}return this.#Xe}addFilter(e){if(!e)return"none";let t,n,i,r,s=this.#q.get(e);if(s)return s;if(1===e.length){const s=e[0],o=new Array(256);for(let e=0;e<256;e++)o[e]=s[e]/255;r=t=n=i=o.join(",")}else{const[s,o,a]=e,l=new Array(256),c=new Array(256),h=new Array(256);for(let e=0;e<256;e++)l[e]=s[e]/255,c[e]=o[e]/255,h[e]=a[e]/255;t=l.join(","),n=c.join(","),i=h.join(","),r=`${t}${n}${i}`}if(s=this.#q.get(r),s)return this.#q.set(e,s),s;const o=`g_${this.#t}_transfer_map_${this.#Z++}`,a=`url(#${o})`;this.#q.set(e,a),this.#q.set(r,a);const l=this.#it(o);return this.#rt(t,n,i,l),a}addHCMFilter(e,t){const n=`${e}-${t}`;if(this.#Ge===n)return this.#Ke;if(this.#Ge=n,this.#Ke="none",this.#Ye?.remove(),!e||!t)return this.#Ke;const i=this.#st(e);e=r.Util.makeHexColor(...i);const s=this.#st(t);if(t=r.Util.makeHexColor(...s),this.#nt.style.color="","#000000"===e&&"#ffffff"===t||e===t)return this.#Ke;const o=new Array(256);for(let e=0;e<=255;e++){const t=e/255;o[e]=t<=.03928?t/12.92:((t+.055)/1.055)**2.4}const a=o.join(","),l=`g_${this.#t}_hcm_filter`,c=this.#Je=this.#it(l);this.#rt(a,a,a,c),this.#ot(c);const h=(e,t)=>{const n=i[e]/255,r=s[e]/255,o=new Array(t+1);for(let e=0;e<=t;e++)o[e]=n+e/t*(r-n);return o.join(",")};return this.#rt(h(0,5),h(1,5),h(2,5),c),this.#Ke=`url(#${l})`,this.#Ke}addHighlightHCMFilter(e,t,n,i){const r=`${e}-${t}-${n}-${i}`;if(this.#et===r)return this.#tt;if(this.#et=r,this.#tt="none",this.#Je?.remove(),!e||!t)return this.#tt;const[s,o]=[e,t].map(this.#st.bind(this));let a=Math.round(.2126*s[0]+.7152*s[1]+.0722*s[2]),l=Math.round(.2126*o[0]+.7152*o[1]+.0722*o[2]),[c,h]=[n,i].map(this.#st.bind(this));l<a&&([a,l,c,h]=[l,a,h,c]),this.#nt.style.color="";const d=(e,t,n)=>{const i=new Array(256),r=(l-a)/n,s=e/255,o=(t-e)/(255*n);let c=0;for(let e=0;e<=n;e++){const t=Math.round(a+e*r),n=s+e*o;for(let e=c;e<=t;e++)i[e]=n;c=t+1}for(let e=c;e<256;e++)i[e]=i[c-1];return i.join(",")},u=`g_${this.#t}_hcm_highlight_filter`,p=this.#Je=this.#it(u);return this.#ot(p),this.#rt(d(c[0],h[0],5),d(c[1],h[1],5),d(c[2],h[2],5),p),this.#tt=`url(#${u})`,this.#tt}destroy(e=!1){e&&(this.#Ke||this.#tt)||(this.#Xe&&(this.#Xe.parentNode.parentNode.remove(),this.#Xe=null),this.#qe&&(this.#qe.clear(),this.#qe=null),this.#Z=0)}#ot(e){const t=this.#ze.createElementNS(s,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#it(e){const t=this.#ze.createElementNS(s,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#nt.append(t),t}#at(e,t,n){const i=this.#ze.createElementNS(s,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}#rt(e,t,n,i){const r=this.#ze.createElementNS(s,"feComponentTransfer");i.append(r),this.#at(r,"feFuncR",e),this.#at(r,"feFuncG",t),this.#at(r,"feFuncB",n)}#st(e){return this.#nt.style.color=e,y(getComputedStyle(this.#nt).getPropertyValue("color"))}}t.DOMFilterFactory=a;class l extends i.BaseCanvasFactory{constructor({ownerDocument:e=globalThis.document}={}){super(),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}async function c(e,t=!1){if(g(e,document.baseURI)){const n=await fetch(e);if(!n.ok)throw new Error(n.statusText);return t?new Uint8Array(await n.arrayBuffer()):(0,r.stringToBytes)(await n.text())}return new Promise(((n,i)=>{const s=new XMLHttpRequest;s.open("GET",e,!0),t&&(s.responseType="arraybuffer"),s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(200===s.status||0===s.status){let e;if(t&&s.response?e=new Uint8Array(s.response):!t&&s.responseText&&(e=(0,r.stringToBytes)(s.responseText)),e)return void n(e)}i(new Error(s.statusText))}},s.send(null)}))}t.DOMCanvasFactory=l;class h extends i.BaseCMapReaderFactory{_fetchData(e,t){return c(e,this.isCompressed).then((e=>({cMapData:e,compressionType:t})))}}t.DOMCMapReaderFactory=h;class d extends i.BaseStandardFontDataFactory{_fetchData(e){return c(e,!0)}}t.DOMStandardFontDataFactory=d;class u extends i.BaseSVGFactory{_createSVG(e){return document.createElementNS(s,e)}}t.DOMSVGFactory=u;class p{constructor({viewBox:e,scale:t,rotation:n,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=i,this.offsetY=r;const o=(e[2]+e[0])/2,a=(e[3]+e[1])/2;let l,c,h,d,u,p,f,m;switch((n%=360)<0&&(n+=360),n){case 180:l=-1,c=0,h=0,d=1;break;case 90:l=0,c=1,h=1,d=0;break;case 270:l=0,c=-1,h=-1,d=0;break;case 0:l=1,c=0,h=0,d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(h=-h,d=-d),0===l?(u=Math.abs(a-e[1])*t+i,p=Math.abs(o-e[0])*t+r,f=(e[3]-e[1])*t,m=(e[2]-e[0])*t):(u=Math.abs(o-e[0])*t+i,p=Math.abs(a-e[1])*t+r,f=(e[2]-e[0])*t,m=(e[3]-e[1])*t),this.transform=[l*t,c*t,h*t,d*t,u-l*t*o-h*t*a,p-c*t*o-d*t*a],this.width=f,this.height=m}get rawDims(){const{viewBox:e}=this;return(0,r.shadow)(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new p({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return r.Util.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=r.Util.applyTransform([e[0],e[1]],this.transform),n=r.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return r.Util.applyInverseTransform([e,t],this.transform)}}t.PageViewport=p;class f extends r.BaseException{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function m(e){const t=e.length;let n=0;for(;n<t&&""===e[n].trim();)n++;return"data:"===e.substring(n,n+5).toLowerCase()}t.RenderingCancelledException=f;function g(e,t){try{const{protocol:n}=t?new URL(e,t):new URL(e);return"http:"===n||"https:"===n}catch{return!1}}let O;t.StatTimer=class{started=Object.create(null);times=[];time(e){e in this.started&&(0,r.warn)(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,r.warn)(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:e}of this.times)t=Math.max(e.length,t);for(const{name:n,start:i,end:r}of this.times)e.push(`${n.padEnd(t)} ${r-i}ms\n`);return e.join("")}};function y(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map((e=>parseInt(e))):e.startsWith("rgba(")?e.slice(5,-1).split(",").map((e=>parseInt(e))).slice(0,3):((0,r.warn)(`Not a valid color format: "${e}"`),[0,0,0])}t.PDFDateString=class{static toDateObject(e){if(!e||"string"!=typeof e)return null;O||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=O.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let s=parseInt(t[4],10);s=s>=0&&s<=23?s:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let a=parseInt(t[6],10);a=a>=0&&a<=59?a:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,"-"===l?(s+=c,o+=h):"+"===l&&(s-=c,o-=h),new Date(Date.UTC(n,i,r,s,o,a))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var i=n(1);class r{constructor(){this.constructor===r&&(0,i.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addHighlightHCMFilter(e,t,n,i){return"none"}destroy(e=!1){}}t.BaseFilterFactory=r;class s{constructor(){this.constructor===s&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d")}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=s;class o{constructor({baseUrl:e=null,isCompressed:t=!0}){this.constructor===o&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":""),n=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(t,n).catch((e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)}))}_fetchData(e,t){(0,i.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=o;class a{constructor({baseUrl:e=null}){this.constructor===a&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetchData(t).catch((e=>{throw new Error(`Unable to load font data at: ${t}`)}))}_fetchData(e){(0,i.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=a;class l{constructor(){this.constructor===l&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if("string"!=typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){(0,i.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var i=n(1);const r=3285377520,s=4294901760,o=65535;t.MurmurHash3_64=class{constructor(e){this.h1=e?4294967295&e:r,this.h2=e?4294967295&e:r}update(e){let t,n;if("string"==typeof e){t=new Uint8Array(2*e.length),n=0;for(let i=0,r=e.length;i<r;i++){const r=e.charCodeAt(i);r<=255?t[n++]=r:(t[n++]=r>>>8,t[n++]=255&r)}}else{if(!(0,i.isArrayBuffer)(e))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");t=e.slice(),n=t.byteLength}const r=n>>2,a=n-4*r,l=new Uint32Array(t.buffer,0,r);let c=0,h=0,d=this.h1,u=this.h2;const p=3432918353,f=461845907,m=11601,g=13715;for(let e=0;e<r;e++)1&e?(c=l[e],c=c*p&s|c*m&o,c=c<<15|c>>>17,c=c*f&s|c*g&o,d^=c,d=d<<13|d>>>19,d=5*d+3864292196):(h=l[e],h=h*p&s|h*m&o,h=h<<15|h>>>17,h=h*f&s|h*g&o,u^=h,u=u<<13|u>>>19,u=5*u+3864292196);switch(c=0,a){case 3:c^=t[4*r+2]<<16;case 2:c^=t[4*r+1]<<8;case 1:c^=t[4*r],c=c*p&s|c*m&o,c=c<<15|c>>>17,c=c*f&s|c*g&o,1&r?d^=c:u^=c}this.h1=d,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=3981806797*e&s|36045*e&o,t=4283543511*t&s|(2950163797*(t<<16|e>>>16)&s)>>>16,e^=t>>>1,e=444984403*e&s|60499*e&o,t=3301882366*t&s|(3120437893*(t<<16|e>>>16)&s)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var i=n(1);t.FontLoader=class{#lt=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#lt.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(e){if(e&&!this.#lt.has(e.loadedName))if((0,i.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:t,src:n,style:r}=e,s=new FontFace(t,n,r);this.addNativeFontFace(s);try{await s.load(),this.#lt.add(t)}catch{(0,i.warn)(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(s)}}else(0,i.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo)return void await this.loadSystemFont(e.systemFontInfo);if(this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw(0,i.warn)(`Failed to load font '${t.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise((t=>{const n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)}))}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return(0,i.shadow)(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(i.isNodeJS||"undefined"!=typeof navigator&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const{loadingRequests:t}=this,n={done:!1,complete:function(){for((0,i.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.length>0&&t[0].done;){const e=t.shift();setTimeout(e.callback,0)}},callback:e};return t.push(n),n}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function r(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}let s,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let c=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=r(d,976,h.length,h);const u=1482184792;let p=n(d,16);for(s=0,o=h.length-3;s<o;s+=4)p=p-u+n(h,s)|0;s<h.length&&(p=p-u+n(h+"XXX",s)|0),d=r(d,16,4,(0,i.string32)(p));const f=`@font-face {font-family:"${h}";src:${`url(data:font/opentype;base64,${btoa(d)});`}}`;this.insertRule(f);const m=this._document.createElement("div");m.style.visibility="hidden",m.style.width=m.style.height="10px",m.style.position="absolute",m.style.top=m.style.left="0px";for(const t of[e.loadedName,h]){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=t,m.append(e)}this._document.body.append(m),function e(t,n){if(++c>30)return(0,i.warn)("Load test font never loaded."),void n();l.font="30px "+t,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(h,(()=>{m.remove(),t.complete()}))}};t.FontFaceObject=class{constructor(e,{isEvalSupported:t=!0,disableFontFace:n=!1,ignoreErrors:i=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const t in e)this[t]=e[t];this.isEvalSupported=!1!==t,this.disableFontFace=!0===n,this.ignoreErrors=!0===i,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}else e=new FontFace(this.loadedName,this.data,{});return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=(0,i.bytesToString)(this.data),t=`url(data:${this.mimetype};base64,${btoa(e)});`;let n;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),n=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this._inspectFont?.(this,t),n}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];let n;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return(0,i.warn)(`getPathGenerator - ignoring character: "${e}".`),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const e=[];for(const t of n){const n=void 0!==t.args?t.args.join(","):"";e.push("c.",t.cmd,"(",n,");\n")}return this.compiledGlyphs[t]=new Function("c","size",e.join(""))}return this.compiledGlyphs[t]=function(e,t){for(const i of n)"scale"===i.cmd&&(i.args=[t,-t]),e[i.cmd].apply(e,i.args)}}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var i=n(7);n(1);const r=function(e){return new Promise(((t,n)=>{require$$5.readFile(e,((e,i)=>{!e&&i?t(new Uint8Array(i)):n(new Error(e))}))}))};class s extends i.BaseFilterFactory{}t.NodeFilterFactory=s;class o extends i.BaseCanvasFactory{_createCanvas(e,t){return require$$5.createCanvas(e,t)}}t.NodeCanvasFactory=o;class a extends i.BaseCMapReaderFactory{_fetchData(e,t){return r(e).then((e=>({cMapData:e,compressionType:t})))}}t.NodeCMapReaderFactory=a;class l extends i.BaseStandardFontDataFactory{_fetchData(e){return r(e)}}t.NodeStandardFontDataFactory=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var i=n(1),r=n(6),s=n(12),o=n(13);const a=4096,l=16;class c{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function h(e,t,n,i,s,o,a,l,c,h){const[d,u,p,f,m,g]=(0,r.getCurrentTransform)(e);if(0===u&&0===p){const r=a*d+m,O=Math.round(r),y=l*f+g,v=Math.round(y),b=(a+c)*d+m,w=Math.abs(Math.round(b)-O)||1,S=(l+h)*f+g,x=Math.abs(Math.round(S)-v)||1;return e.setTransform(Math.sign(d),0,0,Math.sign(f),O,v),e.drawImage(t,n,i,s,o,0,0,w,x),e.setTransform(d,u,p,f,m,g),[w,x]}if(0===d&&0===f){const r=l*p+m,O=Math.round(r),y=a*u+g,v=Math.round(y),b=(l+h)*p+m,w=Math.abs(Math.round(b)-O)||1,S=(a+c)*u+g,x=Math.abs(Math.round(S)-v)||1;return e.setTransform(0,Math.sign(u),Math.sign(p),0,O,v),e.drawImage(t,n,i,s,o,0,0,x,w),e.setTransform(d,u,p,f,m,g),[x,w]}e.drawImage(t,n,i,s,o,a,l,c,h);return[Math.hypot(d,u)*c,Math.hypot(p,f)*h]}class d{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,n){[t,n]=i.Util.applyTransform([t,n],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n)}updateRectMinMax(e,t){const n=i.Util.applyTransform(t,e),r=i.Util.applyTransform(t.slice(2),e);this.minX=Math.min(this.minX,n[0],r[0]),this.minY=Math.min(this.minY,n[1],r[1]),this.maxX=Math.max(this.maxX,n[0],r[0]),this.maxY=Math.max(this.maxY,n[1],r[1])}updateScalingPathMinMax(e,t){i.Util.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.maxX=Math.max(this.maxX,t[1]),this.minY=Math.min(this.minY,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,n,r,s,o,a,l,c,h){const d=i.Util.bezierBoundingBox(t,n,r,s,o,a,l,c);if(h)return h[0]=Math.min(h[0],d[0],d[2]),h[1]=Math.max(h[1],d[0],d[2]),h[2]=Math.min(h[2],d[1],d[3]),void(h[3]=Math.max(h[3],d[1],d[3]));this.updateRectMinMax(e,d)}getPathBoundingBox(e=s.PathType.FILL,t=null){const n=[this.minX,this.minY,this.maxX,this.maxY];if(e===s.PathType.STROKE){t||(0,i.unreachable)("Stroke bounding box must include transform.");const e=i.Util.singularValueDecompose2dScale(t),r=e[0]*this.lineWidth/2,s=e[1]*this.lineWidth/2;n[0]-=r,n[1]-=s,n[2]+=r,n[3]+=s}return n}updateClipFromPath(){const e=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=s.PathType.FILL,t=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function u(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);const n=t.height,r=t.width,s=n%l,o=(n-s)/l,a=0===s?o:o+1,c=e.createImageData(r,l);let h,d=0;const u=t.data,p=c.data;let f,m,g,O;if(t.kind===i.ImageKind.GRAYSCALE_1BPP){const t=u.byteLength,n=new Uint32Array(p.buffer,0,p.byteLength>>2),O=n.length,y=r+7>>3,v=4294967295,b=i.FeatureTest.isLittleEndian?4278190080:255;for(f=0;f<a;f++){for(g=f<o?l:s,h=0,m=0;m<g;m++){const e=t-d;let i=0;const s=e>y?r:8*e-7,o=-8&s;let a=0,l=0;for(;i<o;i+=8)l=u[d++],n[h++]=128&l?v:b,n[h++]=64&l?v:b,n[h++]=32&l?v:b,n[h++]=16&l?v:b,n[h++]=8&l?v:b,n[h++]=4&l?v:b,n[h++]=2&l?v:b,n[h++]=1&l?v:b;for(;i<s;i++)0===a&&(l=u[d++],a=128),n[h++]=l&a?v:b,a>>=1}for(;h<O;)n[h++]=0;e.putImageData(c,0,f*l)}}else if(t.kind===i.ImageKind.RGBA_32BPP){for(m=0,O=r*l*4,f=0;f<o;f++)p.set(u.subarray(d,d+O)),d+=O,e.putImageData(c,0,m),m+=l;f<a&&(O=r*s*4,p.set(u.subarray(d,d+O)),e.putImageData(c,0,m))}else{if(t.kind!==i.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);for(g=l,O=r*g,f=0;f<a;f++){for(f>=o&&(g=s,O=r*g),h=0,m=O;m--;)p[h++]=u[d++],p[h++]=u[d++],p[h++]=u[d++],p[h++]=255;e.putImageData(c,0,f*l)}}}function p(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const n=t.height,i=t.width,r=n%l,s=(n-r)/l,a=0===r?s:s+1,c=e.createImageData(i,l);let h=0;const d=t.data,u=c.data;for(let t=0;t<a;t++){const n=t<s?l:r;({srcPos:h}=(0,o.convertBlackAndWhiteToRGBA)({src:d,srcPos:h,dest:u,width:i,height:n,nonBlackColor:0})),e.putImageData(c,0,t*l)}}function f(e,t){const n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of n)void 0!==e[i]&&(t[i]=e[i]);void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function m(e){if(e.strokeStyle=e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0),!i.isNodeJS){const{filter:t}=e;"none"!==t&&""!==t&&(e.filter="none")}}function g(e,t,n,i){const r=e.length;for(let s=3;s<r;s+=4){const r=e[s];if(0===r)e[s-3]=t,e[s-2]=n,e[s-1]=i;else if(r<255){const o=255-r;e[s-3]=e[s-3]*r+t*o>>8,e[s-2]=e[s-2]*r+n*o>>8,e[s-1]=e[s-1]*r+i*o>>8}}}function O(e,t,n){const i=e.length;for(let r=3;r<i;r+=4){const i=n?n[e[r]]:e[r];t[r]=t[r]*i*.00392156862745098|0}}function y(e,t,n){const i=e.length;for(let r=3;r<i;r+=4){const i=77*e[r-3]+152*e[r-2]+28*e[r-1];t[r]=n?t[r]*n[i>>8]>>8:t[r]*i>>16}}function v(e,t,n,i){const r=i[0],s=i[1],o=i[2]-r,a=i[3]-s;0!==o&&0!==a&&(!function(e,t,n,i,r,s,o,a,l,c,h){const d=!!s,u=d?s[0]:0,p=d?s[1]:0,f=d?s[2]:0,m="Luminosity"===r?y:O,v=Math.min(i,Math.ceil(1048576/n));for(let r=0;r<i;r+=v){const s=Math.min(v,i-r),O=e.getImageData(a-c,r+(l-h),n,s),y=t.getImageData(a,r+l,n,s);d&&g(O.data,u,p,f),m(O.data,y.data,o),t.putImageData(y,a,r+l)}}(t.context,n,o,a,t.subtype,t.backdrop,t.transferMap,r,s,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}function b(e,t){const n=i.Util.singularValueDecompose2dScale(e);n[0]=Math.fround(n[0]),n[1]=Math.fround(n[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*r.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==t?t:n[0]<=s||n[1]<=s}const w=["butt","round","square"],S=["miter","round","bevel"],x={},C={};class _{constructor(e,t,n,i,r,{optionalContentConfig:s,markedContentStack:o=null},a,l){this.ctx=e,this.current=new d(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=s,this.cachedCanvases=new c(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=l,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return"string"==typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,o),this.ctx.fillStyle=a,n){const e=this.cachedCanvases.getCanvas("transparent",s,o);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...(0,r.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),m(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=(0,r.getCurrentTransform)(this.ctx)}executeOperatorList(e,t,n,r){const s=e.argsArray,o=e.fnArray;let a=t||0;const l=s.length;if(l===a)return a;const c=l-a>10&&"function"==typeof n,h=c?Date.now()+15:0;let d=0;const u=this.commonObjs,p=this.objs;let f;for(;;){if(void 0!==r&&a===r.nextBreakPoint)return r.breakIt(a,n),a;if(f=o[a],f!==i.OPS.dependency)this[f].apply(this,s[a]);else for(const e of s[a]){const t=e.startsWith("g_")?u:p;if(!t.has(e))return t.get(e,n),a}if(a++,a===l)return a;if(c&&++d>10){if(Date.now()>h)return n(),a;d=0}}}#ct(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#ct(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#ht()}#ht(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if("none"!==e){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width,i=e.height;let r,s,o=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),l=n,c=i,h="prescale1";for(;o>2&&l>1||a>2&&c>1;){let t=l,n=c;o>2&&l>1&&(t=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),o/=l/t),a>2&&c>1&&(n=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c)/2,a/=c/n),r=this.cachedCanvases.getCanvas(h,t,n),s=r.context,s.clearRect(0,0,t,n),s.drawImage(e,0,0,l,c,0,0,t,n),e=r.canvas,l=t,c=n,h="prescale1"===h?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:n,height:o}=e,a=this.current.fillColor,l=this.current.patternFill,c=(0,r.getCurrentTransform)(t);let d,u,f,m;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer;u=JSON.stringify(l?c:[c.slice(0,4),a]),d=this._cachedBitmapsMap.get(t),d||(d=new Map,this._cachedBitmapsMap.set(t,d));const n=d.get(u);if(n&&!l){return{canvas:n,offsetX:Math.round(Math.min(c[0],c[2])+c[4]),offsetY:Math.round(Math.min(c[1],c[3])+c[5])}}f=n}f||(m=this.cachedCanvases.getCanvas("maskCanvas",n,o),p(m.context,e));let g=i.Util.transform(c,[1/n,0,0,-1/o,0,0]);g=i.Util.transform(g,[1,0,0,1,0,-o]);const O=i.Util.applyTransform([0,0],g),y=i.Util.applyTransform([n,o],g),v=i.Util.normalizeRect([O[0],O[1],y[0],y[1]]),w=Math.round(v[2]-v[0])||1,S=Math.round(v[3]-v[1])||1,x=this.cachedCanvases.getCanvas("fillCanvas",w,S),C=x.context,_=Math.min(O[0],y[0]),E=Math.min(O[1],y[1]);C.translate(-_,-E),C.transform(...g),f||(f=this._scaleImage(m.canvas,(0,r.getCurrentTransformInverse)(C)),f=f.img,d&&l&&d.set(u,f)),C.imageSmoothingEnabled=b((0,r.getCurrentTransform)(C),e.interpolate),h(C,f,0,0,f.width,f.height,0,0,n,o),C.globalCompositeOperation="source-in";const P=i.Util.transform((0,r.getCurrentTransformInverse)(C),[1,0,0,1,-_,-E]);return C.fillStyle=l?a.getPattern(t,this,P,s.PathType.FILL):a,C.fillRect(0,0,n,o),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(u,x.canvas)),{canvas:x.canvas,offsetX:Math.round(_),offsetY:Math.round(E)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=w[e]}setLineJoin(e){this.ctx.lineJoin=S[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n[0],n[1]);break;case"CA":this.current.strokeAlpha=n;break;case"ca":this.current.fillAlpha=n,this.ctx.globalAlpha=n;break;case"BM":this.ctx.globalCompositeOperation=n;break;case"SMask":this.current.activeSMask=n?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(n)}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,e,t);this.suspendedCtx=this.ctx,this.ctx=i.context;const s=this.ctx;s.setTransform(...(0,r.getCurrentTransform)(this.suspendedCtx)),f(this.suspendedCtx,s),function(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,i,r,s,o){t.transform(e,n,i,r,s,o),this.__originalTransform(e,n,i,r,s,o)},e.setTransform=function(e,n,i,r,s,o){t.setTransform(e,n,i,r,s,o),this.__originalSetTransform(e,n,i,r,s,o)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,i,r,s,o){t.bezierCurveTo(e,n,i,r,s,o),this.__originalBezierCurveTo(e,n,i,r,s,o)},e.rect=function(e,n,i,r){t.rect(e,n,i,r),this.__originalRect(e,n,i,r)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),f(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask;v(this.suspendedCtx,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(f(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),f(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,n,i,r,s){this.ctx.transform(e,t,n,i,r,s),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n){const s=this.ctx,o=this.current;let a,l,c=o.x,h=o.y;const d=(0,r.getCurrentTransform)(s),u=0===d[0]&&0===d[3]||0===d[1]&&0===d[2],p=u?n.slice(0):null;for(let n=0,r=0,f=e.length;n<f;n++)switch(0|e[n]){case i.OPS.rectangle:c=t[r++],h=t[r++];const e=t[r++],n=t[r++],f=c+e,m=h+n;s.moveTo(c,h),0===e||0===n?s.lineTo(f,m):(s.lineTo(f,h),s.lineTo(f,m),s.lineTo(c,m)),u||o.updateRectMinMax(d,[c,h,f,m]),s.closePath();break;case i.OPS.moveTo:c=t[r++],h=t[r++],s.moveTo(c,h),u||o.updatePathMinMax(d,c,h);break;case i.OPS.lineTo:c=t[r++],h=t[r++],s.lineTo(c,h),u||o.updatePathMinMax(d,c,h);break;case i.OPS.curveTo:a=c,l=h,c=t[r+4],h=t[r+5],s.bezierCurveTo(t[r],t[r+1],t[r+2],t[r+3],c,h),o.updateCurvePathMinMax(d,a,l,t[r],t[r+1],t[r+2],t[r+3],c,h,p),r+=6;break;case i.OPS.curveTo2:a=c,l=h,s.bezierCurveTo(c,h,t[r],t[r+1],t[r+2],t[r+3]),o.updateCurvePathMinMax(d,a,l,c,h,t[r],t[r+1],t[r+2],t[r+3],p),c=t[r+2],h=t[r+3],r+=4;break;case i.OPS.curveTo3:a=c,l=h,c=t[r+2],h=t[r+3],s.bezierCurveTo(t[r],t[r+1],c,h,c,h),o.updateCurvePathMinMax(d,a,l,t[r],t[r+1],c,h,c,h,p),r+=4;break;case i.OPS.closePath:s.closePath()}u&&o.updateScalingPathMinMax(d,p),o.setCurrentPoint(c,h)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,n=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof n&&n?.getPattern?(t.save(),t.strokeStyle=n.getPattern(t,this,(0,r.getCurrentTransformInverse)(t),s.PathType.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,n=this.current.fillColor;let i=!1;this.current.patternFill&&(t.save(),t.fillStyle=n.getPattern(t,this,(0,r.getCurrentTransformInverse)(t),s.PathType.FILL),i=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==o&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=x}eoClip(){this.pendingClip=C}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(const n of e)t.setTransform(...n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error(`Can't find font for ${e}`);if(r.fontMatrix=n.fontMatrix||i.FONT_IDENTITY_MATRIX,0!==r.fontMatrix[0]&&0!==r.fontMatrix[3]||(0,i.warn)("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;const s=n.loadedName||"sans-serif",o=n.systemFontInfo?.css||`"${s}", ${n.fallbackName}`;let a="normal";n.black?a="900":n.bold&&(a="bold");const l=n.italic?"italic":"normal";let c=t;t<16?c=16:t>100&&(c=100),this.current.fontSizeScale=t/c,this.ctx.font=`${l} ${a} ${c}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,n,i,r,s){this.current.textMatrix=[e,t,n,i,r,s],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,n,s){const o=this.ctx,a=this.current,l=a.font,c=a.textRenderingMode,h=a.fontSize/a.fontSizeScale,d=c&i.TextRenderingMode.FILL_STROKE_MASK,u=!!(c&i.TextRenderingMode.ADD_TO_PATH_FLAG),p=a.patternFill&&!l.missingFile;let f;if((l.disableFontFace||u||p)&&(f=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p?(o.save(),o.translate(t,n),o.beginPath(),f(o,h),s&&o.setTransform(...s),d!==i.TextRenderingMode.FILL&&d!==i.TextRenderingMode.FILL_STROKE||o.fill(),d!==i.TextRenderingMode.STROKE&&d!==i.TextRenderingMode.FILL_STROKE||o.stroke(),o.restore()):(d!==i.TextRenderingMode.FILL&&d!==i.TextRenderingMode.FILL_STROKE||o.fillText(e,t,n),d!==i.TextRenderingMode.STROKE&&d!==i.TextRenderingMode.FILL_STROKE||o.strokeText(e,t,n)),u){(this.pendingTextPaths||=[]).push({transform:(0,r.getCurrentTransform)(o),x:t,y:n,fontSize:h,addToPath:f})}}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let e=3;e<t.length;e+=4)if(t[e]>0&&t[e]<255){n=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",n)}showText(e){const t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);const o=t.fontSize;if(0===o)return;const a=this.ctx,l=t.fontSizeScale,c=t.charSpacing,h=t.wordSpacing,d=t.fontDirection,u=t.textHScale*d,p=e.length,f=n.vertical,m=f?1:-1,g=n.defaultVMetrics,O=o*t.fontMatrix[0],y=t.textRenderingMode===i.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;let v;if(a.save(),a.transform(...t.textMatrix),a.translate(t.x,t.y+t.textRise),d>0?a.scale(u,-1):a.scale(u,1),t.patternFill){a.save();const e=t.fillColor.getPattern(a,this,(0,r.getCurrentTransformInverse)(a),s.PathType.FILL);v=(0,r.getCurrentTransform)(a),a.restore(),a.fillStyle=e}let b=t.lineWidth;const w=t.textMatrixScale;if(0===w||0===b){const e=t.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;e!==i.TextRenderingMode.STROKE&&e!==i.TextRenderingMode.FILL_STROKE||(b=this.getSinglePixelWidth())}else b/=w;if(1!==l&&(a.scale(l,l),b/=l),a.lineWidth=b,n.isInvalidPDFjsFont){const n=[];let i=0;for(const t of e)n.push(t.unicode),i+=t.width;return a.fillText(n.join(""),0,0),t.x+=i*O*u,a.restore(),void this.compose()}let S,x=0;for(S=0;S<p;++S){const t=e[S];if("number"==typeof t){x+=m*t*o/1e3;continue}let i=!1;const r=(t.isSpace?h:0)+c,s=t.fontChar,u=t.accent;let p,b,w=t.width;if(f){const e=t.vmetric||g,n=-(t.vmetric?e[1]:.5*w)*O,i=e[2]*O;w=e?-e[0]:w,p=n/l,b=(x+i)/l}else p=x/l,b=0;if(n.remeasure&&w>0){const e=1e3*a.measureText(s).width/o*l;if(w<e&&this.isFontSubpixelAAEnabled){const t=w/e;i=!0,a.save(),a.scale(t,1),p/=t}else w!==e&&(p+=(w-e)/2e3*o/l)}if(this.contentVisible&&(t.isInFont||n.missingFile))if(y&&!u)a.fillText(s,p,b);else if(this.paintChar(s,p,b,v),u){const e=p+o*u.offset.x/l,t=b-o*u.offset.y/l;this.paintChar(u.fontChar,e,t,v)}x+=f?w*O-r*d:w*O+r*d,i&&a.restore()}f?t.y-=x:t.x+=x*u,a.restore(),this.compose()}showType3Text(e){const t=this.ctx,n=this.current,r=n.font,s=n.fontSize,o=n.fontDirection,a=r.vertical?1:-1,l=n.charSpacing,c=n.wordSpacing,h=n.textHScale*o,d=n.fontMatrix||i.FONT_IDENTITY_MATRIX,u=e.length;let p,f,m,g;if(!(n.textRenderingMode===i.TextRenderingMode.INVISIBLE)&&0!==s){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...n.textMatrix),t.translate(n.x,n.y),t.scale(h,o),p=0;p<u;++p){if(f=e[p],"number"==typeof f){g=a*f*s/1e3,this.ctx.translate(g,0),n.x+=g*h;continue}const o=(f.isSpace?c:0)+l,u=r.charProcOperatorList[f.operatorListId];if(!u){(0,i.warn)(`Type3 character "${f.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=f,this.save(),t.scale(s,s),t.transform(...d),this.executeOperatorList(u),this.restore());m=i.Util.applyTransform([f.width,0],d)[0]*s+o,t.translate(m,0),n.x+=m*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,n,i,r,s){this.ctx.rect(n,i,r-n,s-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const n=e[1],i=this.baseTransform||(0,r.getCurrentTransform)(this.ctx),o={createCanvasGraphics:e=>new _(e,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new s.TilingPattern(e,n,this.ctx,o,i)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,n){const r=i.Util.makeHexColor(e,t,n);this.ctx.strokeStyle=r,this.current.strokeColor=r}setFillRGBColor(e,t,n){const r=i.Util.makeHexColor(e,t,n);this.ctx.fillStyle=r,this.current.fillColor=r,this.current.patternFill=!1}_getPattern(e,t=null){let n;return this.cachedPatterns.has(e)?n=this.cachedPatterns.get(e):(n=(0,s.getShadingPattern)(this.getObject(e)),this.cachedPatterns.set(e,n)),t&&(n.matrix=t),n}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const n=this._getPattern(e);t.fillStyle=n.getPattern(t,this,(0,r.getCurrentTransformInverse)(t),s.PathType.SHADING);const o=(0,r.getCurrentTransformInverse)(t);if(o){const{width:e,height:n}=t.canvas,[r,s,a,l]=i.Util.getAxialAlignedBoundingBox([0,0,e,n],o);this.ctx.fillRect(r,s,a-r,l-s)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform(...e),this.baseTransform=(0,r.getCurrentTransform)(this.ctx),t)){const e=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],e,n),this.current.updateRectMinMax((0,r.getCurrentTransform)(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||(0,i.info)("TODO: Support non-isolated groups."),e.knockout&&(0,i.warn)("Knockout groups not supported.");const n=(0,r.getCurrentTransform)(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=i.Util.getAxialAlignedBoundingBox(e.bbox,(0,r.getCurrentTransform)(t));const o=[0,0,t.canvas.width,t.canvas.height];s=i.Util.intersect(s,o)||[0,0,0,0];const l=Math.floor(s[0]),c=Math.floor(s[1]);let h=Math.max(Math.ceil(s[2])-l,1),d=Math.max(Math.ceil(s[3])-c,1),u=1,p=1;h>a&&(u=h/a,h=a),d>a&&(p=d/a,d=a),this.current.startNewPathAndClipBox([0,0,h,d]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const g=this.cachedCanvases.getCanvas(m,h,d),O=g.context;O.scale(1/u,1/p),O.translate(-l,-c),O.transform(...n),e.smask?this.smaskStack.push({canvas:g.canvas,context:O,offsetX:l,offsetY:c,scaleX:u,scaleY:p,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(l,c),t.scale(u,p),t.save()),f(t,O),this.ctx=O,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,n=this.groupStack.pop();if(this.ctx=n,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=(0,r.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const n=i.Util.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(n)}}beginAnnotation(e,t,n,s,o){if(this.#ct(),m(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(t)&&4===t.length){const s=t[2]-t[0],a=t[3]-t[1];if(o&&this.annotationCanvasMap){(n=n.slice())[4]-=t[0],n[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=s,t[3]=a;const[o,l]=i.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(this.ctx)),{viewportScale:c}=this,h=Math.ceil(s*this.outputScaleX*c),d=Math.ceil(a*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(h,d);const{canvas:u,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.save(),this.ctx.setTransform(o,0,0,-l,0,a*l),m(this.ctx)}else m(this.ctx),this.ctx.rect(t[0],t[1],s,a),this.ctx.clip(),this.endPath()}this.current=new d(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...n),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#ht(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const n=this.ctx,i=this.processingType3;if(i&&(void 0===i.compiled&&(i.compiled=function(e){const{width:t,height:n}=e;if(t>1e3||n>1e3)return null;const i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=t+1;let s,o,a,l=new Uint8Array(r*(n+1));const c=t+7&-8;let h=new Uint8Array(c*n),d=0;for(const t of e.data){let e=128;for(;e>0;)h[d++]=t&e?0:255,e>>=1}let u=0;for(d=0,0!==h[d]&&(l[0]=1,++u),o=1;o<t;o++)h[d]!==h[d+1]&&(l[o]=h[d]?2:1,++u),d++;for(0!==h[d]&&(l[o]=2,++u),s=1;s<n;s++){d=s*c,a=s*r,h[d-c]!==h[d]&&(l[a]=h[d]?1:8,++u);let e=(h[d]?4:0)+(h[d-c]?8:0);for(o=1;o<t;o++)e=(e>>2)+(h[d+1]?4:0)+(h[d-c+1]?8:0),i[e]&&(l[a+o]=i[e],++u),d++;if(h[d-c]!==h[d]&&(l[a+o]=h[d]?2:4,++u),u>1e3)return null}for(d=c*(n-1),a=s*r,0!==h[d]&&(l[a]=8,++u),o=1;o<t;o++)h[d]!==h[d+1]&&(l[a+o]=h[d]?4:8,++u),d++;if(0!==h[d]&&(l[a+o]=4,++u),u>1e3)return null;const p=new Int32Array([0,r,-1,0,-r,0,0,0,1]),f=new Path2D;for(s=0;u&&s<=n;s++){let e=s*r;const n=e+t;for(;e<n&&!l[e];)e++;if(e===n)continue;f.moveTo(e%r,s);const i=e;let o=l[e];do{const t=p[o];do{e+=t}while(!l[e]);const n=l[e];5!==n&&10!==n?(o=n,l[e]=0):(o=n&51*o>>4,l[e]&=o>>2|o<<2),f.lineTo(e%r,e/r|0),l[e]||--u}while(i!==e);--s}return h=null,l=null,function(e){e.save(),e.scale(1/t,-1/n),e.translate(0,-n),e.fill(f),e.beginPath(),e.restore()}}(e)),i.compiled))return void i.compiled(n);const r=this._createMaskCanvas(e),s=r.canvas;n.save(),n.setTransform(1,0,0,1,0,0),n.drawImage(s,r.offsetX,r.offsetY),n.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n=0,s=0,o,a){if(!this.contentVisible)return;e=this.getObject(e.data,e);const l=this.ctx;l.save();const c=(0,r.getCurrentTransform)(l);l.transform(t,n,s,o,0,0);const h=this._createMaskCanvas(e);l.setTransform(1,0,0,1,h.offsetX-c[4],h.offsetY-c[5]);for(let e=0,r=a.length;e<r;e+=2){const r=i.Util.transform(c,[t,n,s,o,a[e],a[e+1]]),[d,u]=i.Util.applyTransform([0,0],r);l.drawImage(h.canvas,d,u)}l.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,n=this.current.fillColor,i=this.current.patternFill;for(const o of e){const{data:e,width:a,height:l,transform:c}=o,d=this.cachedCanvases.getCanvas("maskCanvas",a,l),u=d.context;u.save();p(u,this.getObject(e,o)),u.globalCompositeOperation="source-in",u.fillStyle=i?n.getPattern(u,this,(0,r.getCurrentTransformInverse)(t),s.PathType.FILL):n,u.fillRect(0,0,a,l),u.restore(),t.save(),t.transform(...c),t.scale(1,-1),h(t,d.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,i.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,n,r){if(!this.contentVisible)return;const s=this.getObject(e);if(!s)return void(0,i.warn)("Dependent image isn't ready yet");const o=s.width,a=s.height,l=[];for(let e=0,i=r.length;e<i;e+=2)l.push({transform:[t,0,0,n,r[e],r[e+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(s,l)}applyTransferMapsToCanvas(e){return"none"!==this.current.transferMaps&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if("none"===this.current.transferMaps)return e.bitmap;const{bitmap:t,width:n,height:i}=e,r=this.cachedCanvases.getCanvas("inlineImage",n,i),s=r.context;return s.filter=this.current.transferMaps,s.drawImage(t,0,0),s.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,n=e.height,s=this.ctx;if(this.save(),!i.isNodeJS){const{filter:e}=s;"none"!==e&&""!==e&&(s.filter="none")}let o;if(s.scale(1/t,-1/n),e.bitmap)o=this.applyTransferMapsToBitmap(e);else if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)o=e;else{const i=this.cachedCanvases.getCanvas("inlineImage",t,n).context;u(i,e),o=this.applyTransferMapsToCanvas(i)}const a=this._scaleImage(o,(0,r.getCurrentTransformInverse)(s));s.imageSmoothingEnabled=b((0,r.getCurrentTransform)(s),e.interpolate),h(s,a.img,0,0,a.paintWidth,a.paintHeight,0,-n,t,n),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx;let i;if(e.bitmap)i=e.bitmap;else{const t=e.width,n=e.height,r=this.cachedCanvases.getCanvas("inlineImage",t,n).context;u(r,e),i=this.applyTransferMapsToCanvas(r)}for(const e of t)n.save(),n.transform(...e.transform),n.scale(1,-1),h(n,i,e.x,e.y,e.w,e.h,0,-1,1,1),n.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const n=this.ctx;this.pendingClip&&(t||(this.pendingClip===C?n.clip("evenodd"):n.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),n.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=(0,r.getCurrentTransform)(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(-1===this._cachedScaleForStroking[0]){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:r}=this.ctx.getTransform();let s,o;if(0===n&&0===i){const n=Math.abs(t),i=Math.abs(r);if(n===i)if(0===e)s=o=1/n;else{const t=n*e;s=o=t<1?1/t:1}else if(0===e)s=1/n,o=1/i;else{const t=n*e,r=i*e;s=t<1?1/t:1,o=r<1?1/r:1}}else{const a=Math.abs(t*r-n*i),l=Math.hypot(t,n),c=Math.hypot(i,r);if(0===e)s=c/a,o=l/a;else{const t=e*a;s=c>t?c/t:1,o=l>t?l/t:1}}this._cachedScaleForStroking[0]=s,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:n}=this.current,[i,r]=this.getScaleForStroking();if(t.lineWidth=n||1,1===i&&1===r)return void t.stroke();const s=t.getLineDash();if(e&&t.save(),t.scale(i,r),s.length>0){const e=Math.max(i,r);t.setLineDash(s.map((t=>t/e))),t.lineDashOffset/=e}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}t.CanvasGraphics=_;for(const e in i.OPS)void 0!==_.prototype[e]&&(_.prototype[i.OPS[e]]=_.prototype[e])},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=function(e){switch(e[0]){case"RadialAxial":return new l(e);case"Mesh":return new d(e);case"Dummy":return new u}throw new Error(`Unknown IR type: ${e[0]}`)};var i=n(1),r=n(6);const s={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function o(e,t){if(!t)return;const n=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],n,i),e.clip(r)}t.PathType=s;class a{constructor(){this.constructor===a&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class l extends a{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const e of this._colorStops)t.addColorStop(e[0],e[1]);return t}getPattern(e,t,n,a){let l;if(a===s.STROKE||a===s.FILL){const s=t.current.getClippedPathBoundingBox(a,(0,r.getCurrentTransform)(e))||[0,0,0,0],c=Math.ceil(s[2]-s[0])||1,h=Math.ceil(s[3]-s[1])||1,d=t.cachedCanvases.getCanvas("pattern",c,h,!0),u=d.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-s[0],-s[1]),n=i.Util.transform(n,[1,0,0,1,s[0],s[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),o(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),l=e.createPattern(d.canvas,"no-repeat");const p=new DOMMatrix(n);l.setTransform(p)}else o(e,this._bbox),l=this._createGradient(e);return l}}function c(e,t,n,i,r,s,o,a){const l=t.coords,c=t.colors,h=e.data,d=4*e.width;let u;l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=s,s=o,o=u),l[i+1]>l[r+1]&&(u=i,i=r,r=u,u=o,o=a,a=u),l[n+1]>l[i+1]&&(u=n,n=i,i=u,u=s,s=o,o=u);const p=(l[n]+t.offsetX)*t.scaleX,f=(l[n+1]+t.offsetY)*t.scaleY,m=(l[i]+t.offsetX)*t.scaleX,g=(l[i+1]+t.offsetY)*t.scaleY,O=(l[r]+t.offsetX)*t.scaleX,y=(l[r+1]+t.offsetY)*t.scaleY;if(f>=y)return;const v=c[s],b=c[s+1],w=c[s+2],S=c[o],x=c[o+1],C=c[o+2],_=c[a],E=c[a+1],P=c[a+2],k=Math.round(f),T=Math.round(y);let A,R,M,I,L,$,D,N;for(let e=k;e<=T;e++){if(e<g){const t=e<f?0:(f-e)/(f-g);A=p-(p-m)*t,R=v-(v-S)*t,M=b-(b-x)*t,I=w-(w-C)*t}else{let t;t=e>y?1:g===y?0:(g-e)/(g-y),A=m-(m-O)*t,R=S-(S-_)*t,M=x-(x-E)*t,I=C-(C-P)*t}let t;t=e<f?0:e>y?1:(f-e)/(f-y),L=p-(p-O)*t,$=v-(v-_)*t,D=b-(b-E)*t,N=w-(w-P)*t;const n=Math.round(Math.min(A,L)),i=Math.round(Math.max(A,L));let r=d*e+4*n;for(let e=n;e<=i;e++)t=(A-e)/(A-L),t<0?t=0:t>1&&(t=1),h[r++]=R-(R-$)*t|0,h[r++]=M-(M-D)*t|0,h[r++]=I-(I-N)*t|0,h[r++]=255}}function h(e,t,n){const i=t.coords,r=t.colors;let s,o;switch(t.type){case"lattice":const a=t.verticesPerRow,l=Math.floor(i.length/a)-1,h=a-1;for(s=0;s<l;s++){let t=s*a;for(let s=0;s<h;s++,t++)c(e,n,i[t],i[t+1],i[t+a],r[t],r[t+1],r[t+a]),c(e,n,i[t+a+1],i[t+1],i[t+a],r[t+a+1],r[t+1],r[t+a])}break;case"triangles":for(s=0,o=i.length;s<o;s+=3)c(e,n,i[s],i[s+1],i[s+2],r[s],r[s+1],r[s+2]);break;default:throw new Error("illegal figure")}}class d extends a{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,n){const i=Math.floor(this._bounds[0]),r=Math.floor(this._bounds[1]),s=Math.ceil(this._bounds[2])-i,o=Math.ceil(this._bounds[3])-r,a=Math.min(Math.ceil(Math.abs(s*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(o*e[1]*1.1)),3e3),c=s/a,d=o/l,u={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-r,scaleX:1/c,scaleY:1/d},p=a+4,f=l+4,m=n.getCanvas("mesh",p,f,!1),g=m.context,O=g.createImageData(a,l);if(t){const e=O.data;for(let n=0,i=e.length;n<i;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(const e of this._figures)h(O,e,u);g.putImageData(O,2,2);return{canvas:m.canvas,offsetX:i-2*c,offsetY:r-2*d,scaleX:c,scaleY:d}}getPattern(e,t,n,a){let l;if(o(e,this._bbox),a===s.SHADING)l=i.Util.singularValueDecompose2dScale((0,r.getCurrentTransform)(e));else if(l=i.Util.singularValueDecompose2dScale(t.baseTransform),this.matrix){const e=i.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*e[0],l[1]*e[1]]}const c=this._createMeshCanvas(l,a===s.SHADING?null:this._background,t.cachedCanvases);return a!==s.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class u extends a{getPattern(){return"hotpink"}}const p=1,f=2;class m{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,i,r){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=n,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(e){const t=this.operatorList,n=this.bbox,s=this.xstep,o=this.ystep,a=this.paintType,l=this.tilingType,c=this.color,h=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+l);const d=n[0],u=n[1],p=n[2],f=n[3],m=i.Util.singularValueDecompose2dScale(this.matrix),g=i.Util.singularValueDecompose2dScale(this.baseTransform),O=[m[0]*g[0],m[1]*g[1]],y=this.getSizeAndScale(s,this.ctx.canvas.width,O[0]),v=this.getSizeAndScale(o,this.ctx.canvas.height,O[1]),b=e.cachedCanvases.getCanvas("pattern",y.size,v.size,!0),w=b.context,S=h.createCanvasGraphics(w);S.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(S,a,c);let x=d,C=u,_=p,E=f;return d<0&&(x=0,_+=Math.abs(d)),u<0&&(C=0,E+=Math.abs(u)),w.translate(-y.scale*x,-v.scale*C),S.transform(y.scale,0,0,v.scale,0,0),w.save(),this.clipBbox(S,x,C,_,E),S.baseTransform=(0,r.getCurrentTransform)(S.ctx),S.executeOperatorList(t),S.endDrawing(),{canvas:b.canvas,scaleX:y.scale,scaleY:v.scale,offsetX:x,offsetY:C}}getSizeAndScale(e,t,n){e=Math.abs(e);const i=Math.max(m.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*n);return r>=i?r=i:n=r/e,{scale:n,size:r}}clipBbox(e,t,n,i,s){const o=i-t,a=s-n;e.ctx.rect(t,n,o,a),e.current.updateRectMinMax((0,r.getCurrentTransform)(e.ctx),[t,n,i,s]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const r=e.ctx,s=e.current;switch(t){case p:const e=this.ctx;r.fillStyle=e.fillStyle,r.strokeStyle=e.strokeStyle,s.fillColor=e.fillStyle,s.strokeColor=e.strokeStyle;break;case f:const o=i.Util.makeHexColor(n[0],n[1],n[2]);r.fillStyle=o,r.strokeStyle=o,s.fillColor=o,s.strokeColor=o;break;default:throw new i.FormatError(`Unsupported paint type: ${t}`)}}getPattern(e,t,n,r){let o=n;r!==s.SHADING&&(o=i.Util.transform(o,t.baseTransform),this.matrix&&(o=i.Util.transform(o,this.matrix)));const a=this.createPatternCanvas(t);let l=new DOMMatrix(o);l=l.translate(a.offsetX,a.offsetY),l=l.scale(1/a.scaleX,1/a.scaleY);const c=e.createPattern(a.canvas,"repeat");return c.setTransform(l),c}}t.TilingPattern=m},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=r,t.convertToRGBA=function(e){switch(e.kind){case i.ImageKind.GRAYSCALE_1BPP:return r(e);case i.ImageKind.RGB_24BPP:return function({src:e,srcPos:t=0,dest:n,destPos:r=0,width:s,height:o}){let a=0;const l=e.length>>2,c=new Uint32Array(e.buffer,t,l);if(i.FeatureTest.isLittleEndian){for(;a<l-2;a+=3,r+=4){const e=c[a],t=c[a+1],i=c[a+2];n[r]=4278190080|e,n[r+1]=e>>>24|t<<8|4278190080,n[r+2]=t>>>16|i<<16|4278190080,n[r+3]=i>>>8|4278190080}for(let t=4*a,i=e.length;t<i;t+=3)n[r++]=e[t]|e[t+1]<<8|e[t+2]<<16|4278190080}else{for(;a<l-2;a+=3,r+=4){const e=c[a],t=c[a+1],i=c[a+2];n[r]=255|e,n[r+1]=e<<24|t>>>8|255,n[r+2]=t<<16|i>>>16|255,n[r+3]=i<<8|255}for(let t=4*a,i=e.length;t<i;t+=3)n[r++]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|255}return{srcPos:t,destPos:r}}(e)}return null},t.grayToRGBA=function(e,t){if(i.FeatureTest.isLittleEndian)for(let n=0,i=e.length;n<i;n++)t[n]=65793*e[n]|4278190080;else for(let n=0,i=e.length;n<i;n++)t[n]=16843008*e[n]|255};var i=n(1);function r({src:e,srcPos:t=0,dest:n,width:r,height:s,nonBlackColor:o=4294967295,inverseDecode:a=!1}){const l=i.FeatureTest.isLittleEndian?4278190080:255,[c,h]=a?[o,l]:[l,o],d=r>>3,u=7&r,p=e.length;n=new Uint32Array(n.buffer);let f=0;for(let i=0;i<s;i++){for(const i=t+d;t<i;t++){const i=t<p?e[t]:255;n[f++]=128&i?h:c,n[f++]=64&i?h:c,n[f++]=32&i?h:c,n[f++]=16&i?h:c,n[f++]=8&i?h:c,n[f++]=4&i?h:c,n[f++]=2&i?h:c,n[f++]=1&i?h:c}if(0===u)continue;const i=t<p?e[t++]:255;for(let e=0;e<u;e++)n[f++]=i&1<<7-e?h:c}return{srcPos:t,destPos:f}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const n=Object.create(null);t.GlobalWorkerOptions=n,n.workerPort=null,n.workerSrc=""},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var i=n(1);const r=1,s=2,o=1,a=2,l=3,c=4,h=5,d=6,u=7,p=8;function f(e){switch(e instanceof Error||"object"==typeof e&&null!==e||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new i.AbortException(e.message);case"MissingPDFException":return new i.MissingPDFException(e.message);case"PasswordException":return new i.PasswordException(e.message,e.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new i.UnknownErrorException(e.message,e.details);default:return new i.UnknownErrorException(e.message,e.toString())}}t.MessageHandler=class{constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void this.#dt(t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],t.callback===r)n.resolve(t.data);else{if(t.callback!==s)throw new Error("Unexpected callback case");n.reject(f(t.reason))}return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,o=t.sourceName;new Promise((function(e){e(i(t.data))})).then((function(i){n.postMessage({sourceName:e,targetName:o,callback:r,callbackId:t.callbackId,data:i})}),(function(i){n.postMessage({sourceName:e,targetName:o,callback:s,callbackId:t.callbackId,reason:f(i)})}))}else t.streamId?this.#ut(t):i(t.data)},n.addEventListener("message",this._onComObjOnMessage)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const r=this.callbackId++,s=new i.PromiseCapability;this.callbackCapabilities[r]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(e){s.reject(e)}return s.promise}sendWithStream(e,t,n,r){const s=this.streamId++,a=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:n=>{const o=new i.PromiseCapability;return this.streamControllers[s]={controller:n,startCall:o,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:a,targetName:l,action:e,streamId:s,data:t,desiredSize:n.desiredSize},r),o.promise},pull:e=>{const t=new i.PromiseCapability;return this.streamControllers[s].pullCall=t,c.postMessage({sourceName:a,targetName:l,stream:d,streamId:s,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,i.assert)(e instanceof Error,"cancel must have a valid reason");const t=new i.PromiseCapability;return this.streamControllers[s].cancelCall=t,this.streamControllers[s].isClosed=!0,c.postMessage({sourceName:a,targetName:l,stream:o,streamId:s,reason:f(e)}),t.promise}},n)}#ut(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,o=this,a=this.actionHandler[e.action],d={enqueue(e,o=1,a){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=o,l>0&&this.desiredSize<=0&&(this.sinkCapability=new i.PromiseCapability,this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:r,stream:c,streamId:t,chunk:e},a)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:l,streamId:t}),delete o.streamSinks[t])},error(e){(0,i.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:r,stream:h,streamId:t,reason:f(e)}))},sinkCapability:new i.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[t]=d,new Promise((function(t){t(a(e.data,d))})).then((function(){s.postMessage({sourceName:n,targetName:r,stream:p,streamId:t,success:!0})}),(function(e){s.postMessage({sourceName:n,targetName:r,stream:p,streamId:t,reason:f(e)})}))}#dt(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj,m=this.streamControllers[t],g=this.streamSinks[t];switch(e.stream){case p:e.success?m.startCall.resolve():m.startCall.reject(f(e.reason));break;case u:e.success?m.pullCall.resolve():m.pullCall.reject(f(e.reason));break;case d:if(!g){s.postMessage({sourceName:n,targetName:r,stream:u,streamId:t,success:!0});break}g.desiredSize<=0&&e.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=e.desiredSize,new Promise((function(e){e(g.onPull?.())})).then((function(){s.postMessage({sourceName:n,targetName:r,stream:u,streamId:t,success:!0})}),(function(e){s.postMessage({sourceName:n,targetName:r,stream:u,streamId:t,reason:f(e)})}));break;case c:if((0,i.assert)(m,"enqueue should have stream controller"),m.isClosed)break;m.controller.enqueue(e.chunk);break;case l:if((0,i.assert)(m,"close should have stream controller"),m.isClosed)break;m.isClosed=!0,m.controller.close(),this.#pt(m,t);break;case h:(0,i.assert)(m,"error should have stream controller"),m.controller.error(f(e.reason)),this.#pt(m,t);break;case a:e.success?m.cancelCall.resolve():m.cancelCall.reject(f(e.reason)),this.#pt(m,t);break;case o:if(!g)break;new Promise((function(t){t(g.onCancel?.(f(e.reason)))})).then((function(){s.postMessage({sourceName:n,targetName:r,stream:a,streamId:t,success:!0})}),(function(e){s.postMessage({sourceName:n,targetName:r,stream:a,streamId:t,reason:f(e)})})),g.sinkCapability.reject(f(e.reason)),g.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#pt(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=n(1);t.Metadata=class{#ft;#mt;constructor({parsedData:e,rawData:t}){this.#ft=e,this.#mt=t}getRaw(){return this.#mt}get(e){return this.#ft.get(e)??null}getAll(){return(0,i.objectFromMap)(this.#ft)}has(e){return this.#ft.has(e)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var i=n(1),r=n(8);const s=Symbol("INTERNAL");class o{#gt=!0;constructor(e,t){this.name=e,this.intent=t}get visible(){return this.#gt}_setVisible(e,t){e!==s&&(0,i.unreachable)("Internal method `_setVisible` called."),this.#gt=t}}t.OptionalContentConfig=class{#Ot=null;#yt=new Map;#vt=null;#bt=null;constructor(e){if(this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,this.#bt=e.order;for(const t of e.groups)this.#yt.set(t.id,new o(t.name,t.intent));if("OFF"===e.baseState)for(const e of this.#yt.values())e._setVisible(s,!1);for(const t of e.on)this.#yt.get(t)._setVisible(s,!0);for(const t of e.off)this.#yt.get(t)._setVisible(s,!1);this.#vt=this.getHash()}}#wt(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let r=1;r<t;r++){const t=e[r];let s;if(Array.isArray(t))s=this.#wt(t);else{if(!this.#yt.has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;s=this.#yt.get(t).visible}switch(n){case"And":if(!s)return!1;break;case"Or":if(s)return!0;break;case"Not":return!s;default:return!0}}return"And"===n}isVisible(e){if(0===this.#yt.size)return!0;if(!e)return(0,i.warn)("Optional content group not defined."),!0;if("OCG"===e.type)return this.#yt.has(e.id)?this.#yt.get(e.id).visible:((0,i.warn)(`Optional content group not found: ${e.id}`),!0);if("OCMD"===e.type){if(e.expression)return this.#wt(e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!this.#yt.has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(this.#yt.get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!this.#yt.has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(!this.#yt.get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!this.#yt.has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(!this.#yt.get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!this.#yt.has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(this.#yt.get(t).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,i.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){this.#yt.has(e)?(this.#yt.get(e)._setVisible(s,!!t),this.#Ot=null):(0,i.warn)(`Optional content group not found: ${e}`)}get hasInitialVisibility(){return null===this.#vt||this.getHash()===this.#vt}getOrder(){return this.#yt.size?this.#bt?this.#bt.slice():[...this.#yt.keys()]:null}getGroups(){return this.#yt.size>0?(0,i.objectFromMap)(this.#yt):null}getGroup(e){return this.#yt.get(e)||null}getHash(){if(null!==this.#Ot)return this.#Ot;const e=new r.MurmurHash3_64;for(const[t,n]of this.#yt)e.update(`${t}:${n.visible}`);return this.#Ot=e.hexdigest()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var i=n(1),r=n(6);t.PDFDataTransportStream=class{constructor({length:e,initialData:t,progressiveDone:n=!1,contentDispositionFilename:r=null,disableRange:s=!1,disableStream:o=!1},a){if((0,i.assert)(a,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=n,this._contentDispositionFilename=r,t?.length>0){const e=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=a,this._isStreamingSupported=!o,this._isRangeSupported=!s,this._contentLength=e,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(((e,t)=>{this._onReceiveData({begin:e,chunk:t})})),this._pdfDataRangeTransport.addProgressListener(((e,t)=>{this._onProgress({loaded:e,total:t})})),this._pdfDataRangeTransport.addProgressiveReadListener((e=>{this._onReceiveData({chunk:e})})),this._pdfDataRangeTransport.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(void 0===e)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const t=this._rangeReaders.some((function(t){return t._begin===e&&(t._enqueue(n),!0)}));(0,i.assert)(t,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){void 0===e.total?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new s(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new o(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}};class s{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=(0,r.isPdfFile)(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const e of this._queuedChunks)this._loaded+=e.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length>0){this._requests.shift().resolve({value:e,done:!1})}else this._queuedChunks.push(e);this._loaded+=e.byteLength}}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0){return{value:this._queuedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=new i.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=new i.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var i=n(1),r=n(20);function s(e,t,n){return{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function o(e){const t=new Headers;for(const n in e){const i=e[n];void 0!==i&&t.append(n,i)}return t}function a(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:((0,i.warn)(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}t.PDFFetchStream=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new l(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new c(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class l{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=new i.PromiseCapability,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=o(this._stream.httpHeaders);const n=t.url;fetch(n,s(this._headers,this._withCredentials,this._abortController)).then((e=>{if(!(0,r.validateResponseStatus)(e.status))throw(0,r.createResponseStatusError)(e.status,n);this._reader=e.body.getReader(),this._headersCapability.resolve();const t=t=>e.headers.get(t),{allowRangeRequests:s,suggestedLength:o}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=o||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:a(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class c{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const a=e.source;this._withCredentials=a.withCredentials||!1,this._readCapability=new i.PromiseCapability,this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController,this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${n-1}`);const l=a.url;fetch(l,s(this._headers,this._withCredentials,this._abortController)).then((e=>{if(!(0,r.validateResponseStatus)(e.status))throw(0,r.createResponseStatusError)(e.status,l);this._readCapability.resolve(),this._reader=e.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:a(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){if(404===e||0===e&&t.startsWith("file:"))return new i.MissingPDFException('Missing PDF "'+t+'".');return new i.UnexpectedResponseException(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)},t.extractFilenameFromHeader=function(e){const t=e("Content-Disposition");if(t){let e=(0,r.getFilenameFromContentDispositionHeader)(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if((0,s.isPdfFile)(e))return e}return null},t.validateRangeRequestCapabilities=function({getResponseHeader:e,isHttp:t,rangeChunkSize:n,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(e("Content-Length"),10);if(!Number.isInteger(s))return r;if(r.suggestedLength=s,s<=2*n)return r;if(i||!t)return r;if("bytes"!==e("Accept-Ranges"))return r;if("identity"!==(e("Content-Encoding")||"identity"))return r;return r.allowRangeRequests=!0,r},t.validateResponseStatus=function(e){return 200===e||206===e};var i=n(1),r=n(21),s=n(6)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){let t=!0,n=r("filename\\*","i").exec(e);if(n){n=n[1];let e=a(n);return e=unescape(e),e=l(e),e=c(e),o(e)}if(n=function(e){const t=[];let n;const i=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=i.exec(e));){let[,e,i,r]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,r]}const s=[];for(let e=0;e<t.length&&e in t;++e){let[n,i]=t[e];i=a(i),n&&(i=unescape(i),0===e&&(i=l(i))),s.push(i)}return s.join("")}(e),n){return o(c(n))}if(n=r("filename","i").exec(e),n){n=n[1];let e=a(n);return e=c(e),o(e)}function r(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function s(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const r=new TextDecoder(e,{fatal:!0}),s=(0,i.stringToBytes)(n);n=r.decode(s),t=!1}catch{}}return n}function o(e){return t&&/[\x80-\xff]/.test(e)&&(e=s("utf-8",e),t&&(e=s("iso-8859-1",e))),e}function a(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,"$1")}e=t.join('"')}return e}function l(e){const t=e.indexOf("'");if(-1===t)return e;return s(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function c(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,n,i){if("q"===n||"Q"===n)return s(t,i=(i=i.replaceAll("_"," ")).replaceAll(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));try{i=atob(i)}catch{}return s(t,i)}))}return""};var i=n(1)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var i=n(1),r=n(20);class s{constructor(e,t={}){this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){const i={begin:e,end:t};for(const e in n)i[e]=n[e];return this.request(i)}requestFull(e){return this.request(e)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const n=this.httpHeaders[e];void 0!==n&&t.setRequestHeader(e,n)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==r.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===r.status&&this.isHttp)return void n.onError?.(r.status);const s=r.status||200;if(!(200===s&&206===n.expectedStatus)&&s!==n.expectedStatus)return void n.onError?.(r.status);const o=function(e){const t=e.response;return"string"!=typeof t?t:(0,i.stringToBytes)(t).buffer}(r);if(206===s){const e=r.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);n.onDone({begin:parseInt(t[1],10),chunk:o})}else o?n.onDone({begin:0,chunk:o}):n.onError?.(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}t.PDFNetworkStream=class{constructor(e){this._source=e,this._manager=new s(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new o(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new a(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class o{constructor(e,t){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=new i.PromiseCapability,this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=e=>t.getResponseHeader(e),{allowRangeRequests:i,suggestedLength:s}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e)if(this._requests.length>0){this._requests.shift().resolve({value:e.chunk,done:!1})}else this._cachedChunks.push(e.chunk);if(this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=(0,r.createResponseStatusError)(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0){return{value:this._cachedChunks.shift(),done:!1}}if(this._done)return{value:void 0,done:!0};const e=new i.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class a{constructor(e,t,n){this._manager=e;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;if(this._requests.length>0){this._requests.shift().resolve({value:t,done:!1})}else this._queuedChunk=t;this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=(0,r.createResponseStatusError)(e,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=new i.PromiseCapability;return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var i=n(1),r=n(20);const s=/^file:\/\/\/[a-zA-Z]:\//;t.PDFNodeStream=class{constructor(e){this.source=e,this.url=function(e){const t=require$$5,n=t.parse(e);return"file:"===n.protocol||n.host?n:/^[a-z]:[/\\]/i.test(e)?t.parse(`file:///${e}`):(n.host||(n.protocol="file:"),n)}(e.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new d(this):new c(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new u(this,e,t):new h(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class o{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=new i.PromiseCapability,this._headersCapability=new i.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=new i.PromiseCapability,this.read();this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength});return{value:new Uint8Array(e).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class a{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new i.PromiseCapability;const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();if(null===e)return this._readCapability=new i.PromiseCapability,this.read();this._loaded+=e.length,this.onProgress?.({loaded:this._loaded});return{value:new Uint8Array(e).buffer,done:!1}}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}}function l(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}class c extends o{constructor(e){super(e);const t=t=>{if(404===t.statusCode){const e=new i.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=e,void this._headersCapability.reject(e)}this._headersCapability.resolve(),this._setReadableStream(t);const n=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:s,suggestedLength:o}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=o||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(n)};if(this._request=null,"http:"===this._url.protocol){const n=require$$5;this._request=n.request(l(this._url,e.httpHeaders),t)}else{const n=require$$5;this._request=n.request(l(this._url,e.httpHeaders),t)}this._request.on("error",(e=>{this._storedError=e,this._headersCapability.reject(e)})),this._request.end()}}class h extends a{constructor(e,t,n){super(e),this._httpHeaders={};for(const t in e.httpHeaders){const n=e.httpHeaders[t];void 0!==n&&(this._httpHeaders[t]=n)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;const r=e=>{if(404!==e.statusCode)this._setReadableStream(e);else{const e=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=e}};if(this._request=null,"http:"===this._url.protocol){const e=require$$5;this._request=e.request(l(this._url,this._httpHeaders),r)}else{const e=require$$5;this._request=e.request(l(this._url,this._httpHeaders),r)}this._request.on("error",(e=>{this._storedError=e})),this._request.end()}}class d extends o{constructor(e){super(e);let t=decodeURIComponent(this._url.path);s.test(this._url.href)&&(t=t.replace(/^\//,""));const n=require$$5;n.lstat(t,((e,r)=>{if(e)return"ENOENT"===e.code&&(e=new i.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=e,void this._headersCapability.reject(e);this._contentLength=r.size,this._setReadableStream(n.createReadStream(t)),this._headersCapability.resolve()}))}}class u extends a{constructor(e,t,n){super(e);let i=decodeURIComponent(this._url.path);s.test(this._url.href)&&(i=i.replace(/^\//,""));const r=require$$5;this._setReadableStream(r.createReadStream(i,{start:t,end:n-1}))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var i=n(6),r=n(1);const s="normal",o="normal",a="#000000",l=["butt","round","square"],c=["miter","round","bevel"],h=function(e,t="",n=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!n)return URL.createObjectURL(new Blob([e],{type:t}));const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let r=`data:${t};base64,`;for(let t=0,n=e.length;t<n;t+=3){const s=255&e[t],o=255&e[t+1],a=255&e[t+2];r+=i[s>>2]+i[(3&s)<<4|o>>4]+i[t+1<n?(15&o)<<2|a>>6:64]+i[t+2<n?63&a:64]}return r},d=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256);for(let e=0;e<256;e++){let n=e;for(let e=0;e<8;e++)n=1&n?3988292384^n>>1&2147483647:n>>1&2147483647;t[e]=n}function n(e,n,i,r){let s=r;const o=n.length;i[s]=o>>24&255,i[s+1]=o>>16&255,i[s+2]=o>>8&255,i[s+3]=255&o,s+=4,i[s]=255&e.charCodeAt(0),i[s+1]=255&e.charCodeAt(1),i[s+2]=255&e.charCodeAt(2),i[s+3]=255&e.charCodeAt(3),s+=4,i.set(n,s),s+=n.length;const a=function(e,n,i){let r=-1;for(let s=n;s<i;s++){const n=255&(r^e[s]);r=r>>>8^t[n]}return-1^r}(i,r+4,s);i[s]=a>>24&255,i[s+1]=a>>16&255,i[s+2]=a>>8&255,i[s+3]=255&a}function i(e){let t=e.length;const n=65535,i=Math.ceil(t/n),r=new Uint8Array(2+t+5*i+4);let s=0;r[s++]=120,r[s++]=156;let o=0;for(;t>n;)r[s++]=0,r[s++]=255,r[s++]=255,r[s++]=0,r[s++]=0,r.set(e.subarray(o,o+n),s),s+=n,o+=n,t-=n;r[s++]=1,r[s++]=255&t,r[s++]=t>>8&255,r[s++]=255&~t,r[s++]=(65535&~t)>>8&255,r.set(e.subarray(o),s),s+=e.length-o;const a=function(e,t,n){let i=1,r=0;for(let s=t;s<n;++s)i=(i+(255&e[s]))%65521,r=(r+i)%65521;return r<<16|i}(e,0,e.length);return r[s++]=a>>24&255,r[s++]=a>>16&255,r[s++]=a>>8&255,r[s++]=255&a,r}function s(t,s,o,a){const l=t.width,c=t.height;let d,u,p;const f=t.data;switch(s){case r.ImageKind.GRAYSCALE_1BPP:u=0,d=1,p=l+7>>3;break;case r.ImageKind.RGB_24BPP:u=2,d=8,p=3*l;break;case r.ImageKind.RGBA_32BPP:u=6,d=8,p=4*l;break;default:throw new Error("invalid format")}const m=new Uint8Array((1+p)*c);let g=0,O=0;for(let e=0;e<c;++e)m[g++]=0,m.set(f.subarray(O,O+p),g),O+=p,g+=p;if(s===r.ImageKind.GRAYSCALE_1BPP&&a){g=0;for(let e=0;e<c;e++){g++;for(let e=0;e<p;e++)m[g++]^=255}}const y=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,255&l,c>>24&255,c>>16&255,c>>8&255,255&c,d,u,0,0,0]),v=function(e){if(!r.isNodeJS)return i(e);try{const t=parseInt(process.versions.node)>=8?e:Buffer.from(e),n=require$$5.deflateSync(t,{level:9});return n instanceof Uint8Array?n:new Uint8Array(n)}catch(e){(0,r.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return i(e)}(m),b=e.length+36+y.length+v.length,w=new Uint8Array(b);let S=0;return w.set(e,S),S+=e.length,n("IHDR",y,w,S),S+=12+y.length,n("IDATA",v,w,S),S+=12+v.length,n("IEND",new Uint8Array(0),w,S),h(w,"image/png",o)}return function(e,t,n){return s(e,void 0===e.kind?r.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}();class u{constructor(){this.fontSizeScale=1,this.fontWeight=o,this.fontSize=0,this.textMatrix=r.IDENTITY_MATRIX,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=r.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=a,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(e,t){this.x=e,this.y=t}}function p(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)}function f(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":`scale(${p(e[0])} ${p(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2]){return`rotate(${p(180*Math.acos(e[0])/Math.PI)})`}}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return`translate(${p(e[4])} ${p(e[5])})`;return`matrix(${p(e[0])} ${p(e[1])} ${p(e[2])} ${p(e[3])} ${p(e[4])} ${p(e[5])})`}let m=0,g=0,O=0;t.SVGGraphics=class{constructor(e,t,n=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new u,this.transformMatrix=r.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const e in r.OPS)this._operatorIdMapping[r.OPS[e]]=e}getObject(e,t=null){return"string"==typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,n=e.argsArray;for(let e=0,i=t.length;e<i;e++)if(t[e]===r.OPS.dependency)for(const t of n[e]){const e=t.startsWith("g_")?this.commonObjs:this.objs,n=new Promise((n=>{e.get(t,n)}));this.current.dependencies.push(n)}return Promise.all(this.current.dependencies)}transform(e,t,n,i,s,o){const a=[e,t,n,i,s,o];this.transformMatrix=r.Util.transform(this.transformMatrix,a),this.tgrp=null}getSVG(e,t){this.viewport=t;const n=this._initialize(t);return this.loadDependencies(e).then((()=>(this.transformMatrix=r.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),n)))}convertOpList(e){const t=this._operatorIdMapping,n=e.argsArray,i=e.fnArray,r=[];for(let e=0,s=i.length;e<s;e++){const s=i[e];r.push({fnId:s,fn:t[s],args:n[e]})}return function(e){let t=[];const n=[];for(const i of e)"save"!==i.fn?"restore"===i.fn?t=n.pop():t.push(i):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t.at(-1).items);return t}(r)}executeOpTree(e){for(const t of e){const e=t.fn,n=t.fnId,i=t.args;switch(0|n){case r.OPS.beginText:this.beginText();break;case r.OPS.dependency:break;case r.OPS.setLeading:this.setLeading(i);break;case r.OPS.setLeadingMoveText:this.setLeadingMoveText(i[0],i[1]);break;case r.OPS.setFont:this.setFont(i);break;case r.OPS.showText:case r.OPS.showSpacedText:this.showText(i[0]);break;case r.OPS.endText:this.endText();break;case r.OPS.moveText:this.moveText(i[0],i[1]);break;case r.OPS.setCharSpacing:this.setCharSpacing(i[0]);break;case r.OPS.setWordSpacing:this.setWordSpacing(i[0]);break;case r.OPS.setHScale:this.setHScale(i[0]);break;case r.OPS.setTextMatrix:this.setTextMatrix(i[0],i[1],i[2],i[3],i[4],i[5]);break;case r.OPS.setTextRise:this.setTextRise(i[0]);break;case r.OPS.setTextRenderingMode:this.setTextRenderingMode(i[0]);break;case r.OPS.setLineWidth:this.setLineWidth(i[0]);break;case r.OPS.setLineJoin:this.setLineJoin(i[0]);break;case r.OPS.setLineCap:this.setLineCap(i[0]);break;case r.OPS.setMiterLimit:this.setMiterLimit(i[0]);break;case r.OPS.setFillRGBColor:this.setFillRGBColor(i[0],i[1],i[2]);break;case r.OPS.setStrokeRGBColor:this.setStrokeRGBColor(i[0],i[1],i[2]);break;case r.OPS.setStrokeColorN:this.setStrokeColorN(i);break;case r.OPS.setFillColorN:this.setFillColorN(i);break;case r.OPS.shadingFill:this.shadingFill(i[0]);break;case r.OPS.setDash:this.setDash(i[0],i[1]);break;case r.OPS.setRenderingIntent:this.setRenderingIntent(i[0]);break;case r.OPS.setFlatness:this.setFlatness(i[0]);break;case r.OPS.setGState:this.setGState(i[0]);break;case r.OPS.fill:this.fill();break;case r.OPS.eoFill:this.eoFill();break;case r.OPS.stroke:this.stroke();break;case r.OPS.fillStroke:this.fillStroke();break;case r.OPS.eoFillStroke:this.eoFillStroke();break;case r.OPS.clip:this.clip("nonzero");break;case r.OPS.eoClip:this.clip("evenodd");break;case r.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case r.OPS.paintImageXObject:this.paintImageXObject(i[0]);break;case r.OPS.paintInlineImageXObject:this.paintInlineImageXObject(i[0]);break;case r.OPS.paintImageMaskXObject:this.paintImageMaskXObject(i[0]);break;case r.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(i[0],i[1]);break;case r.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case r.OPS.closePath:this.closePath();break;case r.OPS.closeStroke:this.closeStroke();break;case r.OPS.closeFillStroke:this.closeFillStroke();break;case r.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case r.OPS.nextLine:this.nextLine();break;case r.OPS.transform:this.transform(i[0],i[1],i[2],i[3],i[4],i[5]);break;case r.OPS.constructPath:this.constructPath(i[0],i[1]);break;case r.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,r.warn)(`Unimplemented operator ${e}`)}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,n,i,r,s){const o=this.current;o.textMatrix=o.lineMatrix=[e,t,n,i,r,s],o.textMatrixScale=Math.hypot(e,t),o.x=o.lineX=0,o.y=o.lineY=0,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",`${p(o.fontSize)}px`),o.tspan.setAttributeNS(null,"y",p(-o.y)),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtElement.append(o.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=r.IDENTITY_MATRIX,e.lineMatrix=r.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const n=this.current;n.x=n.lineX+=e,n.y=n.lineY+=t,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${p(n.fontSize)}px`),n.tspan.setAttributeNS(null,"y",p(-n.y))}showText(e){const t=this.current,n=t.font,i=t.fontSize;if(0===i)return;const l=t.fontSizeScale,c=t.charSpacing,h=t.wordSpacing,d=t.fontDirection,u=t.textHScale*d,m=n.vertical,g=m?1:-1,O=n.defaultVMetrics,y=i*t.fontMatrix[0];let v=0;for(const r of e){if(null===r){v+=d*h;continue}if("number"==typeof r){v+=g*r*i/1e3;continue}const e=(r.isSpace?h:0)+c,s=r.fontChar;let o,a,u=r.width;if(m){let e;const t=r.vmetric||O;e=r.vmetric?t[1]:.5*u,e=-e*y;const n=t[2]*y;u=t?-t[0]:u,o=e/l,a=(v+n)/l}else o=v/l,a=0;(r.isInFont||n.missingFile)&&(t.xcoords.push(t.x+o),m&&t.ycoords.push(-t.y+a),t.tspan.textContent+=s);v+=m?u*y-e*d:u*y+e*d}t.tspan.setAttributeNS(null,"x",t.xcoords.map(p).join(" ")),m?t.tspan.setAttributeNS(null,"y",t.ycoords.map(p).join(" ")):t.tspan.setAttributeNS(null,"y",p(-t.y)),m?t.y-=v:t.x+=v*u,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",`${p(t.fontSize)}px`),t.fontStyle!==s&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==o&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const b=t.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;if(b===r.TextRenderingMode.FILL||b===r.TextRenderingMode.FILL_STROKE?(t.fillColor!==a&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===r.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),b===r.TextRenderingMode.STROKE||b===r.TextRenderingMode.FILL_STROKE){const e=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,e)}let w=t.textMatrix;0!==t.textRise&&(w=w.slice(),w[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform",`${f(w)} scale(${p(u)}, -1)`),t.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.txtElement.append(t.tspan),t.txtgrp.append(t.txtElement),this._ensureTransformGroup().append(t.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const t=h(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${t}); }\n`}setFont(e){const t=this.current,n=this.commonObjs.get(e[0]);let i=e[1];t.font=n,!this.embedFonts||n.missingFile||this.embeddedFonts[n.loadedName]||(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),t.fontMatrix=n.fontMatrix||r.FONT_IDENTITY_MATRIX;let s="normal";n.black?s="900":n.bold&&(s="bold");const o=n.italic?"italic":"normal";i<0?(i=-i,t.fontDirection=-1):t.fontDirection=1,t.fontSize=i,t.fontFamily=n.loadedName,t.fontWeight=s,t.fontStyle=o,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",p(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&r.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement?.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=l[e]}setLineJoin(e){this.current.lineJoin=c[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,n){this.current.strokeColor=r.Util.makeHexColor(e,t,n)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,n){this.current.fillColor=r.Util.makeHexColor(e,t,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const{width:t,height:n}=this.viewport,i=r.Util.inverseTransform(this.transformMatrix),[s,o,a,l]=r.Util.getAxialAlignedBoundingBox([0,0,t,n],i),c=this.svgFactory.createElement("svg:rect");c.setAttributeNS(null,"x",s),c.setAttributeNS(null,"y",o),c.setAttributeNS(null,"width",a-s),c.setAttributeNS(null,"height",l-o),c.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&c.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(c)}_makeColorN_Pattern(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],n=e[2],i=e[3]||r.IDENTITY_MATRIX,[s,o,a,l]=e[4],c=e[5],h=e[6],d=e[7],u="shading"+O++,[p,f,m,g]=r.Util.normalizeRect([...r.Util.applyTransform([s,o],i),...r.Util.applyTransform([a,l],i)]),[y,v]=r.Util.singularValueDecompose2dScale(i),b=c*y,w=h*v,S=this.svgFactory.createElement("svg:pattern");S.setAttributeNS(null,"id",u),S.setAttributeNS(null,"patternUnits","userSpaceOnUse"),S.setAttributeNS(null,"width",b),S.setAttributeNS(null,"height",w),S.setAttributeNS(null,"x",`${p}`),S.setAttributeNS(null,"y",`${f}`);const x=this.svg,C=this.transformMatrix,_=this.current.fillColor,E=this.current.strokeColor,P=this.svgFactory.create(m-p,g-f);if(this.svg=P,this.transformMatrix=i,2===d){const e=r.Util.makeHexColor(...t);this.current.fillColor=e,this.current.strokeColor=e}return this.executeOpTree(this.convertOpList(n)),this.svg=x,this.transformMatrix=C,this.current.fillColor=_,this.current.strokeColor=E,S.append(P.childNodes[0]),this.defs.append(S),`url(#${u})`}_makeShadingPattern(e){switch("string"==typeof e&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const t="shading"+O++,n=e[3];let i;switch(e[1]){case"axial":const n=e[4],r=e[5];i=this.svgFactory.createElement("svg:linearGradient"),i.setAttributeNS(null,"id",t),i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"x1",n[0]),i.setAttributeNS(null,"y1",n[1]),i.setAttributeNS(null,"x2",r[0]),i.setAttributeNS(null,"y2",r[1]);break;case"radial":const s=e[4],o=e[5],a=e[6],l=e[7];i=this.svgFactory.createElement("svg:radialGradient"),i.setAttributeNS(null,"id",t),i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"cx",o[0]),i.setAttributeNS(null,"cy",o[1]),i.setAttributeNS(null,"r",l),i.setAttributeNS(null,"fx",s[0]),i.setAttributeNS(null,"fy",s[1]),i.setAttributeNS(null,"fr",a);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const e of n){const t=this.svgFactory.createElement("svg:stop");t.setAttributeNS(null,"offset",e[0]),t.setAttributeNS(null,"stop-color",e[1]),i.append(t)}return this.defs.append(i),`url(#${t})`;case"Mesh":return(0,r.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const n=this.current;let i=n.x,s=n.y,o=[],a=0;for(const n of e)switch(0|n){case r.OPS.rectangle:i=t[a++],s=t[a++];const e=i+t[a++],n=s+t[a++];o.push("M",p(i),p(s),"L",p(e),p(s),"L",p(e),p(n),"L",p(i),p(n),"Z");break;case r.OPS.moveTo:i=t[a++],s=t[a++],o.push("M",p(i),p(s));break;case r.OPS.lineTo:i=t[a++],s=t[a++],o.push("L",p(i),p(s));break;case r.OPS.curveTo:i=t[a+4],s=t[a+5],o.push("C",p(t[a]),p(t[a+1]),p(t[a+2]),p(t[a+3]),p(i),p(s)),a+=6;break;case r.OPS.curveTo2:o.push("C",p(i),p(s),p(t[a]),p(t[a+1]),p(t[a+2]),p(t[a+3])),i=t[a+2],s=t[a+3],a+=4;break;case r.OPS.curveTo3:i=t[a+2],s=t[a+3],o.push("C",p(t[a]),p(t[a+1]),p(i),p(s),p(i),p(s)),a+=4;break;case r.OPS.closePath:o.push("Z")}o=o.join(" "),n.path&&e.length>0&&e[0]!==r.OPS.rectangle&&e[0]!==r.OPS.moveTo?o=n.path.getAttributeNS(null,"d")+o:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(n.path)),n.path.setAttributeNS(null,"d",o),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(i,s)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element)return void(this.pendingClip=null);const t="clippath"+m++,n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"transform",f(this.transformMatrix));const i=e.element.cloneNode(!0);if("evenodd"===this.pendingClip?i.setAttributeNS(null,"clip-rule","evenodd"):i.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.append(i),this.defs.append(n),e.activeClipUrl){e.clipGroup=null;for(const e of this.extraStack)e.clipGroup=null;n.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,r.warn)(`Unimplemented graphic state operator ${t}`)}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,t=1){const n=this.current;let i=n.dashArray;1!==t&&i.length>0&&(i=i.map((function(e){return t*e}))),e.setAttributeNS(null,"stroke",n.strokeColor),e.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",p(n.miterLimit)),e.setAttributeNS(null,"stroke-linecap",n.lineCap),e.setAttributeNS(null,"stroke-linejoin",n.lineJoin),e.setAttributeNS(null,"stroke-width",p(t*n.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",i.map(p).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",p(t*n.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,r.warn)(`Dependent image with object ID ${e} is not ready yet`)}paintInlineImageXObject(e,t){const n=e.width,i=e.height,r=d(e,this.forceDataSchema,!!t),s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",p(n)),s.setAttributeNS(null,"height",p(i)),this.current.element=s,this.clip("nonzero");const o=this.svgFactory.createElement("svg:image");o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r),o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y",p(-i)),o.setAttributeNS(null,"width",p(n)+"px"),o.setAttributeNS(null,"height",p(i)+"px"),o.setAttributeNS(null,"transform",`scale(${p(1/n)} ${p(-1/i)})`),t?t.append(o):this._ensureTransformGroup().append(o)}paintImageMaskXObject(e){const t=this.getObject(e.data,e);if(t.bitmap)return void(0,r.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");const n=this.current,i=t.width,s=t.height,o=n.fillColor;n.maskId="mask"+g++;const a=this.svgFactory.createElement("svg:mask");a.setAttributeNS(null,"id",n.maskId);const l=this.svgFactory.createElement("svg:rect");l.setAttributeNS(null,"x","0"),l.setAttributeNS(null,"y","0"),l.setAttributeNS(null,"width",p(i)),l.setAttributeNS(null,"height",p(s)),l.setAttributeNS(null,"fill",o),l.setAttributeNS(null,"mask",`url(#${n.maskId})`),this.defs.append(a),this._ensureTransformGroup().append(l),this.paintInlineImageXObject(t,a)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const e=t[2]-t[0],n=t[3]-t[1],i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x",t[0]),i.setAttributeNS(null,"y",t[1]),i.setAttributeNS(null,"width",p(e)),i.setAttributeNS(null,"height",p(n)),this.current.element=i,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),n=this.svgFactory.createElement("svg:defs");t.append(n),this.defs=n;const i=this.svgFactory.createElement("svg:g");return i.setAttributeNS(null,"transform",f(e.transform)),t.append(i),this.svg=i,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",f(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class n{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};return function e(i){if(!i)return;let r=null;const s=i.name;if("#text"===s)r=i.value;else{if(!n.shouldBuildText(s))return;i?.attributes?.textContent?r=i.attributes.textContent:i.value&&(r=i.value)}if(null!==r&&t.push({str:r}),i.children)for(const t of i.children)e(t)}(e),i}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}t.XfaText=n},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=function(e){e.textContentSource||!e.textContent&&!e.textContentStream||((0,r.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),e.textContentSource=e.textContent||e.textContentStream);const{container:t,viewport:n}=e,i=getComputedStyle(t),s=i.getPropertyValue("visibility"),o=parseFloat(i.getPropertyValue("--scale-factor"));"visible"===s&&(!o||Math.abs(o-n.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const a=new d(e);return a._render(),a},t.updateTextLayer=function({container:e,viewport:t,textDivs:n,textDivProperties:i,isOffscreenCanvasSupported:s,mustRotate:o=!0,mustRescale:a=!0}){o&&(0,r.setLayerDimensions)(e,{rotation:t.rotation});if(a){const e=l(0,s),r={prevFontSize:null,prevFontFamily:null,div:null,scale:t.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:e};for(const e of n)r.properties=i.get(e),r.div=e,h(r)}};var i=n(1),r=n(6);const s=30,o=.8,a=new Map;function l(e,t){let n;if(t&&i.FeatureTest.isOffscreenCanvasSupported)n=new OffscreenCanvas(e,e).getContext("2d",{alpha:!1});else{const t=document.createElement("canvas");t.width=t.height=e,n=t.getContext("2d",{alpha:!1})}return n}function c(e,t,n){const r=document.createElement("span"),c={angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};e._textDivs.push(r);const h=i.Util.transform(e._transform,t.transform);let d=Math.atan2(h[1],h[0]);const u=n[t.fontName];u.vertical&&(d+=Math.PI/2);const p=Math.hypot(h[2],h[3]),f=p*function(e,t){const n=a.get(e);if(n)return n;const i=l(s,t);i.font=`${s}px ${e}`;const r=i.measureText("");let c=r.fontBoundingBoxAscent,h=Math.abs(r.fontBoundingBoxDescent);if(c){const t=c/(c+h);return a.set(e,t),i.canvas.width=i.canvas.height=0,t}i.strokeStyle="red",i.clearRect(0,0,s,s),i.strokeText("g",0,0);let d=i.getImageData(0,0,s,s).data;h=0;for(let e=d.length-1-3;e>=0;e-=4)if(d[e]>0){h=Math.ceil(e/4/s);break}i.clearRect(0,0,s,s),i.strokeText("A",0,s),d=i.getImageData(0,0,s,s).data,c=0;for(let e=0,t=d.length;e<t;e+=4)if(d[e]>0){c=s-Math.floor(e/4/s);break}if(i.canvas.width=i.canvas.height=0,c){const t=c/(c+h);return a.set(e,t),t}return a.set(e,o),o}(u.fontFamily,e._isOffscreenCanvasSupported);let m,g;0===d?(m=h[4],g=h[5]-f):(m=h[4]+f*Math.sin(d),g=h[5]-f*Math.cos(d));const O="calc(var(--scale-factor)*",y=r.style;e._container===e._rootContainer?(y.left=`${(100*m/e._pageWidth).toFixed(2)}%`,y.top=`${(100*g/e._pageHeight).toFixed(2)}%`):(y.left=`${O}${m.toFixed(2)}px)`,y.top=`${O}${g.toFixed(2)}px)`),y.fontSize=`${O}${p.toFixed(2)}px)`,y.fontFamily=u.fontFamily,c.fontSize=p,r.setAttribute("role","presentation"),r.textContent=t.str,r.dir=t.dir,e._fontInspectorEnabled&&(r.dataset.fontName=t.fontName),0!==d&&(c.angle=d*(180/Math.PI));let v=!1;if(t.str.length>1)v=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(v=!0)}v&&(c.canvasWidth=u.vertical?t.height:t.width),e._textDivProperties.set(r,c),e._isReadableStream&&e._layoutText(r)}function h(e){const{div:t,scale:n,properties:i,ctx:r,prevFontSize:s,prevFontFamily:o}=e,{style:a}=t;let l="";if(0!==i.canvasWidth&&i.hasText){const{fontFamily:c}=a,{canvasWidth:h,fontSize:d}=i;s===d&&o===c||(r.font=`${d*n}px ${c}`,e.prevFontSize=d,e.prevFontFamily=c);const{width:u}=r.measureText(t.textContent);u>0&&(l=`scaleX(${h*n/u})`)}0!==i.angle&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(a.transform=l)}class d{constructor({textContentSource:e,container:t,viewport:n,textDivs:s,textDivProperties:o,textContentItemsStr:a,isOffscreenCanvasSupported:c}){this._textContentSource=e,this._isReadableStream=e instanceof ReadableStream,this._container=this._rootContainer=t,this._textDivs=s||[],this._textContentItemsStr=a||[],this._isOffscreenCanvasSupported=c,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=o||new WeakMap,this._canceled=!1,this._capability=new i.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:n.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:l(0,c)};const{pageWidth:h,pageHeight:d,pageX:u,pageY:p}=n.rawDims;this._transform=[1,0,0,-1,-u,p+d],this._pageWidth=h,this._pageHeight=d,(0,r.setLayerDimensions)(t,n),this._capability.promise.finally((()=>{this._layoutTextParams=null})).catch((()=>{}))}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch((()=>{})),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(e,t){for(const n of e)if(void 0!==n.str)this._textContentItemsStr.push(n.str),c(this,n,t);else if("beginMarkedContentProps"===n.type||"beginMarkedContent"===n.type){const e=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==n.id&&this._container.setAttribute("id",`${n.id}`),e.append(this._container)}else"endMarkedContent"===n.type&&(this._container=this._container.parentNode)}_layoutText(e){const t=this._layoutTextParams.properties=this._textDivProperties.get(e);if(this._layoutTextParams.div=e,h(this._layoutTextParams),t.hasText&&this._container.append(e),t.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this._container.append(e)}}_render(){const e=new i.PromiseCapability;let t=Object.create(null);if(this._isReadableStream){const n=()=>{this._reader.read().then((({value:i,done:r})=>{r?e.resolve():(Object.assign(t,i.styles),this._processItems(i.items,t),n())}),e.reject)};this._reader=this._textContentSource.getReader(),n()}else{if(!this._textContentSource)throw new Error('No "textContentSource" parameter specified.');{const{items:t,styles:n}=this._textContentSource;this._processItems(t,n),e.resolve()}}e.promise.then((()=>{t=null,function(e){if(e._canceled)return;const t=e._textDivs,n=e._capability;if(t.length>1e5)n.resolve();else{if(!e._isReadableStream)for(const n of t)e._layoutText(n);n.resolve()}}(this)}),this._capability.reject)}}t.TextLayerRenderTask=d},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var i=n(1),r=n(4),s=n(28),o=n(33),a=n(6),l=n(34);class c{#St;#xt=!1;#Ct=null;#_t=this.pointerup.bind(this);#Et=this.pointerdown.bind(this);#Pt=new Map;#kt=!1;#Tt=!1;#At=!1;#Rt;static _initialized=!1;constructor({uiManager:e,pageIndex:t,div:n,accessibilityManager:i,annotationLayer:r,viewport:a,l10n:h}){const d=[s.FreeTextEditor,o.InkEditor,l.StampEditor];if(!c._initialized){c._initialized=!0;for(const e of d)e.initialize(h)}e.registerEditorTypes(d),this.#Rt=e,this.pageIndex=t,this.div=n,this.#St=i,this.#Ct=r,this.viewport=a,this.#Rt.addLayer(this)}get isEmpty(){return 0===this.#Pt.size}updateToolbar(e){this.#Rt.updateToolbar(e)}updateMode(e=this.#Rt.getMode()){this.#Mt(),e===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),e!==i.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",e===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",e===i.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",e===i.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(e){if(!e&&this.#Rt.getMode()!==i.AnnotationEditorType.INK)return;if(!e)for(const e of this.#Pt.values())if(e.isEmpty())return void e.setInBackground();this.#It({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(e){this.#Rt.setEditingState(e)}addCommands(e){this.#Rt.addCommands(e)}enable(){this.div.style.pointerEvents="auto";const e=new Set;for(const t of this.#Pt.values())t.enableEditing(),t.annotationElementId&&e.add(t.annotationElementId);if(!this.#Ct)return;const t=this.#Ct.getEditableAnnotations();for(const n of t){if(n.hide(),this.#Rt.isDeletedAnnotationElement(n.data.id))continue;if(e.has(n.data.id))continue;const t=this.deserialize(n);t&&(this.addOrRebuild(t),t.enableEditing())}}disable(){this.#At=!0,this.div.style.pointerEvents="none";const e=new Set;for(const t of this.#Pt.values())t.disableEditing(),t.annotationElementId&&null===t.serialize()?(this.getEditableAnnotation(t.annotationElementId)?.show(),t.remove()):e.add(t.annotationElementId);if(this.#Ct){const t=this.#Ct.getEditableAnnotations();for(const n of t){const{id:t}=n.data;e.has(t)||this.#Rt.isDeletedAnnotationElement(t)||n.show()}}this.#Mt(),this.isEmpty&&(this.div.hidden=!0),this.#At=!1}getEditableAnnotation(e){return this.#Ct?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#Rt.getActive()!==e&&this.#Rt.setActiveEditor(e)}enableClick(){this.div.addEventListener("pointerdown",this.#Et),this.div.addEventListener("pointerup",this.#_t)}disableClick(){this.div.removeEventListener("pointerdown",this.#Et),this.div.removeEventListener("pointerup",this.#_t)}attach(e){this.#Pt.set(e.id,e);const{annotationElementId:t}=e;t&&this.#Rt.isDeletedAnnotationElement(t)&&this.#Rt.removeDeletedAnnotationElement(e)}detach(e){this.#Pt.delete(e.id),this.#St?.removePointerInTextLayer(e.contentDiv),!this.#At&&e.annotationElementId&&this.#Rt.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#Rt.removeEditor(e),e.div.contains(document.activeElement)&&setTimeout((()=>{this.#Rt.focusMainContainer()}),0),e.div.remove(),e.isAttachedToDOM=!1,this.#Tt||this.addInkEditorIfNeeded(!1)}changeParent(e){e.parent!==this&&(e.annotationElementId&&(this.#Rt.addDeletedAnnotationElement(e.annotationElementId),r.AnnotationEditor.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(this.changeParent(e),this.#Rt.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(),this.#Rt.addToAnnotationStorage(e)}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&(e._focusEventsAllowed=!1,setTimeout((()=>{e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",(()=>{e._focusEventsAllowed=!0}),{once:!0}),t.focus())}),0)),e._structTreeParentId=this.#St?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getNextId(){return this.#Rt.getId()}#Lt(e){switch(this.#Rt.getMode()){case i.AnnotationEditorType.FREETEXT:return new s.FreeTextEditor(e);case i.AnnotationEditorType.INK:return new o.InkEditor(e);case i.AnnotationEditorType.STAMP:return new l.StampEditor(e)}return null}pasteEditor(e,t){this.#Rt.updateToolbar(e),this.#Rt.updateMode(e);const{offsetX:n,offsetY:i}=this.#$t(),r=this.getNextId(),s=this.#Lt({parent:this,id:r,x:n,y:i,uiManager:this.#Rt,isCentered:!0,...t});s&&this.add(s)}deserialize(e){switch(e.annotationType??e.annotationEditorType){case i.AnnotationEditorType.FREETEXT:return s.FreeTextEditor.deserialize(e,this,this.#Rt);case i.AnnotationEditorType.INK:return o.InkEditor.deserialize(e,this,this.#Rt);case i.AnnotationEditorType.STAMP:return l.StampEditor.deserialize(e,this,this.#Rt)}return null}#It(e,t){const n=this.getNextId(),i=this.#Lt({parent:this,id:n,x:e.offsetX,y:e.offsetY,uiManager:this.#Rt,isCentered:t});return i&&this.add(i),i}#$t(){const{x:e,y:t,width:n,height:i}=this.div.getBoundingClientRect(),r=Math.max(0,e),s=Math.max(0,t),o=(r+Math.min(window.innerWidth,e+n))/2-e,a=(s+Math.min(window.innerHeight,t+i))/2-t,[l,c]=this.viewport.rotation%180==0?[o,a]:[a,o];return{offsetX:l,offsetY:c}}addNewEditor(){this.#It(this.#$t(),!0)}setSelected(e){this.#Rt.setSelected(e)}toggleSelected(e){this.#Rt.toggleSelected(e)}isSelected(e){return this.#Rt.isSelected(e)}unselect(e){this.#Rt.unselect(e)}pointerup(e){const{isMac:t}=i.FeatureTest.platform;0!==e.button||e.ctrlKey&&t||e.target===this.div&&this.#kt&&(this.#kt=!1,this.#xt?this.#Rt.getMode()!==i.AnnotationEditorType.STAMP?this.#It(e,!1):this.#Rt.unselectAll():this.#xt=!0)}pointerdown(e){if(this.#kt)return void(this.#kt=!1);const{isMac:t}=i.FeatureTest.platform;if(0!==e.button||e.ctrlKey&&t)return;if(e.target!==this.div)return;this.#kt=!0;const n=this.#Rt.getActive();this.#xt=!n||n.isEmpty()}findNewParent(e,t,n){const i=this.#Rt.findParent(t,n);return null!==i&&i!==this&&(i.changeParent(e),!0)}destroy(){this.#Rt.getActive()?.parent===this&&(this.#Rt.commitOrRemove(),this.#Rt.setActiveEditor(null));for(const e of this.#Pt.values())this.#St?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#Pt.clear(),this.#Rt.removeLayer(this)}#Mt(){this.#Tt=!0;for(const e of this.#Pt.values())e.isEmpty()&&e.remove();this.#Tt=!1}render({viewport:e}){this.viewport=e,(0,a.setLayerDimensions)(this.div,e);for(const e of this.#Rt.getEditors(this.pageIndex))this.add(e);this.updateMode()}update({viewport:e}){this.#Rt.commitOrRemove(),this.viewport=e,(0,a.setLayerDimensions)(this.div,{rotation:e.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}}t.AnnotationEditorLayer=c},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var i=n(1),r=n(5),s=n(4),o=n(29);class a extends s.AnnotationEditor{#Dt=this.editorDivBlur.bind(this);#Nt=this.editorDivFocus.bind(this);#Qt=this.editorDivInput.bind(this);#Ft=this.editorDivKeydown.bind(this);#Bt;#jt="";#Vt=`${this.id}-editor`;#Ut;#Wt=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=a.prototype,t=e=>e.isEmpty(),n=r.AnnotationEditorUIManager.TRANSLATE_SMALL,s=r.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new r.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";constructor(e){super({...e,name:"freeTextEditor"}),this.#Bt=e.color||a._defaultColor||s.AnnotationEditor._defaultLineColor,this.#Ut=e.fontSize||a._defaultFontSize}static initialize(e){s.AnnotationEditor.initialize(e,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case i.AnnotationEditorParamsType.FREETEXT_SIZE:a._defaultFontSize=t;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:a._defaultColor=t}}updateParams(e,t){switch(e){case i.AnnotationEditorParamsType.FREETEXT_SIZE:this.#Zt(t);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:this.#Ht(t)}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,a._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,a._defaultColor||s.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,this.#Ut],[i.AnnotationEditorParamsType.FREETEXT_COLOR,this.#Bt]]}#Zt(e){const t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--scale-factor))`,this.translate(0,-(e-this.#Ut)*this.parentScale),this.#Ut=e,this.#qt()},n=this.#Ut;this.addCommands({cmd:()=>{t(e)},undo:()=>{t(n)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#Ht(e){const t=this.#Bt;this.addCommands({cmd:()=>{this.#Bt=this.editorDiv.style.color=e},undo:()=>{this.#Bt=this.editorDiv.style.color=t},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-a._internalPadding*e,-(a._internalPadding+this.#Ut)*e]}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#Ft),this.editorDiv.addEventListener("focus",this.#Nt),this.editorDiv.addEventListener("blur",this.#Dt),this.editorDiv.addEventListener("input",this.#Qt))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#Vt),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#Ft),this.editorDiv.removeEventListener("focus",this.#Nt),this.editorDiv.removeEventListener("blur",this.#Dt),this.editorDiv.removeEventListener("input",this.#Qt),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){this.width?this.#Xt():(this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#zt(){const e=this.editorDiv.getElementsByTagName("div");if(0===e.length)return this.editorDiv.innerText;const t=[];for(const n of e)t.push(n.innerText.replace(/\r\n?|\n/,""));return t.join("\n")}#qt(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:e,div:t}=this,i=t.style.display;t.style.display="hidden",e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=i}this.rotation%180==this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#jt,t=this.#jt=this.#zt().trimEnd();if(e===t)return;const n=e=>{this.#jt=e,e?(this.#Yt(),this._uiManager.rebuild(this),this.#qt()):this.remove()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#qt()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){a._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#Vt),this.enableEditing(),s.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then((e=>this.editorDiv?.setAttribute("aria-label",e))),s.AnnotationEditor._l10nPromise.get("free_text2_default_content").then((e=>this.editorDiv?.setAttribute("default-content",e))),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#Ut}px * var(--scale-factor))`,n.color=this.#Bt,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,r.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[n,i]=this.parentDimensions;if(this.annotationElementId){const{position:r}=this.#Wt;let[s,o]=this.getInitialTranslation();[s,o]=this.pageTranslationToScreen(s,o);const[a,l]=this.pageDimensions,[c,h]=this.pageTranslation;let d,u;switch(this.rotation){case 0:d=e+(r[0]-c)/a,u=t+this.height-(r[1]-h)/l;break;case 90:d=e+(r[0]-c)/a,u=t-(r[1]-h)/l,[s,o]=[o,-s];break;case 180:d=e-this.width+(r[0]-c)/a,u=t-(r[1]-h)/l,[s,o]=[-s,-o];break;case 270:d=e+(r[0]-c-this.height*l)/a,u=t+(r[1]-h-this.width*a)/l,[s,o]=[-o,s]}this.setAt(d*n,u*i,s,o)}else this.setAt(e*n,t*i,this.width*n,this.height*i);this.#Yt(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#Yt(){if(this.editorDiv.replaceChildren(),this.#jt)for(const e of this.#jt.split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(e,t,n){let r=null;if(e instanceof o.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:t,fontColor:n},rect:s,rotation:o,id:a},textContent:l,textPosition:c,parent:{page:{pageNumber:h}}}=e;if(!l||0===l.length)return null;r=e={annotationType:i.AnnotationEditorType.FREETEXT,color:Array.from(n),fontSize:t,value:l.join("\n"),position:c,pageIndex:h-1,rect:s,rotation:o,id:a,deleted:!1}}const s=super.deserialize(e,t,n);return s.#Ut=e.fontSize,s.#Bt=i.Util.makeHexColor(...e.color),s.#jt=e.value,s.annotationElementId=e.id||null,s.#Wt=r,s}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=a._internalPadding*this.parentScale,n=this.getRect(t,t),r=s.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#Bt),o={annotationType:i.AnnotationEditorType.FREETEXT,color:r,fontSize:this.#Ut,value:this.#jt,pageIndex:this.pageIndex,rect:n,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?o:this.annotationElementId&&!this.#Gt(o)?null:(o.id=this.annotationElementId,o)}#Gt(e){const{value:t,fontSize:n,color:i,rect:r,pageIndex:s}=this.#Wt;return e.value!==t||e.fontSize!==n||e.rect.some(((e,t)=>Math.abs(e-r[t])>=1))||e.color.some(((e,t)=>e!==i[t]))||e.pageIndex!==s}#Xt(e=!1){if(!this.annotationElementId)return;if(this.#qt(),!e&&(0===this.width||0===this.height))return void setTimeout((()=>this.#Xt(!0)),0);const t=a._internalPadding*this.parentScale;this.#Wt.rect=this.getRect(t,t)}}t.FreeTextEditor=a},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var i=n(1),r=n(6),s=n(3),o=n(30),a=n(31),l=n(32);const c=1e3,h=new WeakSet;function d(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class u{static create(e){switch(e.data.annotationType){case i.AnnotationType.LINK:return new f(e);case i.AnnotationType.TEXT:return new m(e);case i.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new O(e);case"Btn":return e.data.radioButton?new b(e):e.data.checkBox?new v(e):new w(e);case"Ch":return new S(e);case"Sig":return new y(e)}return new g(e);case i.AnnotationType.POPUP:return new x(e);case i.AnnotationType.FREETEXT:return new _(e);case i.AnnotationType.LINE:return new E(e);case i.AnnotationType.SQUARE:return new P(e);case i.AnnotationType.CIRCLE:return new k(e);case i.AnnotationType.POLYLINE:return new T(e);case i.AnnotationType.CARET:return new R(e);case i.AnnotationType.INK:return new M(e);case i.AnnotationType.POLYGON:return new A(e);case i.AnnotationType.HIGHLIGHT:return new I(e);case i.AnnotationType.UNDERLINE:return new L(e);case i.AnnotationType.SQUIGGLY:return new $(e);case i.AnnotationType.STRIKEOUT:return new D(e);case i.AnnotationType.STAMP:return new N(e);case i.AnnotationType.FILEATTACHMENT:return new Q(e);default:return new p(e)}}}class p{#Kt=!1;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:n}){return!!(e?.str||t?.str||n?.str)}get hasPopupData(){return p._hasPopupData(this.data)}_createContainer(e){const{data:t,parent:{page:n,viewport:r}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),this instanceof g||(s.tabIndex=c),s.style.zIndex=this.parent.zIndex++,this.data.popupRef&&s.setAttribute("aria-haspopup","dialog"),t.noRotate&&s.classList.add("norotate");const{pageWidth:o,pageHeight:a,pageX:l,pageY:h}=r.rawDims;if(!t.rect||this instanceof x){const{rotation:e}=t;return t.hasOwnCanvas||0===e||this.setRotation(e,s),s}const{width:u,height:p}=d(t.rect),f=i.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(!e&&t.borderStyle.width>0){s.style.borderWidth=`${t.borderStyle.width}px`;const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t=`calc(${e}px * var(--scale-factor)) / calc(${n}px * var(--scale-factor))`;s.style.borderRadius=t}else if(this instanceof b){const e=`calc(${u}px * var(--scale-factor)) / calc(${p}px * var(--scale-factor))`;s.style.borderRadius=e}switch(t.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:s.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:s.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:s.style.borderBottomStyle="solid"}const r=t.borderColor||null;r?(this.#Kt=!0,s.style.borderColor=i.Util.makeHexColor(0|r[0],0|r[1],0|r[2])):s.style.borderWidth=0}s.style.left=100*(f[0]-l)/o+"%",s.style.top=100*(f[1]-h)/a+"%";const{rotation:m}=t;return t.hasOwnCanvas||0===m?(s.style.width=100*u/o+"%",s.style.height=100*p/a+"%"):this.setRotation(m,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims,{width:r,height:s}=d(this.data.rect);let o,a;e%180==0?(o=100*r/n,a=100*s/i):(o=100*s/n,a=100*r/i),t.style.width=`${o}%`,t.style.height=`${a}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,n)=>{const i=n.detail[e],r=i[0],s=i.slice(1);n.target.style[t]=o.ColorConverters[`${r}_HTML`](s),this.annotationStorage.setValue(this.data.id,{[t]:o.ColorConverters[`${r}_rgb`](s)})};return(0,i.shadow)(this,"_commonActions",{display:e=>{const{display:t}=e.detail,n=t%2==1;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:1===t||2===t})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:t}=e.detail;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout((()=>e.target.focus({preventScroll:!1})),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail)){const r=e[i]||n[i];r?.(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,r]of Object.entries(t)){const s=n[i];if(s){s({detail:{[i]:r},target:e}),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,r]=this.data.rect;if(1===e.length){const[,{x:s,y:o},{x:a,y:l}]=e[0];if(i===s&&r===o&&t===a&&n===l)return}const{style:s}=this.container;let o;if(this.#Kt){const{borderColor:e,borderWidth:t}=s;s.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${e}" stroke-width="${t}">`],this.container.classList.add("hasBorder")}const a=i-t,l=r-n,{svgFactory:c}=this,h=c.createElement("svg");h.classList.add("quadrilateralsContainer"),h.setAttribute("width",0),h.setAttribute("height",0);const d=c.createElement("defs");h.append(d);const u=c.createElement("clipPath"),p=`clippath_${this.data.id}`;u.setAttribute("id",p),u.setAttribute("clipPathUnits","objectBoundingBox"),d.append(u);for(const[,{x:n,y:i},{x:s,y:h}]of e){const e=c.createElement("rect"),d=(s-t)/a,p=(r-i)/l,f=(n-s)/a,m=(i-h)/l;e.setAttribute("x",d),e.setAttribute("y",p),e.setAttribute("width",f),e.setAttribute("height",m),u.append(e),o?.push(`<rect vector-effect="non-scaling-stroke" x="${d}" y="${p}" width="${f}" height="${m}"/>`)}this.#Kt&&(o.push("</g></svg>')"),s.backgroundImage=o.join("")),this.container.append(h),this.container.style.clipPath=`url(#${p})`}_createPopup(){const{container:e,data:t}=this;e.setAttribute("aria-haspopup","dialog");const n=new x({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(n.render())}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[e];if(r)for(const{page:e,id:s,exportValues:o}of r){if(-1===e)continue;if(s===t)continue;const r="string"==typeof o?o:null,a=document.querySelector(`[data-element-id="${s}"]`);!a||h.has(a)?n.push({id:s,exportValue:r,domElement:a}):(0,i.warn)(`_getElementsByName - element not allowed: ${s}`)}return n}for(const i of document.getElementsByName(e)){const{exportValue:e}=i,r=i.getAttribute("data-element-id");r!==t&&(h.has(i)&&n.push({id:r,exportValue:e,domElement:i}))}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",(()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})}))}}class f extends p{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action),i=!0):e.attachment?(this._bindAttachment(n,e.attachment),i=!0):e.setOCGState?(this.#Jt(n,e.setOCGState),i=!0):e.dest?(this._bindLink(n,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#en(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&this.#en()}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),this.#en()}_bindAttachment(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,t.content,t.filename),!1),this.#en()}#Jt(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),this.#en()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const r=n.get(i);r&&(e[r]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),this.#en()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#en(),!this._fieldObjects)return(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(n||(e.onclick=()=>!1));e.onclick=()=>{n?.();const{fields:e,refs:r,include:s}=t,o=[];if(0!==e.length||0!==r.length){const t=new Set(r);for(const n of e){const e=this._fieldObjects[n]||[];for(const{id:n}of e)t.add(n)}for(const e of Object.values(this._fieldObjects))for(const n of e)t.has(n.id)===s&&o.push(n)}else for(const e of Object.values(this._fieldObjects))o.push(...e);const a=this.annotationStorage,l=[];for(const e of o){const{id:t}=e;switch(l.push(t),e.type){case"text":{const n=e.defaultValue||"";a.setValue(t,{value:n});break}case"checkbox":case"radiobutton":{const n=e.defaultValue===e.exportValues;a.setValue(t,{value:n});break}case"combobox":case"listbox":{const n=e.defaultValue||"";a.setValue(t,{value:n});break}default:continue}const n=document.querySelector(`[data-element-id="${t}"]`);n&&(h.has(n)?n.dispatchEvent(new Event("resetform")):(0,i.warn)(`_bindResetFormAction - element not allowed: ${t}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}}),!1}}}class m extends p{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class g extends p{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&("CANVAS"===e.previousSibling?.nodeName&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){const{isWin:t,isMac:n}=i.FeatureTest.platform;return t&&e.ctrlKey||n&&e.metaKey}_setEventListener(e,t,n,i,r){n.includes("mouse")?e.addEventListener(n,(e=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})})):e.addEventListener(n,(e=>{if("blur"===n){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if("focus"===n){if(t.focused)return;t.focused=!0}r&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:r(e)}})}))}_setEventListeners(e,t,n,i){for(const[r,s]of n)("Action"===s||this.data.actions?.[s])&&("Focus"!==s&&"Blur"!==s||(t||={focused:!1}),this._setEventListener(e,t,r,s,i),"Focus"!==s||this.data.actions?.Blur?"Blur"!==s||this.data.actions?.Focus||this._setEventListener(e,t,"focus","Focus",null):this._setEventListener(e,t,"blur","Blur",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":i.Util.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||9,s=e.style;let o;const a=e=>Math.round(10*e)/10;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=e/(Math.round(e/(i.LINE_FACTOR*r))||1);o=Math.min(r,a(t/i.LINE_FACTOR))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);o=Math.min(r,a(e/i.LINE_FACTOR))}s.fontSize=`calc(${o}px * var(--scale-factor))`,s.color=i.Util.makeHexColor(n[0],n[1],n[2]),null!==this.data.textAlignment&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class O extends g{constructor(e){super(e,{isRenderable:e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,n,i){const r=this.annotationStorage;for(const s of this._getElementsByName(e.name,e.id))s.domElement&&(s.domElement[t]=n),r.setValue(s.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let r=i.value||"";const s=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;s&&r.length>s&&(r=r.slice(0,s));let o=i.formattedValue||this.data.textContent?.join("\n")||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,""));const a={userValue:r,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=o??r,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type="text",n.setAttribute("value",o??r),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),h.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=c,this._setRequired(n,this.data.required),s&&(n.maxLength=s),n.addEventListener("input",(i=>{e.setValue(t,{value:i.target.value}),this.setPropertyOnSiblings(n,"value",i.target.value,"value"),a.formattedValue=null})),n.addEventListener("resetform",(e=>{const t=this.data.defaultFieldValue??"";n.value=a.userValue=t,a.formattedValue=null}));let l=e=>{const{formattedValue:t}=a;null!=t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",(e=>{if(a.focused)return;const{target:t}=e;a.userValue&&(t.value=a.userValue),a.lastCommittedValue=t.value,a.commitKey=1,a.focused=!0})),n.addEventListener("updatefromsandbox",(n=>{this.showElementAndHideCanvas(n.target);const i={value(n){a.userValue=n.detail.value??"",e.setValue(t,{value:a.userValue.toString()}),n.target.value=a.userValue},formattedValue(n){const{formattedValue:i}=n.detail;a.formattedValue=i,null!=i&&n.target!==document.activeElement&&(n.target.value=i),e.setValue(t,{formattedValue:i})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{const{charLimit:i}=n.detail,{target:r}=n;if(0===i)return void r.removeAttribute("maxLength");r.setAttribute("maxLength",i);let s=a.userValue;!s||s.length<=i||(s=s.slice(0,i),r.value=a.userValue=s,e.setValue(t,{value:s}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:1,selStart:r.selectionStart,selEnd:r.selectionEnd}}))}};this._dispatchEventFromSandbox(i,n)})),n.addEventListener("keydown",(e=>{a.commitKey=1;let n=-1;if("Escape"===e.key?n=0:"Enter"!==e.key||this.data.multiLine?"Tab"===e.key&&(a.commitKey=3):n=2,-1===n)return;const{value:i}=e.target;a.lastCommittedValue!==i&&(a.lastCommittedValue=i,a.userValue=i,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,willCommit:!0,commitKey:n,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))}));const i=l;l=null,n.addEventListener("blur",(e=>{if(!a.focused||!e.relatedTarget)return;a.focused=!1;const{value:n}=e.target;a.userValue=n,a.lastCommittedValue!==n&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:n,willCommit:!0,commitKey:a.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}),i(e)})),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",(e=>{a.lastCommittedValue=null;const{data:n,target:i}=e,{value:r,selectionStart:s,selectionEnd:o}=i;let l=s,c=o;switch(e.inputType){case"deleteWordBackward":{const e=r.substring(0,s).match(/\w*[^\w]*$/);e&&(l-=e[0].length);break}case"deleteWordForward":{const e=r.substring(s).match(/^[^\w]*\w*/);e&&(c+=e[0].length);break}case"deleteContentBackward":s===o&&(l-=1);break;case"deleteContentForward":s===o&&(c+=1)}e.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,change:n||"",willCommit:!1,selStart:l,selEnd:c}})})),this._setEventListeners(n,a,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.value))}if(l&&n.addEventListener("blur",l),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/s;n.classList.add("comb"),n.style.letterSpacing=`calc(${e}px * var(--scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell";return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class y extends g{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class v extends g{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;"string"==typeof i&&(i="Off"!==i,e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return h.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=c,r.addEventListener("change",(i=>{const{name:r,checked:s}=i.target;for(const i of this._getElementsByName(r,n)){const n=s&&i.exportValue===t.exportValue;i.domElement&&(i.domElement.checked=n),e.setValue(i.id,{value:n})}e.setValue(n,{value:s})})),r.addEventListener("resetform",(e=>{const n=t.defaultFieldValue||"Off";e.target.checked=n===t.exportValue})),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",(t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(n,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)})),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.checked))),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class b extends g{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;"string"==typeof i&&(i=i!==t.buttonValue,e.setValue(n,{value:i}));const r=document.createElement("input");if(h.add(r),r.setAttribute("data-element-id",n),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.tabIndex=c,r.addEventListener("change",(t=>{const{name:i,checked:r}=t.target;for(const t of this._getElementsByName(i,n))e.setValue(t.id,{value:!1});e.setValue(n,{value:r})})),r.addEventListener("resetform",(e=>{const n=t.defaultFieldValue;e.target.checked=null!=n&&n===t.buttonValue})),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;r.addEventListener("updatefromsandbox",(t=>{const r={value:t=>{const r=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=r&&i.id===n;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(r,t)})),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(e=>e.target.checked))}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class w extends f{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(e.title=this.data.alternativeText);const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",(e=>{this._dispatchEventFromSandbox({},e)}))),e}}class S extends g{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");h.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=c;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",(e=>{const t=this.data.defaultFieldValue;for(const e of i.options)e.selected=e.value===t}));for(const e of this.data.options){const t=document.createElement("option");t.textContent=e.displayValue,t.value=e.exportValue,n.value.includes(e.exportValue)&&(t.setAttribute("selected",!0),r=!1),i.append(t)}let s=null;if(r){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),s=()=>{e.remove(),i.removeEventListener("input",s),s=null},i.addEventListener("input",s)}const o=e=>{const t=e?"value":"textContent",{options:n,multiple:r}=i;return r?Array.prototype.filter.call(n,(e=>e.selected)).map((e=>e[t])):-1===n.selectedIndex?null:n[n.selectedIndex][t]};let a=o(!1);const l=e=>{const t=e.target.options;return Array.prototype.map.call(t,(e=>({displayValue:e.textContent,exportValue:e.value})))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",(n=>{const r={value(n){s?.();const r=n.detail.value,l=new Set(Array.isArray(r)?r:[r]);for(const e of i.options)e.selected=l.has(e.value);e.setValue(t,{value:o(!0)}),a=o(!1)},multipleSelection(e){i.multiple=!0},remove(n){const r=i.options,s=n.detail.remove;if(r[s].selected=!1,i.remove(s),r.length>0){-1===Array.prototype.findIndex.call(r,(e=>e.selected))&&(r[0].selected=!0)}e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},clear(n){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]}),a=o(!1)},insert(n){const{index:r,displayValue:s,exportValue:c}=n.detail.insert,h=i.children[r],d=document.createElement("option");d.textContent=s,d.value=c,h?h.before(d):i.append(d),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},items(n){const{items:r}=n.detail;for(;0!==i.length;)i.remove(0);for(const e of r){const{displayValue:t,exportValue:n}=e,r=document.createElement("option");r.textContent=t,r.value=n,i.append(r)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:o(!0),items:l(n)}),a=o(!1)},indices(n){const i=new Set(n.detail.indices);for(const e of n.target.options)e.selected=i.has(e.index);e.setValue(t,{value:o(!0)}),a=o(!1)},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(r,n)})),i.addEventListener("input",(n=>{const i=o(!0);e.setValue(t,{value:i}),n.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,changeEx:i,willCommit:!1,commitKey:1,keyDown:!1}})})),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],(e=>e.target.value))):i.addEventListener("input",(function(n){e.setValue(t,{value:o(!0)})})),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class x extends p{constructor(e){const{data:t,elements:n}=e;super(e,{isRenderable:p._hasPopupData(t)}),this.elements=n}render(){this.container.classList.add("popupAnnotation");const e=new C({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const n of this.elements)n.popup=e,t.push(n.data.id),n.addHighlightArea();return this.container.setAttribute("aria-controls",t.map((e=>`${i.AnnotationPrefix}${e}`)).join(",")),this.container}}class C{#tn=null;#nn=this.#in.bind(this);#rn=this.#sn.bind(this);#on=this.#an.bind(this);#ln=this.#cn.bind(this);#Bt=null;#Me=null;#hn=null;#dn=null;#un=null;#pn=null;#fn=!1;#mn=null;#gn=null;#On=null;#yn=null;#vn=!1;constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:s,contentsObj:o,richText:a,parent:l,rect:c,parentRect:h,open:d}){this.#Me=e,this.#yn=i,this.#hn=o,this.#On=a,this.#un=l,this.#Bt=t,this.#gn=c,this.#pn=h,this.#dn=n;const u=r.PDFDateString.toDateObject(s);u&&(this.#tn=l.l10n.get("annotation_date_string",{date:u.toLocaleDateString(),time:u.toLocaleTimeString()})),this.trigger=n.flatMap((e=>e.getElementsToTriggerPopup()));for(const e of this.trigger)e.addEventListener("click",this.#ln),e.addEventListener("mouseenter",this.#on),e.addEventListener("mouseleave",this.#rn),e.classList.add("popupTriggerArea");for(const e of n)e.container?.addEventListener("keydown",this.#nn);this.#Me.hidden=!0,d&&this.#cn()}render(){if(this.#mn)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:s}}}=this.#un,o=this.#mn=document.createElement("div");if(o.className="popup",this.#Bt){const e=o.style.outlineColor=i.Util.makeHexColor(...this.#Bt);if(CSS.supports("background-color","color-mix(in srgb, red 30%, white)"))o.style.backgroundColor=`color-mix(in srgb, ${e} 30%, white)`;else{const e=.7;o.style.backgroundColor=i.Util.makeHexColor(...this.#Bt.map((t=>Math.floor(e*(255-t)+t))))}}const a=document.createElement("span");a.className="header";const c=document.createElement("h1");if(a.append(c),({dir:c.dir,str:c.textContent}=this.#yn),o.append(a),this.#tn){const e=document.createElement("span");e.classList.add("popupDate"),this.#tn.then((t=>{e.textContent=t})),a.append(e)}const h=this.#hn,d=this.#On;if(!d?.str||h?.str&&h.str!==d.str){const e=this._formatContents(h);o.append(e)}else l.XfaLayer.render({xfaHtml:d.html,intent:"richText",div:o}),o.lastChild.classList.add("richText","popupContent");let u=!!this.#pn,p=u?this.#pn:this.#gn;for(const e of this.#dn)if(!p||null!==i.Util.intersect(e.data.rect,p)){p=e.data.rect,u=!0;break}const f=i.Util.normalizeRect([p[0],e[3]-p[1]+e[1],p[2],e[3]-p[3]+e[1]]),m=u?p[2]-p[0]+5:0,g=f[0]+m,O=f[1],{style:y}=this.#Me;y.left=100*(g-r)/t+"%",y.top=100*(O-s)/n+"%",this.#Me.append(o)}_formatContents({str:e,dir:t}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let e=0,t=i.length;e<t;++e){const r=i[e];n.append(document.createTextNode(r)),e<t-1&&n.append(document.createElement("br"))}return n}#in(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||("Enter"===e.key||"Escape"===e.key&&this.#fn)&&this.#cn()}#cn(){this.#fn=!this.#fn,this.#fn?(this.#an(),this.#Me.addEventListener("click",this.#ln),this.#Me.addEventListener("keydown",this.#nn)):(this.#sn(),this.#Me.removeEventListener("click",this.#ln),this.#Me.removeEventListener("keydown",this.#nn))}#an(){this.#mn||this.render(),this.isVisible?this.#fn&&this.#Me.classList.add("focused"):(this.#Me.hidden=!1,this.#Me.style.zIndex=parseInt(this.#Me.style.zIndex)+1e3)}#sn(){this.#Me.classList.remove("focused"),!this.#fn&&this.isVisible&&(this.#Me.hidden=!0,this.#Me.style.zIndex=parseInt(this.#Me.style.zIndex)-1e3)}forceHide(){this.#vn=this.isVisible,this.#vn&&(this.#Me.hidden=!0)}maybeShow(){this.#vn&&(this.#vn=!1,this.#Me.hidden=!1)}get isVisible(){return!1===this.#Me.hidden}}class _ extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=i.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=_;class E extends p{#bn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:t,height:n}=d(e.rect),i=this.svgFactory.create(t,n,!0),r=this.#bn=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#bn}addHighlightArea(){this.container.classList.add("highlightArea")}}class P extends p{#wn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:t,height:n}=d(e.rect),i=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,s=this.#wn=this.svgFactory.createElement("svg:rect");return s.setAttribute("x",r/2),s.setAttribute("y",r/2),s.setAttribute("width",t-r),s.setAttribute("height",n-r),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#wn}addHighlightArea(){this.container.classList.add("highlightArea")}}class k extends p{#Sn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:t,height:n}=d(e.rect),i=this.svgFactory.create(t,n,!0),r=e.borderStyle.width,s=this.#Sn=this.svgFactory.createElement("svg:ellipse");return s.setAttribute("cx",t/2),s.setAttribute("cy",n/2),s.setAttribute("rx",t/2-r/2),s.setAttribute("ry",n/2-r/2),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#Sn}addHighlightArea(){this.container.classList.add("highlightArea")}}class T extends p{#xn=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:t,height:n}=d(e.rect),i=this.svgFactory.create(t,n,!0);let r=[];for(const t of e.vertices){const n=t.x-e.rect[0],i=e.rect[3]-t.y;r.push(n+","+i)}r=r.join(" ");const s=this.#xn=this.svgFactory.createElement(this.svgElementName);return s.setAttribute("points",r),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#xn}addHighlightArea(){this.container.classList.add("highlightArea")}}class A extends T{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class R extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class M extends p{#Cn=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=i.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const e=this.data,{width:t,height:n}=d(e.rect),i=this.svgFactory.create(t,n,!0);for(const t of e.inkLists){let n=[];for(const i of t){const t=i.x-e.rect[0],r=e.rect[3]-i.y;n.push(`${t},${r}`)}n=n.join(" ");const r=this.svgFactory.createElement(this.svgElementName);this.#Cn.push(r),r.setAttribute("points",n),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),!e.popupRef&&this.hasPopupData&&this._createPopup(),i.append(r)}return this.container.append(i),this.container}getElementsToTriggerPopup(){return this.#Cn}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=M;class I extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class L extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class $ extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class D extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class N extends p{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=N;class Q extends p{#_n=null;constructor(e){super(e,{isRenderable:!0});const{filename:t,content:n}=this.data.file;this.filename=(0,r.getFilenameFromUrl)(t,!0),this.content=n,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:t,content:n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||0===t.fillAlpha?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(100*t.fillAlpha)}%);`)),n.addEventListener("dblclick",this.#En.bind(this)),this.#_n=n;const{isMac:r}=i.FeatureTest.platform;return e.addEventListener("keydown",(e=>{"Enter"===e.key&&(r?e.metaKey:e.ctrlKey)&&this.#En()})),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#_n}addHighlightArea(){this.container.classList.add("highlightArea")}#En(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}t.AnnotationLayer=class{#St=null;#Pn=null;#kn=new Map;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,l10n:i,page:r,viewport:s}){this.div=e,this.#St=t,this.#Pn=n,this.l10n=i,this.page=r,this.viewport=s,this.zIndex=0,this.l10n||=a.NullL10n}#Tn(e,t){const n=e.firstChild||e;n.id=`${i.AnnotationPrefix}${t}`,this.div.append(e),this.#St?.moveElementInDOM(this.div,e,n,!1)}async render(e){const{annotations:t}=e,n=this.div;(0,r.setLayerDimensions)(n,this.viewport);const o=new Map,a={data:null,layer:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new r.DOMSVGFactory,annotationStorage:e.annotationStorage||new s.AnnotationStorage,enableScripting:!0===e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const e of t){if(e.noHTML)continue;const t=e.annotationType===i.AnnotationType.POPUP;if(t){const t=o.get(e.id);if(!t)continue;a.elements=t}else{const{width:t,height:n}=d(e.rect);if(t<=0||n<=0)continue}a.data=e;const n=u.create(a);if(!n.isRenderable)continue;if(!t&&e.popupRef){const t=o.get(e.popupRef);t?t.push(n):o.set(e.popupRef,[n])}n.annotationEditorType>0&&this.#kn.set(n.data.id,n);const r=n.render();e.hidden&&(r.style.visibility="hidden"),this.#Tn(r,e.id)}this.#An(),await this.l10n.translate(n)}update({viewport:e}){const t=this.div;this.viewport=e,(0,r.setLayerDimensions)(t,{rotation:e.rotation}),this.#An(),t.hidden=!1}#An(){if(!this.#Pn)return;const e=this.div;for(const[t,n]of this.#Pn){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;const{firstChild:r}=i;r?"CANVAS"===r.nodeName?r.replaceWith(n):r.before(n):i.append(n)}this.#Pn.clear()}getEditableAnnotations(){return Array.from(this.#kn.values())}getEditableAnnotation(e){return this.#kn.get(e)}}},(e,t)=>{function n(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}function i(e){return Math.max(0,Math.min(255,255*e))}Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;t.ColorConverters=class{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return[e=i(e),e,e]}static G_HTML([e]){const t=n(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(i)}static RGB_HTML(e){return`#${e.map(n).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,r]){return[i(1-Math.min(1,e+r)),i(1-Math.min(1,n+r)),i(1-Math.min(1,t+r))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,r=1-t,s=1-n;return["CMYK",i,r,s,Math.min(i,r,s)]}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=i;const n={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};function i(e,t){switch(e){case"find_match_count":e=`find_match_count[${1===t.total?"one":"other"}]`;break;case"find_match_count_limit":e=`find_match_count_limit[${1===t.limit?"one":"other"}]`}return n[e]||""}n.print_progress_percent="{{progress}}%";const r={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(e,t=null,n=i(e,t))=>function(e,t){return t?e.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,((e,n)=>n in t?t[n]:"{{"+n+"}}")):e}(n,t),async translate(e){}};t.NullL10n=r},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var i=n(25);t.XfaLayer=class{static setupStorage(e,t,n,i,r){const s=i.getValue(t,{value:null});switch(n.name){case"textarea":if(null!==s.value&&(e.textContent=s.value),"print"===r)break;e.addEventListener("input",(e=>{i.setValue(t,{value:e.target.value})}));break;case"input":if("radio"===n.attributes.type||"checkbox"===n.attributes.type){if(s.value===n.attributes.xfaOn?e.setAttribute("checked",!0):s.value===n.attributes.xfaOff&&e.removeAttribute("checked"),"print"===r)break;e.addEventListener("change",(e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})}))}else{if(null!==s.value&&e.setAttribute("value",s.value),"print"===r)break;e.addEventListener("input",(e=>{i.setValue(t,{value:e.target.value})}))}break;case"select":if(null!==s.value){e.setAttribute("value",s.value);for(const e of n.children)e.attributes.value===s.value?e.attributes.selected=!0:e.attributes.hasOwnProperty("selected")&&delete e.attributes.selected}e.addEventListener("input",(e=>{const n=e.target.options,r=-1===n.selectedIndex?"":n[n.selectedIndex].value;i.setValue(t,{value:r})}))}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:r}){const{attributes:s}=t,o=e instanceof HTMLAnchorElement;"radio"===s.type&&(s.name=`${s.name}-${i}`);for(const[t,n]of Object.entries(s))if(null!=n)switch(t){case"class":n.length&&e.setAttribute(t,n.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",n);break;case"style":Object.assign(e.style,n);break;case"textContent":e.textContent=n;break;default:(!o||"href"!==t&&"newWindow"!==t)&&e.setAttribute(t,n)}o&&r.addLinkAttributes(e,s.href,s.newWindow),n&&s.dataId&&this.setupStorage(e,s.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,s=e.intent||"display",o=document.createElement(r.name);r.attributes&&this.setAttributes({html:o,element:r,intent:s,linkService:n});const a=[[r,-1,o]],l=e.div;if(l.append(o),e.viewport){const t=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=t}"richText"!==s&&l.setAttribute("class","xfaLayer xfaFont");const c=[];for(;a.length>0;){const[e,r,o]=a.at(-1);if(r+1===e.children.length){a.pop();continue}const l=e.children[++a.at(-1)[1]];if(null===l)continue;const{name:h}=l;if("#text"===h){const e=document.createTextNode(l.value);c.push(e),o.append(e);continue}const d=l?.attributes?.xmlns?document.createElementNS(l.attributes.xmlns,h):document.createElement(h);if(o.append(d),l.attributes&&this.setAttributes({html:d,element:l,storage:t,intent:s,linkService:n}),l.children&&l.children.length>0)a.push([l,-1,d]);else if(l.value){const e=document.createTextNode(l.value);i.XfaText.shouldBuildText(h)&&c.push(e),d.append(e)}}for(const e of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))e.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var i=n(1),r=n(4),s=n(29),o=n(6),a=n(5);class l extends r.AnnotationEditor{#Rn=0;#Mn=0;#In=this.canvasPointermove.bind(this);#Ln=this.canvasPointerleave.bind(this);#$n=this.canvasPointerup.bind(this);#Dn=this.canvasPointerdown.bind(this);#Nn=new Path2D;#Qn=!1;#Fn=!1;#Bn=!1;#jn=null;#Vn=0;#Un=0;#Wn=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(e){super({...e,name:"inkEditor"}),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(e){r.AnnotationEditor.initialize(e,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(e,t){switch(e){case i.AnnotationEditorParamsType.INK_THICKNESS:l._defaultThickness=t;break;case i.AnnotationEditorParamsType.INK_COLOR:l._defaultColor=t;break;case i.AnnotationEditorParamsType.INK_OPACITY:l._defaultOpacity=t/100}}updateParams(e,t){switch(e){case i.AnnotationEditorParamsType.INK_THICKNESS:this.#Zn(t);break;case i.AnnotationEditorParamsType.INK_COLOR:this.#Ht(t);break;case i.AnnotationEditorParamsType.INK_OPACITY:this.#Hn(t)}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,l._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,l._defaultColor||r.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*l._defaultOpacity)]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||l._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||l._defaultColor||r.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??l._defaultOpacity))]]}#Zn(e){const t=this.thickness;this.addCommands({cmd:()=>{this.thickness=e,this.#qn()},undo:()=>{this.thickness=t,this.#qn()},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#Ht(e){const t=this.color;this.addCommands({cmd:()=>{this.color=e,this.#Xn()},undo:()=>{this.color=t,this.#Xn()},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#Hn(e){e/=100;const t=this.opacity;this.addCommands({cmd:()=>{this.opacity=e,this.#Xn()},undo:()=>{this.opacity=t,this.#Xn()},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),null!==this.div&&(this.canvas||(this.#zn(),this.#Yn()),this.isAttachedToDOM||(this.parent.add(this),this.#Gn()),this.#qn()))}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#jn.disconnect(),this.#jn=null,super.remove())}setParent(e){!this.parent&&e?this._uiManager.removeShouldRescale(this):this.parent&&null===e&&this._uiManager.addShouldRescale(this),super.setParent(e)}onScaleChanging(){const[e,t]=this.parentDimensions,n=this.width*e,i=this.height*t;this.setDimensions(n,i)}enableEditMode(){this.#Qn||null===this.canvas||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#Dn))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#Dn))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}#Kn(){const{parentRotation:e,parentDimensions:[t,n]}=this;switch(e){case 90:return[0,n,n,t];case 180:return[t,n,t,n];case 270:return[t,0,n,t];default:return[0,0,t,n]}}#Jn(){const{ctx:e,color:t,opacity:n,thickness:i,parentScale:r,scaleFactor:s}=this;e.lineWidth=i*r/s,e.lineCap="round",e.lineJoin="round",e.miterLimit=10,e.strokeStyle=`${t}${(0,a.opacityToHex)(n)}`}#ei(e,t){this.canvas.addEventListener("contextmenu",o.noContextMenu),this.canvas.addEventListener("pointerleave",this.#Ln),this.canvas.addEventListener("pointermove",this.#In),this.canvas.addEventListener("pointerup",this.#$n),this.canvas.removeEventListener("pointerdown",this.#Dn),this.isEditing=!0,this.#Bn||(this.#Bn=!0,this.#Gn(),this.thickness||=l._defaultThickness,this.color||=l._defaultColor||r.AnnotationEditor._defaultLineColor,this.opacity??=l._defaultOpacity),this.currentPath.push([e,t]),this.#Fn=!1,this.#Jn(),this.#Wn=()=>{this.#ti(),this.#Wn&&window.requestAnimationFrame(this.#Wn)},window.requestAnimationFrame(this.#Wn)}#ni(e,t){const[n,i]=this.currentPath.at(-1);if(this.currentPath.length>1&&e===n&&t===i)return;const r=this.currentPath;let s=this.#Nn;if(r.push([e,t]),this.#Fn=!0,r.length<=2)return s.moveTo(...r[0]),void s.lineTo(e,t);3===r.length&&(this.#Nn=s=new Path2D,s.moveTo(...r[0])),this.#ii(s,...r.at(-3),...r.at(-2),e,t)}#ri(){if(0===this.currentPath.length)return;const e=this.currentPath.at(-1);this.#Nn.lineTo(...e)}#si(e,t){let n;if(this.#Wn=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height),this.#ni(e,t),this.#ri(),1!==this.currentPath.length)n=this.#oi();else{const i=[e,t];n=[[i,i.slice(),i.slice(),i]]}const i=this.#Nn,r=this.currentPath;this.currentPath=[],this.#Nn=new Path2D;this.addCommands({cmd:()=>{this.allRawPaths.push(r),this.paths.push(n),this.bezierPath2D.push(i),this.rebuild()},undo:()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(this.#zn(),this.#Yn()),this.#qn())},mustExec:!0})}#ti(){if(!this.#Fn)return;this.#Fn=!1;Math.ceil(this.thickness*this.parentScale);const e=this.currentPath.slice(-3),t=e.map((e=>e[0])),n=e.map((e=>e[1]));Math.min(...t),Math.max(...t),Math.min(...n),Math.max(...n);const{ctx:i}=this;i.save(),i.clearRect(0,0,this.canvas.width,this.canvas.height);for(const e of this.bezierPath2D)i.stroke(e);i.stroke(this.#Nn),i.restore()}#ii(e,t,n,i,r,s,o){const a=(t+i)/2,l=(n+r)/2,c=(i+s)/2,h=(r+o)/2;e.bezierCurveTo(a+2*(i-a)/3,l+2*(r-l)/3,c+2*(i-c)/3,h+2*(r-h)/3,c,h)}#oi(){const e=this.currentPath;if(e.length<=2)return[[e[0],e[0],e.at(-1),e.at(-1)]];const t=[];let n,[i,r]=e[0];for(n=1;n<e.length-2;n++){const[s,o]=e[n],[a,l]=e[n+1],c=(s+a)/2,h=(o+l)/2,d=[i+2*(s-i)/3,r+2*(o-r)/3],u=[c+2*(s-c)/3,h+2*(o-h)/3];t.push([[i,r],d,u,[c,h]]),[i,r]=[c,h]}const[s,o]=e[n],[a,l]=e[n+1],c=[i+2*(s-i)/3,r+2*(o-r)/3],h=[a+2*(s-a)/3,l+2*(o-l)/3];return t.push([[i,r],c,h,[a,l]]),t}#Xn(){if(this.isEmpty())return void this.#ai();this.#Jn();const{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),this.#ai();for(const e of this.bezierPath2D)t.stroke(e)}commit(){this.#Qn||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#Qn=!0,this.div.classList.add("disabled"),this.#qn(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),this.enableEditMode())}canvasPointerdown(e){0===e.button&&this.isInEditMode()&&!this.#Qn&&(this.setInForeground(),e.preventDefault(),"mouse"!==e.type&&this.div.focus(),this.#ei(e.offsetX,e.offsetY))}canvasPointermove(e){e.preventDefault(),this.#ni(e.offsetX,e.offsetY)}canvasPointerup(e){e.preventDefault(),this.#li(e)}canvasPointerleave(e){this.#li(e)}#li(e){this.canvas.removeEventListener("pointerleave",this.#Ln),this.canvas.removeEventListener("pointermove",this.#In),this.canvas.removeEventListener("pointerup",this.#$n),this.canvas.addEventListener("pointerdown",this.#Dn),setTimeout((()=>{this.canvas.removeEventListener("contextmenu",o.noContextMenu)}),10),this.#si(e.offsetX,e.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#zn(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",r.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then((e=>this.canvas?.setAttribute("aria-label",e))),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#Yn(){this.#jn=new ResizeObserver((e=>{const t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)})),this.#jn.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#Qn}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),r.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then((e=>this.div?.setAttribute("aria-label",e)));const[n,i,s,o]=this.#Kn();if(this.setAt(n,i,0,0),this.setDims(s,o),this.#zn(),this.width){const[n,i]=this.parentDimensions;this.setAspectRatio(this.width*n,this.height*i),this.setAt(e*n,t*i,this.width*n,this.height*i),this.#Bn=!0,this.#Gn(),this.setDims(this.width*n,this.height*i),this.#Xn(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#Yn(),this.div}#Gn(){if(!this.#Bn)return;const[e,t]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),this.#ai()}setDimensions(e,t){const n=Math.round(e),i=Math.round(t);if(this.#Vn===n&&this.#Un===i)return;this.#Vn=n,this.#Un=i,this.canvas.style.visibility="hidden";const[r,s]=this.parentDimensions;this.width=e/r,this.height=t/s,this.fixAndSetPosition(),this.#Qn&&this.#ci(e,t),this.#Gn(),this.#Xn(),this.canvas.style.visibility="visible",this.fixDims()}#ci(e,t){const n=this.#hi(),i=(e-n)/this.#Mn,r=(t-n)/this.#Rn;this.scaleFactor=Math.min(i,r)}#ai(){const e=this.#hi()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}static#di(e){const t=new Path2D;for(let n=0,i=e.length;n<i;n++){const[i,r,s,o]=e[n];0===n&&t.moveTo(...i),t.bezierCurveTo(r[0],r[1],s[0],s[1],o[0],o[1])}return t}static#ui(e,t,n){const[i,r,s,o]=t;switch(n){case 0:for(let t=0,n=e.length;t<n;t+=2)e[t]+=i,e[t+1]=o-e[t+1];break;case 90:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=e[t+1]+i,e[t+1]=n+r}break;case 180:for(let t=0,n=e.length;t<n;t+=2)e[t]=s-e[t],e[t+1]+=r;break;case 270:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=s-e[t+1],e[t+1]=o-n}break;default:throw new Error("Invalid rotation")}return e}static#pi(e,t,n){const[i,r,s,o]=t;switch(n){case 0:for(let t=0,n=e.length;t<n;t+=2)e[t]-=i,e[t+1]=o-e[t+1];break;case 90:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=e[t+1]-r,e[t+1]=n-i}break;case 180:for(let t=0,n=e.length;t<n;t+=2)e[t]=s-e[t],e[t+1]-=r;break;case 270:for(let t=0,n=e.length;t<n;t+=2){const n=e[t];e[t]=o-e[t+1],e[t+1]=s-n}break;default:throw new Error("Invalid rotation")}return e}#fi(e,t,n,i){const r=[],s=this.thickness/2,o=e*t+s,a=e*n+s;for(const t of this.paths){const n=[],s=[];for(let i=0,r=t.length;i<r;i++){const[l,c,h,d]=t[i],u=e*l[0]+o,p=e*l[1]+a,f=e*c[0]+o,m=e*c[1]+a,g=e*h[0]+o,O=e*h[1]+a,y=e*d[0]+o,v=e*d[1]+a;0===i&&(n.push(u,p),s.push(u,p)),n.push(f,m,g,O,y,v),s.push(f,m),i===r-1&&s.push(y,v)}r.push({bezier:l.#ui(n,i,this.rotation),points:l.#ui(s,i,this.rotation)})}return r}#mi(){let e=1/0,t=-1/0,n=1/0,r=-1/0;for(const s of this.paths)for(const[o,a,l,c]of s){const s=i.Util.bezierBoundingBox(...o,...a,...l,...c);e=Math.min(e,s[0]),n=Math.min(n,s[1]),t=Math.max(t,s[2]),r=Math.max(r,s[3])}return[e,n,t,r]}#hi(){return this.#Qn?Math.ceil(this.thickness*this.parentScale):0}#qn(e=!1){if(this.isEmpty())return;if(!this.#Qn)return void this.#Xn();const t=this.#mi(),n=this.#hi();this.#Mn=Math.max(r.AnnotationEditor.MIN_SIZE,t[2]-t[0]),this.#Rn=Math.max(r.AnnotationEditor.MIN_SIZE,t[3]-t[1]);const i=Math.ceil(n+this.#Mn*this.scaleFactor),s=Math.ceil(n+this.#Rn*this.scaleFactor),[o,a]=this.parentDimensions;this.width=i/o,this.height=s/a,this.setAspectRatio(i,s);const l=this.translationX,c=this.translationY;this.translationX=-t[0],this.translationY=-t[1],this.#Gn(),this.#Xn(),this.#Vn=i,this.#Un=s,this.setDims(i,s);const h=e?n/this.scaleFactor/2:0;this.translate(l-this.translationX-h,c-this.translationY-h)}static deserialize(e,t,n){if(e instanceof s.InkAnnotationElement)return null;const o=super.deserialize(e,t,n);o.thickness=e.thickness,o.color=i.Util.makeHexColor(...e.color),o.opacity=e.opacity;const[a,c]=o.pageDimensions,h=o.width*a,d=o.height*c,u=o.parentScale,p=e.thickness/2;o.#Qn=!0,o.#Vn=Math.round(h),o.#Un=Math.round(d);const{paths:f,rect:m,rotation:g}=e;for(let{bezier:e}of f){e=l.#pi(e,m,g);const t=[];o.paths.push(t);let n=u*(e[0]-p),i=u*(e[1]-p);for(let r=2,s=e.length;r<s;r+=6){const s=u*(e[r]-p),o=u*(e[r+1]-p),a=u*(e[r+2]-p),l=u*(e[r+3]-p),c=u*(e[r+4]-p),h=u*(e[r+5]-p);t.push([[n,i],[s,o],[a,l],[c,h]]),n=c,i=h}const r=this.#di(t);o.bezierPath2D.push(r)}const O=o.#mi();return o.#Mn=Math.max(r.AnnotationEditor.MIN_SIZE,O[2]-O[0]),o.#Rn=Math.max(r.AnnotationEditor.MIN_SIZE,O[3]-O[1]),o.#ci(h,d),o}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),t=r.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:t,thickness:this.thickness,opacity:this.opacity,paths:this.#fi(this.scaleFactor/this.parentScale,this.translationX,this.translationY,e),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}t.InkEditor=l},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var i=n(1),r=n(4),s=n(6),o=n(29);class a extends r.AnnotationEditor{#gi=null;#Oi=null;#yi=null;#vi=null;#bi=null;#wi=null;#jn=null;#Si=null;#xi=!1;#Ci=!1;static _type="stamp";constructor(e){super({...e,name:"stampEditor"}),this.#vi=e.bitmapUrl,this.#bi=e.bitmapFile}static initialize(e){r.AnnotationEditor.initialize(e)}static get supportedTypes(){return(0,i.shadow)(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map((e=>`image/${e}`)))}static get supportedTypesStr(){return(0,i.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,t){t.pasteEditor(i.AnnotationEditorType.STAMP,{bitmapFile:e.getAsFile()})}#_i(e,t=!1){e?(this.#gi=e.bitmap,t||(this.#Oi=e.id,this.#xi=e.isSvg),this.#zn()):this.remove()}#Ei(){this.#yi=null,this._uiManager.enableWaiting(!1),this.#wi&&this.div.focus()}#Pi(){if(this.#Oi)return this._uiManager.enableWaiting(!0),void this._uiManager.imageManager.getFromId(this.#Oi).then((e=>this.#_i(e,!0))).finally((()=>this.#Ei()));if(this.#vi){const e=this.#vi;return this.#vi=null,this._uiManager.enableWaiting(!0),void(this.#yi=this._uiManager.imageManager.getFromUrl(e).then((e=>this.#_i(e))).finally((()=>this.#Ei())))}if(this.#bi){const e=this.#bi;return this.#bi=null,this._uiManager.enableWaiting(!0),void(this.#yi=this._uiManager.imageManager.getFromFile(e).then((e=>this.#_i(e))).finally((()=>this.#Ei())))}const e=document.createElement("input");e.type="file",e.accept=a.supportedTypesStr,this.#yi=new Promise((t=>{e.addEventListener("change",(async()=>{if(e.files&&0!==e.files.length){this._uiManager.enableWaiting(!0);const t=await this._uiManager.imageManager.getFromFile(e.files[0]);this.#_i(t)}else this.remove();t()})),e.addEventListener("cancel",(()=>{this.remove(),t()}))})).finally((()=>this.#Ei())),e.click()}remove(){this.#Oi&&(this.#gi=null,this._uiManager.imageManager.deleteId(this.#Oi),this.#wi?.remove(),this.#wi=null,this.#jn?.disconnect(),this.#jn=null),super.remove()}rebuild(){this.parent?(super.rebuild(),null!==this.div&&(this.#Oi&&this.#Pi(),this.isAttachedToDOM||this.parent.add(this))):this.#Oi&&this.#Pi()}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#yi||this.#gi||this.#vi||this.#bi)}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;if(this.width&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#gi?this.#zn():this.#Pi(),this.width){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i)}return this.div}#zn(){const{div:e}=this;let{width:t,height:n}=this.#gi;const[i,r]=this.pageDimensions,s=.75;if(this.width)t=this.width*i,n=this.height*r;else if(t>s*i||n>s*r){const e=Math.min(s*i/t,s*r/n);t*=e,n*=e}const[o,a]=this.parentDimensions;this.setDims(t*o/i,n*a/r),this._uiManager.enableWaiting(!1);const l=this.#wi=document.createElement("canvas");e.append(l),e.hidden=!1,this.#ki(t,n),this.#Yn(),this.#Ci||(this.parent.addUndoableEditor(this),this.#Ci=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#Ti(e,t){const[n,i]=this.parentDimensions;this.width=e/n,this.height=t/i,this.setDims(e,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,null!==this.#Si&&clearTimeout(this.#Si);this.#Si=setTimeout((()=>{this.#Si=null,this.#ki(e,t)}),200)}#Ai(e,t){const{width:n,height:i}=this.#gi;let r=n,s=i,o=this.#gi;for(;r>2*e||s>2*t;){const n=r,i=s;r>2*e&&(r=r>=16384?Math.floor(r/2)-1:Math.ceil(r/2)),s>2*t&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2));const a=new OffscreenCanvas(r,s);a.getContext("2d").drawImage(o,0,0,n,i,0,0,r,s),o=a.transferToImageBitmap()}return o}#ki(e,t){e=Math.ceil(e),t=Math.ceil(t);const n=this.#wi;if(!n||n.width===e&&n.height===t)return;n.width=e,n.height=t;const i=this.#xi?this.#gi:this.#Ai(e,t),r=n.getContext("2d");r.filter=this._uiManager.hcmFilter,r.drawImage(i,0,0,i.width,i.height,0,0,e,t)}#Ri(e){if(e){if(this.#xi){const e=this._uiManager.imageManager.getSvgUrl(this.#Oi);if(e)return e}const e=document.createElement("canvas");({width:e.width,height:e.height}=this.#gi);return e.getContext("2d").drawImage(this.#gi,0,0),e.toDataURL()}if(this.#xi){const[e,t]=this.pageDimensions,n=Math.round(this.width*e*s.PixelsPerInch.PDF_TO_CSS_UNITS),i=Math.round(this.height*t*s.PixelsPerInch.PDF_TO_CSS_UNITS),r=new OffscreenCanvas(n,i);return r.getContext("2d").drawImage(this.#gi,0,0,this.#gi.width,this.#gi.height,0,0,n,i),r.transferToImageBitmap()}return structuredClone(this.#gi)}#Yn(){this.#jn=new ResizeObserver((e=>{const t=e[0].contentRect;t.width&&t.height&&this.#Ti(t.width,t.height)})),this.#jn.observe(this.div)}static deserialize(e,t,n){if(e instanceof o.StampAnnotationElement)return null;const i=super.deserialize(e,t,n),{rect:r,bitmapUrl:s,bitmapId:a,isSvg:l,accessibilityData:c}=e;a&&n.imageManager.isValidId(a)?i.#Oi=a:i.#vi=s,i.#xi=l;const[h,d]=i.pageDimensions;return i.width=(r[2]-r[0])/h,i.height=(r[3]-r[1])/d,c&&(i.altTextData=c),i}serialize(e=!1,t=null){if(this.isEmpty())return null;const n={annotationType:i.AnnotationEditorType.STAMP,bitmapId:this.#Oi,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#xi,structTreeParentId:this._structTreeParentId};if(e)return n.bitmapUrl=this.#Ri(!0),n.accessibilityData=this.altTextData,n;const{decorative:r,altText:s}=this.altTextData;if(!r&&s&&(n.accessibilityData={type:"Figure",alt:s}),null===t)return n;t.stamps||=new Map;const o=this.#xi?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(t.stamps.has(this.#Oi)){if(this.#xi){const e=t.stamps.get(this.#Oi);o>e.area&&(e.area=o,e.serialized.bitmap.close(),e.serialized.bitmap=this.#Ri(!1))}}else t.stamps.set(this.#Oi,{area:o,serialized:n}),n.bitmap=this.#Ri(!1);return n}}t.StampEditor=a}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](n,n.exports,__w_pdfjs_require__),n.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return s.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return o.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return i.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return l.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return n.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return n.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return n.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return c.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return n.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return n.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return i.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return r.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return r.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return n.version}});var t=__w_pdfjs_require__(1),n=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),r=__w_pdfjs_require__(26),s=__w_pdfjs_require__(27),o=__w_pdfjs_require__(5),a=__w_pdfjs_require__(29),l=__w_pdfjs_require__(14),c=__w_pdfjs_require__(32)})(),__webpack_exports__})()))})(pdf);var pdfExports=pdf.exports,pdfjsLib=getDefaultExportFromCjs(pdfExports),pdf_viewer={exports:{}};
/**
 * @licstart The following is the entire license notice for the
 * JavaScript code in this page
 *
 * Copyright 2023 Mozilla Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * @licend The above is the entire license notice for the
 * JavaScript code in this page
 */
!function(e,t){!function(t,n){e.exports=t.pdfjsViewer=n()}(globalThis,(()=>(()=>{var e=[,(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFindController=t.FindState=void 0;var i=n(2),r=n(3),s=n(4);const o={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3};t.FindState=o;const a={"":"-","":"'","":"'","":"'","":"'","":'"',"":'"',"":'"',"":'"',"":"1/4","":"1/2","":"3/4"},l=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let c;const h=/\p{M}+/gu,d=/([.*+?^${}()|[\]\\])|(\p{P})|(\s+)|(\p{M})|(\p{L})/gu,u=/([^\p{M}])\p{M}*$/u,p=/^\p{M}*([^\p{M}])/u,f=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,m=new Map,g=new Map;let O=null,y=null;function v(e){const t=[];let n,i;for(;null!==(n=f.exec(e));){let{index:e}=n;for(const i of n[0]){let n=m.get(i);n||(n=i.normalize("NFD").length,m.set(i,n)),t.push([n,e++])}}if(0===t.length&&O)i=O;else if(t.length>0&&y)i=y;else{const e=`([${Object.keys(a).join("")}])|([${(0,r.getNormalizeWithNFKC)()}])|(${"(?:|)"}\\n)|(\\p{M}+(?:-\\n)?)|(\\S-\\n)|(${"(?:\\p{Ideographic}|[-])"}\\n)|(\\n)`;i=0===t.length?O=new RegExp(e+"|(\\u0000)","gum"):y=new RegExp(e+"|([\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f])","gum")}const s=[];for(;null!==(n=h.exec(e));)s.push([n[0].length,n.index]);let o=e.normalize("NFD");const l=[[0,0]];let c=0,d=0,u=0,p=0,v=0,b=!1;return o=o.replace(i,((e,n,i,r,o,h,f,m,O,y)=>{if(y-=p,n){const e=a[n],t=e.length;for(let e=1;e<t;e++)l.push([y-u+e,u-e]);return u-=t-1,e}if(i){let e=g.get(i);e||(e=i.normalize("NFKC"),g.set(i,e));const t=e.length;for(let e=1;e<t;e++)l.push([y-u+e,u-e]);return u-=t-1,e}if(r)return b=!0,y+v===s[c]?.[1]?++c:(l.push([y-1-u+1,u-1]),u-=1,p+=1),l.push([y-u+1,u]),p+=1,v+=1,r.charAt(0);if(o){const e=o.endsWith("\n"),t=e?o.length-2:o.length;b=!0;let n=t;y+v===s[c]?.[1]&&(n-=s[c][0],++c);for(let e=1;e<=n;e++)l.push([y-1-u+e,u-e]);return u-=n,p+=n,e?(y+=t-1,l.push([y-u+1,1+u]),u+=1,p+=1,v+=1,o.slice(0,t)):o}if(h){const e=h.length-2;return l.push([y-u+e,1+u]),u+=1,p+=1,v+=1,h.slice(0,-2)}if(f){const e=f.length-1;return l.push([y-u+e,u]),p+=1,v+=1,f.slice(0,-1)}if(m)return l.push([y-u+1,u-1]),u-=1,p+=1,v+=1," ";if(y+v===t[d]?.[1]){const e=t[d][0]-1;++d;for(let t=1;t<=e;t++)l.push([y-(u-t),u-t]);u-=e,p+=e}return O})),l.push([o.length,u]),[o,l,b]}function b(e,t,n){if(!e)return[t,n];const r=t,s=t+n-1;let o=(0,i.binarySearchFirstItem)(e,(e=>e[0]>=r));e[o][0]>r&&--o;let a=(0,i.binarySearchFirstItem)(e,(e=>e[0]>=s),o);e[a][0]>s&&--a;const l=r+e[o][1];return[l,s+e[a][1]+1-l]}t.PDFFindController=class{#Mi=null;#Ii=!0;#Li=0;constructor({linkService:e,eventBus:t,updateMatchesCountOnProgress:n=!0}){this._linkService=e,this._eventBus=t,this.#Ii=n,this.onIsPageVisible=null,this.#$i(),t._on("find",this.#Di.bind(this)),t._on("findbarclose",this.#Ni.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#Mi}setDocument(e){this._pdfDocument&&this.#$i(),e&&(this._pdfDocument=e,this._firstPageCapability.resolve())}#Di(e){if(!e)return;!1===e.phraseSearch&&(console.error("The `phraseSearch`-parameter was removed, please provide an Array of strings in the `query`-parameter instead."),"string"==typeof e.query&&(e.query=e.query.match(/\S+/g)));const t=this._pdfDocument,{type:n}=e;(null===this.#Mi||this.#Qi(e))&&(this._dirtyMatch=!0),this.#Mi=e,"highlightallchange"!==n&&this.#Fi(o.PENDING),this._firstPageCapability.promise.then((()=>{if(!this._pdfDocument||t&&this._pdfDocument!==t)return;this.#zt();const e=!this._highlightMatches,i=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),n?this._dirtyMatch?this.#Bi():"again"===n?(this.#Bi(),e&&this.#Mi.highlightAll&&this.#ji()):"highlightallchange"===n?(i?this.#Bi():this._highlightMatches=!0,this.#ji()):this.#Bi():this._findTimeout=setTimeout((()=>{this.#Bi(),this._findTimeout=null}),250)}))}scrollMatchIntoView({element:e=null,selectedLeft:t=0,pageIndex:n=-1,matchIndex:r=-1}){if(!this._scrollMatches||!e)return;if(-1===r||r!==this._selected.matchIdx)return;if(-1===n||n!==this._selected.pageIdx)return;this._scrollMatches=!1;const s={top:-50,left:t+-400};(0,i.scrollIntoView)(e,s,!0)}#$i(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#Li=0,this.#Mi=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=new s.PromiseCapability}get#Vi(){const{query:e}=this.#Mi;return"string"==typeof e?(e!==this._rawQuery&&(this._rawQuery=e,[this._normalizedQuery]=v(e)),this._normalizedQuery):(e||[]).filter((e=>!!e)).map((e=>v(e)[0]))}#Qi(e){const t=e.query,n=this.#Mi.query,i=typeof t;if(i!==typeof n)return!0;if("string"===i){if(t!==n)return!0}else if(JSON.stringify(t)!==JSON.stringify(n))return!0;switch(e.type){case"again":const e=this._selected.pageIdx+1,t=this._linkService;return e>=1&&e<=t.pagesCount&&e!==t.page&&!(this.onIsPageVisible?.(e)??1);case"highlightallchange":return!1}return!0}#Ui(e,t,n){let i=e.slice(0,t).match(u);if(i){const n=e.charCodeAt(t),s=i[1].charCodeAt(0);if((0,r.getCharacterType)(n)===(0,r.getCharacterType)(s))return!1}if(i=e.slice(t+n).match(p),i){const s=e.charCodeAt(t+n-1),o=i[1].charCodeAt(0);if((0,r.getCharacterType)(s)===(0,r.getCharacterType)(o))return!1}return!0}#Wi(e,t,n,i){const r=this._pageMatches[n]=[],s=this._pageMatchesLength[n]=[];if(!e)return;const o=this._pageDiffs[n];let a;for(;null!==(a=e.exec(i));){if(t&&!this.#Ui(i,a.index,a[0].length))continue;const[e,n]=b(o,a.index,a[0].length);n&&(r.push(e),s.push(n))}}#Zi(e,t){const{matchDiacritics:n}=this.#Mi;let i=!1;const r="[ ]*";return(e=e.replaceAll(d,((e,r,s,o,a,c)=>r?`[ ]*\\${r}[ ]*`:s?`[ ]*${s}[ ]*`:o?"[ ]+":n?a||c:a?l.has(a.charCodeAt(0))?a:"":t?(i=!0,`${c}\\p{M}*`):c))).endsWith(r)&&(e=e.slice(0,e.length-4)),n&&t&&(c||=String.fromCharCode(...l),i=!0,e=`${e}(?=[${c}]|[^\\p{M}]|$)`),[i,e]}#Hi(e){let t=this.#Vi;if(0===t.length)return;const{caseSensitive:n,entireWord:i}=this.#Mi,r=this._pageContents[e],s=this._hasDiacritics[e];let o=!1;"string"==typeof t?[o,t]=this.#Zi(t,s):t=t.sort().reverse().map((e=>{const[t,n]=this.#Zi(e,s);return o||=t,`(${n})`})).join("|");t=t?new RegExp(t,`g${o?"u":""}${n?"":"i"}`):null,this.#Wi(t,i,e,r),this.#Mi.highlightAll&&this.#qi(e),this._resumePageIdx===e&&(this._resumePageIdx=null,this.#Xi());const a=this._pageMatches[e].length;this._matchesCountTotal+=a,this.#Ii?a>0&&this.#zi():++this.#Li===this._linkService.pagesCount&&this.#zi()}#zt(){if(this._extractTextPromises.length>0)return;let e=Promise.resolve();const t={disableNormalization:!0};for(let n=0,i=this._linkService.pagesCount;n<i;n++){const i=new s.PromiseCapability;this._extractTextPromises[n]=i.promise,e=e.then((()=>this._pdfDocument.getPage(n+1).then((e=>e.getTextContent(t))).then((e=>{const t=[];for(const n of e.items)t.push(n.str),n.hasEOL&&t.push("\n");[this._pageContents[n],this._pageDiffs[n],this._hasDiacritics[n]]=v(t.join("")),i.resolve()}),(e=>{console.error(`Unable to get text content for page ${n+1}`,e),this._pageContents[n]="",this._pageDiffs[n]=null,this._hasDiacritics[n]=!1,i.resolve()}))))}}#qi(e){this._scrollMatches&&this._selected.pageIdx===e&&(this._linkService.page=e+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:e})}#ji(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#Bi(){const e=this.#Mi.findPrevious,t=this._linkService.page-1,n=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=t,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#Li=0,this._matchesCountTotal=0,this.#ji();for(let e=0;e<n;e++)this._pendingFindMatches.has(e)||(this._pendingFindMatches.add(e),this._extractTextPromises[e].then((()=>{this._pendingFindMatches.delete(e),this.#Hi(e)})))}if(0===this.#Vi.length)return void this.#Fi(o.FOUND);if(this._resumePageIdx)return;const i=this._offset;if(this._pagesToSearch=n,null!==i.matchIdx){const t=this._pageMatches[i.pageIdx].length;if(!e&&i.matchIdx+1<t||e&&i.matchIdx>0)return i.matchIdx=e?i.matchIdx-1:i.matchIdx+1,void this.#Yi(!0);this.#Gi(e)}this.#Xi()}#Ki(e){const t=this._offset,n=e.length,i=this.#Mi.findPrevious;return n?(t.matchIdx=i?n-1:0,this.#Yi(!0),!0):(this.#Gi(i),!!(t.wrapped&&(t.matchIdx=null,this._pagesToSearch<0))&&(this.#Yi(!1),!0))}#Xi(){null!==this._resumePageIdx&&console.error("There can only be one pending page.");let e=null;do{const t=this._offset.pageIdx;if(e=this._pageMatches[t],!e){this._resumePageIdx=t;break}}while(!this.#Ki(e))}#Gi(e){const t=this._offset,n=this._linkService.pagesCount;t.pageIdx=e?t.pageIdx-1:t.pageIdx+1,t.matchIdx=null,this._pagesToSearch--,(t.pageIdx>=n||t.pageIdx<0)&&(t.pageIdx=e?n-1:0,t.wrapped=!0)}#Yi(e=!1){let t=o.NOT_FOUND;const n=this._offset.wrapped;if(this._offset.wrapped=!1,e){const e=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,t=n?o.WRAPPED:o.FOUND,-1!==e&&e!==this._selected.pageIdx&&this.#qi(e)}this.#Fi(t,this.#Mi.findPrevious),-1!==this._selected.pageIdx&&(this._scrollMatches=!0,this.#qi(this._selected.pageIdx))}#Ni(e){const t=this._pdfDocument;this._firstPageCapability.promise.then((()=>{!this._pdfDocument||t&&this._pdfDocument!==t||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#Fi(o.FOUND),this._highlightMatches=!1,this.#ji())}))}#Ji(){const{pageIdx:e,matchIdx:t}=this._selected;let n=0,i=this._matchesCountTotal;if(-1!==t){for(let t=0;t<e;t++)n+=this._pageMatches[t]?.length||0;n+=t+1}return(n<1||n>i)&&(n=i=0),{current:n,total:i}}#zi(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#Ji()})}#Fi(e,t=!1){(this.#Ii||this.#Li===this._linkService.pagesCount&&e!==o.PENDING)&&this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:e,previous:t,matchesCount:this.#Ji(),rawQuery:this.#Mi?.query??null})}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.animationStarted=t.VERTICAL_PADDING=t.UNKNOWN_SCALE=t.TextLayerMode=t.SpreadMode=t.SidebarView=t.ScrollMode=t.SCROLLBAR_PADDING=t.RenderingStates=t.ProgressBar=t.PresentationModeState=t.OutputScale=t.MIN_SCALE=t.MAX_SCALE=t.MAX_AUTO_SCALE=t.DEFAULT_SCALE_VALUE=t.DEFAULT_SCALE_DELTA=t.DEFAULT_SCALE=t.CursorTool=t.AutoPrintRegExp=void 0,t.apiPageLayoutToViewerModes=function(e){let t=i.VERTICAL,n=r.NONE;switch(e){case"SinglePage":t=i.PAGE;break;case"OneColumn":break;case"TwoPageLeft":t=i.PAGE;case"TwoColumnLeft":n=r.ODD;break;case"TwoPageRight":t=i.PAGE;case"TwoColumnRight":n=r.EVEN}return{scrollMode:t,spreadMode:n}},t.apiPageModeToSidebarView=function(e){switch(e){case"UseNone":return n.NONE;case"UseThumbs":return n.THUMBS;case"UseOutlines":return n.OUTLINE;case"UseAttachments":return n.ATTACHMENTS;case"UseOC":return n.LAYERS}return n.NONE},t.approximateFraction=function(e){if(Math.floor(e)===e)return[e,1];const t=1/e;if(t>8)return[1,8];if(Math.floor(t)===t)return[1,t];const n=e>1?t:e;let i,r=0,s=1,o=1,a=1;for(;;){const e=r+o,t=s+a;if(t>8)break;n<=e/t?(o=e,a=t):(r=e,s=t)}i=n-r/s<o/a-n?n===e?[r,s]:[s,r]:n===e?[o,a]:[a,o];return i},t.backtrackBeforeAllVisibleElements=a,t.binarySearchFirstItem=o,t.docStyle=void 0,t.getActiveOrFocusedElement=function(){let e=document,t=e.activeElement||e.querySelector(":focus");for(;t?.shadowRoot;)e=t.shadowRoot,t=e.activeElement||e.querySelector(":focus");return t},t.getPageSizeInches=function({view:e,userUnit:t,rotate:n}){const[i,r,s,o]=e,a=n%180!=0,l=(s-i)/72*t,c=(o-r)/72*t;return{width:a?c:l,height:a?l:c}},t.getVisibleElements=function({scrollEl:e,views:t,sortByVisibility:n=!1,horizontal:i=!1,rtl:r=!1}){const s=e.scrollTop,l=s+e.clientHeight,c=e.scrollLeft,h=c+e.clientWidth;const d=[],u=new Set,p=t.length;let f=o(t,i?function(e){const t=e.div,n=t.offsetLeft+t.clientLeft,i=n+t.clientWidth;return r?n<h:i>c}:function(e){const t=e.div;return t.offsetTop+t.clientTop+t.clientHeight>s});f>0&&f<p&&!i&&(f=a(f,t,s));let m=i?h:-1;for(let e=f;e<p;e++){const n=t[e],r=n.div,o=r.offsetLeft+r.clientLeft,a=r.offsetTop+r.clientTop,p=r.clientWidth,f=r.clientHeight,g=o+p,O=a+f;if(-1===m)O>=l&&(m=O);else if((i?o:a)>m)break;if(O<=s||a>=l||g<=c||o>=h)continue;const y=Math.max(0,s-a)+Math.max(0,O-l),v=(p-(Math.max(0,c-o)+Math.max(0,g-h)))/p,b=(f-y)/f*v*100|0;d.push({id:n.id,x:o,y:a,view:n,percent:b,widthPercent:100*v|0}),u.add(n.id)}const g=d[0],O=d.at(-1);n&&d.sort((function(e,t){const n=e.percent-t.percent;return Math.abs(n)>.001?-n:e.id-t.id}));return{first:g,last:O,views:d,ids:u}},t.isPortraitOrientation=function(e){return e.width<=e.height},t.isValidRotation=function(e){return Number.isInteger(e)&&e%90==0},t.isValidScrollMode=function(e){return Number.isInteger(e)&&Object.values(i).includes(e)&&e!==i.UNKNOWN},t.isValidSpreadMode=function(e){return Number.isInteger(e)&&Object.values(r).includes(e)&&e!==r.UNKNOWN},t.normalizeWheelEventDelta=function(e){const t=e.deltaMode;let n=l(e);t===WheelEvent.DOM_DELTA_PIXEL?n/=900:t===WheelEvent.DOM_DELTA_LINE&&(n/=30);return n},t.normalizeWheelEventDirection=l,t.parseQueryString=function(e){const t=new Map;for(const[n,i]of new URLSearchParams(e))t.set(n.toLowerCase(),i);return t},t.removeNullCharacters=function(e,t=!1){if("string"!=typeof e)return console.error("The argument must be a string."),e;t&&(e=e.replaceAll(s," "));return e.replaceAll("\0","")},t.roundToDivide=function(e,t){const n=e%t;return 0===n?e:Math.round(e-n+t)},t.scrollIntoView=function(e,t,n=!1){let i=e.offsetParent;if(!i)return void console.error("offsetParent is not set -- cannot scroll");let r=e.offsetTop+e.clientTop,s=e.offsetLeft+e.clientLeft;for(;i.clientHeight===i.scrollHeight&&i.clientWidth===i.scrollWidth||n&&(i.classList.contains("markedContent")||"hidden"===getComputedStyle(i).overflow);)if(r+=i.offsetTop,s+=i.offsetLeft,i=i.offsetParent,!i)return;t&&(void 0!==t.top&&(r+=t.top),void 0!==t.left&&(s+=t.left,i.scrollLeft=s));i.scrollTop=r},t.toggleCheckedBtn=function(e,t,n=null){e.classList.toggle("toggled",t),e.setAttribute("aria-checked",t),n?.classList.toggle("hidden",!t)},t.toggleExpandedBtn=function(e,t,n=null){e.classList.toggle("toggled",t),e.setAttribute("aria-expanded",t),n?.classList.toggle("hidden",!t)},t.watchScroll=function(e,t){const n=function(n){r||(r=window.requestAnimationFrame((function(){r=null;const n=e.scrollLeft,s=i.lastX;n!==s&&(i.right=n>s),i.lastX=n;const o=e.scrollTop,a=i.lastY;o!==a&&(i.down=o>a),i.lastY=o,t(i)})))},i={right:!0,down:!0,lastX:e.scrollLeft,lastY:e.scrollTop,_eventHandler:n};let r=null;return e.addEventListener("scroll",n,!0),i};t.DEFAULT_SCALE_VALUE="auto";t.DEFAULT_SCALE=1;t.DEFAULT_SCALE_DELTA=1.1;t.MIN_SCALE=.1;t.MAX_SCALE=10;t.UNKNOWN_SCALE=0;t.MAX_AUTO_SCALE=1.25;t.SCROLLBAR_PADDING=40;t.VERTICAL_PADDING=5;t.RenderingStates={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};t.PresentationModeState={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3};const n={UNKNOWN:-1,NONE:0,THUMBS:1,OUTLINE:2,ATTACHMENTS:3,LAYERS:4};t.SidebarView=n;t.TextLayerMode={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2};const i={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3};t.ScrollMode=i;const r={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};t.SpreadMode=r;t.CursorTool={SELECT:0,HAND:1,ZOOM:2};t.AutoPrintRegExp=/\bprint\s*\(/;t.OutputScale=class{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return 1!==this.sx||1!==this.sy}};const s=/[\x01-\x1F]/g;function o(e,t,n=0){let i=n,r=e.length-1;if(r<0||!t(e[r]))return e.length;if(t(e[i]))return i;for(;i<r;){const n=i+r>>1;t(e[n])?r=n:i=n+1}return i}function a(e,t,n){if(e<2)return e;let i=t[e].div,r=i.offsetTop+i.clientTop;r>=n&&(i=t[e-1].div,r=i.offsetTop+i.clientTop);for(let n=e-2;n>=0&&(i=t[n].div,!(i.offsetTop+i.clientTop+i.clientHeight<=r));--n)e=n;return e}function l(e){let t=Math.hypot(e.deltaX,e.deltaY);const n=Math.atan2(e.deltaY,e.deltaX);return-.25*Math.PI<n&&n<.75*Math.PI&&(t=-t),t}const c=new Promise((function(e){window.requestAnimationFrame(e)}));t.animationStarted=c;const h=document.documentElement.style;t.docStyle=h;t.ProgressBar=class{#er=null;#tr=null;#nr=0;#ir=null;#gt=!0;constructor(e){this.#er=e.classList,this.#ir=e.style}get percent(){return this.#nr}set percent(e){this.#nr=function(e,t,n){return Math.min(Math.max(e,t),n)}(e,0,100),isNaN(e)?this.#er.add("indeterminate"):(this.#er.remove("indeterminate"),this.#ir.setProperty("--progressBar-percent",`${this.#nr}%`))}setWidth(e){if(!e)return;const t=e.parentNode.offsetWidth-e.offsetWidth;t>0&&this.#ir.setProperty("--progressBar-end-offset",`${t}px`)}setDisableAutoFetch(e=5e3){isNaN(this.#nr)||(this.#tr&&clearTimeout(this.#tr),this.show(),this.#tr=setTimeout((()=>{this.#tr=null,this.hide()}),e))}hide(){this.#gt&&(this.#gt=!1,this.#er.add("hidden"))}show(){this.#gt||(this.#gt=!0,this.#er.remove("hidden"))}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterType=void 0,t.getCharacterType=function(e){if(function(e){return e<11904}(e))return function(e){return 0==(65408&e)}(e)?function(e){return 32===e||9===e||13===e||10===e}(e)?n.SPACE:function(e){return e>=97&&e<=122||e>=65&&e<=90}(e)||function(e){return e>=48&&e<=57}(e)||95===e?n.ALPHA_LETTER:n.PUNCT:function(e){return 3584==(65408&e)}(e)?n.THAI_LETTER:160===e?n.SPACE:n.ALPHA_LETTER;if(function(e){return e>=13312&&e<=40959||e>=63744&&e<=64255}(e))return n.HAN_LETTER;if(function(e){return e>=12448&&e<=12543}(e))return n.KATAKANA_LETTER;if(function(e){return e>=12352&&e<=12447}(e))return n.HIRAGANA_LETTER;if(function(e){return e>=65376&&e<=65439}(e))return n.HALFWIDTH_KATAKANA_LETTER;return n.ALPHA_LETTER},t.getNormalizeWithNFKC=function(){return i||="---------------------------------------------------------------------------------------------------",i};const n={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};let i;t.CharacterType=n},e=>{e.exports=globalThis.pdfjsLib},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleLinkService=t.PDFLinkService=t.LinkTarget=void 0;var i=n(2);const r={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function s(e,{url:t,target:n,rel:i,enabled:s=!0}={}){if(!t||"string"!=typeof t)throw new Error('A valid "url" parameter must provided.');s?e.href=e.title=t:(e.href="",e.title=`Disabled: ${t}`,e.onclick=()=>!1);let o="";switch(n){case r.NONE:break;case r.SELF:o="_self";break;case r.BLANK:o="_blank";break;case r.PARENT:o="_parent";break;case r.TOP:o="_top"}e.target=o,e.rel="string"==typeof i?i:"noopener noreferrer nofollow"}t.LinkTarget=r;class o{#rr=new Map;constructor({eventBus:e,externalLinkTarget:t=null,externalLinkRel:n=null,ignoreDestinationZoom:i=!1}={}){this.eventBus=e,this.externalLinkTarget=t,this.externalLinkRel=n,this.externalLinkEnabled=!0,this._ignoreDestinationZoom=i,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(e,t=null){this.baseUrl=t,this.pdfDocument=e,this.#rr.clear()}setViewer(e){this.pdfViewer=e}setHistory(e){this.pdfHistory=e}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfViewer.currentPageNumber}set page(e){this.pdfViewer.currentPageNumber=e}get rotation(){return this.pdfViewer.pagesRotation}set rotation(e){this.pdfViewer.pagesRotation=e}get isInPresentationMode(){return this.pdfViewer.isInPresentationMode}#sr(e,t=null,n){const i=n[0];let r;if("object"==typeof i&&null!==i){if(r=this._cachedPageNumber(i),!r)return void this.pdfDocument.getPageIndex(i).then((r=>{this.cachePageRef(r+1,i),this.#sr(e,t,n)})).catch((()=>{console.error(`PDFLinkService.#goToDestinationHelper: "${i}" is not a valid page reference, for dest="${e}".`)}))}else{if(!Number.isInteger(i))return void console.error(`PDFLinkService.#goToDestinationHelper: "${i}" is not a valid destination reference, for dest="${e}".`);r=i+1}!r||r<1||r>this.pagesCount?console.error(`PDFLinkService.#goToDestinationHelper: "${r}" is not a valid page number, for dest="${e}".`):(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:t,explicitDest:n,pageNumber:r})),this.pdfViewer.scrollPageIntoView({pageNumber:r,destArray:n,ignoreDestinationZoom:this._ignoreDestinationZoom}))}async goToDestination(e){if(!this.pdfDocument)return;let t,n;"string"==typeof e?(t=e,n=await this.pdfDocument.getDestination(e)):(t=null,n=await e),Array.isArray(n)?this.#sr(e,t,n):console.error(`PDFLinkService.goToDestination: "${n}" is not a valid destination array, for dest="${e}".`)}goToPage(e){if(!this.pdfDocument)return;const t="string"==typeof e&&this.pdfViewer.pageLabelToPageNumber(e)||0|e;Number.isInteger(t)&&t>0&&t<=this.pagesCount?(this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(t)),this.pdfViewer.scrollPageIntoView({pageNumber:t})):console.error(`PDFLinkService.goToPage: "${e}" is not a valid page.`)}addLinkAttributes(e,t,n=!1){s(e,{url:t,target:n?r.BLANK:this.externalLinkTarget,rel:this.externalLinkRel,enabled:this.externalLinkEnabled})}getDestinationHash(e){if("string"==typeof e){if(e.length>0)return this.getAnchorUrl("#"+escape(e))}else if(Array.isArray(e)){const t=JSON.stringify(e);if(t.length>0)return this.getAnchorUrl("#"+escape(t))}return this.getAnchorUrl("")}getAnchorUrl(e){return this.baseUrl?this.baseUrl+e:e}setHash(e){if(!this.pdfDocument)return;let t,n;if(e.includes("=")){const r=(0,i.parseQueryString)(e);if(r.has("search")){const e=r.get("search").replaceAll('"',""),t="true"===r.get("phrase");this.eventBus.dispatch("findfromurlhash",{source:this,query:t?e:e.match(/\S+/g)})}if(r.has("page")&&(t=0|r.get("page")||1),r.has("zoom")){const e=r.get("zoom").split(","),t=e[0],i=parseFloat(t);t.includes("Fit")?"Fit"===t||"FitB"===t?n=[null,{name:t}]:"FitH"===t||"FitBH"===t||"FitV"===t||"FitBV"===t?n=[null,{name:t},e.length>1?0|e[1]:null]:"FitR"===t?5!==e.length?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):n=[null,{name:t},0|e[1],0|e[2],0|e[3],0|e[4]]:console.error(`PDFLinkService.setHash: "${t}" is not a valid zoom value.`):n=[null,{name:"XYZ"},e.length>1?0|e[1]:null,e.length>2?0|e[2]:null,i?i/100:t]}n?this.pdfViewer.scrollPageIntoView({pageNumber:t||this.page,destArray:n,allowNegativeOffset:!0}):t&&(this.page=t),r.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:r.get("pagemode")}),r.has("nameddest")&&this.goToDestination(r.get("nameddest"))}else{n=unescape(e);try{n=JSON.parse(n),Array.isArray(n)||(n=n.toString())}catch{}if("string"==typeof n||o.#or(n))return void this.goToDestination(n);console.error(`PDFLinkService.setHash: "${unescape(e)}" is not a valid destination.`)}}executeNamedAction(e){switch(e){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1}this.eventBus.dispatch("namedaction",{source:this,action:e})}async executeSetOCGState(e){const t=this.pdfDocument,n=await this.pdfViewer.optionalContentConfigPromise;if(t!==this.pdfDocument)return;let i;for(const t of e.state){switch(t){case"ON":case"OFF":case"Toggle":i=t;continue}switch(i){case"ON":n.setVisibility(t,!0);break;case"OFF":n.setVisibility(t,!1);break;case"Toggle":const e=n.getGroup(t);e&&n.setVisibility(t,!e.visible)}}this.pdfViewer.optionalContentConfigPromise=Promise.resolve(n)}cachePageRef(e,t){if(!t)return;const n=0===t.gen?`${t.num}R`:`${t.num}R${t.gen}`;this.#rr.set(n,e)}_cachedPageNumber(e){if(!e)return null;const t=0===e.gen?`${e.num}R`:`${e.num}R${e.gen}`;return this.#rr.get(t)||null}static#or(e){if(!Array.isArray(e))return!1;const t=e.length;if(t<2)return!1;const n=e[0];if(!("object"==typeof n&&Number.isInteger(n.num)&&Number.isInteger(n.gen)||Number.isInteger(n)&&n>=0))return!1;const i=e[1];if("object"!=typeof i||"string"!=typeof i.name)return!1;let r=!0;switch(i.name){case"XYZ":if(5!==t)return!1;break;case"Fit":case"FitB":return 2===t;case"FitH":case"FitBH":case"FitV":case"FitBV":if(3!==t)return!1;break;case"FitR":if(6!==t)return!1;r=!1;break;default:return!1}for(let n=2;n<t;n++){const t=e[n];if(!("number"==typeof t||r&&null===t))return!1}return!0}}t.PDFLinkService=o;t.SimpleLinkService=class{constructor(){this.externalLinkEnabled=!0}get pagesCount(){return 0}get page(){return 0}set page(e){}get rotation(){return 0}set rotation(e){}get isInPresentationMode(){return!1}async goToDestination(e){}goToPage(e){}addLinkAttributes(e,t,n=!1){s(e,{url:t,enabled:this.externalLinkEnabled})}getDestinationHash(e){return"#"}getAnchorUrl(e){return"#"}setHash(e){}executeNamedAction(e){}executeSetOCGState(e){}cachePageRef(e,t){}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayerBuilder=void 0;var i=n(4),r=n(7),s=n(2);t.AnnotationLayerBuilder=class{#ar=null;constructor({pageDiv:e,pdfPage:t,linkService:n,downloadManager:i,annotationStorage:s=null,imageResourcesPath:o="",renderForms:a=!0,l10n:l=r.NullL10n,enableScripting:c=!1,hasJSActionsPromise:h=null,fieldObjectsPromise:d=null,annotationCanvasMap:u=null,accessibilityManager:p=null}){this.pageDiv=e,this.pdfPage=t,this.linkService=n,this.downloadManager=i,this.imageResourcesPath=o,this.renderForms=a,this.l10n=l,this.annotationStorage=s,this.enableScripting=c,this._hasJSActionsPromise=h||Promise.resolve(!1),this._fieldObjectsPromise=d||Promise.resolve(null),this._annotationCanvasMap=u,this._accessibilityManager=p,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=n.eventBus}async render(e,t="display"){if(this.div){if(this._cancelled||!this.annotationLayer)return;return void this.annotationLayer.update({viewport:e.clone({dontFlip:!0})})}const[n,r,o]=await Promise.all([this.pdfPage.getAnnotations({intent:t}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const a=this.div=document.createElement("div");a.className="annotationLayer",this.pageDiv.append(a),0!==n.length?(this.annotationLayer=new i.AnnotationLayer({div:a,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,l10n:this.l10n,page:this.pdfPage,viewport:e.clone({dontFlip:!0})}),await this.annotationLayer.render({annotations:n,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableScripting:this.enableScripting,hasJSActions:r,fieldObjects:o}),this.linkService.isInPresentationMode&&this.#lr(s.PresentationModeState.FULLSCREEN),this.#ar||(this.#ar=e=>{this.#lr(e.state)},this._eventBus?._on("presentationmodechanged",this.#ar))):this.hide()}cancel(){this._cancelled=!0,this.#ar&&(this._eventBus?._off("presentationmodechanged",this.#ar),this.#ar=null)}hide(){this.div&&(this.div.hidden=!0)}#lr(e){if(!this.div)return;let t=!1;switch(e){case s.PresentationModeState.FULLSCREEN:t=!0;break;case s.PresentationModeState.NORMAL:break;default:return}for(const e of this.div.childNodes)e.hasAttribute("data-internal-link")||(e.inert=t)}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=i;const n={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};function i(e,t){switch(e){case"find_match_count":e=`find_match_count[${1===t.total?"one":"other"}]`;break;case"find_match_count_limit":e=`find_match_count_limit[${1===t.limit?"one":"other"}]`}return n[e]||""}n.print_progress_percent="{{progress}}%";const r={getLanguage:async()=>"en-us",getDirection:async()=>"ltr",get:async(e,t=null,n=i(e,t))=>function(e,t){return t?e.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,((e,n)=>n in t?t[n]:"{{"+n+"}}")):e}(n,t),async translate(e){}};t.NullL10n=r},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DownloadManager=void 0;var i=n(4);function r(e,t){const n=document.createElement("a");if(!n.click)throw new Error('DownloadManager: "a.click()" is not supported.');n.href=e,n.target="_parent","download"in n&&(n.download=t),(document.body||document.documentElement).append(n),n.click(),n.remove()}t.DownloadManager=class{#cr=new WeakMap;downloadUrl(e,t,n){(0,i.createValidAbsoluteUrl)(e,"http://example.com")?r(e+"#pdfjs.action=download",t):console.error(`downloadUrl - not a valid URL: ${e}`)}downloadData(e,t,n){r(URL.createObjectURL(new Blob([e],{type:n})),t)}openOrDownloadData(e,t,n){const r=(0,i.isPdfFile)(n)?"application/pdf":"";return this.downloadData(t,n,r),!1}download(e,t,n,i){r(URL.createObjectURL(e),n)}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WaitOnType=t.EventBus=t.AutomationEventBus=void 0,t.waitOnEventOrTimeout=function({target:e,name:t,delay:r=0}){return new Promise((function(s,o){if("object"!=typeof e||!t||"string"!=typeof t||!(Number.isInteger(r)&&r>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");function a(n){e instanceof i?e._off(t,l):e.removeEventListener(t,l),h&&clearTimeout(h),s(n)}const l=a.bind(null,n.EVENT);e instanceof i?e._on(t,l):e.addEventListener(t,l);const c=a.bind(null,n.TIMEOUT),h=setTimeout(c,r)}))};const n={EVENT:"event",TIMEOUT:"timeout"};t.WaitOnType=n;class i{#o=Object.create(null);on(e,t,n=null){this._on(e,t,{external:!0,once:n?.once})}off(e,t,n=null){this._off(e,t,{external:!0,once:n?.once})}dispatch(e,t){const n=this.#o[e];if(!n||0===n.length)return;let i;for(const{listener:r,external:s,once:o}of n.slice(0))o&&this._off(e,r),s?(i||=[]).push(r):r(t);if(i){for(const e of i)e(t);i=null}}_on(e,t,n=null){(this.#o[e]||=[]).push({listener:t,external:!0===n?.external,once:!0===n?.once})}_off(e,t,n=null){const i=this.#o[e];if(i)for(let e=0,n=i.length;e<n;e++)if(i[e].listener===t)return void i.splice(e,1)}}t.EventBus=i;t.AutomationEventBus=class extends i{dispatch(e,t){throw new Error("Not implemented: AutomationEventBus.dispatch")}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenericL10n=void 0,n(11);var i=n(7);const r={en:"en-US",es:"es-ES",fy:"fy-NL",ga:"ga-IE",gu:"gu-IN",hi:"hi-IN",hy:"hy-AM",nb:"nb-NO",ne:"ne-NP",nn:"nn-NO",pa:"pa-IN",pt:"pt-PT",sv:"sv-SE",zh:"zh-CN"};t.GenericL10n=class{constructor(e){const{webL10n:t}=document;this._lang=e,this._ready=new Promise(((n,i)=>{var s;t.setLanguage((s=e,r[s?.toLowerCase()]||s),(()=>{n(t)}))}))}async getLanguage(){return(await this._ready).getLanguage()}async getDirection(){return(await this._ready).getDirection()}async get(e,t=null,n=(0,i.getL10nFallback)(e,t)){return(await this._ready).get(e,t,n)}async translate(e){return(await this._ready).translate(e)}}},()=>{document.webL10n=function(e,t){var n={},i="",r="textContent",s="",o={},a="loading",l=!0;function c(e,t,n){t=t||function(e){},n=n||function(){};var i=new XMLHttpRequest;i.open("GET",e,l),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=utf-8"),i.onreadystatechange=function(){4==i.readyState&&(200==i.status||0===i.status?t(i.responseText):n())},i.onerror=n,i.ontimeout=n;try{i.send(null)}catch(e){n()}}function h(e,t,s,o){var a=e.replace(/[^\/]*$/,"")||"./";function l(e){return e.lastIndexOf("\\")<0?e:e.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'")}c(e,(function(e){i+=e,function(e,n){var i={},r=/^\s*|\s*$/,s=/^\s*#|^\s*$/,o=/^\s*\[(.*)\]\s*$/,h=/^\s*@import\s+url\((.*)\)\s*$/i,d=/^([^=\s]*)\s*=\s*(.+)$/;function u(e,n,c){var u=e.replace(r,"").split(/[\r\n]+/),f="*",m=t.split("-",1)[0],g=!1,O="";!function e(){for(;;){if(!u.length)return void c();var r=u.shift();if(!s.test(r)){if(n){if(O=o.exec(r)){f=O[1].toLowerCase(),g="*"!==f&&f!==t&&f!==m;continue}if(g)continue;if(O=h.exec(r))return void p(a+O[1],e)}var y=r.match(d);y&&3==y.length&&(i[y[1]]=l(y[2]))}}}()}function p(e,t){c(e,(function(e){u(e,!1,t)}),(function(){console.warn(e+" not found."),t()}))}u(e,!0,(function(){n(i)}))}(e,(function(e){for(var t in e){var i,o,a=t.lastIndexOf(".");a>0?(i=t.substring(0,a),o=t.substring(a+1)):(i=t,o=r),n[i]||(n[i]={}),n[i][o]=e[t]}s&&s()}))}),o)}function d(e,r){e&&(e=e.toLowerCase()),r=r||function(){},n={},i="",s="",s=e;var o=t.querySelectorAll('link[type="application/l10n"]'),l=o.length;if(0!==l){var c,d,u=0;d=function(){++u>=l&&(r(),a="complete")};for(var p=0;p<l;p++){new O(o[p]).load(e,d)}}else{var f=(c=t.querySelector('script[type="application/l10n"]'))?JSON.parse(c.innerHTML):null;if(f&&f.locales&&f.default_locale){if(console.log("using the embedded JSON directory, early way out"),!(n=f.locales[e])){var m=f.default_locale.toLowerCase();for(var g in f.locales){if((g=g.toLowerCase())===e){n=f.locales[e];break}g===m&&(n=f.locales[m])}}r()}else console.log("no resource to load, early way out");a="complete"}function O(e){var t=e.href;this.load=function(e,n){h(t,e,n,(function(){console.warn(t+" not found."),console.warn('"'+e+'" resource not found'),s="",n()}))}}}function u(e,t,i){var r=n[e];if(!r){if(console.warn("#"+e+" is undefined."),!i)return null;r=i}var s={};for(var o in r){var a=r[o];a=f(a=p(a,t,e,o),t,e),s[o]=a}return s}function p(e,t,i,r){var s=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(e);if(!s||!s.length)return e;var a,l=s[1],c=s[2];(t&&c in t?a=t[c]:c in n&&(a=n[c]),l in o)&&(e=(0,o[l])(e,a,i,r));return e}function f(e,t,i){return e.replace(/\{\{\s*(.+?)\s*\}\}/g,(function(e,r){return t&&r in t?t[r]:r in n?n[r]:(console.log("argument {{"+r+"}} for #"+i+" is undefined."),e)}))}function m(e){var n=function(e){if(!e)return{};var t=e.getAttribute("data-l10n-id"),n=e.getAttribute("data-l10n-args"),i={};if(n)try{i=JSON.parse(n)}catch(e){console.warn("could not parse arguments for #"+t)}return{id:t,args:i}}(e);if(n.id){var i=u(n.id,n.args);if(i){if(i[r]){if(0===function(e){if(e.children)return e.children.length;if(void 0!==e.childElementCount)return e.childElementCount;for(var t=0,n=0;n<e.childNodes.length;n++)t+=1===e.nodeType?1:0;return t}(e))e[r]=i[r];else{for(var s=e.childNodes,o=!1,a=0,l=s.length;a<l;a++)3===s[a].nodeType&&/\S/.test(s[a].nodeValue)&&(o?s[a].nodeValue="":(s[a].nodeValue=i[r],o=!0));if(!o){var c=t.createTextNode(i[r]);e.prepend(c)}}delete i[r]}for(var h in i)e[h]=i[h]}else console.warn("#"+n.id+" is undefined.")}}return o.plural=function(e,t,i,a){var l=parseFloat(t);if(isNaN(l))return e;if(a!=r)return e;o._pluralRules||(o._pluralRules=function(e){function t(e,t){return-1!==t.indexOf(e)}function n(e,t,n){return t<=e&&e<=n}var i={0:function(e){return"other"},1:function(e){return n(e%100,3,10)?"few":0===e?"zero":n(e%100,11,99)?"many":2==e?"two":1==e?"one":"other"},2:function(e){return 0!==e&&e%10==0?"many":2==e?"two":1==e?"one":"other"},3:function(e){return 1==e?"one":"other"},4:function(e){return n(e,0,1)?"one":"other"},5:function(e){return n(e,0,2)&&2!=e?"one":"other"},6:function(e){return 0===e?"zero":e%10==1&&e%100!=11?"one":"other"},7:function(e){return 2==e?"two":1==e?"one":"other"},8:function(e){return n(e,3,6)?"few":n(e,7,10)?"many":2==e?"two":1==e?"one":"other"},9:function(e){return 0===e||1!=e&&n(e%100,1,19)?"few":1==e?"one":"other"},10:function(e){return n(e%10,2,9)&&!n(e%100,11,19)?"few":e%10!=1||n(e%100,11,19)?"other":"one"},11:function(e){return n(e%10,2,4)&&!n(e%100,12,14)?"few":e%10==0||n(e%10,5,9)||n(e%100,11,14)?"many":e%10==1&&e%100!=11?"one":"other"},12:function(e){return n(e,2,4)?"few":1==e?"one":"other"},13:function(e){return n(e%10,2,4)&&!n(e%100,12,14)?"few":1!=e&&n(e%10,0,1)||n(e%10,5,9)||n(e%100,12,14)?"many":1==e?"one":"other"},14:function(e){return n(e%100,3,4)?"few":e%100==2?"two":e%100==1?"one":"other"},15:function(e){return 0===e||n(e%100,2,10)?"few":n(e%100,11,19)?"many":1==e?"one":"other"},16:function(e){return e%10==1&&11!=e?"one":"other"},17:function(e){return 3==e?"few":0===e?"zero":6==e?"many":2==e?"two":1==e?"one":"other"},18:function(e){return 0===e?"zero":n(e,0,2)&&0!==e&&2!=e?"one":"other"},19:function(e){return n(e,2,10)?"few":n(e,0,1)?"one":"other"},20:function(e){return!n(e%10,3,4)&&e%10!=9||n(e%100,10,19)||n(e%100,70,79)||n(e%100,90,99)?e%1e6==0&&0!==e?"many":e%10!=2||t(e%100,[12,72,92])?e%10!=1||t(e%100,[11,71,91])?"other":"one":"two":"few"},21:function(e){return 0===e?"zero":1==e?"one":"other"},22:function(e){return n(e,0,1)||n(e,11,99)?"one":"other"},23:function(e){return n(e%10,1,2)||e%20==0?"one":"other"},24:function(e){return n(e,3,10)||n(e,13,19)?"few":t(e,[2,12])?"two":t(e,[1,11])?"one":"other"}},r={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[e.replace(/-.*$/,"")];return r in i?i[r]:(console.warn("plural form unknown for ["+e+"]"),function(){return"other"})}(s));var c="["+o._pluralRules(l)+"]";return 0===l&&i+"[zero]"in n?e=n[i+"[zero]"][a]:1==l&&i+"[one]"in n?e=n[i+"[one]"][a]:2==l&&i+"[two]"in n?e=n[i+"[two]"][a]:i+c in n?e=n[i+c][a]:i+"[other]"in n&&(e=n[i+"[other]"][a]),e},{get:function(e,t,n){var i,s=e.lastIndexOf("."),o=r;s>0&&(o=e.substring(s+1),e=e.substring(0,s)),n&&((i={})[o]=n);var a=u(e,t,i);return a&&o in a?a[o]:"{{"+e+"}}"},getData:function(){return n},getText:function(){return i},getLanguage:function(){return s},setLanguage:function(e,t){d(e,(function(){t&&t()}))},getDirection:function(){var e=s.split("-",1)[0];return["ar","he","fa","ps","ur"].indexOf(e)>=0?"rtl":"ltr"},translate:function(e){for(var n=function(e){return e?e.querySelectorAll("*[data-l10n-id]"):[]}(e=e||t.documentElement),i=n.length,r=0;r<i;r++)m(n[r]);m(e)},getReadyState:function(){return a},ready:function(n){n&&("complete"==a||"interactive"==a?e.setTimeout((function(){n()})):t.addEventListener&&t.addEventListener("localized",(function e(){t.removeEventListener("localized",e),n()})))}}}(window,document)},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFHistory=void 0,t.isDestArraysEqual=a,t.isDestHashesEqual=o;var i=n(2),r=n(9);function s(){return document.location.hash}function o(e,t){if("string"!=typeof e||"string"!=typeof t)return!1;if(e===t)return!0;return(0,i.parseQueryString)(e).get("nameddest")===t}function a(e,t){function n(e,t){if(typeof e!=typeof t)return!1;if(Array.isArray(e)||Array.isArray(t))return!1;if(null!==e&&"object"==typeof e&&null!==t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!n(e[i],t[i]))return!1;return!0}return e===t||Number.isNaN(e)&&Number.isNaN(t)}if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(!n(e[i],t[i]))return!1;return!0}t.PDFHistory=class{constructor({linkService:e,eventBus:t}){this.linkService=e,this.eventBus=t,this._initialized=!1,this._fingerprint="",this.reset(),this._boundEvents=null,this.eventBus._on("pagesinit",(()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",(e=>{this._isPagesLoaded=!!e.pagesCount}),{once:!0})}))}initialize({fingerprint:e,resetHistory:t=!1,updateUrl:n=!1}){if(!e||"string"!=typeof e)return void console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');this._initialized&&this.reset();const i=""!==this._fingerprint&&this._fingerprint!==e;this._fingerprint=e,this._updateUrl=!0===n,this._initialized=!0,this._bindEvents();const r=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=s(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this._isValidState(r,!0)||t){const{hash:e,page:n,rotation:r}=this._parseCurrentHash(!0);return!e||i||t?void this._pushOrReplaceState(null,!0):void this._pushOrReplaceState({hash:e,page:n,rotation:r},!0)}const o=r.destination;this._updateInternalState(o,r.uid,!0),void 0!==o.rotation&&(this._initialRotation=o.rotation),o.dest?(this._initialBookmark=JSON.stringify(o.dest),this._destination.page=null):o.hash?this._initialBookmark=o.hash:o.page&&(this._initialBookmark=`page=${o.page}`)}reset(){this._initialized&&(this._pageHide(),this._initialized=!1,this._unbindEvents()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:e=null,explicitDest:t,pageNumber:n}){if(!this._initialized)return;if(e&&"string"!=typeof e)return void console.error(`PDFHistory.push: "${e}" is not a valid namedDest parameter.`);if(!Array.isArray(t))return void console.error(`PDFHistory.push: "${t}" is not a valid explicitDest parameter.`);if(!this._isValidPage(n)&&(null!==n||this._destination))return void console.error(`PDFHistory.push: "${n}" is not a valid pageNumber parameter.`);const i=e||JSON.stringify(t);if(!i)return;let r=!1;if(this._destination&&(o(this._destination.hash,i)||a(this._destination.dest,t))){if(this._destination.page)return;r=!0}this._popStateInProgress&&!r||(this._pushOrReplaceState({dest:t,hash:i,page:n,rotation:this.linkService.rotation},r),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))}pushPage(e){this._initialized&&(this._isValidPage(e)?this._destination?.page!==e&&(this._popStateInProgress||(this._pushOrReplaceState({dest:null,hash:`page=${e}`,page:e,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then((()=>{this._popStateInProgress=!1}))))):console.error(`PDFHistory.pushPage: "${e}" is not a valid page number.`))}pushCurrentPosition(){this._initialized&&!this._popStateInProgress&&this._tryPushCurrentPosition()}back(){if(!this._initialized||this._popStateInProgress)return;const e=window.history.state;this._isValidState(e)&&e.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const e=window.history.state;this._isValidState(e)&&e.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}_pushOrReplaceState(e,t=!1){const n=t||!this._destination,i={fingerprint:this._fingerprint,uid:n?this._uid:this._uid+1,destination:e};let r;if(this._updateInternalState(e,i.uid),this._updateUrl&&e?.hash){const t=document.location.href.split("#")[0];t.startsWith("file://")||(r=`${t}#${e.hash}`)}n?window.history.replaceState(i,"",r):window.history.pushState(i,"",r)}_tryPushCurrentPosition(e=!1){if(!this._position)return;let t=this._position;if(e&&(t=Object.assign(Object.create(null),this._position),t.temporary=!0),!this._destination)return void this._pushOrReplaceState(t);if(this._destination.temporary)return void this._pushOrReplaceState(t,!0);if(this._destination.hash===t.hash)return;if(!this._destination.page&&this._numPositionUpdates<=50)return;let n=!1;if(this._destination.page>=t.first&&this._destination.page<=t.page){if(void 0!==this._destination.dest||!this._destination.first)return;n=!0}this._pushOrReplaceState(t,n)}_isValidPage(e){return Number.isInteger(e)&&e>0&&e<=this.linkService.pagesCount}_isValidState(e,t=!1){if(!e)return!1;if(e.fingerprint!==this._fingerprint){if(!t)return!1;{if("string"!=typeof e.fingerprint||e.fingerprint.length!==this._fingerprint.length)return!1;const[t]=performance.getEntriesByType("navigation");if("reload"!==t?.type)return!1}}return!(!Number.isInteger(e.uid)||e.uid<0)&&(null!==e.destination&&"object"==typeof e.destination)}_updateInternalState(e,t,n=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),n&&e?.temporary&&delete e.temporary,this._destination=e,this._uid=t,this._maxUid=Math.max(this._maxUid,t),this._numPositionUpdates=0}_parseCurrentHash(e=!1){const t=unescape(s()).substring(1),n=(0,i.parseQueryString)(t),r=n.get("nameddest")||"";let o=0|n.get("page");return(!this._isValidPage(o)||e&&r.length>0)&&(o=null),{hash:t,page:o,rotation:this.linkService.rotation}}_updateViewarea({location:e}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:e.pdfOpenParams.substring(1),page:this.linkService.page,first:e.pageNumber,rotation:e.rotation},this._popStateInProgress||(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout((()=>{this._popStateInProgress||this._tryPushCurrentPosition(!0),this._updateViewareaTimeout=null}),1e3))}_popState({state:e}){const t=s(),n=this._currentHash!==t;if(this._currentHash=t,!e){this._uid++;const{hash:e,page:t,rotation:n}=this._parseCurrentHash();return void this._pushOrReplaceState({hash:e,page:t,rotation:n},!0)}if(!this._isValidState(e))return;this._popStateInProgress=!0,n&&(this._blockHashChange++,(0,r.waitOnEventOrTimeout)({target:window,name:"hashchange",delay:1e3}).then((()=>{this._blockHashChange--})));const o=e.destination;this._updateInternalState(o,e.uid,!0),(0,i.isValidRotation)(o.rotation)&&(this.linkService.rotation=o.rotation),o.dest?this.linkService.goToDestination(o.dest):o.hash?this.linkService.setHash(o.hash):o.page&&(this.linkService.page=o.page),Promise.resolve().then((()=>{this._popStateInProgress=!1}))}_pageHide(){this._destination&&!this._destination.temporary||this._tryPushCurrentPosition()}_bindEvents(){this._boundEvents||(this._boundEvents={updateViewarea:this._updateViewarea.bind(this),popState:this._popState.bind(this),pageHide:this._pageHide.bind(this)},this.eventBus._on("updateviewarea",this._boundEvents.updateViewarea),window.addEventListener("popstate",this._boundEvents.popState),window.addEventListener("pagehide",this._boundEvents.pageHide))}_unbindEvents(){this._boundEvents&&(this.eventBus._off("updateviewarea",this._boundEvents.updateViewarea),window.removeEventListener("popstate",this._boundEvents.popState),window.removeEventListener("pagehide",this._boundEvents.pageHide),this._boundEvents=null)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFPageView=void 0;var i=n(4),r=n(2),s=n(14),o=n(6),a=n(15),l=n(7),c=n(5),h=n(16),d=n(17),u=n(18),p=n(19),f=n(20);const m=a.compatibilityParams.maxCanvasPixels||16777216,g=()=>({annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new c.SimpleLinkService}});t.PDFPageView=class{#hr=i.AnnotationMode.ENABLE_FORMS;#dr=!1;#ur=null;#pr=null;#fr=null;#mr=null;#gr=r.RenderingStates.INITIAL;#Or=r.TextLayerMode.ENABLE;#yr={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#vr=new WeakMap;constructor(e){const t=e.container,n=e.defaultViewport;this.id=e.id,this.renderingId="page"+this.id,this.#ur=e.layerProperties||g,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=e.scale||r.DEFAULT_SCALE,this.viewport=n,this.pdfPageRotate=n.rotation,this._optionalContentConfigPromise=e.optionalContentConfigPromise||null,this.#Or=e.textLayerMode??r.TextLayerMode.ENABLE,this.#hr=e.annotationMode??i.AnnotationMode.ENABLE_FORMS,this.imageResourcesPath=e.imageResourcesPath||"",this.isOffscreenCanvasSupported=e.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=e.maxCanvasPixels??m,this.pageColors=e.pageColors||null,this.eventBus=e.eventBus,this.renderingQueue=e.renderingQueue,this.l10n=e.l10n||l.NullL10n,this.renderTask=null,this.resume=null,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=t,e.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),this.maxCanvasPixels=0),this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.zoomLayer=null,this.xfaLayer=null,this.structTreeLayer=null;const s=document.createElement("div");if(s.className="page",s.setAttribute("data-page-number",this.id),s.setAttribute("role","region"),this.l10n.get("page_landmark",{page:this.id}).then((e=>{s.setAttribute("aria-label",e)})),this.div=s,this.#Ti(),t?.append(s),this._isStandalone){t?.style.setProperty("--scale-factor",this.scale*i.PixelsPerInch.PDF_TO_CSS_UNITS);const{optionalContentConfigPromise:n}=e;n&&n.then((e=>{n===this._optionalContentConfigPromise&&(this.#yr.initialOptionalContent=e.hasInitialVisibility)}))}}get renderingState(){return this.#gr}set renderingState(e){if(e!==this.#gr)switch(this.#gr=e,this.#pr&&(clearTimeout(this.#pr),this.#pr=null),e){case r.RenderingStates.PAUSED:this.div.classList.remove("loading");break;case r.RenderingStates.RUNNING:this.div.classList.add("loadingIcon"),this.#pr=setTimeout((()=>{this.div.classList.add("loading"),this.#pr=null}),0);break;case r.RenderingStates.INITIAL:case r.RenderingStates.FINISHED:this.div.classList.remove("loadingIcon","loading")}}#Ti(){const{viewport:e}=this;if(this.pdfPage){if(this.#fr===e.rotation)return;this.#fr=e.rotation}(0,i.setLayerDimensions)(this.div,e,!0,!1)}setPdfPage(e){!this._isStandalone||"CanvasText"!==this.pageColors?.foreground&&"Canvas"!==this.pageColors?.background||this._container?.style.setProperty("--hcm-highligh-filter",e.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight")),this.pdfPage=e,this.pdfPageRotate=e.rotate;const t=(this.rotation+this.pdfPageRotate)%360;this.viewport=e.getViewport({scale:this.scale*i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:t}),this.#Ti(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}get _textHighlighter(){return(0,i.shadow)(this,"_textHighlighter",new u.TextHighlighter({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#ur().findController}))}async#br(){let e=null;try{await this.annotationLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationLayer: "${t}".`),e=t}finally{this.eventBus.dispatch("annotationlayerrendered",{source:this,pageNumber:this.id,error:e})}}async#wr(){let e=null;try{await this.annotationEditorLayer.render(this.viewport,"display")}catch(t){console.error(`#renderAnnotationEditorLayer: "${t}".`),e=t}finally{this.eventBus.dispatch("annotationeditorlayerrendered",{source:this,pageNumber:this.id,error:e})}}async#Sr(){let e=null;try{const e=await this.xfaLayer.render(this.viewport,"display");e?.textDivs&&this._textHighlighter&&this.#xr(e.textDivs)}catch(t){console.error(`#renderXfaLayer: "${t}".`),e=t}finally{this.eventBus.dispatch("xfalayerrendered",{source:this,pageNumber:this.id,error:e})}}async#Cr(){const{pdfPage:e,textLayer:t,viewport:n}=this;if(!t)return;let r=null;try{if(!t.renderingDone){const n=e.streamTextContent({includeMarkedContent:!0,disableNormalization:!0});t.setTextContentSource(n)}await t.render(n)}catch(e){if(e instanceof i.AbortException)return;console.error(`#renderTextLayer: "${e}".`),r=e}this.eventBus.dispatch("textlayerrendered",{source:this,pageNumber:this.id,numTextDivs:t.numTextDivs,error:r}),this.#_r()}async#_r(){if(!this.textLayer)return;this.structTreeLayer||=new h.StructTreeLayerBuilder;const e=await(this.structTreeLayer.renderingDone?null:this.pdfPage.getStructTree()),t=this.structTreeLayer?.render(e);t&&this.canvas?.append(t),this.structTreeLayer?.show()}async#xr(e){const t=await this.pdfPage.getTextContent(),n=[];for(const e of t.items)n.push(e.str);this._textHighlighter.setTextMapping(e,n),this._textHighlighter.enable()}_resetZoomLayer(e=!1){if(!this.zoomLayer)return;const t=this.zoomLayer.firstChild;this.#vr.delete(t),t.width=0,t.height=0,e&&this.zoomLayer.remove(),this.zoomLayer=null}reset({keepZoomLayer:e=!1,keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:n=!1,keepXfaLayer:i=!1,keepTextLayer:s=!1}={}){this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:n,keepXfaLayer:i,keepTextLayer:s}),this.renderingState=r.RenderingStates.INITIAL;const o=this.div,a=o.childNodes,l=e&&this.zoomLayer||null,c=t&&this.annotationLayer?.div||null,h=n&&this.annotationEditorLayer?.div||null,d=i&&this.xfaLayer?.div||null,u=s&&this.textLayer?.div||null;for(let e=a.length-1;e>=0;e--){const t=a[e];switch(t){case l:case c:case h:case d:case u:continue}t.remove()}o.removeAttribute("data-loaded"),c&&this.annotationLayer.hide(),h&&this.annotationEditorLayer.hide(),d&&this.xfaLayer.hide(),u&&this.textLayer.hide(),this.structTreeLayer?.hide(),l||(this.canvas&&(this.#vr.delete(this.canvas),this.canvas.width=0,this.canvas.height=0,delete this.canvas),this._resetZoomLayer())}update({scale:e=0,rotation:t=null,optionalContentConfigPromise:n=null,drawingDelay:s=-1}){this.scale=e||this.scale,"number"==typeof t&&(this.rotation=t),n instanceof Promise&&(this._optionalContentConfigPromise=n,n.then((e=>{n===this._optionalContentConfigPromise&&(this.#yr.initialOptionalContent=e.hasInitialVisibility)}))),this.#yr.directDrawing=!0;const o=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:o}),this.#Ti(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.canvas){let e=!1;if(this.#dr)if(0===this.maxCanvasPixels)e=!0;else if(this.maxCanvasPixels>0){const{width:t,height:n}=this.viewport,{sx:i,sy:r}=this.outputScale;e=(Math.floor(t)*i|0)*(Math.floor(n)*r|0)>this.maxCanvasPixels}const t=!e&&s>=0&&s<1e3;if(t||e){if(t&&this.renderingState!==r.RenderingStates.FINISHED&&(this.cancelRendering({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:s}),this.renderingState=r.RenderingStates.FINISHED,this.#yr.directDrawing=!1),this.cssTransform({target:this.canvas,redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!t,hideTextLayer:t}),t)return;return void this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!0,timestamp:performance.now(),error:this.#mr})}this.zoomLayer||this.canvas.hidden||(this.zoomLayer=this.canvas.parentNode,this.zoomLayer.style.position="absolute")}this.zoomLayer&&this.cssTransform({target:this.zoomLayer.firstChild}),this.reset({keepZoomLayer:!0,keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0})}cancelRendering({keepAnnotationLayer:e=!1,keepAnnotationEditorLayer:t=!1,keepXfaLayer:n=!1,keepTextLayer:i=!1,cancelExtraDelay:r=0}={}){this.renderTask&&(this.renderTask.cancel(r),this.renderTask=null),this.resume=null,!this.textLayer||i&&this.textLayer.div||(this.textLayer.cancel(),this.textLayer=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),!this.annotationLayer||e&&this.annotationLayer.div||(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),!this.annotationEditorLayer||t&&this.annotationEditorLayer.div||(this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),!this.xfaLayer||n&&this.xfaLayer.div||(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({target:e,redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:n=!1,redrawXfaLayer:i=!1,redrawTextLayer:r=!1,hideTextLayer:s=!1}){if(!e.hasAttribute("zooming")){e.setAttribute("zooming",!0);const{style:t}=e;t.width=t.height=""}const o=this.#vr.get(e);if(this.viewport!==o){const t=this.viewport.rotation-o.rotation,n=Math.abs(t);let i=1,r=1;if(90===n||270===n){const{width:e,height:t}=this.viewport;i=t/e,r=e/t}e.style.transform=`rotate(${t}deg) scale(${i}, ${r})`}t&&this.annotationLayer&&this.#br(),n&&this.annotationEditorLayer&&this.#wr(),i&&this.xfaLayer&&this.#Sr(),this.textLayer&&(s?(this.textLayer.hide(),this.structTreeLayer?.hide()):r&&this.#Cr())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(e,t){return this.viewport.convertToPdfPoint(e,t)}async#Er(e,t=null){if(e===this.renderTask&&(this.renderTask=null),t instanceof i.RenderingCancelledException)this.#mr=null;else if(this.#mr=t,this.renderingState=r.RenderingStates.FINISHED,this._resetZoomLayer(!0),this.#yr.regularAnnotations=!e.separateAnnots,this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:!1,timestamp:performance.now(),error:this.#mr}),t)throw t}async draw(){this.renderingState!==r.RenderingStates.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:e,l10n:t,pageColors:n,pdfPage:a,viewport:l}=this;if(!a)throw this.renderingState=r.RenderingStates.FINISHED,new Error("pdfPage is not loaded");this.renderingState=r.RenderingStates.RUNNING;const c=document.createElement("div");if(c.classList.add("canvasWrapper"),e.append(c),this.textLayer||this.#Or===r.TextLayerMode.DISABLE||a.isPureXfa||(this._accessibilityManager||=new d.TextAccessibilityManager,this.textLayer=new p.TextLayerBuilder({highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,enablePermissions:this.#Or===r.TextLayerMode.ENABLE_PERMISSIONS}),e.append(this.textLayer.div)),!this.annotationLayer&&this.#hr!==i.AnnotationMode.DISABLE){const{annotationStorage:n,downloadManager:r,enableScripting:s,fieldObjectsPromise:l,hasJSActionsPromise:c,linkService:h}=this.#ur();this._annotationCanvasMap||=new Map,this.annotationLayer=new o.AnnotationLayerBuilder({pageDiv:e,pdfPage:a,annotationStorage:n,imageResourcesPath:this.imageResourcesPath,renderForms:this.#hr===i.AnnotationMode.ENABLE_FORMS,linkService:h,downloadManager:r,l10n:t,enableScripting:s,hasJSActionsPromise:c,fieldObjectsPromise:l,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager})}const{width:h,height:u}=l,m=document.createElement("canvas");m.setAttribute("role","presentation"),m.hidden=!0;const g=!(!n?.background||!n?.foreground);let O=e=>{g&&!e||(m.hidden=!1,O=null)};c.append(m),this.canvas=m;const y=m.getContext("2d",{alpha:!1}),v=this.outputScale=new r.OutputScale;if(0===this.maxCanvasPixels){const e=1/this.scale;v.sx*=e,v.sy*=e,this.#dr=!0}else if(this.maxCanvasPixels>0){const e=h*u,t=Math.sqrt(this.maxCanvasPixels/e);v.sx>t||v.sy>t?(v.sx=t,v.sy=t,this.#dr=!0):this.#dr=!1}const b=(0,r.approximateFraction)(v.sx),w=(0,r.approximateFraction)(v.sy);m.width=(0,r.roundToDivide)(h*v.sx,b[0]),m.height=(0,r.roundToDivide)(u*v.sy,w[0]);const{style:S}=m;S.width=(0,r.roundToDivide)(h,b[1])+"px",S.height=(0,r.roundToDivide)(u,w[1])+"px",this.#vr.set(m,l);const x={canvasContext:y,transform:v.scaled?[v.sx,0,0,v.sy,0,0]:null,viewport:l,annotationMode:this.#hr,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:n},C=this.renderTask=this.pdfPage.render(x);C.onContinue=e=>{if(O?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this))return this.renderingState=r.RenderingStates.PAUSED,void(this.resume=()=>{this.renderingState=r.RenderingStates.RUNNING,e()});e()};const _=C.promise.then((async()=>{if(O?.(!0),await this.#Er(C),this.#Cr(),this.annotationLayer&&await this.#br(),!this.annotationEditorLayer){const{annotationEditorUIManager:n}=this.#ur();if(!n)return;this.annotationEditorLayer=new s.AnnotationEditorLayerBuilder({uiManager:n,pageDiv:e,pdfPage:a,l10n:t,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer})}this.#wr()}),(e=>(e instanceof i.RenderingCancelledException||O?.(!0),this.#Er(C,e))));if(a.isPureXfa){if(this.xfaLayer)this.xfaLayer.div&&e.append(this.xfaLayer.div);else{const{annotationStorage:t,linkService:n}=this.#ur();this.xfaLayer=new f.XfaLayerBuilder({pageDiv:e,pdfPage:a,annotationStorage:t,linkService:n})}this.#Sr()}return e.setAttribute("data-loaded",!0),this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id}),_}setPageLabel(e){this.pageLabel="string"==typeof e?e:null,null!==this.pageLabel?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:e,initialOptionalContent:t,regularAnnotations:n}=this.#yr;return e&&t&&n?this.canvas:null}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayerBuilder=void 0;var i=n(4),r=n(7);t.AnnotationEditorLayerBuilder=class{#Ct=null;#Rt;constructor(e){this.pageDiv=e.pageDiv,this.pdfPage=e.pdfPage,this.accessibilityManager=e.accessibilityManager,this.l10n=e.l10n||r.NullL10n,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#Rt=e.uiManager,this.#Ct=e.annotationLayer||null}async render(e,t="display"){if("display"!==t)return;if(this._cancelled)return;const n=e.clone({dontFlip:!0});if(this.div)return this.annotationEditorLayer.update({viewport:n}),void this.show();const r=this.div=document.createElement("div");r.className="annotationEditorLayer",r.tabIndex=0,r.hidden=!0,r.dir=this.#Rt.direction,this.pageDiv.append(r),this.annotationEditorLayer=new i.AnnotationEditorLayer({uiManager:this.#Rt,div:r,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:n,annotationLayer:this.#Ct});const s={viewport:n,div:r,annotations:null,intent:t};this.annotationEditorLayer.render(s),this.show()}cancel(){this._cancelled=!0,this.div&&(this.pageDiv=null,this.annotationEditorLayer.destroy(),this.div.remove())}hide(){this.div&&(this.div.hidden=!0)}show(){this.div&&!this.annotationEditorLayer.isEmpty&&(this.div.hidden=!1)}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.compatibilityParams=t.OptionKind=t.AppOptions=void 0;const n=Object.create(null);t.compatibilityParams=n;{const e=navigator.userAgent||"",t=navigator.platform||"",i=navigator.maxTouchPoints||1,r=/Android/.test(e);(/\b(iPad|iPhone|iPod)(?=;)/.test(e)||"MacIntel"===t&&i>1||r)&&(n.maxCanvasPixels=5242880)}const i={VIEWER:2,API:4,WORKER:8,PREFERENCE:128};t.OptionKind=i;const r={annotationEditorMode:{value:0,kind:i.VIEWER+i.PREFERENCE},annotationMode:{value:2,kind:i.VIEWER+i.PREFERENCE},cursorToolOnLoad:{value:0,kind:i.VIEWER+i.PREFERENCE},defaultZoomDelay:{value:400,kind:i.VIEWER+i.PREFERENCE},defaultZoomValue:{value:"",kind:i.VIEWER+i.PREFERENCE},disableHistory:{value:!1,kind:i.VIEWER},disablePageLabels:{value:!1,kind:i.VIEWER+i.PREFERENCE},enablePermissions:{value:!1,kind:i.VIEWER+i.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:i.VIEWER+i.PREFERENCE},enableScripting:{value:!0,kind:i.VIEWER+i.PREFERENCE},enableStampEditor:{value:!0,kind:i.VIEWER+i.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:i.VIEWER},externalLinkTarget:{value:0,kind:i.VIEWER+i.PREFERENCE},historyUpdateUrl:{value:!1,kind:i.VIEWER+i.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:i.VIEWER+i.PREFERENCE},imageResourcesPath:{value:"./images/",kind:i.VIEWER},maxCanvasPixels:{value:16777216,kind:i.VIEWER},forcePageColors:{value:!1,kind:i.VIEWER+i.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:i.VIEWER+i.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:i.VIEWER+i.PREFERENCE},pdfBugEnabled:{value:!1,kind:i.VIEWER+i.PREFERENCE},printResolution:{value:150,kind:i.VIEWER},sidebarViewOnLoad:{value:-1,kind:i.VIEWER+i.PREFERENCE},scrollModeOnLoad:{value:-1,kind:i.VIEWER+i.PREFERENCE},spreadModeOnLoad:{value:-1,kind:i.VIEWER+i.PREFERENCE},textLayerMode:{value:1,kind:i.VIEWER+i.PREFERENCE},viewerCssTheme:{value:0,kind:i.VIEWER+i.PREFERENCE},viewOnLoad:{value:0,kind:i.VIEWER+i.PREFERENCE},cMapPacked:{value:!0,kind:i.API},cMapUrl:{value:"../web/cmaps/",kind:i.API},disableAutoFetch:{value:!1,kind:i.API+i.PREFERENCE},disableFontFace:{value:!1,kind:i.API+i.PREFERENCE},disableRange:{value:!1,kind:i.API+i.PREFERENCE},disableStream:{value:!1,kind:i.API+i.PREFERENCE},docBaseUrl:{value:"",kind:i.API},enableXfa:{value:!0,kind:i.API+i.PREFERENCE},fontExtraProperties:{value:!1,kind:i.API},isEvalSupported:{value:!0,kind:i.API},isOffscreenCanvasSupported:{value:!0,kind:i.API},maxImageSize:{value:-1,kind:i.API},pdfBug:{value:!1,kind:i.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:i.API},verbosity:{value:1,kind:i.API},workerPort:{value:null,kind:i.WORKER},workerSrc:{value:"../build/pdf.worker.js",kind:i.WORKER}};r.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:i.VIEWER},r.disablePreferences={value:!1,kind:i.VIEWER},r.locale={value:navigator.language||"en-US",kind:i.VIEWER},r.sandboxBundleSrc={value:"../build/pdf.sandbox.js",kind:i.VIEWER};const s=Object.create(null);class o{constructor(){throw new Error("Cannot initialize AppOptions.")}static get(e){const t=s[e];if(void 0!==t)return t;const i=r[e];return void 0!==i?n[e]??i.value:void 0}static getAll(e=null){const t=Object.create(null);for(const o in r){const a=r[o];if(e){if(0==(e&a.kind))continue;if(e===i.PREFERENCE){const e=a.value,n=typeof e;if("boolean"===n||"string"===n||"number"===n&&Number.isInteger(e)){t[o]=e;continue}throw new Error(`Invalid type for preference: ${o}`)}}const l=s[o];t[o]=void 0!==l?l:n[o]??a.value}return t}static set(e,t){s[e]=t}static setAll(e){for(const t in e)s[t]=e[t]}static remove(e){delete s[e]}}t.AppOptions=o,o._hasUserOptions=function(){return Object.keys(s).length>0}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StructTreeLayerBuilder=void 0;var i=n(2);const r={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},s=/^H(\d+)$/;t.StructTreeLayerBuilder=class{#Pr=void 0;get renderingDone(){return void 0!==this.#Pr}render(e){if(void 0!==this.#Pr)return this.#Pr;const t=this.#kr(e);return t?.classList.add("structTree"),this.#Pr=t}hide(){this.#Pr&&!this.#Pr.hidden&&(this.#Pr.hidden=!0)}show(){this.#Pr?.hidden&&(this.#Pr.hidden=!1)}#Tr(e,t){const{alt:n,id:r,lang:s}=e;void 0!==n&&t.setAttribute("aria-label",(0,i.removeNullCharacters)(n)),void 0!==r&&t.setAttribute("aria-owns",r),void 0!==s&&t.setAttribute("lang",(0,i.removeNullCharacters)(s,!0))}#kr(e){if(!e)return null;const t=document.createElement("span");if("role"in e){const{role:n}=e,i=n.match(s);i?(t.setAttribute("role","heading"),t.setAttribute("aria-level",i[1])):r[n]&&t.setAttribute("role",r[n])}if(this.#Tr(e,t),e.children)if(1===e.children.length&&"id"in e.children[0])this.#Tr(e.children[0],t);else for(const n of e.children)t.append(this.#kr(n));return t}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextAccessibilityManager=void 0;var i=n(2);class r{#Ar=!1;#Rr=null;#Mr=new Map;#Ir=new Map;setTextMapping(e){this.#Rr=e}static#Lr(e,t){const n=e.getBoundingClientRect(),i=t.getBoundingClientRect();if(0===n.width&&0===n.height)return 1;if(0===i.width&&0===i.height)return-1;const r=n.y,s=n.y+n.height,o=n.y+n.height/2,a=i.y,l=i.y+i.height,c=i.y+i.height/2;if(o<=a&&c>=s)return-1;if(c<=r&&o>=l)return 1;return n.x+n.width/2-(i.x+i.width/2)}enable(){if(this.#Ar)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#Rr)throw new Error("Text divs and strings have not been set.");if(this.#Ar=!0,this.#Rr=this.#Rr.slice(),this.#Rr.sort(r.#Lr),this.#Mr.size>0){const e=this.#Rr;for(const[t,n]of this.#Mr){document.getElementById(t)?this.#$r(t,e[n]):this.#Mr.delete(t)}}for(const[e,t]of this.#Ir)this.addPointerInTextLayer(e,t);this.#Ir.clear()}disable(){this.#Ar&&(this.#Ir.clear(),this.#Rr=null,this.#Ar=!1)}removePointerInTextLayer(e){if(!this.#Ar)return void this.#Ir.delete(e);const t=this.#Rr;if(!t||0===t.length)return;const{id:n}=e,i=this.#Mr.get(n);if(void 0===i)return;const r=t[i];this.#Mr.delete(n);let s=r.getAttribute("aria-owns");s?.includes(n)&&(s=s.split(" ").filter((e=>e!==n)).join(" "),s?r.setAttribute("aria-owns",s):(r.removeAttribute("aria-owns"),r.setAttribute("role","presentation")))}#$r(e,t){const n=t.getAttribute("aria-owns");n?.includes(e)||t.setAttribute("aria-owns",n?`${n} ${e}`:e),t.removeAttribute("role")}addPointerInTextLayer(e,t){const{id:n}=e;if(!n)return null;if(!this.#Ar)return this.#Ir.set(e,t),null;t&&this.removePointerInTextLayer(e);const s=this.#Rr;if(!s||0===s.length)return null;const o=(0,i.binarySearchFirstItem)(s,(t=>r.#Lr(e,t)<0)),a=Math.max(0,o-1),l=s[a];this.#$r(n,l),this.#Mr.set(n,a);const c=l.parentNode;return c?.classList.contains("markedContent")?c.id:null}moveElementInDOM(e,t,n,s){const o=this.addPointerInTextLayer(n,s);if(!e.hasChildNodes())return e.append(t),o;const a=Array.from(e.childNodes).filter((e=>e!==t));if(0===a.length)return o;const l=n||t,c=(0,i.binarySearchFirstItem)(a,(e=>r.#Lr(l,e)<0));return 0===c?a[0].before(t):a[c-1].after(t),o}}t.TextAccessibilityManager=r},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextHighlighter=void 0;t.TextHighlighter=class{constructor({findController:e,eventBus:t,pageIndex:n}){this.findController=e,this.matches=[],this.eventBus=t,this.pageIdx=n,this._onUpdateTextLayerMatches=null,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(e,t){this.textDivs=e,this.textContentItemsStr=t}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this._onUpdateTextLayerMatches||(this._onUpdateTextLayerMatches=e=>{e.pageIndex!==this.pageIdx&&-1!==e.pageIndex||this._updateMatches()},this.eventBus._on("updatetextlayermatches",this._onUpdateTextLayerMatches)),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this._onUpdateTextLayerMatches&&(this.eventBus._off("updatetextlayermatches",this._onUpdateTextLayerMatches),this._onUpdateTextLayerMatches=null),this._updateMatches(!0))}_convertMatches(e,t){if(!e)return[];const{textContentItemsStr:n}=this;let i=0,r=0;const s=n.length-1,o=[];for(let a=0,l=e.length;a<l;a++){let l=e[a];for(;i!==s&&l>=r+n[i].length;)r+=n[i].length,i++;i===n.length&&console.error("Could not find a matching mapping");const c={begin:{divIdx:i,offset:l-r}};for(l+=t[a];i!==s&&l>r+n[i].length;)r+=n[i].length,i++;c.end={divIdx:i,offset:l-r},o.push(c)}return o}_renderMatches(e){if(0===e.length)return;const{findController:t,pageIdx:n}=this,{textContentItemsStr:i,textDivs:r}=this,s=n===t.selected.pageIdx,o=t.selected.matchIdx;let a=null;const l={divIdx:-1,offset:void 0};function c(e,t){const n=e.divIdx;return r[n].textContent="",h(n,0,e.offset,t)}function h(e,t,n,s){let o=r[e];if(o.nodeType===Node.TEXT_NODE){const t=document.createElement("span");o.before(t),t.append(o),r[e]=t,o=t}const a=i[e].substring(t,n),l=document.createTextNode(a);if(s){const e=document.createElement("span");return e.className=`${s} appended`,e.append(l),o.append(e),s.includes("selected")?e.offsetLeft:0}return o.append(l),0}let d=o,u=d+1;if(t.state.highlightAll)d=0,u=e.length;else if(!s)return;let p=-1,f=-1;for(let i=d;i<u;i++){const d=e[i],u=d.begin;if(u.divIdx===p&&u.offset===f)continue;p=u.divIdx,f=u.offset;const m=d.end,g=s&&i===o,O=g?" selected":"";let y=0;if(a&&u.divIdx===a.divIdx?h(a.divIdx,a.offset,u.offset):(null!==a&&h(a.divIdx,a.offset,l.offset),c(u)),u.divIdx===m.divIdx)y=h(u.divIdx,u.offset,m.offset,"highlight"+O);else{y=h(u.divIdx,u.offset,l.offset,"highlight begin"+O);for(let e=u.divIdx+1,t=m.divIdx;e<t;e++)r[e].className="highlight middle"+O;c(m,"highlight end"+O)}a=m,g&&t.scrollMatchIntoView({element:r[u.divIdx],selectedLeft:y,pageIndex:n,matchIndex:o})}a&&h(a.divIdx,a.offset,l.offset)}_updateMatches(e=!1){if(!this.enabled&&!e)return;const{findController:t,matches:n,pageIdx:i}=this,{textContentItemsStr:r,textDivs:s}=this;let o=-1;for(const e of n){for(let t=Math.max(o,e.begin.divIdx),n=e.end.divIdx;t<=n;t++){const e=s[t];e.textContent=r[t],e.className=""}o=e.end.divIdx+1}if(!t?.highlightMatches||e)return;const a=t.pageMatches[i]||null,l=t.pageMatchesLength[i]||null;this.matches=this._convertMatches(a,l),this._renderMatches(this.matches)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerBuilder=void 0;var i=n(4),r=n(2);t.TextLayerBuilder=class{#Dr=!1;#Nr=0;#Qr=0;#Fr=null;constructor({highlighter:e=null,accessibilityManager:t=null,isOffscreenCanvasSupported:n=!0,enablePermissions:i=!1}){this.textContentItemsStr=[],this.renderingDone=!1,this.textDivs=[],this.textDivProperties=new WeakMap,this.textLayerRenderTask=null,this.highlighter=e,this.accessibilityManager=t,this.isOffscreenCanvasSupported=n,this.#Dr=!0===i,this.div=document.createElement("div"),this.div.className="textLayer",this.hide()}#Br(){this.renderingDone=!0;const e=document.createElement("div");e.className="endOfContent",this.div.append(e),this.#jr()}get numTextDivs(){return this.textDivs.length}async render(e){if(!this.#Fr)throw new Error('No "textContentSource" parameter specified.');const t=e.scale*(globalThis.devicePixelRatio||1),{rotation:n}=e;if(this.renderingDone){const r=n!==this.#Nr,s=t!==this.#Qr;return(r||s)&&(this.hide(),(0,i.updateTextLayer)({container:this.div,viewport:e,textDivs:this.textDivs,textDivProperties:this.textDivProperties,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,mustRescale:s,mustRotate:r}),this.#Qr=t,this.#Nr=n),void this.show()}this.cancel(),this.highlighter?.setTextMapping(this.textDivs,this.textContentItemsStr),this.accessibilityManager?.setTextMapping(this.textDivs),this.textLayerRenderTask=(0,i.renderTextLayer)({textContentSource:this.#Fr,container:this.div,viewport:e,textDivs:this.textDivs,textDivProperties:this.textDivProperties,textContentItemsStr:this.textContentItemsStr,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported}),await this.textLayerRenderTask.promise,this.#Br(),this.#Qr=t,this.#Nr=n,this.show(),this.accessibilityManager?.enable()}hide(){this.div.hidden||(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.renderingDone&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null),this.highlighter?.disable(),this.accessibilityManager?.disable(),this.textContentItemsStr.length=0,this.textDivs.length=0,this.textDivProperties=new WeakMap}setTextContentSource(e){this.cancel(),this.#Fr=e}#jr(){const{div:e}=this;e.addEventListener("mousedown",(t=>{const n=e.querySelector(".endOfContent");if(!n)return;let i=t.target!==e;if(i&&="none"!==getComputedStyle(n).getPropertyValue("-moz-user-select"),i){const i=e.getBoundingClientRect(),r=Math.max(0,(t.pageY-i.top)/i.height);n.style.top=(100*r).toFixed(2)+"%"}n.classList.add("active")})),e.addEventListener("mouseup",(()=>{const t=e.querySelector(".endOfContent");t&&(t.style.top="",t.classList.remove("active"))})),e.addEventListener("copy",(e=>{if(!this.#Dr){const t=document.getSelection();e.clipboardData.setData("text/plain",(0,r.removeNullCharacters)((0,i.normalizeUnicode)(t.toString())))}e.preventDefault(),e.stopPropagation()}))}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayerBuilder=void 0;var i=n(4);t.XfaLayerBuilder=class{constructor({pageDiv:e,pdfPage:t,annotationStorage:n=null,linkService:i,xfaHtml:r=null}){this.pageDiv=e,this.pdfPage=t,this.annotationStorage=n,this.linkService=i,this.xfaHtml=r,this.div=null,this._cancelled=!1}async render(e,t="display"){if("print"===t){const n={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t},r=document.createElement("div");return this.pageDiv.append(r),n.div=r,i.XfaLayer.render(n)}const n=await this.pdfPage.getXfa();if(this._cancelled||!n)return{textDivs:[]};const r={viewport:e.clone({dontFlip:!0}),div:this.div,xfaHtml:n,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:t};return this.div?i.XfaLayer.update(r):(this.div=document.createElement("div"),this.pageDiv.append(this.div),r.div=this.div,i.XfaLayer.render(r))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFScriptingManager=void 0;var i=n(22),r=n(23);class s extends r.PDFScriptingManager{constructor(e){e.externalServices||window.addEventListener("updatefromsandbox",(t=>{e.eventBus.dispatch("updatefromsandbox",{source:window,detail:t.detail})})),e.externalServices||={createScripting:({sandboxBundleSrc:e})=>new i.GenericScripting(e)},e.docProperties||=e=>(0,i.docProperties)(e),super(e)}}t.PDFScriptingManager=s},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GenericScripting=void 0,t.docProperties=async function(e){const t="".split("#")[0];let{info:n,metadata:r,contentDispositionFilename:s,contentLength:o}=await e.getMetadata();if(!o){const{length:t}=await e.getDownloadInfo();o=t}return{...n,baseURL:t,filesize:o,filename:s||(0,i.getPdfFilenameFromUrl)(""),metadata:r?.getRaw(),authors:r?.get("dc:creator"),numPages:e.numPages,URL:""}};var i=n(4);t.GenericScripting=class{constructor(e){this._ready=(0,i.loadScript)(e,!0).then((()=>window.pdfjsSandbox.QuickJSSandbox()))}async createSandbox(e){(await this._ready).create(e)}async dispatchEventInSandbox(e){const t=await this._ready;setTimeout((()=>t.dispatchEvent(e)),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFScriptingManager=void 0;var i=n(2),r=n(4);t.PDFScriptingManager=class{#Vr=null;#Ur=null;#Wr=null;#Zr=null;#Hr=null;#qr=null;#Xr=null;#zr=!1;#Yr=null;#Gr=null;#Kr=null;constructor({eventBus:e,sandboxBundleSrc:t=null,externalServices:n=null,docProperties:i=null}){this.#Zr=e,this.#Yr=t,this.#Hr=n,this.#Wr=i}setViewer(e){this.#Xr=e}async setDocument(e){if(this.#qr&&await this.#Jr(),this.#qr=e,!e)return;const[t,n,i]=await Promise.all([e.getFieldObjects(),e.getCalculationOrderIds(),e.getJSActions()]);if(t||i){if(e===this.#qr){try{this.#Gr=this.#es()}catch(e){return console.error(`setDocument: "${e.message}".`),void await this.#Jr()}this._internalEvents.set("updatefromsandbox",(e=>{e?.source===window&&this.#ts(e.detail)})),this._internalEvents.set("dispatcheventinsandbox",(e=>{this.#Gr?.dispatchEventInSandbox(e.detail)})),this._internalEvents.set("pagechanging",(({pageNumber:e,previous:t})=>{e!==t&&(this.#ns(t),this.#is(e))})),this._internalEvents.set("pagerendered",(({pageNumber:e})=>{this._pageOpenPending.has(e)&&e===this.#Xr.currentPageNumber&&this.#is(e)})),this._internalEvents.set("pagesdestroy",(async()=>{await this.#ns(this.#Xr.currentPageNumber),await(this.#Gr?.dispatchEventInSandbox({id:"doc",name:"WillClose"})),this.#Vr?.resolve()}));for(const[e,t]of this._internalEvents)this.#Zr._on(e,t);try{const r=await this.#Wr(e);if(e!==this.#qr)return;await this.#Gr.createSandbox({objects:t,calculationOrder:n,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...r,actions:i}}),this.#Zr.dispatch("sandboxcreated",{source:this})}catch(e){return console.error(`setDocument: "${e.message}".`),void await this.#Jr()}await(this.#Gr?.dispatchEventInSandbox({id:"doc",name:"Open"})),await this.#is(this.#Xr.currentPageNumber,!0),Promise.resolve().then((()=>{e===this.#qr&&(this.#zr=!0)}))}}else await this.#Jr()}async dispatchWillSave(){return this.#Gr?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#Gr?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){if(this.#Gr){await(this.#Kr?.promise),this.#Kr=new r.PromiseCapability;try{await this.#Gr.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(e){throw this.#Kr.resolve(),this.#Kr=null,e}await this.#Kr.promise}}async dispatchDidPrint(){return this.#Gr?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#Ur?.promise||null}get ready(){return this.#zr}get _internalEvents(){return(0,r.shadow)(this,"_internalEvents",new Map)}get _pageOpenPending(){return(0,r.shadow)(this,"_pageOpenPending",new Set)}get _visitedPages(){return(0,r.shadow)(this,"_visitedPages",new Map)}async#ts(e){const t=this.#Xr,n=t.isInPresentationMode||t.isChangingPresentationMode,{id:r,siblings:s,command:o,value:a}=e;if(!r){switch(o){case"clear":console.clear();break;case"error":console.error(a);break;case"layout":if(!n){const e=(0,i.apiPageLayoutToViewerModes)(a);t.spreadMode=e.spreadMode}break;case"page-num":t.currentPageNumber=a+1;break;case"print":await t.pagesPromise,this.#Zr.dispatch("print",{source:this});break;case"println":console.log(a);break;case"zoom":n||(t.currentScaleValue=a);break;case"SaveAs":this.#Zr.dispatch("download",{source:this});break;case"FirstPage":t.currentPageNumber=1;break;case"LastPage":t.currentPageNumber=t.pagesCount;break;case"NextPage":t.nextPage();break;case"PrevPage":t.previousPage();break;case"ZoomViewIn":n||t.increaseScale();break;case"ZoomViewOut":n||t.decreaseScale();break;case"WillPrintFinished":this.#Kr?.resolve(),this.#Kr=null}return}if(n&&e.focus)return;delete e.id,delete e.siblings;const l=s?[r,...s]:[r];for(const t of l){const n=document.querySelector(`[data-element-id="${t}"]`);n?n.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:e})):this.#qr?.annotationStorage.setValue(t,e)}}async#is(e,t=!1){const n=this.#qr,s=this._visitedPages;if(t&&(this.#Vr=new r.PromiseCapability),!this.#Vr)return;const o=this.#Xr.getPageView(e-1);if(o?.renderingState!==i.RenderingStates.FINISHED)return void this._pageOpenPending.add(e);this._pageOpenPending.delete(e);const a=(async()=>{const t=await(s.has(e)?null:o.pdfPage?.getJSActions());n===this.#qr&&await(this.#Gr?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:e,actions:t}))})();s.set(e,a)}async#ns(e){const t=this.#qr,n=this._visitedPages;if(!this.#Vr)return;if(this._pageOpenPending.has(e))return;const i=n.get(e);i&&(n.set(e,null),await i,t===this.#qr&&await(this.#Gr?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:e})))}#es(){if(this.#Ur=new r.PromiseCapability,this.#Gr)throw new Error("#initScripting: Scripting already exists.");return this.#Hr.createScripting({sandboxBundleSrc:this.#Yr})}async#Jr(){if(!this.#Gr)return this.#qr=null,void this.#Ur?.resolve();this.#Vr&&(await Promise.race([this.#Vr.promise,new Promise((e=>{setTimeout(e,1e3)}))]).catch((()=>{})),this.#Vr=null),this.#qr=null;try{await this.#Gr.destroySandbox()}catch{}this.#Kr?.reject(new Error("Scripting destroyed.")),this.#Kr=null;for(const[e,t]of this._internalEvents)this.#Zr._off(e,t);this._internalEvents.clear(),this._pageOpenPending.clear(),this._visitedPages.clear(),this.#Gr=null,this.#zr=!1,this.#Ur?.resolve()}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFSinglePageViewer=void 0;var i=n(2),r=n(25);class s extends r.PDFViewer{_resetView(){super._resetView(),this._scrollMode=i.ScrollMode.PAGE,this._spreadMode=i.SpreadMode.NONE}set scrollMode(e){}_updateScrollMode(){}set spreadMode(e){}_updateSpreadMode(){}}t.PDFSinglePageViewer=s},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PagesCountLimit=t.PDFViewer=t.PDFPageViewBuffer=void 0;var i=n(4),r=n(2),s=n(7),o=n(13),a=n(26),l=n(5);const c={FORCE_SCROLL_MODE_PAGE:15e3,FORCE_LAZY_PAGE_INIT:7500,PAUSE_EAGER_PAGE_INIT:250};function h(e){return Object.values(i.AnnotationEditorType).includes(e)&&e!==i.AnnotationEditorType.DISABLE}t.PagesCountLimit=c;class d{#rs=new Set;#ss=0;constructor(e){this.#ss=e}push(e){const t=this.#rs;t.has(e)&&t.delete(e),t.add(e),t.size>this.#ss&&this.#os()}resize(e,t=null){this.#ss=e;const n=this.#rs;if(t){const e=n.size;let i=1;for(const r of n)if(t.has(r.id)&&(n.delete(r),n.add(r)),++i>e)break}for(;n.size>this.#ss;)this.#os()}has(e){return this.#rs.has(e)}[Symbol.iterator](){return this.#rs.keys()}#os(){const e=this.#rs.keys().next().value;e?.destroy(),this.#rs.delete(e)}}t.PDFPageViewBuffer=d;t.PDFViewer=class{#as=null;#ie=null;#ls=i.AnnotationEditorType.NONE;#cs=null;#hr=i.AnnotationMode.ENABLE_FORMS;#hs=null;#ds=null;#Dr=!1;#us=!1;#ps=null;#fs=!1;#ms=0;#gs=new ResizeObserver(this.#Os.bind(this));#ys=null;#vs=null;#bs=null;#Or=r.TextLayerMode.ENABLE;constructor(e){const t="3.11.174";if(i.version!==t)throw new Error(`The API version "${i.version}" does not match the Viewer version "${t}".`);if(this.container=e.container,this.viewer=e.viewer||e.container.firstElementChild,"DIV"!==this.container?.tagName||"DIV"!==this.viewer?.tagName)throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&"absolute"!==getComputedStyle(this.container).position)throw new Error("The `container` must be absolutely positioned.");this.#gs.observe(this.container),this.eventBus=e.eventBus,this.linkService=e.linkService||new l.SimpleLinkService,this.downloadManager=e.downloadManager||null,this.findController=e.findController||null,this.#ie=e.altTextManager||null,this.findController&&(this.findController.onIsPageVisible=e=>this._getVisiblePages().ids.has(e)),this._scriptingManager=e.scriptingManager||null,this.#Or=e.textLayerMode??r.TextLayerMode.ENABLE,this.#hr=e.annotationMode??i.AnnotationMode.ENABLE_FORMS,this.#ls=e.annotationEditorMode??i.AnnotationEditorType.NONE,this.imageResourcesPath=e.imageResourcesPath||"",this.enablePrintAutoRotate=e.enablePrintAutoRotate||!1,this.removePageBorders=e.removePageBorders||!1,e.useOnlyCssZoom&&(console.error("useOnlyCssZoom was removed, please use `maxCanvasPixels = 0` instead."),e.maxCanvasPixels=0),this.isOffscreenCanvasSupported=e.isOffscreenCanvasSupported??!0,this.maxCanvasPixels=e.maxCanvasPixels,this.l10n=e.l10n||s.NullL10n,this.#Dr=e.enablePermissions||!1,this.pageColors=e.pageColors||null,this.defaultRenderingQueue=!e.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new a.PDFRenderingQueue,this.renderingQueue.setViewer(this)):this.renderingQueue=e.renderingQueue,this.scroll=(0,r.watchScroll)(this.container,this._scrollUpdate.bind(this)),this.presentationModeState=r.PresentationModeState.UNKNOWN,this._onBeforeDraw=this._onAfterDraw=null,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#ws(),this.eventBus._on("thumbnailrendered",(({pageNumber:e,pdfPage:t})=>{const n=this._pages[e-1];this.#as.has(n)||t?.cleanup()}))}get pagesCount(){return this._pages.length}getPageView(e){return this._pages[e]}getCachedPageViews(){return new Set(this.#as)}get pageViewsReady(){return this._pagesCapability.settled&&this._pages.every((e=>e?.pdfPage))}get renderForms(){return this.#hr===i.AnnotationMode.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(e){if(!Number.isInteger(e))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(e,!0)||console.error(`currentPageNumber: "${e}" is not a valid page.`))}_setCurrentPageNumber(e,t=!1){if(this._currentPageNumber===e)return t&&this.#Ss(),!0;if(!(0<e&&e<=this.pagesCount))return!1;const n=this._currentPageNumber;return this._currentPageNumber=e,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:e,pageLabel:this._pageLabels?.[e-1]??null,previous:n}),t&&this.#Ss(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(e){if(!this.pdfDocument)return;let t=0|e;if(this._pageLabels){const n=this._pageLabels.indexOf(e);n>=0&&(t=n+1)}this._setCurrentPageNumber(t,!0)||console.error(`currentPageLabel: "${e}" is not a valid page.`)}get currentScale(){return this._currentScale!==r.UNKNOWN_SCALE?this._currentScale:r.DEFAULT_SCALE}set currentScale(e){if(isNaN(e))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#xs(e,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(e){this.pdfDocument&&this.#xs(e,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(e){if(!(0,r.isValidRotation)(e))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument)return;if((e%=360)<0&&(e+=360),this._pagesRotation===e)return;this._pagesRotation=e;const t=this._currentPageNumber;this.refresh(!0,{rotation:e}),this._currentScaleValue&&this.#xs(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:e,pageNumber:t}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}#ur(){const e=this;return{get annotationEditorUIManager(){return e.#cs},get annotationStorage(){return e.pdfDocument?.annotationStorage},get downloadManager(){return e.downloadManager},get enableScripting(){return!!e._scriptingManager},get fieldObjectsPromise(){return e.pdfDocument?.getFieldObjects()},get findController(){return e.findController},get hasJSActionsPromise(){return e.pdfDocument?.hasJSActions()},get linkService(){return e.linkService}}}#Cs(e){const t={annotationEditorMode:this.#ls,annotationMode:this.#hr,textLayerMode:this.#Or};return e?(e.includes(i.PermissionFlag.COPY)||this.#Or!==r.TextLayerMode.ENABLE||(t.textLayerMode=r.TextLayerMode.ENABLE_PERMISSIONS),e.includes(i.PermissionFlag.MODIFY_CONTENTS)||(t.annotationEditorMode=i.AnnotationEditorType.DISABLE),e.includes(i.PermissionFlag.MODIFY_ANNOTATIONS)||e.includes(i.PermissionFlag.FILL_INTERACTIVE_FORMS)||this.#hr!==i.AnnotationMode.ENABLE_FORMS||(t.annotationMode=i.AnnotationMode.ENABLE),t):t}#_s(){if("hidden"===document.visibilityState||!this.container.offsetParent||0===this._getVisiblePages().views.length)return Promise.resolve();const e=new Promise((e=>{this.#vs=()=>{"hidden"===document.visibilityState&&(e(),document.removeEventListener("visibilitychange",this.#vs),this.#vs=null)},document.addEventListener("visibilitychange",this.#vs)}));return Promise.race([this._onePageRenderedCapability.promise,e])}async getAllText(){const e=[],t=[];for(let n=1,i=this.pdfDocument.numPages;n<=i;++n){if(this.#fs)return null;t.length=0;const i=await this.pdfDocument.getPage(n),{items:s}=await i.getTextContent();for(const e of s)e.str&&t.push(e.str),e.hasEOL&&t.push("\n");e.push((0,r.removeNullCharacters)(t.join("")))}return e.join("\n")}#Es(e,t){const n=document.getSelection(),{focusNode:i,anchorNode:s}=n;if(s&&i&&n.containsNode(this.#ps)){if(this.#us||e===r.TextLayerMode.ENABLE_PERMISSIONS)return t.preventDefault(),void t.stopPropagation();this.#us=!0;const n=this.container.style.cursor;this.container.style.cursor="wait";const i=e=>this.#fs="Escape"===e.key;window.addEventListener("keydown",i),this.getAllText().then((async e=>{null!==e&&await navigator.clipboard.writeText(e)})).catch((e=>{console.warn(`Something goes wrong when extracting the text: ${e.message}`)})).finally((()=>{this.#us=!1,this.#fs=!1,window.removeEventListener("keydown",i),this.container.style.cursor=n})),t.preventDefault(),t.stopPropagation()}}setDocument(e){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#cs&&(this.#cs.destroy(),this.#cs=null)),this.pdfDocument=e,!e)return;const t=e.numPages,n=e.getPage(1),s=e.getOptionalContentConfig(),a=this.#Dr?e.getPermissions():Promise.resolve();if(t>c.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const e=this._scrollMode=r.ScrollMode.PAGE;this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e})}this._pagesCapability.promise.then((()=>{this.eventBus.dispatch("pagesloaded",{source:this,pagesCount:t})}),(()=>{})),this._onBeforeDraw=e=>{const t=this._pages[e.pageNumber-1];t&&this.#as.push(t)},this.eventBus._on("pagerender",this._onBeforeDraw),this._onAfterDraw=e=>{e.cssTransform||this._onePageRenderedCapability.settled||(this._onePageRenderedCapability.resolve({timestamp:e.timestamp}),this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null,this.#vs&&(document.removeEventListener("visibilitychange",this.#vs),this.#vs=null))},this.eventBus._on("pagerendered",this._onAfterDraw),Promise.all([n,a]).then((([n,a])=>{if(e!==this.pdfDocument)return;this._firstPageCapability.resolve(n),this._optionalContentConfigPromise=s;const{annotationEditorMode:l,annotationMode:d,textLayerMode:u}=this.#Cs(a);if(u!==r.TextLayerMode.DISABLE){const e=this.#ps=document.createElement("div");e.id="hiddenCopyElement",this.viewer.before(e)}if(l!==i.AnnotationEditorType.DISABLE){const t=l;e.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):h(t)?(this.#cs=new i.AnnotationEditorUIManager(this.container,this.viewer,this.#ie,this.eventBus,e,this.pageColors),t!==i.AnnotationEditorType.NONE&&this.#cs.updateMode(t)):console.error(`Invalid AnnotationEditor mode: ${t}`)}const p=this.#ur.bind(this),f=this._scrollMode===r.ScrollMode.PAGE?null:this.viewer,m=this.currentScale,g=n.getViewport({scale:m*i.PixelsPerInch.PDF_TO_CSS_UNITS});this.viewer.style.setProperty("--scale-factor",g.scale),"CanvasText"!==this.pageColors?.foreground&&"Canvas"!==this.pageColors?.background||this.viewer.style.setProperty("--hcm-highligh-filter",e.filterFactory.addHighlightHCMFilter("CanvasText","Canvas","HighlightText","Highlight"));for(let e=1;e<=t;++e){const t=new o.PDFPageView({container:f,eventBus:this.eventBus,id:e,scale:m,defaultViewport:g.clone(),optionalContentConfigPromise:s,renderingQueue:this.renderingQueue,textLayerMode:u,annotationMode:d,imageResourcesPath:this.imageResourcesPath,isOffscreenCanvasSupported:this.isOffscreenCanvasSupported,maxCanvasPixels:this.maxCanvasPixels,pageColors:this.pageColors,l10n:this.l10n,layerProperties:p});this._pages.push(t)}const O=this._pages[0];O&&(O.setPdfPage(n),this.linkService.cachePageRef(1,n.ref)),this._scrollMode===r.ScrollMode.PAGE?this.#Ps():this._spreadMode!==r.SpreadMode.NONE&&this._updateSpreadMode(),this.#_s().then((async()=>{if(this.findController?.setDocument(e),this._scriptingManager?.setDocument(e),this.#ps&&(this.#ds=this.#Es.bind(this,u),document.addEventListener("copy",this.#ds)),this.#cs&&this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:this.#ls}),e.loadingParams.disableAutoFetch||t>c.FORCE_LAZY_PAGE_INIT)return void this._pagesCapability.resolve();let n=t-1;if(n<=0)this._pagesCapability.resolve();else for(let i=2;i<=t;++i){const t=e.getPage(i).then((e=>{const t=this._pages[i-1];t.pdfPage||t.setPdfPage(e),this.linkService.cachePageRef(i,e.ref),0==--n&&this._pagesCapability.resolve()}),(e=>{console.error(`Unable to get page ${i} to initialize viewer`,e),0==--n&&this._pagesCapability.resolve()}));i%c.PAUSE_EAGER_PAGE_INIT==0&&await t}})),this.eventBus.dispatch("pagesinit",{source:this}),e.getMetadata().then((({info:t})=>{e===this.pdfDocument&&t.Language&&(this.viewer.lang=t.Language)})),this.defaultRenderingQueue&&this.update()})).catch((e=>{console.error("Unable to initialize viewer",e),this._pagesCapability.reject(e)}))}setPageLabels(e){if(this.pdfDocument){e?Array.isArray(e)&&this.pdfDocument.numPages===e.length?this._pageLabels=e:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let e=0,t=this._pages.length;e<t;e++)this._pages[e].setPageLabel(this._pageLabels?.[e]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=r.UNKNOWN_SCALE,this._currentScaleValue=null,this._pageLabels=null,this.#as=new d(10),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=new i.PromiseCapability,this._onePageRenderedCapability=new i.PromiseCapability,this._pagesCapability=new i.PromiseCapability,this._scrollMode=r.ScrollMode.VERTICAL,this._previousScrollMode=r.ScrollMode.UNKNOWN,this._spreadMode=r.SpreadMode.NONE,this.#ys={previousPageNumber:1,scrollDown:!0,pages:[]},this._onBeforeDraw&&(this.eventBus._off("pagerender",this._onBeforeDraw),this._onBeforeDraw=null),this._onAfterDraw&&(this.eventBus._off("pagerendered",this._onAfterDraw),this._onAfterDraw=null),this.#vs&&(document.removeEventListener("visibilitychange",this.#vs),this.#vs=null),this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#ps&&(document.removeEventListener("copy",this.#ds),this.#ds=null,this.#ps.remove(),this.#ps=null)}#Ps(){if(this._scrollMode!==r.ScrollMode.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const e=this._currentPageNumber,t=this.#ys,n=this.viewer;if(n.textContent="",t.pages.length=0,this._spreadMode!==r.SpreadMode.NONE||this.isInPresentationMode){const i=new Set,r=this._spreadMode-1;-1===r?i.add(e-1):e%2!==r?(i.add(e-1),i.add(e)):(i.add(e-2),i.add(e-1));const s=document.createElement("div");if(s.className="spread",this.isInPresentationMode){const e=document.createElement("div");e.className="dummyPage",s.append(e)}for(const e of i){const n=this._pages[e];n&&(s.append(n.div),t.pages.push(n))}n.append(s)}else{const i=this._pages[e-1];n.append(i.div),t.pages.push(i)}t.scrollDown=e>=t.previousPageNumber,t.previousPageNumber=e}_scrollUpdate(){0!==this.pagesCount&&this.update()}#ks(e,t=null){const{div:n,id:i}=e;if(this._currentPageNumber!==i&&this._setCurrentPageNumber(i),this._scrollMode===r.ScrollMode.PAGE&&(this.#Ps(),this.update()),!t&&!this.isInPresentationMode){const e=n.offsetLeft+n.clientLeft,i=e+n.clientWidth,{scrollLeft:s,clientWidth:o}=this.container;(this._scrollMode===r.ScrollMode.HORIZONTAL||e<s||i>s+o)&&(t={left:0,top:0})}(0,r.scrollIntoView)(n,t),!this._currentScaleValue&&this._location&&(this._location=null)}#Ts(e){return e===this._currentScale||Math.abs(e-this._currentScale)<1e-15}#As(e,t,{noScroll:n=!1,preset:r=!1,drawingDelay:s=-1}){if(this._currentScaleValue=t.toString(),this.#Ts(e))return void(r&&this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:t}));this.viewer.style.setProperty("--scale-factor",e*i.PixelsPerInch.PDF_TO_CSS_UNITS);const o=s>=0&&s<1e3;if(this.refresh(!0,{scale:e,drawingDelay:o?s:-1}),o&&(this.#bs=setTimeout((()=>{this.#bs=null,this.refresh()}),s)),this._currentScale=e,!n){let e,t=this._currentPageNumber;!this._location||this.isInPresentationMode||this.isChangingPresentationMode||(t=this._location.pageNumber,e=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:t,destArray:e,allowNegativeOffset:!0})}this.eventBus.dispatch("scalechanging",{source:this,scale:e,presetValue:r?t:void 0}),this.defaultRenderingQueue&&this.update()}get#Rs(){return this._spreadMode!==r.SpreadMode.NONE&&this._scrollMode!==r.ScrollMode.HORIZONTAL?2:1}#xs(e,t){let n=parseFloat(e);if(n>0)t.preset=!1,this.#As(n,e,t);else{const i=this._pages[this._currentPageNumber-1];if(!i)return;let s=r.SCROLLBAR_PADDING,o=r.VERTICAL_PADDING;this.isInPresentationMode?(s=o=4,this._spreadMode!==r.SpreadMode.NONE&&(s*=2)):this.removePageBorders?s=o=0:this._scrollMode===r.ScrollMode.HORIZONTAL&&([s,o]=[o,s]);const a=(this.container.clientWidth-s)/i.width*i.scale/this.#Rs,l=(this.container.clientHeight-o)/i.height*i.scale;switch(e){case"page-actual":n=1;break;case"page-width":n=a;break;case"page-height":n=l;break;case"page-fit":n=Math.min(a,l);break;case"auto":const t=(0,r.isPortraitOrientation)(i)?a:Math.min(l,a);n=Math.min(r.MAX_AUTO_SCALE,t);break;default:return void console.error(`#setScale: "${e}" is an unknown zoom value.`)}t.preset=!0,this.#As(n,e,t)}}#Ss(){const e=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#xs(this._currentScaleValue,{noScroll:!0}),this.#ks(e)}pageLabelToPageNumber(e){if(!this._pageLabels)return null;const t=this._pageLabels.indexOf(e);return t<0?null:t+1}scrollPageIntoView({pageNumber:e,destArray:t=null,allowNegativeOffset:n=!1,ignoreDestinationZoom:s=!1}){if(!this.pdfDocument)return;const o=Number.isInteger(e)&&this._pages[e-1];if(!o)return void console.error(`scrollPageIntoView: "${e}" is not a valid pageNumber parameter.`);if(this.isInPresentationMode||!t)return void this._setCurrentPageNumber(e,!0);let a,l,c=0,h=0,d=0,u=0;const p=o.rotation%180!=0,f=(p?o.height:o.width)/o.scale/i.PixelsPerInch.PDF_TO_CSS_UNITS,m=(p?o.width:o.height)/o.scale/i.PixelsPerInch.PDF_TO_CSS_UNITS;let g=0;switch(t[1].name){case"XYZ":c=t[2],h=t[3],g=t[4],c=null!==c?c:0,h=null!==h?h:m;break;case"Fit":case"FitB":g="page-fit";break;case"FitH":case"FitBH":h=t[2],g="page-width",null===h&&this._location?(c=this._location.left,h=this._location.top):("number"!=typeof h||h<0)&&(h=m);break;case"FitV":case"FitBV":c=t[2],d=f,u=m,g="page-height";break;case"FitR":c=t[2],h=t[3],d=t[4]-c,u=t[5]-h;let e=r.SCROLLBAR_PADDING,n=r.VERTICAL_PADDING;this.removePageBorders&&(e=n=0),a=(this.container.clientWidth-e)/d/i.PixelsPerInch.PDF_TO_CSS_UNITS,l=(this.container.clientHeight-n)/u/i.PixelsPerInch.PDF_TO_CSS_UNITS,g=Math.min(Math.abs(a),Math.abs(l));break;default:return void console.error(`scrollPageIntoView: "${t[1].name}" is not a valid destination type.`)}if(s||(g&&g!==this._currentScale?this.currentScaleValue=g:this._currentScale===r.UNKNOWN_SCALE&&(this.currentScaleValue=r.DEFAULT_SCALE_VALUE)),"page-fit"===g&&!t[4])return void this.#ks(o);const O=[o.viewport.convertToViewportPoint(c,h),o.viewport.convertToViewportPoint(c+d,h+u)];let y=Math.min(O[0][0],O[1][0]),v=Math.min(O[0][1],O[1][1]);n||(y=Math.max(y,0),v=Math.max(v,0)),this.#ks(o,{left:y,top:v})}_updateLocation(e){const t=this._currentScale,n=this._currentScaleValue,i=parseFloat(n)===t?Math.round(1e4*t)/100:n,r=e.id,s=this._pages[r-1],o=this.container,a=s.getPagePoint(o.scrollLeft-e.x,o.scrollTop-e.y),l=Math.round(a[0]),c=Math.round(a[1]);let h=`#page=${r}`;this.isInPresentationMode||(h+=`&zoom=${i},${l},${c}`),this._location={pageNumber:r,scale:i,top:c,left:l,rotation:this._pagesRotation,pdfOpenParams:h}}update(){const e=this._getVisiblePages(),t=e.views,n=t.length;if(0===n)return;const i=Math.max(10,2*n+1);this.#as.resize(i,e.ids),this.renderingQueue.renderHighestPriority(e);const s=this._spreadMode===r.SpreadMode.NONE&&(this._scrollMode===r.ScrollMode.PAGE||this._scrollMode===r.ScrollMode.VERTICAL),o=this._currentPageNumber;let a=!1;for(const e of t){if(e.percent<100)break;if(e.id===o&&s){a=!0;break}}this._setCurrentPageNumber(a?o:t[0].id),this._updateLocation(e.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}containsElement(e){return this.container.contains(e)}focus(){this.container.focus()}get _isContainerRtl(){return"rtl"===getComputedStyle(this.container).direction}get isInPresentationMode(){return this.presentationModeState===r.PresentationModeState.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===r.PresentationModeState.CHANGING}get isHorizontalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return!this.isInPresentationMode&&this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const e=this._scrollMode===r.ScrollMode.PAGE?this.#ys.pages:this._pages,t=this._scrollMode===r.ScrollMode.HORIZONTAL,n=t&&this._isContainerRtl;return(0,r.getVisibleElements)({scrollEl:this.container,views:e,sortByVisibility:!0,horizontal:t,rtl:n})}cleanup(){for(const e of this._pages)e.renderingState!==r.RenderingStates.FINISHED&&e.reset()}_cancelRendering(){for(const e of this._pages)e.cancelRendering()}async#Ms(e){if(e.pdfPage)return e.pdfPage;try{const t=await this.pdfDocument.getPage(e.id);return e.pdfPage||e.setPdfPage(t),this.linkService._cachedPageNumber?.(t.ref)||this.linkService.cachePageRef(e.id,t.ref),t}catch(e){return console.error("Unable to get page for page view",e),null}}#Is(e){if(1===e.first?.id)return!0;if(e.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case r.ScrollMode.PAGE:return this.#ys.scrollDown;case r.ScrollMode.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(e){const t=e||this._getVisiblePages(),n=this.#Is(t),i=this._spreadMode!==r.SpreadMode.NONE&&this._scrollMode!==r.ScrollMode.HORIZONTAL,s=this.renderingQueue.getHighestPriority(t,this._pages,n,i);return!!s&&(this.#Ms(s).then((()=>{this.renderingQueue.renderView(s)})),!0)}get hasEqualPageSizes(){const e=this._pages[0];for(let t=1,n=this._pages.length;t<n;++t){const n=this._pages[t];if(n.width!==e.width||n.height!==e.height)return!1}return!0}getPagesOverview(){let e;return this._pages.map((t=>{const n=t.pdfPage.getViewport({scale:1}),i=(0,r.isPortraitOrientation)(n);if(void 0===e)e=i;else if(this.enablePrintAutoRotate&&i!==e)return{width:n.height,height:n.width,rotation:(n.rotation-90)%360};return{width:n.width,height:n.height,rotation:n.rotation}}))}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig()):Promise.resolve(null)}set optionalContentConfigPromise(e){if(!(e instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${e}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=e,this.refresh(!1,{optionalContentConfigPromise:e}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:e}))}get scrollMode(){return this._scrollMode}set scrollMode(e){if(this._scrollMode!==e){if(!(0,r.isValidScrollMode)(e))throw new Error(`Invalid scroll mode: ${e}`);this.pagesCount>c.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=e,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:e}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(e=null){const t=this._scrollMode,n=this.viewer;n.classList.toggle("scrollHorizontal",t===r.ScrollMode.HORIZONTAL),n.classList.toggle("scrollWrapped",t===r.ScrollMode.WRAPPED),this.pdfDocument&&e&&(t===r.ScrollMode.PAGE?this.#Ps():this._previousScrollMode===r.ScrollMode.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#xs(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(e){if(this._spreadMode!==e){if(!(0,r.isValidSpreadMode)(e))throw new Error(`Invalid spread mode: ${e}`);this._spreadMode=e,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:e}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(e=null){if(!this.pdfDocument)return;const t=this.viewer,n=this._pages;if(this._scrollMode===r.ScrollMode.PAGE)this.#Ps();else if(t.textContent="",this._spreadMode===r.SpreadMode.NONE)for(const e of this._pages)t.append(e.div);else{const e=this._spreadMode-1;let i=null;for(let r=0,s=n.length;r<s;++r)null===i?(i=document.createElement("div"),i.className="spread",t.append(i)):r%2===e&&(i=i.cloneNode(!1),t.append(i)),i.append(n[r].div)}e&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#xs(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(e,!0),this.update())}_getPageAdvance(e,t=!1){switch(this._scrollMode){case r.ScrollMode.WRAPPED:{const{views:n}=this._getVisiblePages(),i=new Map;for(const{id:e,y:t,percent:r,widthPercent:s}of n){if(0===r||s<100)continue;let n=i.get(t);n||i.set(t,n||=[]),n.push(e)}for(const n of i.values()){const i=n.indexOf(e);if(-1===i)continue;const r=n.length;if(1===r)break;if(t)for(let t=i-1,r=0;t>=r;t--){const i=n[t],r=n[t+1]-1;if(i<r)return e-r}else for(let t=i+1,s=r;t<s;t++){const i=n[t],r=n[t-1]+1;if(i>r)return r-e}if(t){const t=n[0];if(t<e)return e-t+1}else{const t=n[r-1];if(t>e)return t-e+1}break}break}case r.ScrollMode.HORIZONTAL:break;case r.ScrollMode.PAGE:case r.ScrollMode.VERTICAL:{if(this._spreadMode===r.SpreadMode.NONE)break;const n=this._spreadMode-1;if(t&&e%2!==n)break;if(!t&&e%2===n)break;const{views:i}=this._getVisiblePages(),s=t?e-1:e+1;for(const{id:e,percent:t,widthPercent:n}of i)if(e===s){if(t>0&&100===n)return 2;break}break}}return 1}nextPage(){const e=this._currentPageNumber,t=this.pagesCount;if(e>=t)return!1;const n=this._getPageAdvance(e,!1)||1;return this.currentPageNumber=Math.min(e+n,t),!0}previousPage(){const e=this._currentPageNumber;if(e<=1)return!1;const t=this._getPageAdvance(e,!0)||1;return this.currentPageNumber=Math.max(e-t,1),!0}increaseScale({drawingDelay:e,scaleFactor:t,steps:n}={}){if(!this.pdfDocument)return;let i=this._currentScale;if(t>1)i=Math.round(i*t*100)/100;else{n??=1;do{i=Math.ceil(10*(i*r.DEFAULT_SCALE_DELTA).toFixed(2))/10}while(--n>0&&i<r.MAX_SCALE)}this.#xs(Math.min(r.MAX_SCALE,i),{noScroll:!1,drawingDelay:e})}decreaseScale({drawingDelay:e,scaleFactor:t,steps:n}={}){if(!this.pdfDocument)return;let i=this._currentScale;if(t>0&&t<1)i=Math.round(i*t*100)/100;else{n??=1;do{i=Math.floor(10*(i/r.DEFAULT_SCALE_DELTA).toFixed(2))/10}while(--n>0&&i>r.MIN_SCALE)}this.#xs(Math.max(r.MIN_SCALE,i),{noScroll:!1,drawingDelay:e})}#ws(e=this.container.clientHeight){e!==this.#ms&&(this.#ms=e,r.docStyle.setProperty("--viewer-container-height",`${e}px`))}#Os(e){for(const t of e)if(t.target===this.container){this.#ws(Math.floor(t.borderBoxSize[0].blockSize)),this.#hs=null;break}}get containerTopLeft(){return this.#hs||=[this.container.offsetTop,this.container.offsetLeft]}get annotationEditorMode(){return this.#cs?this.#ls:i.AnnotationEditorType.DISABLE}set annotationEditorMode({mode:e,editId:t=null}){if(!this.#cs)throw new Error("The AnnotationEditor is not enabled.");if(this.#ls!==e){if(!h(e))throw new Error(`Invalid AnnotationEditor mode: ${e}`);this.pdfDocument&&(this.#ls=e,this.eventBus.dispatch("annotationeditormodechanged",{source:this,mode:e}),this.#cs.updateMode(e,t))}}set annotationEditorParams({type:e,value:t}){if(!this.#cs)throw new Error("The AnnotationEditor is not enabled.");this.#cs.updateParams(e,t)}refresh(e=!1,t=Object.create(null)){if(this.pdfDocument){for(const e of this._pages)e.update(t);null!==this.#bs&&(clearTimeout(this.#bs),this.#bs=null),e||this.update()}}}},(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFRenderingQueue=void 0;var i=n(4),r=n(2);t.PDFRenderingQueue=class{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(e){this.pdfViewer=e}setThumbnailViewer(e){this.pdfThumbnailViewer=e}isHighestPriority(e){return this.highestPriorityPage===e.renderingId}renderHighestPriority(e){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),this.pdfViewer.forceRendering(e)||this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),3e4))}getHighestPriority(e,t,n,i=!1){const r=e.views,s=r.length;if(0===s)return null;for(let e=0;e<s;e++){const t=r[e].view;if(!this.isViewFinished(t))return t}const o=e.first.id,a=e.last.id;if(a-o+1>s){const i=e.ids;for(let e=1,r=a-o;e<r;e++){const r=n?o+e:a-e;if(i.has(r))continue;const s=t[r-1];if(!this.isViewFinished(s))return s}}let l=n?a:o-2,c=t[l];return c&&!this.isViewFinished(c)||i&&(l+=n?1:-1,c=t[l],c&&!this.isViewFinished(c))?c:null}isViewFinished(e){return e.renderingState===r.RenderingStates.FINISHED}renderView(e){switch(e.renderingState){case r.RenderingStates.FINISHED:return!1;case r.RenderingStates.PAUSED:this.highestPriorityPage=e.renderingId,e.resume();break;case r.RenderingStates.RUNNING:this.highestPriorityPage=e.renderingId;break;case r.RenderingStates.INITIAL:this.highestPriorityPage=e.renderingId,e.draw().finally((()=>{this.renderHighestPriority()})).catch((e=>{e instanceof i.RenderingCancelledException||console.error(`renderView: "${e}"`)}))}return!0}}}],t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return e[i](s,s.exports,n),s.exports}var i={};return(()=>{var e=i;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AnnotationLayerBuilder",{enumerable:!0,get:function(){return o.AnnotationLayerBuilder}}),Object.defineProperty(e,"DownloadManager",{enumerable:!0,get:function(){return a.DownloadManager}}),Object.defineProperty(e,"EventBus",{enumerable:!0,get:function(){return l.EventBus}}),Object.defineProperty(e,"FindState",{enumerable:!0,get:function(){return t.FindState}}),Object.defineProperty(e,"GenericL10n",{enumerable:!0,get:function(){return c.GenericL10n}}),Object.defineProperty(e,"LinkTarget",{enumerable:!0,get:function(){return r.LinkTarget}}),Object.defineProperty(e,"NullL10n",{enumerable:!0,get:function(){return h.NullL10n}}),Object.defineProperty(e,"PDFFindController",{enumerable:!0,get:function(){return t.PDFFindController}}),Object.defineProperty(e,"PDFHistory",{enumerable:!0,get:function(){return d.PDFHistory}}),Object.defineProperty(e,"PDFLinkService",{enumerable:!0,get:function(){return r.PDFLinkService}}),Object.defineProperty(e,"PDFPageView",{enumerable:!0,get:function(){return u.PDFPageView}}),Object.defineProperty(e,"PDFScriptingManager",{enumerable:!0,get:function(){return p.PDFScriptingManager}}),Object.defineProperty(e,"PDFSinglePageViewer",{enumerable:!0,get:function(){return f.PDFSinglePageViewer}}),Object.defineProperty(e,"PDFViewer",{enumerable:!0,get:function(){return m.PDFViewer}}),Object.defineProperty(e,"ProgressBar",{enumerable:!0,get:function(){return s.ProgressBar}}),Object.defineProperty(e,"RenderingStates",{enumerable:!0,get:function(){return s.RenderingStates}}),Object.defineProperty(e,"ScrollMode",{enumerable:!0,get:function(){return s.ScrollMode}}),Object.defineProperty(e,"SimpleLinkService",{enumerable:!0,get:function(){return r.SimpleLinkService}}),Object.defineProperty(e,"SpreadMode",{enumerable:!0,get:function(){return s.SpreadMode}}),Object.defineProperty(e,"StructTreeLayerBuilder",{enumerable:!0,get:function(){return g.StructTreeLayerBuilder}}),Object.defineProperty(e,"TextLayerBuilder",{enumerable:!0,get:function(){return O.TextLayerBuilder}}),Object.defineProperty(e,"XfaLayerBuilder",{enumerable:!0,get:function(){return y.XfaLayerBuilder}}),Object.defineProperty(e,"parseQueryString",{enumerable:!0,get:function(){return s.parseQueryString}});var t=n(1),r=n(5),s=n(2),o=n(6),a=n(8),l=n(9),c=n(10),h=n(7),d=n(12),u=n(13),p=n(21),f=n(24),m=n(25),g=n(16),O=n(19),y=n(20)})(),i})()))}(pdf_viewer);var pdf_viewerExports=pdf_viewer.exports;const PdfViewer=({src:e,pdfCMapsUrl:t,pdfWorkerUrl:n})=>{const i=React.useRef(null),r=React.useRef(null),s=React.useRef(null),[o,a]=React.useState((()=>new pdf_viewerExports.EventBus)),[l,c]=React.useState((()=>new pdf_viewerExports.PDFLinkService({eventBus:o}))),[h,d]=React.useState((()=>new pdf_viewerExports.PDFFindController({eventBus:o,linkService:l}))),[u,p]=React.useState(),f=t||"",m=n||"";pdfjsLib.GlobalWorkerOptions.workerSrc=m;const[g,O]=React.useState(),y=React.useCallback((e=>{O(e)}),[]);function v(e){u&&(u.currentScaleValue="number"==typeof e?e.toFixed(2):e)}function b(e){u&&(u.currentPageNumber=e)}function w(e){e.target.setSelectionRange(0,e.target.value.length)}return React.useEffect((()=>{let e=u;if(g)return!u&&o&&(e=new pdf_viewerExports.PDFViewer({container:g,eventBus:o,linkService:l,findController:h}),l.setViewer(e),p(e),o.on("scalechanging",(function(){s.current.value=Math.round(100*e.currentScale).toFixed(0)+"%"})),o.on("pagechanging",(function(){i.current&&(i.current.value=e.currentPageNumber.toFixed(0))})),o.on("pagesinit",(function(){e.currentScaleValue="auto",i.current.value="1",r.current.innerText=e.pagesCount.toFixed(0)}))),()=>{e&&(e.cleanup(),p(null))}}),[g]),React.useEffect((()=>{if(e&&u){let t=pdfjsLib.getDocument({url:e,enableXfa:true,cMapUrl:f,cMapPacked:true});return t.promise.then((e=>{u.setDocument(e),l.setDocument(e,null)})),()=>{if(t){try{null==t||t.destroy()}catch(e){}try{u.setDocument(null)}catch(e){}try{l.setDocument(null,null)}catch(e){}}}}}),[e,u]),React.createElement("div",{className:"wy-content-pdf","data-controller":"pdf","data-pdf-url-value":""},React.createElement("div",{className:"wy-toolbars-bottom"},React.createElement("nav",{className:"wy-toolbar wy-toolbar-center"},React.createElement("div",{className:"wy-toolbar-buttons"},React.createElement("input",{type:"text",className:"wy-input",ref:i,onChange:function(){if(u&&i.current){let e=parseInt(i.current.value);isNaN(e)?b(u.currentPageNumber):e>u.pagesCount?b(u.pagesCount):b(e<=0?1:e)}},onClick:w,"data-pdf-target":"pageNumber"}),React.createElement("span",{className:"wy-toolbar-text"},"/"),React.createElement("span",{className:"wy-toolbar-text",ref:r},"1")),React.createElement("div",{className:"wy-toolbar-buttons"},React.createElement("button",{className:"wy-button wy-button-icon btn-zoom-out",onClick:function(){if(u){let e=u.currentScale,t=1;do{e/=1.1,e=Math.floor(10*e)/10,e=Math.max(.2,e)}while(--t>0&&e>.2);v(e)}},title:"Zoom out"},React.createElement(UIIcon.UI,{name:"minus"})),React.createElement("input",{type:"text",className:"wy-input",ref:s,onChange:function(){if(u&&s.current){let e=parseFloat(s.current.value.replace("%",""));isNaN(e)?v(u.currentScale+1e-4):v(e/100)}},onClick:w,value:"100%","data-pdf-target":"zoomLevel"}),React.createElement("button",{className:"wy-button wy-button-icon btn-zoom-in",onClick:function(){if(console.debug("zoomIn"),u){let e=u.currentScale,t=1;do{e*=1.1,e=Math.floor(10*e)/10,e=Math.min(3,e)}while(--t>0&&e<3);v(e)}},title:"Zoom in"},React.createElement(UIIcon.UI,{name:"plus"}))),React.createElement("div",{className:"wy-toolbar-buttons"},React.createElement("button",{className:"wy-button wy-button-icon btn-fit-page",onClick:function(){v("page-width")},title:"Fit to width"},React.createElement(UIIcon.UI,{name:"fit-width"})),React.createElement("button",{className:"wy-button wy-button-icon",onClick:function(){v("page-fit")},title:"Fit to screen"},React.createElement(UIIcon.UI,{name:"fit-screen"}))))),React.createElement("div",{ref:y,className:"wy-pdf-container"},React.createElement("div",{id:"viewer",className:"pdfViewer"})))};function checkImageLoad(e){e.complete&&0!==e.naturalHeight?e.classList.contains("wy-loading")?e.decode().then((()=>{e.classList.add("wy-loaded")})):e.classList.add("wy-loading","wy-loaded"):e.classList.add("wy-loading")}function imageLoaded(e){var t=e.target;"IMG"===t.tagName&&t.classList.contains("wy-loading")&&!t.classList.contains("wy-loaded")&&t.classList.add("wy-loaded")}const Image$1=({src:e,previewSrc:t,width:n,height:i,more:r,onClick:s})=>{let o=n/i||1,a=o.toPrecision(5),l=(64*o).toPrecision(5)+"px",c=(100/o).toPrecision(5)+"%",h=n+"px",d=n>0?2*n+"px":"none";const u=React.useCallback((e=>{e&&checkImageLoad(e)}),[]);return React.createElement("a",{href:e,className:"wy-image",onClick:e=>s(e),style:{flexBasis:l,flexGrow:a,flexShrink:a,width:h,maxWidth:d}},React.createElement("div",{className:"wy-image-area",style:{paddingBottom:c}},React.createElement("img",{ref:u,src:t,onLoad:imageLoaded,alt:"",loading:"lazy",decoding:"async"}),!!r&&React.createElement("span",{className:"wy-more"},"+",r)))},ImageGrid=({children:e,limit:t=3})=>{let n=React.Children.toArray(e),i=n.length>t?n.length-t:0,r=n.slice(0,t),s=r[r.length-1];if(React.isValidElement(s)){let e={more:i};r[r.length-1]=React.cloneElement(s,e)}return React.createElement("div",{className:"wy-image-grid"},r)},getStream=e=>{if(e&&e.ok&&e.body){const t=e.body.getReader();return new ReadableStream({start(e){let n=()=>t.read().then((({done:t,value:i})=>{if(!t)return e.enqueue(i),n();e.close()}));return n()}})}},PreviewImage=({src:e,width:t,height:n})=>{const i=React.useCallback((e=>{e&&checkImageLoad(e)}),[]);return React.createElement(React.Fragment,null,t&&n?React.createElement("div",{className:"wy-content-image wy-responsive-image",style:{"--width":t,"--height":n}},React.createElement("img",{className:"wy-loading-transition",ref:i,src:e,onLoad:imageLoaded,width:t,height:n,decoding:"async"}),React.createElement(UISpinner.UI,null)):React.createElement("div",{className:"wy-content-image wy-responsive-image wy-intrinsic-image"},React.createElement("img",{ref:i,src:e,onLoad:imageLoaded,decoding:"async"})))},PreviewDocument=({src:e,client:t})=>{let n=new URL("/js/pdf.worker.min.js",t.url).toString(),i=new URL("/cmaps/",t.url).toString();return React.createElement(PdfViewer,{src:e,pdfWorkerUrl:n,pdfCMapsUrl:i})};function mediaFallback(e){e.classList.contains("wy-loading")&&e.classList.add("wy-loaded"),e.classList.add("wy-error"),e.outerHTML=e.outerHTML.replace(/<(video|audio)/,"<div").replace(/(video|audio)>/,"div>")}function mediaLoaded(e){var t=e.target;"VIDEO"!==t.tagName&&"AUDIO"!==t.tagName||t.classList.contains("wy-loading")&&t.classList.add("wy-loaded")}function mediaError(e){var t,n=e.target;"SOURCE"===n.tagName&&((t=n.parentNode).dataset.errors=(t.dataset.errors||0)+1,t.querySelectorAll("source").length>=t.dataset.errors&&(console.warn(t.tagName.toLowerCase()+" source error, switching to fallback"),mediaFallback(t)))}function codecError(e){var t=e.target;"VIDEO"!==t.tagName&&"AUDIO"!==t.tagName||("VIDEO"===t.tagName&&!t.videoWidth||"AUDIO"===t.tagName&&!t.duration)&&(console.warn(t.tagName.toLowerCase()+" track not available, switching to fallback"),mediaFallback(t))}const PreviewMedia=({format:e,src:t,name:n,mediaType:i})=>{const[r,s]=React.useState(),o=React.useCallback((e=>{e&&(e.classList.add("wy-loading"),s(e))}),[]);return React.useEffect((()=>{if(r)return r.addEventListener("error",mediaError,!0),r.addEventListener("loadedmetadata",mediaLoaded,!0),r.addEventListener("loadedmetadata",codecError,!0),()=>{r.pause(),r.removeAttribute("autoplay"),r.setAttribute("preload","none"),r.removeEventListener("error",mediaError,!0),r.removeEventListener("loadedmetadata",mediaLoaded,!0),r.removeEventListener("loadedmetadata",codecError,!0)}}),[r]),"video"===e?React.createElement(React.Fragment,null,React.createElement("video",{ref:o,className:"wy-content-video",controls:!0,crossOrigin:"use-credentials",autoPlay:!0},React.createElement("source",{src:t,type:i}),React.createElement(PreviewIcon,{src:t,icon:"file-video"})),React.createElement(UISpinner.UI,null)):React.createElement(React.Fragment,null,React.createElement("audio",{ref:o,className:"wy-content-audio",controls:!0,crossOrigin:"use-credentials",autoPlay:!0},React.createElement("source",{src:t,type:i})))},PreviewText=({src:e,html:t=!1,code:n=!1})=>{const[i,r]=React.useState("");return React.useEffect((()=>{fetch(e).then(getStream).then((e=>new Response(e))).then((e=>e.text())).then((e=>{r(e)}))}),[e]),React.createElement(React.Fragment,null,t?n?React.createElement("div",{className:"wy-content-code wy-code",dangerouslySetInnerHTML:{__html:i}}):React.createElement("div",{className:"wy-document wy-light"},React.createElement("div",{className:"wy-content-html",dangerouslySetInnerHTML:{__html:i}})):n?React.createElement("div",{className:"wy-content-code"},i):React.createElement("div",{className:"wy-document wy-light"},React.createElement("pre",{className:"wy-content-text"},i)))},PreviewEmbed=({src:e,name:t,icon:n,provider:i})=>{const[r,s]=React.useState(),o=React.useCallback((e=>{e&&(e.classList.add("wy-loading"),s(e))}),[]);return React.useEffect((()=>{if(r){let e=setTimeout((function(){r.classList.add("wy-fallback")}),2500),t=t=>{var n=t.target;"OBJECT"===n.tagName&&n.classList.contains("wy-loading")&&!n.classList.contains("wy-loaded")&&(n.classList.add("wy-loaded"),clearTimeout(e))};return r.addEventListener("load",t,!0),()=>{r.removeEventListener("load",t,!0),clearTimeout(e)}}}),[r]),React.createElement(React.Fragment,null,React.createElement("object",{ref:o,className:"wy-content-iframe",data:e}),React.createElement(UISpinner.UI,null),React.createElement(PreviewIcon,{src:e,icon:n,provider:i,className:"wy-content-iframe-fallback"}))},PreviewIcon=({children:e,src:t,icon:n,provider:i,className:r})=>React.createElement("div",{className:classNames("wy-content-icon",r)},React.createElement("div",{className:"wy-content-icon"},React.createElement(UIIcon.UI,{name:n})),React.createElement("div",{className:"wy-content-name"},i?React.createElement(React.Fragment,null,React.createElement("span",null,"No preview available. "),React.createElement("a",{href:t,target:"_blank"},`Open in ${i}?`)):React.createElement("span",null,"No preview available :(")),e),Preview=({client:e,src:t,link:n,format:i,name:r,icon:s,width:o,height:a,mediaType:l,provider:c})=>React.createElement(React.Fragment,null,"image"===i&&React.createElement(PreviewImage,{key:t,src:t,width:o,height:a}),"pdf"===i&&React.createElement(PreviewDocument,{src:t,client:e}),("video"===i||"audio"===i)&&React.createElement(PreviewMedia,{key:t,format:i,src:t,name:r,mediaType:l}),"text"===i&&React.createElement(PreviewText,{key:t,src:t}),"code"===i&&React.createElement(PreviewText,{key:t,src:t,html:!/^(?:blob:|data:)/.test(t),code:!0}),"html"===i&&React.createElement(PreviewText,{key:t,src:t,html:!0}),"embed"===i&&React.createElement(PreviewEmbed,{key:t,src:t,name:r,icon:s,provider:c}),"none"===i&&(n?React.createElement(PreviewIcon,{src:n,icon:s,provider:c}):React.createElement(PreviewIcon,{src:t,icon:s}))),fileSizeAsString=(e,t=3)=>{for(var n=e,i=[" B"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"],r=0;r<i.length-1&&n>=1024;)n=100*n/1024/100,r++;return n.toLocaleString(void 0,{maximumSignificantDigits:t})+i[r]};function getExtension(e){return(e.substring(e.lastIndexOf("."),e.length)||e).toLowerCase()}function isAudio(e){switch(e){case".aac":case".aif":case".aiff":case".au":case".gsm":case".m4a":case".mid":case".midi":case".mka":case".mp3":case".oga":case".ogg":case".ra":case".ram":case".snd":case".spx":case".wav":case".wma":return!0;default:return!1}}function isImage(e){switch(e){case".ai":case".apng":case".bmp":case".emf":case".eps":case".gif":case".heic":case".ico":case".jpg":case".jpeg":case".png":case".psd":case".svg":case".tif":case".tiff":case".webp":case".wmf":return!0;default:return!1}}function isWebImage(e){switch(getExtension(e)){case".apng":case".bmp":case".gif":case".ico":case".jpg":case".jpeg":case".png":case".svg":case".webp":return!0;default:return!1}}function isVideo(e){switch(e){case".3g2":case".asx":case".asf":case".avi":case".flv":case".mk3d":case".mkv":case".mov":case".mp4":case".mpeg":case".mpg":case".ogm":case".ogv":case".ogx":case".qt":case".rm":case".rv":case".smi":case".smil":case".swf":case".webm":case".wmv":case".xaml":return!0;default:return!1}}function isMarkdown(e){switch(e){case".markdown":case".md":return!0;default:return!1}}function isMarkup(e){switch(e){case".htm":case".html":case".xhtml":case".xml":return!0;default:return!1}}function isCode(e){if(isMarkup(e))return!0;switch(e){case".as":case".as3":case".asm":case".aspx":case".bat":case".c":case".cc":case".cmake":case".coffee":case".cpp":case".cs":case".css":case".cxx":case".diff":case".erb":case".erl":case".groovy":case".gvy":case".h":case".haml":case".hh":case".hpp":case".hxx":case".java":case".js":case".json":case".jsx":case".less":case".lst":case".m":case".make":case".ml":case".mm":case".out":case".patch":case".php":case".pl":case".plist":case".properties":case".py":case".rb":case".sass":case".scala":case".scm":case".script":case".scss":case".sh":case".sml":case".sql":case".vb":case".vi":case".vim":case".xsd":case".xsl":case".yaml":case".yml":return!0;default:return!1}}function isText(e){return!(!isCode(e)&&!isMarkdown(e))||".txt"===e}function getIcon(e,t){var n=getExtension(e);if(""===n)return{icon:"file"};if(isAudio(n))return{icon:"file-music",color:"indigo"};if(isImage(n))return{icon:"file-image",color:"cyan"};if(isVideo(n))return{icon:"file-video",color:"pink"};if(isMarkup(n))return{icon:"file-xml",color:"purple"};if(isCode(n))return{icon:"file-code",color:"purple"};if(isText(n))return{icon:"file-document"};switch(n){case".7z":case".zip":return{icon:"file-compressed",color:"orange"};case".doc":case".docm":case".docx":case".dotm":case".dotx":return{icon:"file-word",color:"native"};case".eml":case".msg":return{icon:"email",color:""};case".xls":case".xlsm":case".xlsx":case".xltx":return{icon:"file-excel",color:"native"};case".pdf":return{icon:"file-pdf",color:"native"};case".ppt":case".pptm":case".pptx":case".potx":return{icon:"file-powerpoint",color:"native"};case".pages":return{icon:"file",color:"orange"};case".numbers":return{icon:"file",color:"green"};case".keynote":return{icon:"file",color:"blue"}}return{icon:"file"}}function getWebPreviewFormat(e){var t=getExtension(e);return""===t?"none":isWebImage(t)?"image":isCode(t)?"code":isText(t)?"text":isAudio(t)?"audio":isVideo(t)?"video":"none"}function getProvider(e){switch(e){case"Google Drive":return"google-drive";case"Dropbox":return"dropbox";case"OneDrive":return"onedrive";case"Box":return"box";default:return""}}function getKind(e){var t="file";switch(getExtension(e)){case".7z":case".zip":t="archive";break;case".aac":case".aif":case".aiff":case".au":case".gsm":case".m4a":case".mid":case".midi":case".mka":case".mp3":case".oga":case".ogg":case".ra":case".ram":case".snd":case".spx":case".wav":case".wma":t="audio";break;case".c":case".cgi":case".cpp":case".cs":case".cshtml":case".css":case".html":case".java":case".js":case".json":case".less":case".php":case".pl":case".ps1":case".py":case".rb":case".rs":case".scss":case".sh":case".swift":case".sql":case".ts":case".xml":case".yaml":case".yml":t="code";break;case".doc":case".docm":case".docx":case".dotm":case".dotx":case".gdoc":case".pages":case".pdf":t="document";break;case".eml":case".msg":t="email";break;case".gslides":case".keynote":case".ppt":case".pptm":case".pptx":case".potx":t="presentation";break;case".gsheet":case".numbers":case".xls":case".xlsm":case".xlsx":case".xltx":t="spreadsheet";break;case".ai":case".apng":case".bmp":case".emf":case".eps":case".gif":case".heic":case".ico":case".jpg":case".jpeg":case".png":case".psd":case".svg":case".tif":case".tiff":case".webp":case".wmf":t="image";break;case".md":case".markdown":case".txt":t="text";break;case".3g2":case".asx":case".asf":case".avi":case".flv":case".mk3d":case".mkv":case".mov":case".mp4":case".mpeg":case".mpg":case".ogm":case".ogv":case".ogx":case".qt":case".rm":case".rv":case".smi":case".smil":case".swf":case".webm":case".wmv":case".xaml":t="video"}return t}function openUrl(e="",t="",n="",i=!1){if(e){const r=document.createElement("a");i&&(/^(data:|blob:)/.test(e)?r.download=n||"download":e=e.includes("?d=1")||e.includes("&d=1")?e:e.includes("?")?e+"&d=1":e+"?d=1"),t&&(r.target=t),r.href=e,document.body.appendChild(r);try{r.click()}catch(r){if(console.warn("Could not open link normally, trying fallback"),/^(?:blob:|data:)/.test(e))console.error(`Could not ${i?"download":"open"} ${n}`);else try{window.open(e,t)}catch(e){console.error(`Could not ${i?"download":"open"} ${n}`)}}document.body.removeChild(r)}}const PreviewContext=React.createContext({openPreview:Function,closePreview:Function,setPreviewFiles:Function});function allowedKeyTarget$1(e){return!e.target.matches("input, textarea, select")&&!e.target.closest('[contenteditable="true"]')}const PreviewProvider=({client:e,children:t})=>{const[n,i]=React.useState(!1),[r,s]=React.useState(),[o,a]=React.useState(),[l,c]=React.useState(),[h,d]=React.useState(),[u,p]=React.useState();React.useEffect((()=>{if(l&&r){let e=r.map((function(e){return e.id})).indexOf(l);p(e>0?r[e-1].id:void 0),d(e+1<r.length?r[e+1].id:void 0),a(r.find((e=>e.id===l)))}}),[r,null==r?void 0:r.length,l]);const f=()=>{i(!1)};React.useEffect((()=>{if(o){const e=e=>{n&&(27===e.which?(e.stopImmediatePropagation(),f()):37===e.which?allowedKeyTarget$1(e)&&(e.stopPropagation(),c(u)):39===e.which&&allowedKeyTarget$1(e)&&(e.stopPropagation(),c(h)))};return document.addEventListener("keyup",e,!0),()=>{document.removeEventListener("keyup",e,!0)}}}),[o,n]),getIcon((null==o?void 0:o.name)||"").icon;let m=getExtension((null==o?void 0:o.name)||""),g=getIcon((null==o?void 0:o.name)||"").icon,O=(null==o?void 0:o.preview_url)||(null==o?void 0:o.download_url)||"";return"image"===(null==o?void 0:o.preview_format)&&(".gif"===m||".svg"===m)&&(O=(null==o?void 0:o.download_url)||""),React.createElement(React.Fragment,null,React.createElement(PreviewContext.Provider,{value:{openPreview:e=>{c(e),i(!0)},closePreview:f,setPreviewFiles:e=>{s(e)}}},t),r&&React.createElement(UIOverlay.UI,{isOpen:n,className:"wy-dark",closeOnEsc:!1,onClose:()=>i(!1)},React.createElement("header",{className:"wy-appbars"},React.createElement("nav",{className:"wy-appbar"},React.createElement(UIButton.UI,{onClick:f},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("div",{className:classNames("wy-appbar-text",{"wy-appbar-text-trashed":null==o?void 0:o.is_trashed})},o&&React.createElement("span",null,o.name)),React.createElement("div",{className:"wy-appbar-buttons"},o&&React.createElement(UIButton.UI,{onClick:()=>{o&&o.download_url&&openUrl(o.download_url,"_top",o.name,!0)}},React.createElement(UIIcon.UI,{name:"download"}))))),React.createElement("div",{className:"wy-main"},React.createElement("div",{className:"wy-preview"},o&&React.createElement(React.Fragment,null,u&&React.createElement("nav",{className:"wy-nav-prev"},React.createElement(UIButton.UI,{onClick:()=>{c(u)}},React.createElement(UIIcon.UI,{name:"previous"}))),h&&React.createElement("nav",{className:"wy-nav-next"},React.createElement(UIButton.UI,{onClick:()=>{c(h)}},React.createElement(UIIcon.UI,{name:"next"}))),React.createElement("div",{className:"wy-preview-area wy-scroll-y wy-scroll-x"},React.createElement(Preview,{client:e,src:O,link:o.external_url,format:o.is_trashed?"none":o.preview_format,name:o.name,icon:g,width:o.width,height:o.height,mediaType:o.media_type,provider:o.provider})))))))};var FUNC_ERROR_TEXT$1="Expected a function",NAN$1=NaN,symbolTag$1="[object Symbol]",reTrim$1=/^\s+|\s+$/g,reIsBadHex$1=/^[-+]0x[0-9a-f]+$/i,reIsBinary$1=/^0b[01]+$/i,reIsOctal$1=/^0o[0-7]+$/i,freeParseInt$1=parseInt,freeGlobal$1="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf$1="object"==typeof self&&self&&self.Object===Object&&self,root$1=freeGlobal$1||freeSelf$1||Function("return this")(),objectProto$1=Object.prototype,objectToString$1=objectProto$1.toString,nativeMax$1=Math.max,nativeMin$1=Math.min,now$1=function(){return root$1.Date.now()};function debounce$3(e,t,n){var i,r,s,o,a,l,c=0,h=!1,d=!1,u=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$1);function p(t){var n=i,s=r;return i=r=void 0,c=t,o=e.apply(s,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=s}function m(){var e=now$1();if(f(e))return g(e);a=setTimeout(m,function(e){var n=t-(e-l);return d?nativeMin$1(n,s-(e-c)):n}(e))}function g(e){return a=void 0,u&&i?p(e):(i=r=void 0,o)}function O(){var e=now$1(),n=f(e);if(i=arguments,r=this,l=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(m,t),h?p(e):o}(l);if(d)return a=setTimeout(m,t),p(l)}return void 0===a&&(a=setTimeout(m,t)),o}return t=toNumber$1(t)||0,isObject$3(n)&&(h=!!n.leading,s=(d="maxWait"in n)?nativeMax$1(toNumber$1(n.maxWait)||0,t):s,u="trailing"in n?!!n.trailing:u),O.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=r=a=void 0},O.flush=function(){return void 0===a?o:g(now$1())},O}function throttle(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$1);return isObject$3(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),debounce$3(e,t,{leading:i,maxWait:t,trailing:r})}function isObject$3(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike$1(e){return!!e&&"object"==typeof e}function isSymbol$1(e){return"symbol"==typeof e||isObjectLike$1(e)&&objectToString$1.call(e)==symbolTag$1}function toNumber$1(e){if("number"==typeof e)return e;if(isSymbol$1(e))return NAN$1;if(isObject$3(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject$3(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim$1,"");var n=reIsBinary$1.test(e);return n||reIsOctal$1.test(e)?freeParseInt$1(e.slice(2),n?2:8):reIsBadHex$1.test(e)?NAN$1:+e}var lodash_throttle=throttle,throttle$1=getDefaultExportFromCjs(lodash_throttle),scrollbarClassnameTarget=document.documentElement;function checkScrollbar(e){var t;for(var n in e){t=e[n].target;try{(t===document.documentElement?window.innerWidth:t.clientWidth)!==t.offsetWidth?scrollbarClassnameTarget.classList.add("wy-scrollbars"):scrollbarClassnameTarget.classList.remove("wy-scrollbars")}catch(e){console.warn("scrollbar detection failed",e)}}return scrollbarClassnameTarget.classList.contains("wy-scrollbars")}function detectScrollbars(){var e=document.getElementById("wy-scrollbar-detection");return e||((e=document.createElement("aside")).id="wy-scrollbar-detection",e.className="wy-scrollbar-detection",document.documentElement.insertBefore(e,document.body)),new Promise((t=>{new ResizeObserver((e=>{let n=checkScrollbar(e);t(n)})).observe(e)}))}function checkScrollbarAdjust(e){for(var t in e){let n=e[t].target,i=getComputedStyle(n);void 0!==n.dataset.adjustScrollbarTop&&scrollbarClassnameTarget.style.setProperty("--wy-scrollbar-adjust-top",i.height),void 0!==n.dataset.adjustScrollbarBottom&&scrollbarClassnameTarget.style.setProperty("--wy-scrollbar-adjust-bottom",i.height)}}function detectScrollbarAdjustments(){var e=new ResizeObserver(checkScrollbarAdjust);const t=()=>{if(scrollbarClassnameTarget.style.removeProperty("--wy-scrollbar-adjust-top"),scrollbarClassnameTarget.style.removeProperty("--wy-scrollbar-adjust-bottom"),e.disconnect(),scrollbarClassnameTarget.classList.contains("wy-scrollbars")){let t=document.querySelectorAll("[data-adjust-scrollbar-top], [data-adjust-scrollbar-bottom]");t&&t.forEach((t=>{checkScrollbarAdjust([{target:t}]),e.observe(t)}))}};requestAnimationFrame(t),setTimeout(t,5e3),new MutationObserver(throttle$1(t,100)).observe(scrollbarClassnameTarget,{childList:!0,subtree:!0})}function useMutateExternalBlobs(e){if(!e)throw new Error("useMutateExternalBlobs must be used within an WeavyProvider");return useMutation((async({blob:t})=>(await e.post("/api/blobs/external","POST",JSON.stringify(t))).json()),{onSuccess:e=>{}})}function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function isObject$2(e){return"[object Object]"===Object.prototype.toString.call(e)}function isPlainObject(e){var t,n;return!1!==isObject$2(e)&&(void 0===(t=e.constructor)||!1!==isObject$2(n=t.prototype)&&!1!==Object.prototype.hasOwnProperty.call(n,"isPrototypeOf"))}function eqJQuery(e,t){return e&&t&&e.jquery&&t.jquery&&e.jquery===t.jquery&&e.length===t.length&&e.length===e.filter(t).length}function eqObjects(e,t,n){if(!isPlainObject(e)||!isPlainObject(t))return!1;var i=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(!n&&i.length!==r.length)return!1;for(var s=0;s<i.length;s++){var o=i[s],a=e[o],l=t[o];if(a!==l&&!eqJQuery(a,l)&&!eqObjects(a,l,n))return!1}return!0}function toKebabCase(e){return e.length>0?e.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").replace(/_|\s+/g,"-").toLowerCase():e}function WeavyPromiseWrapper(e){var t,n="pending",i=function(){return t};return i.promise=i.bind(i),i.state=function(){return n},(i.reset=function(){var r,s;return n="pending",t=new Promise((function(e,t){r=function(){n="resolved",e.apply(this,arguments)},s=function(){n="rejected",t.apply(this,arguments)}})),t.weavy=!0,i.resolve=function(){return r.apply(t,arguments),i},i.reject=function(){return s.apply(t,arguments),i},"function"==typeof e&&e(r,s),i})(),i.then=function(){return(t=t.then.apply(t,arguments)).weavy=!0,i},i.catch=function(){return(t=t.catch.apply(t,arguments)).weavy=!0,i},i.finally=function(){return(t=t.finally.apply(t,arguments)).weavy=!0,i},i}function WeavyPostal(e){var t=this;this.timeout=e&&e.timeout||2e3;var n=[],i=new Set,r=new Map,s=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeavyPromiseWrapper,h=null,d=u(window.location.href);function u(e){var t=null;try{t=/^((?:https?:\/\/[^/]+)|(?:file:\/\/))\/?/.exec(e)[1]}catch(e){console.error("Unable to resolve location origin. Make sure you are using http, https or file protocol and have a valid location URL.")}return t}function p(e,t){var i=e.source===window&&e.origin===d;if(t||=s.has(e.source)&&e.origin===s.get(e.source),i||t){var r=!e.data.weavyId||!0===e.data.weavyId;t&&!e.data.windowName&&(e.data.windowName=o.get(e.source));var a=e.data.name;if("distribute"===a){if(h)return;e.data.name=e.data.distributeName}n.forEach((function(t){var n=t.name===a||"message"===t.name,i=null===t.selector,s=t.selector===e.data.weavyId,o=isPlainObject(t.selector)&&eqObjects(t.selector,e.data,!0);n&&(r||i||s||o)&&(t.handler(e,e.data),t.once&&m(t.name,t.selector,t.handler))}))}}function f(e,t,i){"function"==typeof arguments[1]&&(i=arguments[1],t=null),n.push({name:e,handler:i,selector:t})}function m(e,t,i){"function"==typeof arguments[1]&&(i=arguments[1],t=null),n=n.filter((function(n){var r=e===n.name,s=i===n.handler,o="string"==typeof t&&t===n.selector,a=isPlainObject(t)&&eqObjects(t,n.selector);return!(r&&s&&(null===t||o||a))}))}function g(e,t){if(r.has(t)){if(r.get(t).has(e)){var n=r.get(t).get(e);try{i.delete(n),o.delete(n),a.delete(n),s.delete(n)}catch(e){}}if(r.get(t).delete(e),0===r.get(t).size)try{r.delete(t)}catch(e){}}}function O(e,n,i){var r=new WeavyPromiseWrapper;null===i&&(i=void 0);var o=e===window.self,a=o?u(window.location.href):s.get(e);return o||e&&a===l.get(e)?(n.weavyMessageId||(n.weavyMessageId=S4()+S4()),queueMicrotask((()=>{console.debug("whenPostMessage",n.name,n.weavyMessageId);var s=setTimeout((function(){"pending"===r.state()&&r.reject(new Error("postMessage() receipt timed out: "+n.weavyMessageId+", "+n.name))}),t.timeout||2e3);f("message-receipt",{weavyId:n.weavyId,weavyMessageId:n.weavyMessageId},(function(){console.debug("message-receipt received",n.weavyMessageId,n.name),clearTimeout(s),r.resolve()}));try{e.postMessage(n,a,i)}catch(e){r.reject(e)}}))):r.reject(new Error("postMessage() Invalid window origin: "+a+", "+n.name)),r()}window.addEventListener("message",(function(e){if(e.data.name&&void 0!==e.data.weavyId){if(e.data.weavyMessageId&&"message-receipt"!==e.data.name&&"unready"!==e.data.name){console.debug("sending message receipt",e.data.weavyMessageId,e.data.name);try{e.source.postMessage({name:"message-receipt",weavyId:e.data.weavyId,weavyMessageId:e.data.weavyMessageId},e.origin)}catch(e){console.error("could not post back message-receipt to source")}}switch(e.data.name){case"register-child":if(a.has(e.source)||console.warn("register-child: contentwindow not pre-registered"),s.get(e.source)!==e.origin)return void console.error("register-child: "+o.get(e.source)+" has invalid origin",e.origin);try{var t=a.get(e.source),n=o.get(e.source);n&&e.source.postMessage({name:"register-window",windowName:n,weavyId:t||!0},e.origin)}catch(e){console.error("could not register frame window",t,n,e)}break;case"ready":r.has(e.data.weavyId)&&o.has(e.source)&&r.get(e.data.weavyId).get(o.get(e.source))&&(l.set(e.source,e.origin),p(e));break;case"unready":r.has(e.data.weavyId)&&p(e,!0);break;default:(e.source===window||r.size)&&p(e)}}})),this.on=f,this.one=function(e,t,i){"function"==typeof arguments[1]&&(i=arguments[1],t=null),n.push({name:e,handler:i,selector:t,once:!0})},this.off=m,this.registerContentWindow=function(e,t,n,l){try{if(!t)return void console.error("registerContentWindow() No valid contentWindow to register, must be a window and have a name.")}catch(e){console.error("registerContentWindow() cannot access contentWindowName")}e.self&&(e=e.self),n&&"true"!==n||(n=!0),r.has(n)||r.set(n,new Map),r.get(n).set(t,e),i.add(e),o.set(e,t),a.set(e,n),s.set(e,l)},this.unregisterContentWindow=g,this.unregisterAll=function(e){r.has(e)&&(r.get(e).forEach((function(t,n){g(n,e)})),r.get(e),r.delete(e))},this.postToFrame=function(e,t,n,i){if("object"==typeof n&&n.name){var s;try{s=r.get(t).get(e)}catch(n){console.error("postToFrame() Window not registered",t,e)}return n.weavyId=t,O(s,n,i)}console.error("postToFrame() Invalid message format",n)},this.postToSelf=function(e,t){if("object"==typeof e&&e.name)return e.weavyId=e.weavyId||!0,O(window.self,e,t);console.error("postToSelf() Invalid message format",e)},this.postToSource=function(e,t,n){if(e.source&&void 0!==e.data.weavyId){var i=e.source===window.self&&e.origin===d,r=s.has(e.source)&&e.origin===s.get(e.source);if(null===n&&(n=void 0),i||r){t.weavyId=e.data.weavyId;try{e.source.postMessage(t,e.origin,n)}catch(e){console.error("postToSource() Could not post message back to source")}}}},this.postToChildren=function(e,t){"object"==typeof e&&e.name?(null===t&&(t=void 0),e.distributeName=e.name,e.name="distribute",e.weavyId=e.weavyId||!0,i.forEach((function(n){if(s.get(n)===l.get(n))try{n.postMessage(e,s.get(n),t)}catch(e){console.warn("postToChildren() could not distribute message to "+o.get(n))}}))):console.error("postToChildren() Invalid message format",e)},this.whenLeader=function(){return c()},Object.defineProperty(this,"isLeader",{get:function(){return h}}),"pending"===c.state()&&(h=!0,c.resolve(h))}window.addEventListener("unhandledrejection",(function(e){e.promise.weavy&&e.preventDefault()})),WeavyPromiseWrapper.resolve=function(e){var t=WeavyPromiseWrapper();return t.resolve(e),t},WeavyPromiseWrapper.reject=function(e){var t=WeavyPromiseWrapper();return t.reject(e),t};var WeavyPostal$1=new WeavyPostal;const CloudFilesContext=React.createContext({open:Function});let addFunc=([])=>{};const CloudFilesProvider=({children:e,options:t,client:n})=>{const[i,r]=React.useState(!1),[s,o]=React.useState(!1),[a,l]=React.useState(""),c=(null==t?void 0:t.filebrowserUrl)||"",h=useMutateExternalBlobs(n),d=React.useCallback((e=>{null!==e&&null!=e.contentWindow&&WeavyPostal$1.registerContentWindow(e.contentWindow.self,"weavy-filebrowser","wy-filebrowser",new URL(c).origin)}),[]);React.useEffect((()=>{var e="";try{window.location.ancestorOrigins&&0<window.location.ancestorOrigins.length?e=window.location.ancestorOrigins[window.location.ancestorOrigins.length-1]:window.top&&(e=window.top.document.location.origin)}catch(e){}if(!e)try{e=window.self.document.location.origin}catch(e){console.error("Filebrowser: Could not read current origin.")}const t=c+"?origin="+e+"&v=X&t="+Date.now().toString()+"&weavyId=wy-filebrowser";return l(t),WeavyPostal$1.on("add-external-blobs",u),WeavyPostal$1.on("request:file-browser-close",p),()=>{WeavyPostal$1.off("add-external-blobs",u),WeavyPostal$1.off("request:file-browser-close",p)}}),[]);const u=async(e,t)=>{let n=[];for(let e=0;e<t.blobs.length;e++){let i=await h.mutateAsync({blob:t.blobs[e]});i.errors?console.error(i.errors):n.push(i)}addFunc(n),f()},p=()=>{f()},f=()=>{r(!1),o(!1)};return React.createElement(React.Fragment,null,React.createElement(CloudFilesContext.Provider,{value:{open:e=>{addFunc=e,r(!0)}}},e),React.createElement(UIOverlay.UI,{isOpen:i,className:"wy-modal wy-panel wy-loaded"},!s&&React.createElement(UISpinner.UI,{overlay:!0}),React.createElement("iframe",{ref:d,onLoad:()=>{o(!0)},src:a,className:"wy-panel-frame",id:"weavy-filebrowser",name:"weavy-filebrowser"})))};dayjs.extend(relativeTime),dayjs.extend(utc),dayjs.extend(timezone),dayjs.extend(localizedFormat);const WeavyContext=React.createContext({client:null,options:{}}),queryClient=new QueryClient({defaultOptions:{queries:{cacheTime:864e5}}}),WeavyProvider=({children:e,client:t,options:n})=>{let i={zoomAuthenticationUrl:void 0,teamsAuthenticationUrl:void 0,enableScrollbarDetection:!0,filebrowserUrl:"https://filebrowser.weavy.io/v14/",reactions:["","","","",""]},r=Object.assign(Object.assign({},i),n);return r.enableScrollbarDetection&&detectScrollbars().then((()=>detectScrollbarAdjustments())),t||queryClient.clear(),React.createElement(React.Fragment,null,t&&React.createElement(QueryClientProvider,{client:queryClient},React.createElement(WeavyContext.Provider,{value:{client:t,options:r}},React.createElement(UserProvider,{client:t},React.createElement(CloudFilesProvider,{options:r,client:t},React.createElement(PreviewProvider,{client:t},e))))))};function usePresence(){const{client:e}=React.useContext(WeavyContext);if(!e)throw new Error("usePresence must be used within an WeavyProvider");React.useEffect((()=>{e.subscribe(null,"online",t)}),[]);const t=e=>{Array.isArray(e)?(document.querySelectorAll(".wy-presence").forEach((function(e){e.classList.remove("wy-presence-active")})),e.forEach((function(e){document.querySelectorAll("[data-presence-id='"+e+"']").forEach((function(e){e.classList.add("wy-presence-active")}))}))):document.querySelectorAll("[data-presence-id='"+e+"']").forEach((function(e){e.classList.add("wy-presence-active")}))}}const MessengerContext=React.createContext({selectedConversationId:null,setSelectedConversationId:e=>{}}),MessengerProvider=({children:e})=>{const[t,n]=React.useState(null);usePresence();return React.createElement(React.Fragment,null,React.createElement(MessengerContext.Provider,{value:{selectedConversationId:t,setSelectedConversationId:e=>{n(e)}}},e))};function useMembers(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useMembers must be used within an WeavyProvider");return useQuery(["members",e],(async()=>{const t=await n.get(`/api/apps/${e}/members?top=1000`);return await t.json()}),t)}const Typing=({children:e,id:t,context:n})=>{const[i,r]=React.useState([]),[s,o]=React.useState(""),a=React.useRef(null),{client:l}=React.useContext(WeavyContext),{user:c}=React.useContext(UserContext);React.useEffect((()=>(h(),()=>{clearTimeout(a.current)})),[i,t,n]),React.useEffect((()=>(r([]),null==l||l.subscribe(`a${t}`,"typing",d),null==l||l.subscribe(`a${t}`,"message_created",u),()=>{null==l||l.unsubscribe(`a${t}`,"typing",d),null==l||l.unsubscribe(`a${t}`,"message_created",u)})),[t]);const h=()=>{let e=i;a.current&&(clearTimeout(a.current),a.current=null);let t=Date.now();if(e.forEach((function(n,i){t-n.time>5e3&&e.splice(i,1)})),e.length){let n=Math.round((t-Math.max.apply(null,e.map((function(e){return e.time}))))/1e3)%3+1,i=".".repeat(n),r=e.map((e=>e.display_name)).sort(),s="";for(let e=0;e<r.length;e++)e>0&&(e===r.length-1?s+=" and ":s+=", "),s+=r[e];1===r.length?s+=" is typing":s+=" are typing",o(s+i),a.current=setTimeout(h,1e3)}else o("")},d=React.useCallback((e=>{var n;e.entity.id===t&&e.actor.id!==c.id&&(n=e.actor,i.forEach((function(e,t){e.member.id===n.id&&r(i.splice(t,1))})),n.time=Date.now(),r([...i,n]))}),[t,n,i]),u=React.useCallback((e=>{e.message.app_id===t&&r([])}),[t,n,i]);return React.createElement(React.Fragment,null,React.createElement("span",Object.assign({},""!==s?{}:{hidden:!0}),s),React.createElement("span",Object.assign({},""===s?{}:{hidden:!0}),e))};var Typing$1=React.memo(Typing),fromEntries=function(e){return e.reduce((function(e,t){var n=t[0],i=t[1];return e[n]=i,e}),{})},useIsomorphicLayoutEffect="undefined"!=typeof window&&window.document&&window.document.createElement?React__namespace.useLayoutEffect:React__namespace.useEffect,top$1="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top$1,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce((function(e,t){return e.concat([t+"-"+start,t+"-"+end])}),[]),placements=[].concat(basePlacements,[auto]).reduce((function(e,t){return e.concat([t,t+"-"+start,t+"-"+end])}),[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getNodeName(e){return e?(e.nodeName||"").toLowerCase():null}function getWindow(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function isElement(e){return e instanceof getWindow(e).Element||e instanceof Element}function isHTMLElement(e){return e instanceof getWindow(e).HTMLElement||e instanceof HTMLElement}function isShadowRoot(e){return"undefined"!=typeof ShadowRoot&&(e instanceof getWindow(e).ShadowRoot||e instanceof ShadowRoot)}function applyStyles(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},i=t.attributes[e]||{},r=t.elements[e];isHTMLElement(r)&&getNodeName(r)&&(Object.assign(r.style,n),Object.keys(i).forEach((function(e){var t=i[e];!1===t?r.removeAttribute(e):r.setAttribute(e,!0===t?"":t)})))}))}function effect$2(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var i=t.elements[e],r=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});isHTMLElement(i)&&getNodeName(i)&&(Object.assign(i.style,s),Object.keys(r).forEach((function(e){i.removeAttribute(e)})))}))}}var applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect:effect$2,requires:["computeStyles"]};function getBasePlacement(e){return e.split("-")[0]}var max=Math.max,min=Math.min,round=Math.round;function getUAString(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map((function(e){return e.brand+"/"+e.version})).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var i=e.getBoundingClientRect(),r=1,s=1;t&&isHTMLElement(e)&&(r=e.offsetWidth>0&&round(i.width)/e.offsetWidth||1,s=e.offsetHeight>0&&round(i.height)/e.offsetHeight||1);var o=(isElement(e)?getWindow(e):window).visualViewport,a=!isLayoutViewport()&&n,l=(i.left+(a&&o?o.offsetLeft:0))/r,c=(i.top+(a&&o?o.offsetTop:0))/s,h=i.width/r,d=i.height/s;return{width:h,height:d,top:c,right:l+h,bottom:c+d,left:l,x:l,y:c}}function getLayoutRect(e){var t=getBoundingClientRect(e),n=e.offsetWidth,i=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-i)<=1&&(i=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:i}}function contains$1(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&isShadowRoot(n)){var i=t;do{if(i&&e.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function isTableElement(e){return["table","td","th"].indexOf(getNodeName(e))>=0}function getDocumentElement(e){return((isElement(e)?e.ownerDocument:e.document)||window.document).documentElement}function getParentNode(e){return"html"===getNodeName(e)?e:e.assignedSlot||e.parentNode||(isShadowRoot(e)?e.host:null)||getDocumentElement(e)}function getTrueOffsetParent(e){return isHTMLElement(e)&&"fixed"!==getComputedStyle$1(e).position?e.offsetParent:null}function getContainingBlock(e){var t=/firefox/i.test(getUAString());if(/Trident/i.test(getUAString())&&isHTMLElement(e)&&"fixed"===getComputedStyle$1(e).position)return null;var n=getParentNode(e);for(isShadowRoot(n)&&(n=n.host);isHTMLElement(n)&&["html","body"].indexOf(getNodeName(n))<0;){var i=getComputedStyle$1(n);if("none"!==i.transform||"none"!==i.perspective||"paint"===i.contain||-1!==["transform","perspective"].indexOf(i.willChange)||t&&"filter"===i.willChange||t&&i.filter&&"none"!==i.filter)return n;n=n.parentNode}return null}function getOffsetParent(e){for(var t=getWindow(e),n=getTrueOffsetParent(e);n&&isTableElement(n)&&"static"===getComputedStyle$1(n).position;)n=getTrueOffsetParent(n);return n&&("html"===getNodeName(n)||"body"===getNodeName(n)&&"static"===getComputedStyle$1(n).position)?t:n||getContainingBlock(e)||t}function getMainAxisFromPlacement(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function within(e,t,n){return max(e,min(t,n))}function withinMaxClamp(e,t,n){var i=within(e,t,n);return i>n?n:i}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(e){return Object.assign({},getFreshSideObject(),e)}function expandToHashMap(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}var toPaddingObject=function(e,t){return mergePaddingObject("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:expandToHashMap(e,basePlacements))};function arrow(e){var t,n=e.state,i=e.name,r=e.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=getBasePlacement(n.placement),l=getMainAxisFromPlacement(a),c=[left,right].indexOf(a)>=0?"height":"width";if(s&&o){var h=toPaddingObject(r.padding,n),d=getLayoutRect(s),u="y"===l?top$1:left,p="y"===l?bottom:right,f=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],m=o[l]-n.rects.reference[l],g=getOffsetParent(s),O=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,y=f/2-m/2,v=h[u],b=O-d[c]-h[p],w=O/2-d[c]/2+y,S=within(v,w,b),x=l;n.modifiersData[i]=((t={})[x]=S,t.centerOffset=S-w,t)}}function effect$1(e){var t=e.state,n=e.options.element,i=void 0===n?"[data-popper-arrow]":n;null!=i&&("string"!=typeof i||(i=t.elements.popper.querySelector(i)))&&contains$1(t.elements.popper,i)&&(t.elements.arrow=i)}var arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$1,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(e){return e.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(e,t){var n=e.x,i=e.y,r=t.devicePixelRatio||1;return{x:round(n*r)/r||0,y:round(i*r)/r||0}}function mapToStyles(e){var t,n=e.popper,i=e.popperRect,r=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,h=e.roundOffsets,d=e.isFixed,u=o.x,p=void 0===u?0:u,f=o.y,m=void 0===f?0:f,g="function"==typeof h?h({x:p,y:m}):{x:p,y:m};p=g.x,m=g.y;var O=o.hasOwnProperty("x"),y=o.hasOwnProperty("y"),v=left,b=top$1,w=window;if(c){var S=getOffsetParent(n),x="clientHeight",C="clientWidth";if(S===getWindow(n)&&"static"!==getComputedStyle$1(S=getDocumentElement(n)).position&&"absolute"===a&&(x="scrollHeight",C="scrollWidth"),r===top$1||(r===left||r===right)&&s===end)b=bottom,m-=(d&&S===w&&w.visualViewport?w.visualViewport.height:S[x])-i.height,m*=l?1:-1;if(r===left||(r===top$1||r===bottom)&&s===end)v=right,p-=(d&&S===w&&w.visualViewport?w.visualViewport.width:S[C])-i.width,p*=l?1:-1}var _,E=Object.assign({position:a},c&&unsetSides),P=!0===h?roundOffsetsByDPR({x:p,y:m},getWindow(n)):{x:p,y:m};return p=P.x,m=P.y,l?Object.assign({},E,((_={})[b]=y?"0":"",_[v]=O?"0":"",_.transform=(w.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",_)):Object.assign({},E,((t={})[b]=y?m+"px":"",t[v]=O?p+"px":"",t.transform="",t))}function computeStyles(e){var t=e.state,n=e.options,i=n.gpuAcceleration,r=void 0===i||i,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,c={placement:getBasePlacement(t.placement),variation:getVariation(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:r,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,mapToStyles(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,mapToStyles(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}},passive={passive:!0};function effect(e){var t=e.state,n=e.instance,i=e.options,r=i.scroll,s=void 0===r||r,o=i.resize,a=void 0===o||o,l=getWindow(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach((function(e){e.addEventListener("scroll",n.update,passive)})),a&&l.addEventListener("resize",n.update,passive),function(){s&&c.forEach((function(e){e.removeEventListener("scroll",n.update,passive)})),a&&l.removeEventListener("resize",n.update,passive)}}var eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:effect,data:{}},hash$2={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,(function(e){return hash$2[e]}))}var hash$1={start:"end",end:"start"};function getOppositeVariationPlacement(e){return e.replace(/start|end/g,(function(e){return hash$1[e]}))}function getWindowScroll(e){var t=getWindow(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function getWindowScrollBarX(e){return getBoundingClientRect(getDocumentElement(e)).left+getWindowScroll(e).scrollLeft}function getViewportRect(e,t){var n=getWindow(e),i=getDocumentElement(e),r=n.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(r){s=r.width,o=r.height;var c=isLayoutViewport();(c||!c&&"fixed"===t)&&(a=r.offsetLeft,l=r.offsetTop)}return{width:s,height:o,x:a+getWindowScrollBarX(e),y:l}}function getDocumentRect(e){var t,n=getDocumentElement(e),i=getWindowScroll(e),r=null==(t=e.ownerDocument)?void 0:t.body,s=max(n.scrollWidth,n.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),o=max(n.scrollHeight,n.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),a=-i.scrollLeft+getWindowScrollBarX(e),l=-i.scrollTop;return"rtl"===getComputedStyle$1(r||n).direction&&(a+=max(n.clientWidth,r?r.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}function isScrollParent(e){var t=getComputedStyle$1(e),n=t.overflow,i=t.overflowX,r=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+r+i)}function getScrollParent$1(e){return["html","body","#document"].indexOf(getNodeName(e))>=0?e.ownerDocument.body:isHTMLElement(e)&&isScrollParent(e)?e:getScrollParent$1(getParentNode(e))}function listScrollParents(e,t){var n;void 0===t&&(t=[]);var i=getScrollParent$1(e),r=i===(null==(n=e.ownerDocument)?void 0:n.body),s=getWindow(i),o=r?[s].concat(s.visualViewport||[],isScrollParent(i)?i:[]):i,a=t.concat(o);return r?a:a.concat(listScrollParents(getParentNode(o)))}function rectToClientRect(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function getInnerBoundingClientRect(e,t){var n=getBoundingClientRect(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function getClientRectFromMixedType(e,t,n){return t===viewport?rectToClientRect(getViewportRect(e,n)):isElement(t)?getInnerBoundingClientRect(t,n):rectToClientRect(getDocumentRect(getDocumentElement(e)))}function getClippingParents(e){var t=listScrollParents(getParentNode(e)),n=["absolute","fixed"].indexOf(getComputedStyle$1(e).position)>=0&&isHTMLElement(e)?getOffsetParent(e):e;return isElement(n)?t.filter((function(e){return isElement(e)&&contains$1(e,n)&&"body"!==getNodeName(e)})):[]}function getClippingRect(e,t,n,i){var r="clippingParents"===t?getClippingParents(e):[].concat(t),s=[].concat(r,[n]),o=s[0],a=s.reduce((function(t,n){var r=getClientRectFromMixedType(e,n,i);return t.top=max(r.top,t.top),t.right=min(r.right,t.right),t.bottom=min(r.bottom,t.bottom),t.left=max(r.left,t.left),t}),getClientRectFromMixedType(e,o,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function computeOffsets(e){var t,n=e.reference,i=e.element,r=e.placement,s=r?getBasePlacement(r):null,o=r?getVariation(r):null,a=n.x+n.width/2-i.width/2,l=n.y+n.height/2-i.height/2;switch(s){case top$1:t={x:a,y:n.y-i.height};break;case bottom:t={x:a,y:n.y+n.height};break;case right:t={x:n.x+n.width,y:l};break;case left:t={x:n.x-i.width,y:l};break;default:t={x:n.x,y:n.y}}var c=s?getMainAxisFromPlacement(s):null;if(null!=c){var h="y"===c?"height":"width";switch(o){case start:t[c]=t[c]-(n[h]/2-i[h]/2);break;case end:t[c]=t[c]+(n[h]/2-i[h]/2)}}return t}function detectOverflow(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=void 0===i?e.placement:i,s=n.strategy,o=void 0===s?e.strategy:s,a=n.boundary,l=void 0===a?clippingParents:a,c=n.rootBoundary,h=void 0===c?viewport:c,d=n.elementContext,u=void 0===d?popper:d,p=n.altBoundary,f=void 0!==p&&p,m=n.padding,g=void 0===m?0:m,O=mergePaddingObject("number"!=typeof g?g:expandToHashMap(g,basePlacements)),y=u===popper?reference:popper,v=e.rects.popper,b=e.elements[f?y:u],w=getClippingRect(isElement(b)?b:b.contextElement||getDocumentElement(e.elements.popper),l,h,o),S=getBoundingClientRect(e.elements.reference),x=computeOffsets({reference:S,element:v,strategy:"absolute",placement:r}),C=rectToClientRect(Object.assign({},v,x)),_=u===popper?C:S,E={top:w.top-_.top+O.top,bottom:_.bottom-w.bottom+O.bottom,left:w.left-_.left+O.left,right:_.right-w.right+O.right},P=e.modifiersData.offset;if(u===popper&&P){var k=P[r];Object.keys(E).forEach((function(e){var t=[right,bottom].indexOf(e)>=0?1:-1,n=[top$1,bottom].indexOf(e)>=0?"y":"x";E[e]+=k[n]*t}))}return E}function computeAutoPlacement(e,t){void 0===t&&(t={});var n=t,i=n.placement,r=n.boundary,s=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?placements:l,h=getVariation(i),d=h?a?variationPlacements:variationPlacements.filter((function(e){return getVariation(e)===h})):basePlacements,u=d.filter((function(e){return c.indexOf(e)>=0}));0===u.length&&(u=d);var p=u.reduce((function(t,n){return t[n]=detectOverflow(e,{placement:n,boundary:r,rootBoundary:s,padding:o})[getBasePlacement(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}function getExpandedFallbackPlacements(e){if(getBasePlacement(e)===auto)return[];var t=getOppositePlacement(e);return[getOppositeVariationPlacement(e),t,getOppositeVariationPlacement(t)]}function flip(e){var t=e.state,n=e.options,i=e.name;if(!t.modifiersData[i]._skip){for(var r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,c=n.padding,h=n.boundary,d=n.rootBoundary,u=n.altBoundary,p=n.flipVariations,f=void 0===p||p,m=n.allowedAutoPlacements,g=t.options.placement,O=getBasePlacement(g),y=l||(O===g||!f?[getOppositePlacement(g)]:getExpandedFallbackPlacements(g)),v=[g].concat(y).reduce((function(e,n){return e.concat(getBasePlacement(n)===auto?computeAutoPlacement(t,{placement:n,boundary:h,rootBoundary:d,padding:c,flipVariations:f,allowedAutoPlacements:m}):n)}),[]),b=t.rects.reference,w=t.rects.popper,S=new Map,x=!0,C=v[0],_=0;_<v.length;_++){var E=v[_],P=getBasePlacement(E),k=getVariation(E)===start,T=[top$1,bottom].indexOf(P)>=0,A=T?"width":"height",R=detectOverflow(t,{placement:E,boundary:h,rootBoundary:d,altBoundary:u,padding:c}),M=T?k?right:left:k?bottom:top$1;b[A]>w[A]&&(M=getOppositePlacement(M));var I=getOppositePlacement(M),L=[];if(s&&L.push(R[P]<=0),a&&L.push(R[M]<=0,R[I]<=0),L.every((function(e){return e}))){C=E,x=!1;break}S.set(E,L)}if(x)for(var $=function(e){var t=v.find((function(t){var n=S.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return C=t,"break"},D=f?3:1;D>0;D--){if("break"===$(D))break}t.placement!==C&&(t.modifiersData[i]._skip=!0,t.placement=C,t.reset=!0)}}var flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function isAnySideFullyClipped(e){return[top$1,right,bottom,left].some((function(t){return e[t]>=0}))}function hide(e){var t=e.state,n=e.name,i=t.rects.reference,r=t.rects.popper,s=t.modifiersData.preventOverflow,o=detectOverflow(t,{elementContext:"reference"}),a=detectOverflow(t,{altBoundary:!0}),l=getSideOffsets(o,i),c=getSideOffsets(a,r,s),h=isAnySideFullyClipped(l),d=isAnySideFullyClipped(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:h,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":d})}var hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(e,t,n){var i=getBasePlacement(e),r=[left,top$1].indexOf(i)>=0?-1:1,s="function"==typeof n?n(Object.assign({},t,{placement:e})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*r,[left,right].indexOf(i)>=0?{x:a,y:o}:{x:o,y:a}}function offset(e){var t=e.state,n=e.options,i=e.name,r=n.offset,s=void 0===r?[0,0]:r,o=placements.reduce((function(e,n){return e[n]=distanceAndSkiddingToXY(n,t.rects,s),e}),{}),a=o[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[i]=o}var offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(e){var t=e.state,n=e.name;t.modifiersData[n]=computeOffsets({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})}var popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(e){return"x"===e?"y":"x"}function preventOverflow(e){var t=e.state,n=e.options,i=e.name,r=n.mainAxis,s=void 0===r||r,o=n.altAxis,a=void 0!==o&&o,l=n.boundary,c=n.rootBoundary,h=n.altBoundary,d=n.padding,u=n.tether,p=void 0===u||u,f=n.tetherOffset,m=void 0===f?0:f,g=detectOverflow(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:h}),O=getBasePlacement(t.placement),y=getVariation(t.placement),v=!y,b=getMainAxisFromPlacement(O),w=getAltAxis(b),S=t.modifiersData.popperOffsets,x=t.rects.reference,C=t.rects.popper,_="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,E="number"==typeof _?{mainAxis:_,altAxis:_}:Object.assign({mainAxis:0,altAxis:0},_),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,k={x:0,y:0};if(S){if(s){var T,A="y"===b?top$1:left,R="y"===b?bottom:right,M="y"===b?"height":"width",I=S[b],L=I+g[A],$=I-g[R],D=p?-C[M]/2:0,N=y===start?x[M]:C[M],Q=y===start?-C[M]:-x[M],F=t.elements.arrow,B=p&&F?getLayoutRect(F):{width:0,height:0},j=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:getFreshSideObject(),V=j[A],U=j[R],W=within(0,x[M],B[M]),Z=v?x[M]/2-D-W-V-E.mainAxis:N-W-V-E.mainAxis,H=v?-x[M]/2+D+W+U+E.mainAxis:Q+W+U+E.mainAxis,q=t.elements.arrow&&getOffsetParent(t.elements.arrow),X=q?"y"===b?q.clientTop||0:q.clientLeft||0:0,z=null!=(T=null==P?void 0:P[b])?T:0,Y=I+H-z,G=within(p?min(L,I+Z-z-X):L,I,p?max($,Y):$);S[b]=G,k[b]=G-I}if(a){var K,J="x"===b?top$1:left,ee="x"===b?bottom:right,te=S[w],ne="y"===w?"height":"width",ie=te+g[J],re=te-g[ee],se=-1!==[top$1,left].indexOf(O),oe=null!=(K=null==P?void 0:P[w])?K:0,ae=se?ie:te-x[ne]-C[ne]-oe+E.altAxis,le=se?te+x[ne]+C[ne]-oe-E.altAxis:re,ce=p&&se?withinMaxClamp(ae,te,le):within(p?ae:ie,te,p?le:re);S[w]=ce,k[w]=ce-te}t.modifiersData[i]=k}}var preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function getNodeScroll(e){return e!==getWindow(e)&&isHTMLElement(e)?getHTMLElementScroll(e):getWindowScroll(e)}function isElementScaled(e){var t=e.getBoundingClientRect(),n=round(t.width)/e.offsetWidth||1,i=round(t.height)/e.offsetHeight||1;return 1!==n||1!==i}function getCompositeRect(e,t,n){void 0===n&&(n=!1);var i=isHTMLElement(t),r=isHTMLElement(t)&&isElementScaled(t),s=getDocumentElement(t),o=getBoundingClientRect(e,r,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(i||!i&&!n)&&(("body"!==getNodeName(t)||isScrollParent(s))&&(a=getNodeScroll(t)),isHTMLElement(t)?((l=getBoundingClientRect(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=getWindowScrollBarX(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function order(e){var t=new Map,n=new Set,i=[];function r(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach((function(e){if(!n.has(e)){var i=t.get(e);i&&r(i)}})),i.push(e)}return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||r(e)})),i}function orderModifiers(e){var t=order(e);return modifierPhases.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}function debounce$2(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}function mergeByName(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function popperGenerator(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,i=void 0===n?[]:n,r=t.defaultOptions,s=void 0===r?DEFAULT_OPTIONS:r;return function(e,t,n){void 0===n&&(n=s);var r={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],a=!1,l={state:r,setOptions:function(n){var a="function"==typeof n?n(r.options):n;c(),r.options=Object.assign({},s,r.options,a),r.scrollParents={reference:isElement(e)?listScrollParents(e):e.contextElement?listScrollParents(e.contextElement):[],popper:listScrollParents(t)};var h=orderModifiers(mergeByName([].concat(i,r.options.modifiers)));return r.orderedModifiers=h.filter((function(e){return e.enabled})),r.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,i=void 0===n?{}:n,s=e.effect;if("function"==typeof s){var a=s({state:r,name:t,instance:l,options:i}),c=function(){};o.push(a||c)}})),l.update()},forceUpdate:function(){if(!a){var e=r.elements,t=e.reference,n=e.popper;if(areValidElements(t,n)){r.rects={reference:getCompositeRect(t,getOffsetParent(n),"fixed"===r.options.strategy),popper:getLayoutRect(n)},r.reset=!1,r.placement=r.options.placement,r.orderedModifiers.forEach((function(e){return r.modifiersData[e.name]=Object.assign({},e.data)}));for(var i=0;i<r.orderedModifiers.length;i++)if(!0!==r.reset){var s=r.orderedModifiers[i],o=s.fn,c=s.options,h=void 0===c?{}:c,d=s.name;"function"==typeof o&&(r=o({state:r,options:h,name:d,instance:l})||r)}else r.reset=!1,i=-1}}},update:debounce$2((function(){return new Promise((function(e){l.forceUpdate(),e(r)}))})),destroy:function(){c(),a=!0}};if(!areValidElements(e,t))return l;function c(){o.forEach((function(e){return e()})),o=[]}return l.setOptions(n).then((function(e){!a&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers:defaultModifiers}),hasElementType="undefined"!=typeof Element,hasMap="function"==typeof Map,hasSet="function"==typeof Set,hasArrayBuffer="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function equal(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var n,i,r,s;if(Array.isArray(e)){if((n=e.length)!=t.length)return!1;for(i=n;0!=i--;)if(!equal(e[i],t[i]))return!1;return!0}if(hasMap&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(s=e.entries();!(i=s.next()).done;)if(!t.has(i.value[0]))return!1;for(s=e.entries();!(i=s.next()).done;)if(!equal(i.value[1],t.get(i.value[0])))return!1;return!0}if(hasSet&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(s=e.entries();!(i=s.next()).done;)if(!t.has(i.value[0]))return!1;return!0}if(hasArrayBuffer&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((n=e.length)!=t.length)return!1;for(i=n;0!=i--;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((n=(r=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(t,r[i]))return!1;if(hasElementType&&e instanceof Element)return!1;for(i=n;0!=i--;)if(("_owner"!==r[i]&&"__v"!==r[i]&&"__o"!==r[i]||!e.$$typeof)&&!equal(e[r[i]],t[r[i]]))return!1;return!0}return e!=e&&t!=t}var reactFastCompare=function(e,t){try{return equal(e,t)}catch(e){if((e.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw e}},isEqual=getDefaultExportFromCjs(reactFastCompare),EMPTY_MODIFIERS=[],usePopper=function(e,t,n){void 0===n&&(n={});var i=React__namespace.useRef(null),r={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||EMPTY_MODIFIERS},s=React__namespace.useState({styles:{popper:{position:r.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),o=s[0],a=s[1],l=React__namespace.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(e){var t=e.state,n=Object.keys(t.elements);ReactDOM__namespace.flushSync((function(){a({styles:fromEntries(n.map((function(e){return[e,t.styles[e]||{}]}))),attributes:fromEntries(n.map((function(e){return[e,t.attributes[e]]})))})}))},requires:["computeStyles"]}}),[]),c=React__namespace.useMemo((function(){var e={onFirstUpdate:r.onFirstUpdate,placement:r.placement,strategy:r.strategy,modifiers:[].concat(r.modifiers,[l,{name:"applyStyles",enabled:!1}])};return isEqual(i.current,e)?i.current||e:(i.current=e,e)}),[r.onFirstUpdate,r.placement,r.strategy,r.modifiers,l]),h=React__namespace.useRef();return useIsomorphicLayoutEffect((function(){h.current&&h.current.setOptions(c)}),[c]),useIsomorphicLayoutEffect((function(){if(null!=e&&null!=t){var i=(n.createPopper||createPopper)(e,t,c);return h.current=i,function(){i.destroy(),h.current=null}}}),[e,t,n.createPopper]),{state:h.current?h.current.state:null,styles:o.styles,attributes:o.attributes,update:h.current?h.current.update:null,forceUpdate:h.current?h.current.forceUpdate:null}};const Dropdown=e=>{var{directionX:t="right",directionY:n="down",icon:i="dots-vertical",children:r,className:s="",title:o="",buttonContent:a,disabled:l=!1,noWrapper:c}=e,h=__rest(e,["directionX","directionY","icon","children","className","title","buttonContent","disabled","noWrapper"]);const[d,u]=React.useState(!1),p="right"===t&&"down"===n?"bottom-start":"left"===t&&"down"===n?"bottom-end":"right"===t&&"up"===n?"top-start":"top-end",[f,m]=React.useState(null),[g,O]=React.useState(null),{styles:y,attributes:v,update:b}=usePopper(d?f:void 0,d?g:void 0,{placement:p,modifiers:[{name:"offset",options:{offset:[0,5]}}]}),w=()=>{u(!1)};React.useEffect((()=>{null==b||b(),setTimeout((()=>{d?document.addEventListener("click",w,{once:!0}):document.removeEventListener("click",w)}))}),[d]);return React.createElement("span",Object.assign({className:classNames({"wy-dropdown":!c,"wy-dropup":!c&&"up"===n},s)},h),React.createElement(UIButton.UI,{ref:m,onClick:e=>(e=>{e.preventDefault(),u(!d)})(e),className:classNames({"wy-active":d}),title:o,disabled:l},a||React.createElement(UIIcon.UI,{name:i})),React.createElement("div",Object.assign({ref:O,className:classNames("wy-dropdown-menu",{"wy-dropdown-menu-end":"left"===t}),hidden:!d,style:y.popper},v.popper),r))},DropdownItem=e=>{var{children:t,className:n="",onClick:i,active:r}=e,s=__rest(e,["children","className","onClick","active"]);return React.createElement("div",Object.assign({className:classNames("wy-dropdown-item",{"wy-active":r},n),onClick:e=>{e.preventDefault(),i&&i(e)}},s),t)},DropdownAnchorItem=e=>{var{children:t,className:n="",link:i,active:r,download:s}=e,o=__rest(e,["children","className","link","active","download"]);return s&&(o=Object.assign(Object.assign({},o),{download:!0})),React.createElement("a",Object.assign({className:classNames("wy-dropdown-item",{"wy-active":r},n),href:i},o),t)},DropdownDivider=()=>React.createElement("hr",{className:"wy-dropdown-divider"}),UIDropdown={UI:Dropdown,Item:DropdownItem,Anchor:DropdownAnchorItem,Divider:DropdownDivider};var FUNC_ERROR_TEXT="Expected a function",NAN=NaN,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(e,t,n){var i,r,s,o,a,l,c=0,h=!1,d=!1,u=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function p(t){var n=i,s=r;return i=r=void 0,c=t,o=e.apply(s,n)}function f(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=s}function m(){var e=now();if(f(e))return g(e);a=setTimeout(m,function(e){var n=t-(e-l);return d?nativeMin(n,s-(e-c)):n}(e))}function g(e){return a=void 0,u&&i?p(e):(i=r=void 0,o)}function O(){var e=now(),n=f(e);if(i=arguments,r=this,l=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(m,t),h?p(e):o}(l);if(d)return a=setTimeout(m,t),p(l)}return void 0===a&&(a=setTimeout(m,t)),o}return t=toNumber(t)||0,isObject$1(n)&&(h=!!n.leading,s=(d="maxWait"in n)?nativeMax(toNumber(n.maxWait)||0,t):s,u="trailing"in n?!!n.trailing:u),O.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=r=a=void 0},O.flush=function(){return void 0===a?o:g(now())},O}function isObject$1(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function isObjectLike(e){return!!e&&"object"==typeof e}function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&objectToString.call(e)==symbolTag}function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject$1(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject$1(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var n=reIsBinary.test(e);return n||reIsOctal.test(e)?freeParseInt(e.slice(2),n?2:8):reIsBadHex.test(e)?NAN:+e}var lodash_debounce=debounce,debounce$1=getDefaultExportFromCjs(lodash_debounce);function useDebounce(e,t){const n=React.useRef({cb:e,delay:t});return React.useEffect((()=>{n.current={cb:e,delay:t}})),React.useCallback(debounce$1(((...e)=>{n.current.delay===t&&n.current.cb(...e)}),t,{leading:!1,trailing:!0}),[t,debounce$1])}function useSearchUsers(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useSearchUsers must be used within an WeavyProvider");return useQuery("users",(async()=>{const t=await n.get(`/api/users/autocomplete?q=${e}&skip=0&top=25`);return await t.json()}),t)}const Presence=({id:e,status:t})=>React.createElement("span",{className:classNames("wy-presence",{"wy-presence-active":"active"===t}),"data-presence-id":e}),wordBoundary='\\s,.:;"',separateByWordBoundaryRegExp=new RegExp(`^|[${wordBoundary}]|$`,"g");function getInitials(e,t=2){if(!e)return null;let n="";const i=e.split(separateByWordBoundaryRegExp).filter((e=>e));return 1==i.length?n=i[0]:i.forEach((e=>{n+=e.charAt(0)})),n.substring(0,t).toUpperCase()}const Avatar=({id:e,src:t,name:n,presence:i,size:r=48,className:s})=>{const o=r/16;let a;return!t&&n&&(a=getInitials(n)),React.createElement("div",{className:classNames("wy-avatar-presence",s)},t?React.createElement("img",{alt:"",title:n,className:"wy-avatar",height:r,width:r,src:t}):React.createElement("div",{className:"wy-avatar wy-avatar-initials",style:{"--wy-component-avatar-size":`${o}rem`},title:n},React.createElement("span",null,a)),i&&e&&React.createElement(Presence,{id:e,status:i}))},AvatarGroup=({user:e,members:t,name:n="",size:i=48})=>{const r=i/16,s=((null==t?void 0:t.data)||[]).filter((t=>t.id!==e.id)).slice(0,2).reverse(),o=(null==s?void 0:s.shift())||e,a=(null==s?void 0:s.shift())||(o!==e?e:void 0);return React.createElement("div",{className:"wy-avatar-group",title:n,style:{"--wy-component-avatar-size":`${r}rem`}},React.createElement(Avatar,{src:null==a?void 0:a.avatar_url,name:null==a?void 0:a.display_name,size:2*i/3}),React.createElement(Avatar,{src:o.avatar_url,name:o.display_name,size:2*i/3}))},SearchUsers=({existingMembers:e,handleSubmit:t,buttonTitle:n})=>{const[i,r]=React.useState(""),[s,o]=React.useState([]),{data:a,refetch:l}=useSearchUsers(i||"*",{enabled:!1}),c=useDebounce((()=>l()),250);React.useEffect(c,[i]);const h=e=>null!=s.find((t=>t.id===e)),d=(e,t)=>{o(t?[...s,e]:s.filter((t=>t.id!==e.id)))},u=()=>{r("")};return React.createElement("div",{className:"wy-search wy-scroll-y"},React.createElement("div",{className:"wy-pane-group"},React.createElement("div",{className:"wy-search-form wy-input-group"},React.createElement("input",{className:"wy-search-input wy-input wy-input-filled",value:i,onChange:e=>r(e.target.value),name:"text",placeholder:"Search..."}),React.createElement(UIButton.UI,{type:"reset",onClick:()=>u()},React.createElement(UIIcon.UI,{name:"close-circle"})),React.createElement(UIButton.UI,null,React.createElement(UIIcon.UI,{name:"magnify"})))),React.createElement("div",{className:"wy-pane-group"},a&&(!a.data||0===a.data.filter((t=>void 0===(null==e?void 0:e.find((e=>e.id===t.id))))).length)&&React.createElement("div",{className:"wy-table-no-result"},"Your search did not match any people."),s&&s.length>0&&React.createElement("div",{className:"wy-pane-group"},React.createElement("label",{className:"wy-input-label"},"Selected"),s.map((e=>React.createElement("div",{className:"wy-item",key:e.id},React.createElement(Avatar,{src:e.avatar_url,size:32,id:e.id,presence:e.presence,name:e.display_name}),React.createElement("div",{className:"wy-item-body"},e.display_name),React.createElement(UIButton.UI,{onClick:()=>d(e,!h(e.id)),title:"Remove"},React.createElement(UIIcon.UI,{name:"account-minus"}))))),React.createElement("hr",null)),React.createElement("div",{className:"wy-pane-group"},a&&a.data&&a.data.filter((t=>void 0===(null==e?void 0:e.find((e=>e.id===t.id)))&&void 0===s.find((e=>e.id===t.id)))).map((e=>React.createElement("div",{className:"wy-item",key:e.id},React.createElement(Avatar,{src:e.avatar_url,size:32,id:e.id,presence:e.presence,name:e.display_name}),React.createElement("div",{className:"wy-item-body"},e.display_name),React.createElement(UIButton.UI,{onClick:()=>d(e,!h(e.id)),title:"Add"},React.createElement(UIIcon.UI,{name:"account-plus"}))))))),React.createElement("div",{className:"wy-footerbars"},React.createElement("div",{className:"wy-footerbar"},React.createElement("div",{className:"wy-pane-group"},React.createElement("div",{className:"wy-buttons"},React.createElement("button",{className:"wy-button wy-button-primary",type:"button",onClick:()=>{t(s),u()},disabled:0===s.length},n))))))};function useMutateMembers(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateMembers must be used within an WeavyProvider");return useMutation((async({id:t,members:n})=>await e.post("/api/apps/"+t+"/members/","POST",JSON.stringify(n))),{onSuccess:(e,n,i)=>{t.invalidateQueries("conversations"),t.invalidateQueries(["conversation",n.id]),t.invalidateQueries(["members",n.id])}})}function useConversation(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useConversation must be used within an WeavyProvider");return useQuery(["conversation",e],(async()=>{const t=await n.get("/api/conversations/"+e);return await t.json()}),t)}function useMutateConversationName(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateConversationName must be used within an WeavyProvider");return useMutation((async({id:t,name:n})=>(await e.post("/api/apps/"+t,"PATCH",JSON.stringify({type:"ChatRoom",name:n}))).json()),{onSuccess:(e,n,i)=>{t.invalidateQueries("conversations"),t.invalidateQueries(["conversation",n.id])}})}function useMutateRemoveMembers(){const{client:e}=React.useContext(WeavyContext);if(!e)throw new Error("useMutateRemoveMembers must be used within an WeavyProvider");return useMutation((async({id:t,members:n})=>await e.post("/api/apps/"+t+"/members/"+n.join(","),"DELETE",JSON.stringify(n))))}function useMessages(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useMessages must be used within an WeavyProvider");var i=Object.assign(Object.assign({},t),{getNextPageParam:(e,t)=>{if((null==e?void 0:e.end)<(null==e?void 0:e.count))return 25*t.length},select:e=>({pages:[...e.pages].reverse(),pageParams:[...e.pageParams].reverse()})});return useInfiniteQuery(["messages",e],(async t=>{var i;let r=t.pageParam||0;const s=await n.get("/api/apps/"+e+"/messages?orderby=createdat+desc&skip="+r+"&top=25");let o=await s.json();return o.data=(null===(i=o.data)||void 0===i?void 0:i.reverse())||[],o}),i)}const Attachment=({url:e,previewUrl:t,name:n,size:i,provider:r,onClick:s})=>{let o=i&&i>0?fileSizeAsString(i):null,a=getExtension(n),{icon:l}=getIcon(n),c=getKind(n),h=getProvider(r);return React.createElement("a",{href:t||e,className:"wy-item wy-item-lg",target:"_blank",title:n,onClick:s?e=>s(e):void 0},React.createElement(UIIcon.UI,{name:l+(h?`+${h}`:""),size:48,className:classNames("wy-kind-"+toKebabCase(c),"wy-ext-"+a.substring(1))}),React.createElement("div",{className:"wy-item-body "},React.createElement("div",{className:"wy-item-title"},n),o&&React.createElement("div",{className:"wy-item-text",title:o},o)))};function findAnyExistingItem(e,t,n,i=!1){var r;return e&&e.pages&&e.pages.some((e=>{var i;return null===(i=e.data)||void 0===i?void 0:i.some((e=>{if(e[t]===n)return r=e,!0}))})),r&&i?JSON.parse(JSON.stringify(r)):r}function addToQueryData(e,t,n={},i){var r;if(e){if(e.pages){var s=-1;const o=null!==(r=e.pages.map(((r,o)=>{if(s>=0)return r;var a=r.data||[];return a=a.filter((e=>e.id!==t.id&&(!i||e.id!==i))),n&&n.by?(s=a.findIndex((e=>{var i=e[n.by],r=t[n.by];if("modified_at"===n.by&&(null!=i||(i=e.created_at),null!=r||(r=t.created_at)),"string"==typeof i&&"string"==typeof r){let e=i.localeCompare(r,void 0,{sensitivity:"base",numeric:!0});return n.descending?e<0:e>0}return n.descending?i<r:i>r})))>=0?(a.splice(s,0,t),r.data=[...a]):o==e.pages.length-1&&r.end===r.count?r.data=[...a,t]:r.data=[...a]:0===o&&(n.descending?r.data=[t,...a]:r.data=[...a,t]),r})))&&void 0!==r?r:[];return{pages:o,pageParams:e.pageParams}}if(e.length){s=-1;var o=[...e.filter((e=>e.id!==t.id&&(!i||e.id!==i)))];return n&&n.by?(s=o.findIndex((e=>{var i=e[n.by],r=t[n.by];if("modified_at"===n.by&&(null!=i||(i=e.created_at),null!=r||(r=t.created_at)),"string"==typeof i&&"string"==typeof r){let e=i.localeCompare(r,void 0,{sensitivity:"base",numeric:!0});return n.descending?e<0:e>0}return n.descending?i<r:i>r})))>=0?o.splice(s,0,t):o.push(t):n.descending?o.unshift(t):o.push(t),o}}return e}function updateQueryData(e,t,n){var i;if(void 0!==t){const r=t instanceof Function?t:e=>e.id===t;if(e){if(e.pages){return{pages:null!==(i=e.pages.map(((e,t)=>(e.data&&(e.data=[...e.data.map((e=>(r(e)&&(e=JSON.parse(JSON.stringify(e)),n(e)),e)))]),e))))&&void 0!==i?i:[],pageParams:e.pageParams}}if(e.length)return[...e.map((e=>(r(e)&&(e=JSON.parse(JSON.stringify(e)),n(e)),e)))]}}return e}function removeQueryData(e,t){var n;if(void 0!==t){const i=t instanceof Function?t:e=>e.id===t;if(e){if(e.pages){return{pages:null!==(n=e.pages.map(((e,t)=>(e.data=[...e.data.filter((e=>!i(e)))],e))))&&void 0!==n?n:[],pageParams:e.pageParams}}if(e.length)return[...e.filter((e=>!i(e)))]}}return e}const addCacheItem=(e,t,n,i,r)=>{e.setQueryData(t,(e=>addToQueryData(e,n,r,i)))},updateCacheItem=(e,t,n,i)=>{e.setQueryData(t,(e=>updateQueryData(e,n,i)))},removeCacheItem=(e,t,n)=>{e.setQueryData(t,(e=>removeQueryData(e,n)))};function useMutateReaction(){const{client:e}=React.useContext(WeavyContext),{user:t}=React.useContext(UserContext),n=useQueryClient();if(!e)throw new Error("useMutateReaction must be used within an WeavyProvider");return useMutation((async({id:t,type:n,reaction:i})=>await e.post(`/api/${n}/${t}/reactions`,"POST",JSON.stringify({content:i}))),{onSuccess:(e,t,n)=>{},onMutate:async e=>{updateCacheItem(n,[e.type,e.parentId],e.id,(n=>{n.reactions=n.reactions||[],n.reactions=[...n.reactions,{content:e.reaction,created_by_id:t.id}]}))}})}const events=[],callbacks={};function useForceUpdate(){const[,e]=React.useState({});return React.useCallback((()=>e({})),[])}function useEvents(){const e=useForceUpdate();return{dispatch:(t,n)=>{events.push({event:t,data:n,created:Date.now()}),((t,n)=>{t&&(t.forEach((e=>e(n))),e())})(callbacks[t],n)},on:(e,t)=>(callbacks[e]?callbacks[e].push(t):callbacks[e]=[t],()=>callbacks[e]=callbacks[e].filter((e=>e!==t))),off:(e,t)=>{callbacks[e]&&(callbacks[e]=callbacks[e].filter((e=>e!==t)))},events:events}}function useMutateDeleteReaction(){const{client:e}=React.useContext(WeavyContext),{user:t}=React.useContext(UserContext),n=useQueryClient();if(!e)throw new Error("useMutateDeleteReaction must be used within an WeavyProvider");return useMutation((async({id:t,type:n})=>await e.post(`/api/${n}/${t}/reactions`,"DELETE","")),{onSuccess:(e,t,n)=>{},onMutate:async e=>{updateCacheItem(n,[e.type,e.parentId],e.id,(e=>{e.reactions=[...e.reactions.filter((e=>e.created_by_id!==t.id))]}))}})}const SheetImpl=({children:e,className:t="",isOpen:n,style:i,title:r,onClose:s})=>{const[o,a]=React.useState(!1),{dispatch:l,on:c,off:h}=useEvents();return React.useEffect((()=>{if(s){if(o)return c("close_sheet",s),()=>{h("close_sheet",s)};h("close_sheet",s)}}),[o]),React.useEffect((()=>{n?l("close_sheet",{}):a(!1)}),[n]),React.createElement(Modal,{isOpen:n,ariaHideApp:!1,onAfterOpen:()=>{a(!0)},onAfterClose:()=>{a(!1)},onRequestClose:s,closeTimeoutMS:201,className:classNames("wy-sheet",t,{"wy-show":o}),overlayClassName:"wy-viewport",contentLabel:r,shouldCloseOnOverlayClick:!1,style:i},React.createElement("div",{className:"wy-appbar"},React.createElement("div",null),React.createElement("div",{className:"wy-appbar-text"},r),React.createElement("div",{className:"wy-appbar-buttons"},s&&React.createElement(UIButton.UI,{onClick:e=>s(e),title:"Close"},React.createElement(UIIcon.UI,{name:"close"})))),React.createElement("div",{className:"wy-sheet-body wy-scroll-y"},e))},UISheet={UI:SheetImpl};function useReactionList(e,t,n){const{client:i}=React.useContext(WeavyContext);if(!i)throw new Error("useReactionList must be used within an WeavyProvider");return useQuery(["reactions",e,t],(async()=>{const n=await i.get(`/api/${t}/${e}/reactions`);return await n.json()}),n)}function useMutateReplaceReaction(){const{client:e}=React.useContext(WeavyContext),{user:t}=React.useContext(UserContext),n=useQueryClient();if(!e)throw new Error("useMutateReplaceReaction must be used within an WeavyProvider");return useMutation((async({id:t,type:n,reaction:i})=>{await e.post(`/api/${n}/${t}/reactions`,"DELETE","");return await e.post(`/api/${n}/${t}/reactions`,"POST",JSON.stringify({content:i}))}),{onSuccess:(e,t,n)=>{},onMutate:async e=>{updateCacheItem(n,[e.type,e.parentId],e.id,(n=>{n.reactions=n.reactions.map((n=>(n.created_by_id!==t.id||(n.content=e.reaction),n)))}))}})}const ReactionsLike=({id:e,parentId:t,type:n,reactions:i})=>{const{user:r}=React.useContext(UserContext),[s,o]=React.useState(""),a=useMutateReaction(),l=useMutateDeleteReaction(),c=useMutateReplaceReaction();React.useEffect((()=>{var e=null==i?void 0:i.find((e=>e.created_by_id===r.id));o(e?e.content:"")}),[i]);return React.createElement(UIButton.UI,{className:"wy-like-button",onClick:()=>(async s=>{const o=null==i?void 0:i.find((e=>e.created_by_id===r.id));o&&o.content!==s?await c.mutateAsync({parentId:t,id:e,type:n,reaction:s}):o?await l.mutateAsync({parentId:t,id:e,type:n,reaction:s}):await a.mutateAsync({parentId:t,id:e,type:n,reaction:s})})("")},React.createElement(UIIcon.UI,{name:""===s?"thumb-up":"thumb-up-outline",size:20}))},ReactionsMenu=({id:e,parentId:t,type:n,placement:i="top",reactions:r})=>{const{user:s}=React.useContext(UserContext),{options:o}=React.useContext(WeavyContext),[a,l]=React.useState(!1),[c,h]=React.useState(""),d=null==o?void 0:o.reactions,u=useMutateReaction(),p=useMutateDeleteReaction(),f=useMutateReplaceReaction(),[m,g]=React.useState(null),[O,y]=React.useState(null),{styles:v,attributes:b,update:w}=usePopper(a?m:void 0,a?O:void 0,{placement:i});React.useEffect((()=>{null==w||w(),a?document.addEventListener("click",(()=>{l(!1)})):document.removeEventListener("click",(()=>{l(!1)}))}),[a]),React.useEffect((()=>{var e=null==r?void 0:r.find((e=>e.created_by_id===s.id));h(e?e.content:"")}),[r]);return React.createElement("div",{className:classNames({"wy-active":a}),style:{position:"relative"}},React.createElement(UIButton.UI,{ref:g,className:"wy-reaction-menu-button",onClick:e=>{e.stopPropagation(),l(!a)}},React.createElement(UIIcon.UI,{name:"emoticon-plus",size:20})),React.createElement("div",Object.assign({ref:y,className:"wy-reaction-menu wy-dropdown-menu",hidden:!a,style:v.popper},b.popper),React.createElement("div",{className:"wy-reaction-picker"},null==d?void 0:d.map(((i,o)=>React.createElement(UIButton.UI,{key:o,onClick:()=>(async i=>{const o=null==r?void 0:r.find((e=>e.created_by_id===s.id));o&&o.content!==i?await f.mutateAsync({parentId:t,id:e,type:n,reaction:i}):o?await p.mutateAsync({parentId:t,id:e,type:n,reaction:i}):await u.mutateAsync({parentId:t,id:e,type:n,reaction:i}),l(!1)})(i),className:classNames("wy-button-icon wy-reaction-button",{"wy-active":c===i}),"data-emoji":i},React.createElement("span",{className:"wy-emoji"},i)))))))},ReactionsList=({id:e,type:t,reactions:n,featureEnabled:i=!0})=>{var r,s;const{user:o}=React.useContext(UserContext),[a,l]=React.useState(),[c,h]=React.useState([]),[d,u]=React.useState(0),{data:p,isLoading:f,refetch:m}=useReactionList(e,t,{enabled:!1}),{on:g,off:O}=useEvents(),[y,v]=React.useState(!1);React.useEffect((()=>(g("reaction_added_"+e,b),g("reaction_deleted_"+e,w),()=>{O("reaction_added_"+e,b),O("reaction_deleted_"+e,w)})),[e]),React.useEffect((()=>{l(n)}),[n]),React.useEffect((()=>{if(a){let e=[...new Map(null==a?void 0:a.map((e=>[e.content,e]))).values()].map((e=>({content:e.content,count:a.filter((t=>t.content===e.content)).length,has_reacted:a.filter((t=>t.content===e.content&&t.created_by_id===o.id)).length>0}))),t=e.reduce(((e,t)=>e+t.count),0);h(e),u(t),y&&setTimeout((()=>m()),200)}}),[a,e,t]);const b=React.useCallback((t=>{t.entity.id===e&&t.actor.id!==o.id&&l((e=>[...e||[],{content:t.reaction,created_by_id:t.actor.id}]))}),[e,a]),w=React.useCallback((t=>{t.entity.id===e&&t.actor.id!==o.id&&l((e=>null==e?void 0:e.filter((e=>e.created_by_id!==t.actor.id))))}),[e,a]),S=e=>{e.preventDefault(),m(),v(!0)};return React.createElement(React.Fragment,null,d>0&&i&&React.createElement(React.Fragment,null,React.createElement(UIButton.UI,{className:"wy-reactions wy-button-icon",onClick:S},!!c&&c.map(((e,t)=>React.createElement("span",{key:t,className:"wy-emoji",title:e.count.toString()},e.content))),d>1&&React.createElement("span",{className:"wy-reaction-count"},d)),React.createElement(UISheet.UI,{title:"Reactions",isOpen:y,onClose:()=>{v(!1)}},y&&React.createElement(React.Fragment,null,f&&React.createElement(UISpinner.UI,{overlay:!0}),!f&&p&&(null===(r=p.data)||void 0===r?void 0:r.map(((e,t)=>React.createElement("div",{className:"wy-item",key:"r"+t},React.createElement(Avatar,{size:32,src:e.created_by.avatar_url,name:e.created_by.display_name}),React.createElement("div",{className:"wy-item-body"},e.created_by.display_name),React.createElement("span",{className:"wy-emoji"},e.content)))))))),d>0&&!i&&React.createElement(React.Fragment,null,React.createElement("a",{href:"#",className:"wy-like-count",onClick:e=>S(e)},d," ",1===d?"like":"likes"),React.createElement(UISheet.UI,{title:"Reactions",isOpen:y,onClose:()=>{v(!1)}},y&&React.createElement(React.Fragment,null,f&&React.createElement(UISpinner.UI,{overlay:!0}),!f&&p&&(null===(s=p.data)||void 0===s?void 0:s.map(((e,t)=>React.createElement("div",{className:"wy-item",key:"r"+t},React.createElement(Avatar,{size:32,src:e.created_by.avatar_url,name:e.created_by.display_name}),React.createElement("div",{className:"wy-item-body"},e.created_by.display_name),React.createElement("span",{className:"wy-emoji"},e.content)))))))))},SeenBy=({seenBy:e})=>React.createElement(React.Fragment,null,e&&e.length>0&&React.createElement("div",{className:"wy-readby-status"},e.map((e=>{const t=dayjs.utc(e.marked_at).tz(dayjs.tz.guess());return React.createElement(Avatar,{name:`Seen by ${e.display_name} at ${t.format("LLLL")}`,src:e.avatar_url,size:16,key:e.id})})))),MeetingCard=({meeting:e})=>React.createElement("div",{className:"wy-list"},e.ended_at&&React.createElement("div",{className:"wy-item wy-meeting"},React.createElement(UIIcon.UI,{name:"zoom",size:96,color:"gray"}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},"Zoom meeting"),React.createElement("div",{className:"wy-item-body"},React.createElement("div",null,"Ended ",dayjs.utc(e.ended_at).tz(dayjs.tz.guess()).fromNow()),e.recording_url&&React.createElement("div",{className:"wy-meeting-actions"},React.createElement("a",{href:e.recording_url,target:"_blank",className:"wy-button wy-button-primary"},"Play recording"))))),!e.ended_at&&React.createElement("a",{className:"wy-item wy-meeting",href:e.join_url,target:"_blank"},React.createElement(UIIcon.UI,{name:"zoom",color:"native",size:96}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},"Zoom meeting"),React.createElement("div",{className:"wy-item-body"},React.createElement("div",null,"ID: ",`${e.provider_id.substring(0,3)}-${e.provider_id.substring(3,6)}-${e.provider_id.substring(6)}`),React.createElement("div",{className:"wy-meeting-actions"},React.createElement(UIButton.UI,{className:"wy-button-primary"},"Join meeting"))))));function useMutateVote(){const e=useQueryClient(),{client:t}=React.useContext(WeavyContext);if(!t)throw new Error("useMutateVote must be used within an WeavyProvider");return useMutation((async({id:e})=>(await t.post(`/api/options/${e}/vote`,"POST","")).json()),{onSuccess:async(n,i,r)=>{const s=await t.get("/api/"+i.type+"/"+i.parentId);let o=await s.json();updateCacheItem(e,[i.type,i.appId],i.parentId,(e=>{e.options=o.options}))},onMutate:async t=>{updateCacheItem(e,[t.type,t.appId],t.parentId,(e=>{var n;e.options=null===(n=e.options)||void 0===n?void 0:n.map((e=>{if(e.has_voted){e.has_voted=!1;let t=e.vote_count||1;e.vote_count=t-1}else if(!e.has_voted&&e.id===t.id){e.has_voted=!0;let t=e.vote_count||0;e.vote_count=t+1}return e}))}))}})}function useVotes(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useVotes must be used within an WeavyProvider");return useQuery(["votes",e],(async()=>{const t=await n.get(`/api/options/${e}/voters`);return await t.json()}),t)}const PollOption=({id:e,text:t,has_voted:n,ratio:i,onVote:r})=>{const[s,o]=React.useState(!1),{data:a,isLoading:l,refetch:c}=useVotes(e,{enabled:!1});return React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-item wy-poll-option",onClick:()=>r(e)},React.createElement("div",{className:"wy-progress",style:{width:i+"%"}}),n&&React.createElement(UIIcon.UI,{name:"check-circle"}),!n&&React.createElement(UIIcon.UI,{name:"circle-outline"}),React.createElement("div",{className:"wy-item-body"},t),i>0&&React.createElement("a",{className:"wy-facepile",onClick:e=>{e.preventDefault(),e.stopPropagation(),o(!0),c()}}," ",i+"%"," ")),React.createElement(UISheet.UI,{title:t,isOpen:s,onClose:()=>o(!1)},l&&React.createElement(UISpinner.UI,null),!l&&a&&a.map(((e,t)=>React.createElement("div",{className:"wy-item",key:"vote"+t},React.createElement(Avatar,{size:32,src:e.avatar_url,name:e.display_name}),React.createElement("div",{className:"wy-item-body"},e.display_name))))))},Poll=({appId:e,parentId:t,parentType:n,options:i})=>{const[r,s]=React.useState(i),[o,a]=React.useState(0),l=useMutateVote();React.useEffect((()=>{let e=r.reduce(((e,t)=>e+(t.vote_count||0)),0);a(e)}),[r]),React.useEffect((()=>{s(i)}),[i]);const c=async i=>{i&&await l.mutateAsync({id:i,appId:e,type:n,parentId:t})};return React.createElement("div",{className:"wy-poll"},r.map((e=>{let t=o>0?Math.round((e.vote_count||0)/o*100):0;return React.createElement(PollOption,{key:"option"+e.id,id:e.id||-1,text:e.text,has_voted:e.has_voted,ratio:t,onVote:c})})))};var Feature;!function(e){e.Attachments="Attachments",e.CloudFiles="CloudFiles",e.Embeds="Embeds",e.Meetings="Meetings",e.Mentions="Mentions",e.Polls="Polls",e.Previews="Previews",e.Reactions="Reactions",e.Receipts="Receipts",e.Thumbnails="Thumbnails",e.Typing="Typing",e.Webhooks="Webhooks",e.Comments="Comments",e.Versions="Versions",e.WebDAV="WebDAV"}(Feature||(Feature={}));const hasFeature=(e,t,n=!0)=>-1!=e.indexOf(t)&&n,Message=({id:e,html:t,temp:n,me:i,avatar:r,name:s,created_at:o,created_by:a,attachments:l,meeting:c,options:h,appId:d,reactions:u,seenBy:p,chatRoom:f,features:m,appFeatures:g})=>{const{openPreview:O,setPreviewFiles:y}=React.useContext(PreviewContext);let v=null==l?void 0:l.filter((e=>"image"===e.kind&&e.thumbnail_url)),b=null==l?void 0:l.filter((e=>"image"!==e.kind||!e.thumbnail_url));const w=dayjs.utc(o).tz(dayjs.tz.guess()),S=(e,t)=>{e.preventDefault(),y(l),O(t)};return React.createElement(React.Fragment,null,React.createElement("div",{className:classNames("wy-message",{"wy-message-me":i})},!i&&React.createElement("div",{className:"wy-message-author"},r&&React.createElement(Avatar,{src:r,size:32,name:s})),React.createElement("div",{className:"wy-message-content"},React.createElement("div",{className:"wy-message-meta"},f&&!i&&React.createElement("span",null,a,"  "),React.createElement("time",{dateTime:o,title:w.format("LLLL")},w.fromNow())),React.createElement("div",{className:"wy-message-bubble"},n&&React.createElement("div",{className:"wy-content"},t),!n&&React.createElement(React.Fragment,null,v&&!!v.length&&React.createElement(ImageGrid,null,v.map((e=>e.download_url&&React.createElement(Image$1,{onClick:t=>S(t,e.id),key:e.id,src:e.download_url,previewSrc:e.preview_url,width:e.width,height:e.height})||null))),t&&React.createElement("div",{className:"wy-content",dangerouslySetInnerHTML:{__html:t||""}}),c&&React.createElement(MeetingCard,{meeting:c}),h&&h.length>0&&React.createElement(Poll,{appId:d,parentId:e,parentType:"messages",options:h}),b&&!!b.length&&React.createElement("div",{className:"wy-list wy-list-bordered"},b.map((e=>React.createElement(Attachment,{key:e.id,onClick:t=>S(t,e.id),name:e.name,previewFormat:e.kind,provider:e.provider,url:e.download_url,previewUrl:e.provider?e.external_url:e.preview_url,mediaType:e.media_type,kind:e.kind,size:e.size})))),React.createElement("div",{className:"wy-reactions-line"},hasFeature(m,Feature.Reactions,null==g?void 0:g.reactions)?React.createElement(React.Fragment,null,React.createElement(ReactionsList,{id:e,type:"messages",parentId:d,reactions:u}),!n&&React.createElement(ReactionsMenu,{parentId:d,id:e,type:"messages",reactions:u,placement:i?"top-end":"top-start"})):React.createElement(React.Fragment,null,!n&&React.createElement(ReactionsList,{id:e,type:"messages",parentId:d,reactions:u,featureEnabled:!1}),React.createElement(ReactionsLike,{id:e,type:"messages",parentId:d,reactions:u}))))))),hasFeature(m,Feature.Receipts,null==g?void 0:g.receipts)&&React.createElement(SeenBy,{id:e,parentId:d,seenBy:p,createdAt:o}))};function getNextPositionedChild(e){for(;e;)if(e=e.nextElementSibling,!1===/absolute|sticky|fixed/.test(getComputedStyle(e).position))return e}function getScrollParent(e,t){if(e){var n=getComputedStyle(e),i="absolute"===n.position,r=t?/(auto|scroll|overlay|hidden)/:/(auto|overlay|scroll)/;if("fixed"===n.position)return document.scrollingElement;for(var s=e;s=s.parentElement;)if(n=getComputedStyle(s),(!i||"static"!==n.position)&&r.test(n.overflow+n.overflowY+n.overflowX))return s}return document.scrollingElement}function isParentAtBottom(e,t){if(e){t??=128;let n=getScrollParent(e);return Math.abs(n.scrollTop+n.clientHeight-n.scrollHeight)<t}return!1}async function scrollParentToBottom(e,t){if(e){let n=getScrollParent(e);Math.abs(n.scrollTop+n.clientHeight-n.scrollHeight)>1&&(t?n.scrollTo({top:n.scrollHeight,left:0,behavior:"smooth"}):n.scrollTop=n.scrollHeight),await new Promise((e=>{let i=n.scrollTop,r=()=>{t&&n.scrollTop===i&&(n.scrollTop=n.scrollHeight),i=n.scrollTop,Math.abs(n.scrollTop+n.clientHeight-n.scrollHeight)>1?requestAnimationFrame(r):e()};requestAnimationFrame(r)}))}}const THRESHOLD=0,ROOT_MARGIN="24px";function createScroller(e,t,n=!1){let i=!1;var r=getScrollParent(e);r.style.overflowAnchor="none";var s=r===document.documentElement?document:r;t??=()=>Promise.reject(new Error("No reverse scroller handler function defined"));const o=new IntersectionObserver(((e,s)=>{e.forEach((function(e){if(e.isIntersecting&&!i){if(i=!0,n)var s=getNextPositionedChild(e.target),o=r.scrollHeight,a=s.offsetTop;let l=()=>{queueMicrotask((()=>{if(o!==r.scrollHeight){if(n){let e=s.offsetTop-a;r.scrollTop+=e}requestAnimationFrame((()=>i=!1))}else queueMicrotask((()=>{if(o!==r.scrollHeight){if(n){let e=s.offsetTop-a;r.scrollTop+=e}requestAnimationFrame((()=>i=!1))}else requestAnimationFrame((()=>{if(n){let e=s.offsetTop-a;r.scrollTop+=e}requestAnimationFrame((()=>i=!1))}))}))}))},c=t();c?c.then(l):l()}}))}),{root:s,threshold:THRESHOLD,rootMargin:ROOT_MARGIN});return o.observe(e),o}function useInfinteScroll(e,t=[],n=!1){const i=React.useRef(),[r,s]=React.useState();return React.useLayoutEffect((()=>{var t;if(!e.isLoading)return requestAnimationFrame((()=>{t=createScroller(i.current,(()=>{if(e.hasNextPage||e.isFetching)return e.fetchNextPage({cancelRefetch:!1}).then((()=>{if(n)return new Promise((e=>{s((()=>{e()}))}))}))}),n)})),()=>{null==t||t.disconnect()}}),[e.isLoading,e.dataUpdatedAt,...t]),i}function useReverseInfiniteScroll(e,t=[]){return useInfinteScroll(e,t,!0)}function useMutateRead(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateUnread must be used within an WeavyProvider");return useMutation((async({id:t,read:n,messageId:i})=>{const r=n?`/api/conversations/${t}/mark?messageId=${i}`:`/api/conversations/${t}/mark`;return(await e.post(r,n?"PUT":"DELETE","")).json()}),{onSuccess:()=>{t.invalidateQueries("conversations")},onMutate:async e=>{updateCacheItem(t,"conversations",e.id,(t=>{t.is_unread=!e.read}))}})}function useMutateMessage(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateMessage must be used within an WeavyProvider");return useMutation((async({id:t,text:n,blobs:i,meeting:r})=>(await e.post("/api/apps/"+t+"/messages","POST",JSON.stringify({text:n,blobs:i.map((e=>e.id)),meeting_id:r}))).json()),{onSuccess:(e,n,i)=>{addCacheItem(t,["messages",n.id],e,i.tempId),t.invalidateQueries("conversations")},onMutate:async e=>{await t.cancelQueries(["messages",e.id]);const n=Math.random(),i={id:n,app_id:-1,attachment_ids:[],is_subscribed:!0,is_trashed:!1,text:e.text,html:e.text,plain:e.text,temp:!0,created_by_id:e.userId,created_by:{id:e.userId,avatar_url:"",display_name:"",presence:"",name:""},created_at:(new Date).toUTCString(),attachments:[],reactions:[]};return addCacheItem(t,["messages",e.id],i),e.callback(),{tempId:n}}})}function _objectWithoutPropertiesLoose$1(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}class Text{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,n){[e,t]=clip(this,e,t);let i=[];return this.decompose(0,e,i,2),n.length&&n.decompose(0,n.length,i,3),this.decompose(t,this.length,i,1),TextNode.from(i,this.length-(t-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=clip(this,e,t);let n=[];return this.decompose(e,t,n,0),TextNode.from(n,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),i=new RawTextCursor(this),r=new RawTextCursor(e);for(let e=t,s=t;;){if(i.next(e),r.next(e),e=0,i.lineBreak!=r.lineBreak||i.done!=r.done||i.value!=r.value)return!1;if(s+=i.value.length,i.done||s>=n)return!0}}iter(e=1){return new RawTextCursor(this,e)}iterRange(e,t=this.length){return new PartialTextCursor(this,e,t)}iterLines(e,t){let n;if(null==e)n=this.iter();else{null==t&&(t=this.lines+1);let i=this.line(e).from;n=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new LineCursor(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(0==e.length)throw new RangeError("A document must have at least one line");return 1!=e.length||e[0]?e.length<=32?new TextLeaf(e):TextNode.from(TextLeaf.split(e,[])):Text.empty}}class TextLeaf extends Text{constructor(e,t=textLength(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.text[r],o=i+s.length;if((t?n:o)>=e)return new Line$1(i,o,n,s);i=o+1,n++}}decompose(e,t,n,i){let r=e<=0&&t>=this.length?this:new TextLeaf(sliceText(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(1&i){let e=n.pop(),t=appendText(r.text,e.text.slice(),0,r.length);if(t.length<=32)n.push(new TextLeaf(t,e.length+r.length));else{let e=t.length>>1;n.push(new TextLeaf(t.slice(0,e)),new TextLeaf(t.slice(e)))}}else n.push(r)}replace(e,t,n){if(!(n instanceof TextLeaf))return super.replace(e,t,n);[e,t]=clip(this,e,t);let i=appendText(this.text,appendText(n.text,sliceText(this.text,0,e)),t),r=this.length+n.length-(t-e);return i.length<=32?new TextLeaf(i,r):TextNode.from(TextLeaf.split(i,[]),r)}sliceString(e,t=this.length,n="\n"){[e,t]=clip(this,e,t);let i="";for(let r=0,s=0;r<=t&&s<this.text.length;s++){let o=this.text[s],a=r+o.length;r>e&&s&&(i+=n),e<a&&t>r&&(i+=o.slice(Math.max(0,e-r),t-r)),r=a+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let n=[],i=-1;for(let r of e)n.push(r),i+=r.length+1,32==n.length&&(t.push(new TextLeaf(n,i)),n=[],i=-1);return i>-1&&t.push(new TextLeaf(n,i)),t}}class TextNode extends Text{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let t of e)this.lines+=t.lines}lineInner(e,t,n,i){for(let r=0;;r++){let s=this.children[r],o=i+s.length,a=n+s.lines-1;if((t?a:o)>=e)return s.lineInner(e,t,n,i);i=o+1,n=a+1}}decompose(e,t,n,i){for(let r=0,s=0;s<=t&&r<this.children.length;r++){let o=this.children[r],a=s+o.length;if(e<=a&&t>=s){let r=i&((s<=e?1:0)|(a>=t?2:0));s>=e&&a<=t&&!r?n.push(o):o.decompose(e-s,t-s,n,r)}s=a+1}}replace(e,t,n){if([e,t]=clip(this,e,t),n.lines<this.lines)for(let i=0,r=0;i<this.children.length;i++){let s=this.children[i],o=r+s.length;if(e>=r&&t<=o){let a=s.replace(e-r,t-r,n),l=this.lines-s.lines+a.lines;if(a.lines<l>>4&&a.lines>l>>6){let r=this.children.slice();return r[i]=a,new TextNode(r,this.length-(t-e)+n.length)}return super.replace(r,o,a)}r=o+1}return super.replace(e,t,n)}sliceString(e,t=this.length,n="\n"){[e,t]=clip(this,e,t);let i="";for(let r=0,s=0;r<this.children.length&&s<=t;r++){let o=this.children[r],a=s+o.length;s>e&&r&&(i+=n),e<a&&t>s&&(i+=o.sliceString(e-s,t-s,n)),s=a+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof TextNode))return 0;let n=0,[i,r,s,o]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,r+=t){if(i==s||r==o)return n;let a=this.children[i],l=e.children[r];if(a!=l)return n+a.scanIdentical(l,t);n+=a.length+1}}static from(e,t=e.reduce(((e,t)=>e+t.length+1),-1)){let n=0;for(let t of e)n+=t.lines;if(n<32){let n=[];for(let t of e)t.flatten(n);return new TextLeaf(n,t)}let i=Math.max(32,n>>5),r=i<<1,s=i>>1,o=[],a=0,l=-1,c=[];function h(e){let t;if(e.lines>r&&e instanceof TextNode)for(let t of e.children)h(t);else e.lines>s&&(a>s||!a)?(d(),o.push(e)):e instanceof TextLeaf&&a&&(t=c[c.length-1])instanceof TextLeaf&&e.lines+t.lines<=32?(a+=e.lines,l+=e.length+1,c[c.length-1]=new TextLeaf(t.text.concat(e.text),t.length+1+e.length)):(a+e.lines>i&&d(),a+=e.lines,l+=e.length+1,c.push(e))}function d(){0!=a&&(o.push(1==c.length?c[0]:TextNode.from(c,l)),l=-1,a=c.length=0)}for(let t of e)h(t);return d(),1==o.length?o[0]:new TextNode(o,t)}}function textLength(e){let t=-1;for(let n of e)t+=n.length+1;return t}function appendText(e,t,n=0,i=1e9){for(let r=0,s=0,o=!0;s<e.length&&r<=i;s++){let a=e[s],l=r+a.length;l>=n&&(l>i&&(a=a.slice(0,i-r)),r<n&&(a=a.slice(n-r)),o?(t[t.length-1]+=a,o=!1):t.push(a)),r=l+1}return t}function sliceText(e,t,n){return appendText(e,[""],t,n)}Text.empty=new TextLeaf([""],0);class RawTextCursor{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof TextLeaf?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,i=this.nodes[n],r=this.offsets[n],s=r>>1,o=i instanceof TextLeaf?i.text.length:i.children.length;if(s==(t>0?o:0)){if(0==n)return this.done=!0,this.value="",this;t>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((1&r)==(t>0?0:1)){if(this.offsets[n]+=t,0==e)return this.lineBreak=!0,this.value="\n",this;e--}else if(i instanceof TextLeaf){let r=i.text[s+(t<0?-1:0)];if(this.offsets[n]+=t,r.length>Math.max(0,e))return this.value=0==e?r:t>0?r.slice(e):r.slice(0,r.length-e),this;e-=r.length}else{let r=i.children[s+(t<0?-1:0)];e>r.length?(e-=r.length,this.offsets[n]+=t):(t<0&&this.offsets[n]--,this.nodes.push(r),this.offsets.push(t>0?1:(r instanceof TextLeaf?r.text.length:r.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class PartialTextCursor{constructor(e,t,n){this.value="",this.done=!1,this.cursor=new RawTextCursor(e,t>n?-1:1),this.pos=t>n?e.length:0,this.from=Math.min(t,n),this.to=Math.max(t,n)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let n=t<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=n?i:t<0?i.slice(i.length-n):i.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&""!=this.value}}class LineCursor{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:n,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}"undefined"!=typeof Symbol&&(Text.prototype[Symbol.iterator]=function(){return this.iter()},RawTextCursor.prototype[Symbol.iterator]=PartialTextCursor.prototype[Symbol.iterator]=LineCursor.prototype[Symbol.iterator]=function(){return this});let Line$1=class{constructor(e,t,n,i){this.from=e,this.to=t,this.number=n,this.text=i}get length(){return this.to-this.from}};function clip(e,t,n){return[t=Math.max(0,Math.min(e.length,t)),Math.max(t,Math.min(e.length,n))]}let extend="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map((e=>e?parseInt(e,36):1));for(let e=1;e<extend.length;e++)extend[e]+=extend[e-1];function isExtendingChar(e){for(let t=1;t<extend.length;t+=2)if(extend[t]>e)return extend[t-1]<=e;return!1}function isRegionalIndicator(e){return e>=127462&&e<=127487}const ZWJ=8205;function findClusterBreak(e,t,n=!0,i=!0){return(n?nextClusterBreak:prevClusterBreak)(e,t,i)}function nextClusterBreak(e,t,n){if(t==e.length)return t;t&&surrogateLow(e.charCodeAt(t))&&surrogateHigh(e.charCodeAt(t-1))&&t--;let i=codePointAt(e,t);for(t+=codePointSize(i);t<e.length;){let r=codePointAt(e,t);if(i==ZWJ||r==ZWJ||n&&isExtendingChar(r))t+=codePointSize(r),i=r;else{if(!isRegionalIndicator(r))break;{let n=0,i=t-2;for(;i>=0&&isRegionalIndicator(codePointAt(e,i));)n++,i-=2;if(n%2==0)break;t+=2}}}return t}function prevClusterBreak(e,t,n){for(;t>0;){let i=nextClusterBreak(e,t-2,n);if(i<t)return i;t--}return 0}function surrogateLow(e){return e>=56320&&e<57344}function surrogateHigh(e){return e>=55296&&e<56320}function codePointAt(e,t){let n=e.charCodeAt(t);if(!surrogateHigh(n)||t+1==e.length)return n;let i=e.charCodeAt(t+1);return surrogateLow(i)?i-56320+(n-55296<<10)+65536:n}function fromCodePoint(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}function codePointSize(e){return e<65536?1:2}const DefaultSplit=/\r\n?|\n/;var MapMode=function(e){return e[e.Simple=0]="Simple",e[e.TrackDel=1]="TrackDel",e[e.TrackBefore=2]="TrackBefore",e[e.TrackAfter=3]="TrackAfter",e}(MapMode||(MapMode={}));class ChangeDesc{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t+1];e+=n<0?this.sections[t]:n}return e}get empty(){return 0==this.sections.length||2==this.sections.length&&this.sections[1]<0}iterGaps(e){for(let t=0,n=0,i=0;t<this.sections.length;){let r=this.sections[t++],s=this.sections[t++];s<0?(e(n,i,r),i+=r):i+=s,n+=r}}iterChangedRanges(e,t=!1){iterChanges(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];i<0?e.push(n,i):e.push(i,n)}return new ChangeDesc(e)}composeDesc(e){return this.empty?e:e.empty?this:composeSets(this,e)}mapDesc(e,t=!1){return e.empty?this:mapSet(this,e,t)}mapPos(e,t=-1,n=MapMode.Simple){let i=0,r=0;for(let s=0;s<this.sections.length;){let o=this.sections[s++],a=this.sections[s++],l=i+o;if(a<0){if(l>e)return r+(e-i);r+=o}else{if(n!=MapMode.Simple&&l>=e&&(n==MapMode.TrackDel&&i<e&&l>e||n==MapMode.TrackBefore&&i<e||n==MapMode.TrackAfter&&l>e))return null;if(l>e||l==e&&t<0&&!o)return e==i||t<0?r:r+a;r+=a}i=l}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return r}touchesRange(e,t=e){for(let n=0,i=0;n<this.sections.length&&i<=t;){let r=i+this.sections[n++];if(this.sections[n++]>=0&&i<=t&&r>=e)return!(i<e&&r>t)||"cover";i=r}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let n=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+n+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some((e=>"number"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeDesc");return new ChangeDesc(e)}static create(e){return new ChangeDesc(e)}}class ChangeSet extends ChangeDesc{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return iterChanges(this,((t,n,i,r,s)=>e=e.replace(i,i+(n-t),s)),!1),e}mapDesc(e,t=!1){return mapSet(this,e,t,!0)}invert(e){let t=this.sections.slice(),n=[];for(let i=0,r=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o>=0){t[i]=o,t[i+1]=s;let a=i>>1;for(;n.length<a;)n.push(Text.empty);n.push(s?e.slice(r,r+s):Text.empty)}r+=s}return new ChangeSet(t,n)}compose(e){return this.empty?e:e.empty?this:composeSets(this,e,!0)}map(e,t=!1){return e.empty?this:mapSet(this,e,t,!0)}iterChanges(e,t=!1){iterChanges(this,e,t)}get desc(){return ChangeDesc.create(this.sections)}filter(e){let t=[],n=[],i=[],r=new SectionIter(this);e:for(let s=0,o=0;;){let a=s==e.length?1e9:e[s++];for(;o<a||o==a&&0==r.len;){if(r.done)break e;let e=Math.min(r.len,a-o);addSection(i,e,-1);let s=-1==r.ins?-1:0==r.off?r.ins:0;addSection(t,e,s),s>0&&addInsert(n,t,r.text),r.forward(e),o+=e}let l=e[s++];for(;o<l;){if(r.done)break e;let e=Math.min(r.len,l-o);addSection(t,e,-1),addSection(i,e,-1==r.ins?-1:0==r.off?r.ins:0),r.forward(e),o+=e}}return{changes:new ChangeSet(t,n),filtered:ChangeDesc.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let n=this.sections[t],i=this.sections[t+1];i<0?e.push(n):0==i?e.push([n]):e.push([n].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,n){let i=[],r=[],s=0,o=null;function a(e=!1){if(!e&&!i.length)return;s<t&&addSection(i,t-s,-1);let n=new ChangeSet(i,r);o=o?o.compose(n.map(o)):n,i=[],r=[],s=0}return function e(l){if(Array.isArray(l))for(let t of l)e(t);else if(l instanceof ChangeSet){if(l.length!=t)throw new RangeError(`Mismatched change set length (got ${l.length}, expected ${t})`);a(),o=o?o.compose(l.map(o)):l}else{let{from:e,to:o=e,insert:c}=l;if(e>o||e<0||o>t)throw new RangeError(`Invalid change range ${e} to ${o} (in doc of length ${t})`);let h=c?"string"==typeof c?Text.of(c.split(n||DefaultSplit)):c:Text.empty,d=h.length;if(e==o&&0==d)return;e<s&&a(),e>s&&addSection(i,e-s,-1),addSection(i,o-e,d),addInsert(r,i,h),s=o}}(e),a(!o),o}static empty(e){return new ChangeSet(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],n=[];for(let i=0;i<e.length;i++){let r=e[i];if("number"==typeof r)t.push(r,-1);else{if(!Array.isArray(r)||"number"!=typeof r[0]||r.some(((e,t)=>t&&"string"!=typeof e)))throw new RangeError("Invalid JSON representation of ChangeSet");if(1==r.length)t.push(r[0],0);else{for(;n.length<i;)n.push(Text.empty);n[i]=Text.of(r.slice(1)),t.push(r[0],n[i].length)}}}return new ChangeSet(t,n)}static createSet(e,t){return new ChangeSet(e,t)}}function addSection(e,t,n,i=!1){if(0==t&&n<=0)return;let r=e.length-2;r>=0&&n<=0&&n==e[r+1]?e[r]+=t:0==t&&0==e[r]?e[r+1]+=n:i?(e[r]+=t,e[r+1]+=n):e.push(t,n)}function addInsert(e,t,n){if(0==n.length)return;let i=t.length-2>>1;if(i<e.length)e[e.length-1]=e[e.length-1].append(n);else{for(;e.length<i;)e.push(Text.empty);e.push(n)}}function iterChanges(e,t,n){let i=e.inserted;for(let r=0,s=0,o=0;o<e.sections.length;){let a=e.sections[o++],l=e.sections[o++];if(l<0)r+=a,s+=a;else{let c=r,h=s,d=Text.empty;for(;c+=a,h+=l,l&&i&&(d=d.append(i[o-2>>1])),!(n||o==e.sections.length||e.sections[o+1]<0);)a=e.sections[o++],l=e.sections[o++];t(r,c,s,h,d),r=c,s=h}}}function mapSet(e,t,n,i=!1){let r=[],s=i?[]:null,o=new SectionIter(e),a=new SectionIter(t);for(let e=-1;;)if(-1==o.ins&&-1==a.ins){let e=Math.min(o.len,a.len);addSection(r,e,-1),o.forward(e),a.forward(e)}else if(a.ins>=0&&(o.ins<0||e==o.i||0==o.off&&(a.len<o.len||a.len==o.len&&!n))){let t=a.len;for(addSection(r,a.ins,-1);t;){let n=Math.min(o.len,t);o.ins>=0&&e<o.i&&o.len<=n&&(addSection(r,0,o.ins),s&&addInsert(s,r,o.text),e=o.i),o.forward(n),t-=n}a.next()}else{if(!(o.ins>=0)){if(o.done&&a.done)return s?ChangeSet.createSet(r,s):ChangeDesc.create(r);throw new Error("Mismatched change set lengths")}{let t=0,n=o.len;for(;n;)if(-1==a.ins){let e=Math.min(n,a.len);t+=e,n-=e,a.forward(e)}else{if(!(0==a.ins&&a.len<n))break;n-=a.len,a.next()}addSection(r,t,e<o.i?o.ins:0),s&&e<o.i&&addInsert(s,r,o.text),e=o.i,o.forward(o.len-n)}}}function composeSets(e,t,n=!1){let i=[],r=n?[]:null,s=new SectionIter(e),o=new SectionIter(t);for(let e=!1;;){if(s.done&&o.done)return r?ChangeSet.createSet(i,r):ChangeDesc.create(i);if(0==s.ins)addSection(i,s.len,0,e),s.next();else if(0!=o.len||o.done){if(s.done||o.done)throw new Error("Mismatched change set lengths");{let t=Math.min(s.len2,o.len),n=i.length;if(-1==s.ins){let n=-1==o.ins?-1:o.off?0:o.ins;addSection(i,t,n,e),r&&n&&addInsert(r,i,o.text)}else-1==o.ins?(addSection(i,s.off?0:s.len,t,e),r&&addInsert(r,i,s.textBit(t))):(addSection(i,s.off?0:s.len,o.off?0:o.ins,e),r&&!o.off&&addInsert(r,i,o.text));e=(s.ins>t||o.ins>=0&&o.len>t)&&(e||i.length>n),s.forward2(t),o.forward(t)}}else addSection(i,0,o.ins,e),r&&addInsert(r,i,o.text),o.next()}}class SectionIter{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return-2==this.ins}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Text.empty:e[t]}textBit(e){let{inserted:t}=this.set,n=this.i-2>>1;return n>=t.length&&!e?Text.empty:t[n].slice(this.off,null==e?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){-1==this.ins?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class SelectionRange{constructor(e,t,n){this.from=e,this.to=t,this.flags=n}get anchor(){return 32&this.flags?this.to:this.from}get head(){return 32&this.flags?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return 8&this.flags?-1:16&this.flags?1:0}get bidiLevel(){let e=7&this.flags;return 7==e?null:e}get goalColumn(){let e=this.flags>>6;return 16777215==e?void 0:e}map(e,t=-1){let n,i;return this.empty?n=i=e.mapPos(this.from,t):(n=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),n==this.from&&i==this.to?this:new SelectionRange(n,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return EditorSelection.range(e,t);let n=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return EditorSelection.range(this.anchor,n)}eq(e,t=!1){return!(this.anchor!=e.anchor||this.head!=e.head||t&&this.empty&&this.assoc!=e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||"number"!=typeof e.anchor||"number"!=typeof e.head)throw new RangeError("Invalid JSON representation for SelectionRange");return EditorSelection.range(e.anchor,e.head)}static create(e,t,n){return new SelectionRange(e,t,n)}}class EditorSelection{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:EditorSelection.create(this.ranges.map((n=>n.map(e,t))),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return 1==this.ranges.length?this:new EditorSelection([this.main],0)}addRange(e,t=!0){return EditorSelection.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let n=this.ranges.slice();return n[t]=e,EditorSelection.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map((e=>e.toJSON())),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||"number"!=typeof e.main||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new EditorSelection(e.ranges.map((e=>SelectionRange.fromJSON(e))),e.main)}static single(e,t=e){return new EditorSelection([EditorSelection.range(e,t)],0)}static create(e,t=0){if(0==e.length)throw new RangeError("A selection needs at least one range");for(let n=0,i=0;i<e.length;i++){let r=e[i];if(r.empty?r.from<=n:r.from<n)return EditorSelection.normalized(e.slice(),t);n=r.to}return new EditorSelection(e,t)}static cursor(e,t=0,n,i){return SelectionRange.create(e,e,(0==t?0:t<0?8:16)|(null==n?7:Math.min(6,n))|(null!=i?i:16777215)<<6)}static range(e,t,n,i){let r=(null!=n?n:16777215)<<6|(null==i?7:Math.min(6,i));return t<e?SelectionRange.create(t,e,48|r):SelectionRange.create(e,t,(t>e?8:0)|r)}static normalized(e,t=0){let n=e[t];e.sort(((e,t)=>e.from-t.from)),t=e.indexOf(n);for(let n=1;n<e.length;n++){let i=e[n],r=e[n-1];if(i.empty?i.from<=r.to:i.from<r.to){let s=r.from,o=Math.max(i.to,r.to);n<=t&&t--,e.splice(--n,2,i.anchor>i.head?EditorSelection.range(o,s):EditorSelection.range(s,o))}}return new EditorSelection(e,t)}}function checkSelection(e,t){for(let n of e.ranges)if(n.to>t)throw new RangeError("Selection points outside of document")}let nextID=0;class Facet{constructor(e,t,n,i,r){this.combine=e,this.compareInput=t,this.compare=n,this.isStatic=i,this.id=nextID++,this.default=e([]),this.extensions="function"==typeof r?r(this):r}get reader(){return this}static define(e={}){return new Facet(e.combine||(e=>e),e.compareInput||((e,t)=>e===t),e.compare||(e.combine?(e,t)=>e===t:sameArray$1),!!e.static,e.enables)}of(e){return new FacetProvider([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new FacetProvider(e,this,2,t)}from(e,t){return t||(t=e=>e),this.compute([e],(n=>t(n.field(e))))}}function sameArray$1(e,t){return e==t||e.length==t.length&&e.every(((e,n)=>e===t[n]))}class FacetProvider{constructor(e,t,n,i){this.dependencies=e,this.facet=t,this.type=n,this.value=i,this.id=nextID++}dynamicSlot(e){var t;let n=this.value,i=this.facet.compareInput,r=this.id,s=e[r]>>1,o=2==this.type,a=!1,l=!1,c=[];for(let n of this.dependencies)"doc"==n?a=!0:"selection"==n?l=!0:0==(1&(null!==(t=e[n.id])&&void 0!==t?t:1))&&c.push(e[n.id]);return{create:e=>(e.values[s]=n(e),1),update(e,t){if(a&&t.docChanged||l&&(t.docChanged||t.selection)||ensureAll(e,c)){let t=n(e);if(o?!compareArray(t,e.values[s],i):!i(t,e.values[s]))return e.values[s]=t,1}return 0},reconfigure:(e,t)=>{let a,l=t.config.address[r];if(null!=l){let r=getAddr(t,l);if(this.dependencies.every((n=>n instanceof Facet?t.facet(n)===e.facet(n):!(n instanceof StateField)||t.field(n,!1)==e.field(n,!1)))||(o?compareArray(a=n(e),r,i):i(a=n(e),r)))return e.values[s]=r,0}else a=n(e);return e.values[s]=a,1}}}}function compareArray(e,t,n){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!n(e[i],t[i]))return!1;return!0}function ensureAll(e,t){let n=!1;for(let i of t)1&ensureAddr(e,i)&&(n=!0);return n}function dynamicFacetSlot(e,t,n){let i=n.map((t=>e[t.id])),r=n.map((e=>e.type)),s=i.filter((e=>!(1&e))),o=e[t.id]>>1;function a(e){let n=[];for(let t=0;t<i.length;t++){let s=getAddr(e,i[t]);if(2==r[t])for(let e of s)n.push(e);else n.push(s)}return t.combine(n)}return{create(e){for(let t of i)ensureAddr(e,t);return e.values[o]=a(e),1},update(e,n){if(!ensureAll(e,s))return 0;let i=a(e);return t.compare(i,e.values[o])?0:(e.values[o]=i,1)},reconfigure(e,r){let s=ensureAll(e,i),l=r.config.facets[t.id],c=r.facet(t);if(l&&!s&&sameArray$1(n,l))return e.values[o]=c,0;let h=a(e);return t.compare(h,c)?(e.values[o]=c,0):(e.values[o]=h,1)}}}const initField=Facet.define({static:!0});class StateField{constructor(e,t,n,i,r){this.id=e,this.createF=t,this.updateF=n,this.compareF=i,this.spec=r,this.provides=void 0}static define(e){let t=new StateField(nextID++,e.create,e.update,e.compare||((e,t)=>e===t),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(initField).find((e=>e.field==this));return((null==t?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:e=>(e.values[t]=this.create(e),1),update:(e,n)=>{let i=e.values[t],r=this.updateF(i,n);return this.compareF(i,r)?0:(e.values[t]=r,1)},reconfigure:(e,n)=>null!=n.config.address[this.id]?(e.values[t]=n.field(this),0):(e.values[t]=this.create(e),1)}}init(e){return[this,initField.of({field:this,create:e})]}get extension(){return this}}const Prec_={lowest:4,low:3,default:2,high:1,highest:0};function prec(e){return t=>new PrecExtension(t,e)}const Prec={highest:prec(Prec_.highest),high:prec(Prec_.high),default:prec(Prec_.default),low:prec(Prec_.low),lowest:prec(Prec_.lowest)};class PrecExtension{constructor(e,t){this.inner=e,this.prec=t}}class Compartment{of(e){return new CompartmentInstance(this,e)}reconfigure(e){return Compartment.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class CompartmentInstance{constructor(e,t){this.compartment=e,this.inner=t}}class Configuration{constructor(e,t,n,i,r,s){for(this.base=e,this.compartments=t,this.dynamicSlots=n,this.address=i,this.staticValues=r,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return null==t?e.default:this.staticValues[t>>1]}static resolve(e,t,n){let i=[],r=Object.create(null),s=new Map;for(let n of flatten$1(e,t,s))n instanceof StateField?i.push(n):(r[n.facet.id]||(r[n.facet.id]=[])).push(n);let o=Object.create(null),a=[],l=[];for(let e of i)o[e.id]=l.length<<1,l.push((t=>e.slot(t)));let c=null==n?void 0:n.config.facets;for(let e in r){let t=r[e],i=t[0].facet,s=c&&c[e]||[];if(t.every((e=>0==e.type)))if(o[i.id]=a.length<<1|1,sameArray$1(s,t))a.push(n.facet(i));else{let e=i.combine(t.map((e=>e.value)));a.push(n&&i.compare(e,n.facet(i))?n.facet(i):e)}else{for(let e of t)0==e.type?(o[e.id]=a.length<<1|1,a.push(e.value)):(o[e.id]=l.length<<1,l.push((t=>e.dynamicSlot(t))));o[i.id]=l.length<<1,l.push((e=>dynamicFacetSlot(e,i,t)))}}let h=l.map((e=>e(o)));return new Configuration(e,s,h,o,a,r)}}function flatten$1(e,t,n){let i=[[],[],[],[],[]],r=new Map;return function e(s,o){let a=r.get(s);if(null!=a){if(a<=o)return;let e=i[a].indexOf(s);e>-1&&i[a].splice(e,1),s instanceof CompartmentInstance&&n.delete(s.compartment)}if(r.set(s,o),Array.isArray(s))for(let t of s)e(t,o);else if(s instanceof CompartmentInstance){if(n.has(s.compartment))throw new RangeError("Duplicate use of compartment in extensions");let i=t.get(s.compartment)||s.inner;n.set(s.compartment,i),e(i,o)}else if(s instanceof PrecExtension)e(s.inner,s.prec);else if(s instanceof StateField)i[o].push(s),s.provides&&e(s.provides,o);else if(s instanceof FacetProvider)i[o].push(s),s.facet.extensions&&e(s.facet.extensions,Prec_.default);else{let t=s.extension;if(!t)throw new Error(`Unrecognized extension value in extension set (${s}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);e(t,o)}}(e,Prec_.default),i.reduce(((e,t)=>e.concat(t)))}function ensureAddr(e,t){if(1&t)return 2;let n=t>>1,i=e.status[n];if(4==i)throw new Error("Cyclic dependency between fields and/or facets");if(2&i)return i;e.status[n]=4;let r=e.computeSlot(e,e.config.dynamicSlots[n]);return e.status[n]=2|r}function getAddr(e,t){return 1&t?e.config.staticValues[t>>1]:e.values[t>>1]}const languageData=Facet.define(),allowMultipleSelections=Facet.define({combine:e=>e.some((e=>e)),static:!0}),lineSeparator=Facet.define({combine:e=>e.length?e[0]:void 0,static:!0}),changeFilter=Facet.define(),transactionFilter=Facet.define(),transactionExtender=Facet.define(),readOnly=Facet.define({combine:e=>!!e.length&&e[0]});class Annotation{constructor(e,t){this.type=e,this.value=t}static define(){return new AnnotationType}}class AnnotationType{of(e){return new Annotation(this,e)}}class StateEffectType{constructor(e){this.map=e}of(e){return new StateEffect(this,e)}}class StateEffect{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return void 0===t?void 0:t==this.value?this:new StateEffect(this.type,t)}is(e){return this.type==e}static define(e={}){return new StateEffectType(e.map||(e=>e))}static mapEffects(e,t){if(!e.length)return e;let n=[];for(let i of e){let e=i.map(t);e&&n.push(e)}return n}}StateEffect.reconfigure=StateEffect.define(),StateEffect.appendConfig=StateEffect.define();class Transaction{constructor(e,t,n,i,r,s){this.startState=e,this.changes=t,this.selection=n,this.effects=i,this.annotations=r,this.scrollIntoView=s,this._doc=null,this._state=null,n&&checkSelection(n,t.newLength),r.some((e=>e.type==Transaction.time))||(this.annotations=r.concat(Transaction.time.of(Date.now())))}static create(e,t,n,i,r,s){return new Transaction(e,t,n,i,r,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(Transaction.userEvent);return!(!t||!(t==e||t.length>e.length&&t.slice(0,e.length)==e&&"."==t[e.length]))}}function joinRanges(e,t){let n=[];for(let i=0,r=0;;){let s,o;if(i<e.length&&(r==t.length||t[r]>=e[i]))s=e[i++],o=e[i++];else{if(!(r<t.length))return n;s=t[r++],o=t[r++]}!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function mergeTransaction(e,t,n){var i;let r,s,o;return n?(r=t.changes,s=ChangeSet.empty(t.changes.length),o=e.changes.compose(t.changes)):(r=t.changes.map(e.changes),s=e.changes.mapDesc(t.changes,!0),o=e.changes.compose(r)),{changes:o,selection:t.selection?t.selection.map(s):null===(i=e.selection)||void 0===i?void 0:i.map(r),effects:StateEffect.mapEffects(e.effects,r).concat(StateEffect.mapEffects(t.effects,s)),annotations:e.annotations.length?e.annotations.concat(t.annotations):t.annotations,scrollIntoView:e.scrollIntoView||t.scrollIntoView}}function resolveTransactionInner(e,t,n){let i=t.selection,r=asArray$1(t.annotations);return t.userEvent&&(r=r.concat(Transaction.userEvent.of(t.userEvent))),{changes:t.changes instanceof ChangeSet?t.changes:ChangeSet.of(t.changes||[],n,e.facet(lineSeparator)),selection:i&&(i instanceof EditorSelection?i:EditorSelection.single(i.anchor,i.head)),effects:asArray$1(t.effects),annotations:r,scrollIntoView:!!t.scrollIntoView}}function resolveTransaction(e,t,n){let i=resolveTransactionInner(e,t.length?t[0]:{},e.doc.length);t.length&&!1===t[0].filter&&(n=!1);for(let r=1;r<t.length;r++){!1===t[r].filter&&(n=!1);let s=!!t[r].sequential;i=mergeTransaction(i,resolveTransactionInner(e,t[r],s?i.changes.newLength:e.doc.length),s)}let r=Transaction.create(e,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return extendTransaction(n?filterTransaction(r):r)}function filterTransaction(e){let t=e.startState,n=!0;for(let i of t.facet(changeFilter)){let t=i(e);if(!1===t){n=!1;break}Array.isArray(t)&&(n=!0===n?t:joinRanges(n,t))}if(!0!==n){let i,r;if(!1===n)r=e.changes.invertedDesc,i=ChangeSet.empty(t.doc.length);else{let t=e.changes.filter(n);i=t.changes,r=t.filtered.mapDesc(t.changes).invertedDesc}e=Transaction.create(t,i,e.selection&&e.selection.map(r),StateEffect.mapEffects(e.effects,r),e.annotations,e.scrollIntoView)}let i=t.facet(transactionFilter);for(let n=i.length-1;n>=0;n--){let r=i[n](e);e=r instanceof Transaction?r:Array.isArray(r)&&1==r.length&&r[0]instanceof Transaction?r[0]:resolveTransaction(t,asArray$1(r),!1)}return e}function extendTransaction(e){let t=e.startState,n=t.facet(transactionExtender),i=e;for(let r=n.length-1;r>=0;r--){let s=n[r](e);s&&Object.keys(s).length&&(i=mergeTransaction(i,resolveTransactionInner(t,s,e.changes.newLength),!0))}return i==e?e:Transaction.create(t,e.changes,e.selection,i.effects,i.annotations,i.scrollIntoView)}Transaction.time=Annotation.define(),Transaction.userEvent=Annotation.define(),Transaction.addToHistory=Annotation.define(),Transaction.remote=Annotation.define();const none$3=[];function asArray$1(e){return null==e?none$3:Array.isArray(e)?e:[e]}var CharCategory=function(e){return e[e.Word=0]="Word",e[e.Space=1]="Space",e[e.Other=2]="Other",e}(CharCategory||(CharCategory={}));const nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let wordChar;try{wordChar=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch(e){}function hasWordChar(e){if(wordChar)return wordChar.test(e);for(let t=0;t<e.length;t++){let n=e[t];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||nonASCIISingleCaseWordChar.test(n)))return!0}return!1}function makeCategorizer(e){return t=>{if(!/\S/.test(t))return CharCategory.Space;if(hasWordChar(t))return CharCategory.Word;for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return CharCategory.Word;return CharCategory.Other}}class EditorState{constructor(e,t,n,i,r,s){this.config=e,this.doc=t,this.selection=n,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=r,s&&(s._state=this);for(let e=0;e<this.config.dynamicSlots.length;e++)ensureAddr(this,e<<1);this.computeSlot=null}field(e,t=!0){let n=this.config.address[e.id];if(null!=n)return ensureAddr(this,n),getAddr(this,n);if(t)throw new RangeError("Field is not present in this state")}update(...e){return resolveTransaction(this,e,!0)}applyTransaction(e){let t,n=this.config,{base:i,compartments:r}=n;for(let t of e.effects)t.is(Compartment.reconfigure)?(n&&(r=new Map,n.compartments.forEach(((e,t)=>r.set(t,e))),n=null),r.set(t.value.compartment,t.value.extension)):t.is(StateEffect.reconfigure)?(n=null,i=t.value):t.is(StateEffect.appendConfig)&&(n=null,i=asArray$1(i).concat(t.value));if(n)t=e.startState.values.slice();else{n=Configuration.resolve(i,r,this),t=new EditorState(n,this.doc,this.selection,n.dynamicSlots.map((()=>null)),((e,t)=>t.reconfigure(e,this)),null).values}let s=e.startState.facet(allowMultipleSelections)?e.newSelection:e.newSelection.asSingle();new EditorState(n,e.newDoc,s,t,((t,n)=>n.update(t,e)),e)}replaceSelection(e){return"string"==typeof e&&(e=this.toText(e)),this.changeByRange((t=>({changes:{from:t.from,to:t.to,insert:e},range:EditorSelection.cursor(t.from+e.length)})))}changeByRange(e){let t=this.selection,n=e(t.ranges[0]),i=this.changes(n.changes),r=[n.range],s=asArray$1(n.effects);for(let n=1;n<t.ranges.length;n++){let o=e(t.ranges[n]),a=this.changes(o.changes),l=a.map(i);for(let e=0;e<n;e++)r[e]=r[e].map(l);let c=i.mapDesc(a,!0);r.push(o.range.map(c)),i=i.compose(l),s=StateEffect.mapEffects(s,l).concat(StateEffect.mapEffects(asArray$1(o.effects),c))}return{changes:i,selection:EditorSelection.create(r,t.mainIndex),effects:s}}changes(e=[]){return e instanceof ChangeSet?e:ChangeSet.of(e,this.doc.length,this.facet(EditorState.lineSeparator))}toText(e){return Text.of(e.split(this.facet(EditorState.lineSeparator)||DefaultSplit))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return null==t?e.default:(ensureAddr(this,t),getAddr(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let i=e[n];i instanceof StateField&&null!=this.config.address[i.id]&&(t[n]=i.spec.toJSON(this.field(e[n]),this))}return t}static fromJSON(e,t={},n){if(!e||"string"!=typeof e.doc)throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(n)for(let t in n)if(Object.prototype.hasOwnProperty.call(e,t)){let r=n[t],s=e[t];i.push(r.init((e=>r.spec.fromJSON(s,e))))}return EditorState.create({doc:e.doc,selection:EditorSelection.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=Configuration.resolve(e.extensions||[],new Map),n=e.doc instanceof Text?e.doc:Text.of((e.doc||"").split(t.staticFacet(EditorState.lineSeparator)||DefaultSplit)),i=e.selection?e.selection instanceof EditorSelection?e.selection:EditorSelection.single(e.selection.anchor,e.selection.head):EditorSelection.single(0);return checkSelection(i,n.length),t.staticFacet(allowMultipleSelections)||(i=i.asSingle()),new EditorState(t,n,i,t.dynamicSlots.map((()=>null)),((e,t)=>t.create(e)),null)}get tabSize(){return this.facet(EditorState.tabSize)}get lineBreak(){return this.facet(EditorState.lineSeparator)||"\n"}get readOnly(){return this.facet(readOnly)}phrase(e,...t){for(let t of this.facet(EditorState.phrases))if(Object.prototype.hasOwnProperty.call(t,e)){e=t[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,((e,n)=>{if("$"==n)return"$";let i=+(n||1);return!i||i>t.length?e:t[i-1]}))),e}languageDataAt(e,t,n=-1){let i=[];for(let r of this.facet(languageData))for(let s of r(this,t,n))Object.prototype.hasOwnProperty.call(s,e)&&i.push(s[e]);return i}charCategorizer(e){return makeCategorizer(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:n,length:i}=this.doc.lineAt(e),r=this.charCategorizer(e),s=e-n,o=e-n;for(;s>0;){let e=findClusterBreak(t,s,!1);if(r(t.slice(e,s))!=CharCategory.Word)break;s=e}for(;o<i;){let e=findClusterBreak(t,o);if(r(t.slice(o,e))!=CharCategory.Word)break;o=e}return s==o?null:EditorSelection.range(s+n,o+n)}}function combineConfig(e,t,n={}){let i={};for(let t of e)for(let e of Object.keys(t)){let r=t[e],s=i[e];if(void 0===s)i[e]=r;else if(s===r||void 0===r);else{if(!Object.hasOwnProperty.call(n,e))throw new Error("Config merge conflict for field "+e);i[e]=n[e](s,r)}}for(let e in t)void 0===i[e]&&(i[e]=t[e]);return i}EditorState.allowMultipleSelections=allowMultipleSelections,EditorState.tabSize=Facet.define({combine:e=>e.length?e[0]:4}),EditorState.lineSeparator=lineSeparator,EditorState.readOnly=readOnly,EditorState.phrases=Facet.define({compare(e,t){let n=Object.keys(e),i=Object.keys(t);return n.length==i.length&&n.every((n=>e[n]==t[n]))}}),EditorState.languageData=languageData,EditorState.changeFilter=changeFilter,EditorState.transactionFilter=transactionFilter,EditorState.transactionExtender=transactionExtender,Compartment.reconfigure=StateEffect.define();class RangeValue{eq(e){return this==e}range(e,t=e){return Range$1.create(e,t,this)}}RangeValue.prototype.startSide=RangeValue.prototype.endSide=0,RangeValue.prototype.point=!1,RangeValue.prototype.mapMode=MapMode.TrackDel;let Range$1=class e{constructor(e,t,n){this.from=e,this.to=t,this.value=n}static create(t,n,i){return new e(t,n,i)}};function cmpRange(e,t){return e.from-t.from||e.value.startSide-t.value.startSide}class Chunk{constructor(e,t,n,i){this.from=e,this.to=t,this.value=n,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,n,i=0){let r=n?this.to:this.from;for(let s=i,o=r.length;;){if(s==o)return s;let i=s+o>>1,a=r[i]-e||(n?this.value[i].endSide:this.value[i].startSide)-t;if(i==s)return a>=0?s:o;a>=0?o=i:s=i+1}}between(e,t,n,i){for(let r=this.findIndex(t,-1e9,!0),s=this.findIndex(n,1e9,!1,r);r<s;r++)if(!1===i(this.from[r]+e,this.to[r]+e,this.value[r]))return!1}map(e,t){let n=[],i=[],r=[],s=-1,o=-1;for(let a=0;a<this.value.length;a++){let l,c,h=this.value[a],d=this.from[a]+e,u=this.to[a]+e;if(d==u){let e=t.mapPos(d,h.startSide,h.mapMode);if(null==e)continue;if(l=c=e,h.startSide!=h.endSide&&(c=t.mapPos(d,h.endSide),c<l))continue}else if(l=t.mapPos(d,h.startSide),c=t.mapPos(u,h.endSide),l>c||l==c&&h.startSide>0&&h.endSide<=0)continue;(c-l||h.endSide-h.startSide)<0||(s<0&&(s=l),h.point&&(o=Math.max(o,c-l)),n.push(h),i.push(l-s),r.push(c-s))}return{mapped:n.length?new Chunk(i,r,n,o):null,pos:s}}}class RangeSet{constructor(e,t,n,i){this.chunkPos=e,this.chunk=t,this.nextLayer=n,this.maxPoint=i}static create(e,t,n,i){return new RangeSet(e,t,n,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:n=!1,filterFrom:i=0,filterTo:r=this.length}=e,s=e.filter;if(0==t.length&&!s)return this;if(n&&(t=t.slice().sort(cmpRange)),this.isEmpty)return t.length?RangeSet.of(t):this;let o=new LayerCursor(this,null,-1).goto(0),a=0,l=[],c=new RangeSetBuilder;for(;o.value||a<t.length;)if(a<t.length&&(o.from-t[a].from||o.startSide-t[a].value.startSide)>=0){let e=t[a++];c.addInner(e.from,e.to,e.value)||l.push(e)}else 1==o.rangeIndex&&o.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(o.chunkIndex)<t[a].from)&&(!s||i>this.chunkEnd(o.chunkIndex)||r<this.chunkPos[o.chunkIndex])&&c.addChunk(this.chunkPos[o.chunkIndex],this.chunk[o.chunkIndex])?o.nextChunk():((!s||i>o.to||r<o.from||s(o.from,o.to,o.value))&&(c.addInner(o.from,o.to,o.value)||l.push(Range$1.create(o.from,o.to,o.value))),o.next());return c.finishInner(this.nextLayer.isEmpty&&!l.length?RangeSet.empty:this.nextLayer.update({add:l,filter:s,filterFrom:i,filterTo:r}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],n=[],i=-1;for(let r=0;r<this.chunk.length;r++){let s=this.chunkPos[r],o=this.chunk[r],a=e.touchesRange(s,s+o.length);if(!1===a)i=Math.max(i,o.maxPoint),t.push(o),n.push(e.mapPos(s));else if(!0===a){let{mapped:r,pos:a}=o.map(s,e);r&&(i=Math.max(i,r.maxPoint),t.push(r),n.push(a))}}let r=this.nextLayer.map(e);return 0==t.length?r:new RangeSet(n,t,r||RangeSet.empty,i)}between(e,t,n){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let r=this.chunkPos[i],s=this.chunk[i];if(t>=r&&e<=r+s.length&&!1===s.between(r,e-r,t-r,n))return}this.nextLayer.between(e,t,n)}}iter(e=0){return HeapCursor.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return HeapCursor.from(e).goto(t)}static compare(e,t,n,i,r=-1){let s=e.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r)),o=t.filter((e=>e.maxPoint>0||!e.isEmpty&&e.maxPoint>=r)),a=findSharedChunks(s,o,n),l=new SpanCursor(s,a,r),c=new SpanCursor(o,a,r);n.iterGaps(((e,t,n)=>compare(l,e,c,t,n,i))),n.empty&&0==n.length&&compare(l,0,c,0,0,i)}static eq(e,t,n=0,i){null==i&&(i=999999999);let r=e.filter((e=>!e.isEmpty&&t.indexOf(e)<0)),s=t.filter((t=>!t.isEmpty&&e.indexOf(t)<0));if(r.length!=s.length)return!1;if(!r.length)return!0;let o=findSharedChunks(r,s),a=new SpanCursor(r,o,0).goto(n),l=new SpanCursor(s,o,0).goto(n);for(;;){if(a.to!=l.to||!sameValues(a.active,l.active)||a.point&&(!l.point||!a.point.eq(l.point)))return!1;if(a.to>i)return!0;a.next(),l.next()}}static spans(e,t,n,i,r=-1){let s=new SpanCursor(e,null,r).goto(t),o=t,a=s.openStart;for(;;){let e=Math.min(s.to,n);if(s.point){let n=s.activeForPoint(s.to),r=s.pointFrom<t?n.length+1:Math.min(n.length,a);i.point(o,e,s.point,n,r,s.pointRank),a=Math.min(s.openEnd(e),n.length)}else e>o&&(i.span(o,e,s.active,a),a=s.openEnd(e));if(s.to>n)return a+(s.point&&s.to>n?1:0);o=s.to,s.next()}}static of(e,t=!1){let n=new RangeSetBuilder;for(let i of e instanceof Range$1?[e]:t?lazySort(e):e)n.add(i.from,i.to,i.value);return n.finish()}static join(e){if(!e.length)return RangeSet.empty;let t=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let i=e[n];i!=RangeSet.empty;i=i.nextLayer)t=new RangeSet(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}function lazySort(e){if(e.length>1)for(let t=e[0],n=1;n<e.length;n++){let i=e[n];if(cmpRange(t,i)>0)return e.slice().sort(cmpRange);t=i}return e}RangeSet.empty=new RangeSet([],[],null,-1),RangeSet.empty.nextLayer=RangeSet.empty;class RangeSetBuilder{finishChunk(e){this.chunks.push(new Chunk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,n){this.addInner(e,t,n)||(this.nextLayer||(this.nextLayer=new RangeSetBuilder)).add(e,t,n)}addInner(e,t,n){let i=e-this.lastTo||n.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return!(i<0)&&(250==this.from.length&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=t,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let n=t.value.length-1;return this.last=t.value[n],this.lastFrom=t.from[n]+e,this.lastTo=t.to[n]+e,!0}finish(){return this.finishInner(RangeSet.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),0==this.chunks.length)return e;let t=RangeSet.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function findSharedChunks(e,t,n){let i=new Map;for(let t of e)for(let e=0;e<t.chunk.length;e++)t.chunk[e].maxPoint<=0&&i.set(t.chunk[e],t.chunkPos[e]);let r=new Set;for(let e of t)for(let t=0;t<e.chunk.length;t++){let s=i.get(e.chunk[t]);null==s||(n?n.mapPos(s):s)!=e.chunkPos[t]||(null==n?void 0:n.touchesRange(s,s+e.chunk[t].length))||r.add(e.chunk[t])}return r}class LayerCursor{constructor(e,t,n,i=0){this.layer=e,this.skip=t,this.minPoint=n,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,n){for(;this.chunkIndex<this.layer.chunk.length;){let t=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(t)||this.layer.chunkEnd(this.chunkIndex)<e||t.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!n||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;){if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],n=e+t.from[this.rangeIndex];if(this.from=n,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class HeapCursor{constructor(e){this.heap=e}static from(e,t=null,n=-1){let i=[];for(let r=0;r<e.length;r++)for(let s=e[r];!s.isEmpty;s=s.nextLayer)s.maxPoint>=n&&i.push(new LayerCursor(s,t,n,r));return 1==i.length?i[0]:new HeapCursor(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let n of this.heap)n.goto(e,t);for(let e=this.heap.length>>1;e>=0;e--)heapBubble(this.heap,e);return this.next(),this}forward(e,t){for(let n of this.heap)n.forward(e,t);for(let e=this.heap.length>>1;e>=0;e--)heapBubble(this.heap,e);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(0==this.heap.length)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),heapBubble(this.heap,0)}}}function heapBubble(e,t){for(let n=e[t];;){let i=1+(t<<1);if(i>=e.length)break;let r=e[i];if(i+1<e.length&&r.compare(e[i+1])>=0&&(r=e[i+1],i++),n.compare(r)<0)break;e[i]=n,e[t]=r,t=i}}class SpanCursor{constructor(e,t,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=HeapCursor.from(e,t,n)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){remove(this.active,e),remove(this.activeTo,e),remove(this.activeRank,e),this.minActive=findMinIndex(this.active,this.activeTo)}addActive(e){let t=0,{value:n,to:i,rank:r}=this.cursor;for(;t<this.activeRank.length&&(r-this.activeRank[t]||i-this.activeTo[t])>0;)t++;insert(this.active,t,n),insert(this.activeTo,t,i),insert(this.activeRank,t,r),e&&insert(e,t,this.cursor.from),this.minActive=findMinIndex(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),n&&remove(n,i)}else{if(!this.cursor.value){this.to=this.endSide=1e9;break}if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}{let e=this.cursor.value;if(e.point){if(!(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)){this.point=e,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=e.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}this.cursor.next()}else this.addActive(n),this.cursor.next()}}}if(n){this.openStart=0;for(let t=n.length-1;t>=0&&n[t]<e;t--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&t.push(this.active[n]);return t.reverse()}openEnd(e){let t=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)t++;return t}}function compare(e,t,n,i,r,s){e.goto(t),n.goto(i);let o=i+r,a=i,l=i-t;for(;;){let t=e.to+l-n.to||e.endSide-n.endSide,i=t<0?e.to+l:n.to,r=Math.min(i,o);if(e.point||n.point?e.point&&n.point&&(e.point==n.point||e.point.eq(n.point))&&sameValues(e.activeForPoint(e.to),n.activeForPoint(n.to))||s.comparePoint(a,r,e.point,n.point):r>a&&!sameValues(e.active,n.active)&&s.compareRange(a,r,e.active,n.active),i>o)break;a=i,t<=0&&e.next(),t>=0&&n.next()}}function sameValues(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n]&&!e[n].eq(t[n]))return!1;return!0}function remove(e,t){for(let n=t,i=e.length-1;n<i;n++)e[n]=e[n+1];e.pop()}function insert(e,t,n){for(let n=e.length-1;n>=t;n--)e[n+1]=e[n];e[t]=n}function findMinIndex(e,t){let n=-1,i=1e9;for(let r=0;r<t.length;r++)(t[r]-i||e[r].endSide-e[n].endSide)<0&&(n=r,i=t[r]);return n}function countColumn(e,t,n=e.length){let i=0;for(let r=0;r<n;)9==e.charCodeAt(r)?(i+=t-i%t,r++):(i++,r=findClusterBreak(e,r));return i}function findColumn(e,t,n,i){for(let i=0,r=0;;){if(r>=t)return i;if(i==e.length)break;r+=9==e.charCodeAt(i)?n-r%n:1,i=findClusterBreak(e,i)}return!0===i?-1:e.length}const C="",COUNT="undefined"==typeof Symbol?"__"+C:Symbol.for(C),SET="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),top="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class StyleModule{constructor(e,t){this.rules=[];let{finish:n}=t||{};function i(e){return/^@/.test(e)?[e]:e.split(/,\s*/)}function r(e,t,s,o){let a=[],l=/^@(\w+)\b/.exec(e[0]),c=l&&"keyframes"==l[1];if(l&&null==t)return s.push(e[0]+";");for(let n in t){let o=t[n];if(/&/.test(n))r(n.split(/,\s*/).map((t=>e.map((e=>t.replace(/&/,e))))).reduce(((e,t)=>e.concat(t))),o,s);else if(o&&"object"==typeof o){if(!l)throw new RangeError("The value of a property ("+n+") should be a primitive value.");r(i(n),o,a,c)}else null!=o&&a.push(n.replace(/_.*/,"").replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))+": "+o+";")}(a.length||c)&&s.push((!n||l||o?e:e.map(n)).join(", ")+" {"+a.join(" ")+"}")}for(let t in e)r(i(t),e[t],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let e=top[COUNT]||1;return top[COUNT]=e+1,C+e.toString(36)}static mount(e,t,n){let i=e[SET],r=n&&n.nonce;i?r&&i.setNonce(r):i=new StyleSet(e,r),i.mount(Array.isArray(t)?t:[t])}}let adoptedSet=new Map;class StyleSet{constructor(e,t){let n=e.ownerDocument||e,i=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let t=adoptedSet.get(n);if(t)return e.adoptedStyleSheets=[t.sheet,...e.adoptedStyleSheets],e[SET]=t;this.sheet=new i.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],adoptedSet.set(n,this)}else{this.styleTag=n.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);let i=e.head||e;i.insertBefore(this.styleTag,i.firstChild)}this.modules=[],e[SET]=this}mount(e){let t=this.sheet,n=0,i=0;for(let r=0;r<e.length;r++){let s=e[r],o=this.modules.indexOf(s);if(o<i&&o>-1&&(this.modules.splice(o,1),i--,o=-1),-1==o){if(this.modules.splice(i++,0,s),t)for(let e=0;e<s.rules.length;e++)t.insertRule(s.rules[e],n++)}else{for(;i<o;)n+=this.modules[i++].rules.length;n+=s.rules.length,i++}}if(!t){let e="";for(let t=0;t<this.modules.length;t++)e+=this.modules[t].getRules()+"\n";this.styleTag.textContent=e}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}for(var base={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shift={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},mac="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),ie$1="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),i=0;i<10;i++)base[48+i]=base[96+i]=String(i);for(var i=1;i<=24;i++)base[i+111]="F"+i;for(var i=65;i<=90;i++)base[i]=String.fromCharCode(i+32),shift[i]=String.fromCharCode(i);for(var code in base)shift.hasOwnProperty(code)||(shift[code]=base[code]);function keyName(e){var t=!(mac&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||ie$1&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?shift:base)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}function getSelection(e){let t;return t=11==e.nodeType?e.getSelection?e:e.ownerDocument:e,t.getSelection()}function contains(e,t){return!!t&&(e==t||e.contains(1!=t.nodeType?t.parentNode:t))}function deepActiveElement(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function hasSelection(e,t){if(!t.anchorNode)return!1;try{return contains(e,t.anchorNode)}catch(e){return!1}}function clientRectsFor(e){return 3==e.nodeType?textRange(e,0,e.nodeValue.length).getClientRects():1==e.nodeType?e.getClientRects():[]}function isEquivalentPosition(e,t,n,i){return!!n&&(scanFor(e,t,n,i,-1)||scanFor(e,t,n,i,1))}function domIndex(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t}function scanFor(e,t,n,i,r){for(;;){if(e==n&&t==i)return!0;if(t==(r<0?0:maxOffset(e))){if("DIV"==e.nodeName)return!1;let n=e.parentNode;if(!n||1!=n.nodeType)return!1;t=domIndex(e)+(r<0?0:1),e=n}else{if(1!=e.nodeType)return!1;if(1==(e=e.childNodes[t+(r<0?-1:0)]).nodeType&&"false"==e.contentEditable)return!1;t=r<0?maxOffset(e):0}}}function maxOffset(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function flattenRect(e,t){let n=t?e.left:e.right;return{left:n,right:n,top:e.top,bottom:e.bottom}}function windowRect(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}function getScale(e,t){let n=t.width/e.offsetWidth,i=t.height/e.offsetHeight;return(n>.995&&n<1.005||!isFinite(n)||Math.abs(t.width-e.offsetWidth)<1)&&(n=1),(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.height-e.offsetHeight)<1)&&(i=1),{scaleX:n,scaleY:i}}function scrollRectIntoView(e,t,n,i,r,s,o,a){let l=e.ownerDocument,c=l.defaultView||window;for(let h=e,d=!1;h&&!d;)if(1==h.nodeType){let e,u=h==l.body,p=1,f=1;if(u)e=windowRect(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(h).position)&&(d=!0),h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let t=h.getBoundingClientRect();({scaleX:p,scaleY:f}=getScale(h,t)),e={left:t.left,right:t.left+h.clientWidth*p,top:t.top,bottom:t.top+h.clientHeight*f}}let m=0,g=0;if("nearest"==r)t.top<e.top?(g=-(e.top-t.top+o),n>0&&t.bottom>e.bottom+g&&(g=t.bottom-e.bottom+g+o)):t.bottom>e.bottom&&(g=t.bottom-e.bottom+o,n<0&&t.top-g<e.top&&(g=-(e.top+g-t.top+o)));else{let i=t.bottom-t.top,s=e.bottom-e.top;g=("center"==r&&i<=s?t.top+i/2-s/2:"start"==r||"center"==r&&n<0?t.top-o:t.bottom-s+o)-e.top}if("nearest"==i)t.left<e.left?(m=-(e.left-t.left+s),n>0&&t.right>e.right+m&&(m=t.right-e.right+m+s)):t.right>e.right&&(m=t.right-e.right+s,n<0&&t.left<e.left+m&&(m=-(e.left+m-t.left+s)));else{m=("center"==i?t.left+(t.right-t.left)/2-(e.right-e.left)/2:"start"==i==a?t.left-s:t.right-(e.right-e.left)+s)-e.left}if(m||g)if(u)c.scrollBy(m,g);else{let e=0,n=0;if(g){let e=h.scrollTop;h.scrollTop+=g/f,n=(h.scrollTop-e)*f}if(m){let t=h.scrollLeft;h.scrollLeft+=m/p,e=(h.scrollLeft-t)*p}t={left:t.left-e,top:t.top-n,right:t.right-e,bottom:t.bottom-n},e&&Math.abs(e-m)<1&&(i="nearest"),n&&Math.abs(n-g)<1&&(r="nearest")}if(u)break;h=h.assignedSlot||h.parentNode}else{if(11!=h.nodeType)break;h=h.host}}function scrollableParent(e){let t=e.ownerDocument;for(let n=e.parentNode;n&&n!=t.body;)if(1==n.nodeType){if(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)return n;n=n.assignedSlot||n.parentNode}else{if(11!=n.nodeType)break;n=n.host}return null}class DOMSelectionState{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?maxOffset(t):0),n,Math.min(e.focusOffset,n?maxOffset(n):0))}set(e,t,n,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=i}}let preventScrollSupported=null,scratchRange;function focusPreventScroll(e){if(e.setActive)return e.setActive();if(preventScrollSupported)return e.focus(preventScrollSupported);let t=[];for(let n=e;n&&(t.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(e.focus(null==preventScrollSupported?{get preventScroll(){return preventScrollSupported={preventScroll:!0},!0}}:void 0),!preventScrollSupported){preventScrollSupported=!1;for(let e=0;e<t.length;){let n=t[e++],i=t[e++],r=t[e++];n.scrollTop!=i&&(n.scrollTop=i),n.scrollLeft!=r&&(n.scrollLeft=r)}}}function textRange(e,t,n=t){let i=scratchRange||(scratchRange=document.createRange());return i.setEnd(e,n),i.setStart(e,t),i}function dispatchKey(e,t,n){let i={key:t,code:t,keyCode:n,which:n,cancelable:!0},r=new KeyboardEvent("keydown",i);r.synthetic=!0,e.dispatchEvent(r);let s=new KeyboardEvent("keyup",i);return s.synthetic=!0,e.dispatchEvent(s),r.defaultPrevented||s.defaultPrevented}function getRoot(e){for(;e;){if(e&&(9==e.nodeType||11==e.nodeType&&e.host))return e;e=e.assignedSlot||e.parentNode}return null}function clearAttributes(e){for(;e.attributes.length;)e.removeAttributeNode(e.attributes[0])}function atElementStart(e,t){let n=t.focusNode,i=t.focusOffset;if(!n||t.anchorNode!=n||t.anchorOffset!=i)return!1;for(i=Math.min(i,maxOffset(n));;)if(i){if(1!=n.nodeType)return!1;let e=n.childNodes[i-1];"false"==e.contentEditable?i--:(n=e,i=maxOffset(n))}else{if(n==e)return!0;i=domIndex(n),n=n.parentNode}}function isScrolledToBottom(e){return e.scrollTop>Math.max(1,e.scrollHeight-e.clientHeight-4)}class DOMPos{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new DOMPos(e.parentNode,domIndex(e),t)}static after(e,t){return new DOMPos(e.parentNode,domIndex(e)+1,t)}}const noChildren=[];class ContentView{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(2&this.flags){let n,i=this.dom,r=null;for(let s of this.children){if(7&s.flags){if(!s.dom&&(n=r?r.nextSibling:i.firstChild)){let e=ContentView.get(n);(!e||!e.parent&&e.canReuseDOM(s))&&s.reuseDOM(n)}s.sync(e,t),s.flags&=-8}if(n=r?r.nextSibling:i.firstChild,t&&!t.written&&t.node==i&&n!=s.dom&&(t.written=!0),s.dom.parentNode==i)for(;n&&n!=s.dom;)n=rm$1(n);else i.insertBefore(s.dom,n);r=s.dom}for(n=r?r.nextSibling:i.firstChild,n&&t&&t.node==i&&(t.written=!0);n;)n=rm$1(n)}else if(1&this.flags)for(let n of this.children)7&n.flags&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let i=0==maxOffset(e)?0:0==t?-1:1;for(;;){let t=e.parentNode;if(t==this.dom)break;0==i&&t.firstChild!=t.lastChild&&(i=e==t.firstChild?-1:1),e=t}n=i<0?e:e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!ContentView.get(n);)n=n.nextSibling;if(!n)return this.length;for(let e=0,t=0;;e++){let i=this.children[e];if(i.dom==n)return t;t+=i.length+i.breakAfter}}domBoundsAround(e,t,n=0){let i=-1,r=-1,s=-1,o=-1;for(let a=0,l=n,c=n;a<this.children.length;a++){let n=this.children[a],h=l+n.length;if(l<e&&h>t)return n.domBoundsAround(e,t,l);if(h>=e&&-1==i&&(i=a,r=l),l>t&&n.dom.parentNode==this.dom){s=a,o=c;break}c=h,l=h+n.breakAfter}return{from:r,to:o<0?n+this.length:o,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),1&t.flags)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,7&this.flags&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=noChildren){this.markDirty();for(let i=e;i<t;i++){let e=this.children[i];e.parent==this&&n.indexOf(e)<0&&e.destroy()}this.children.splice(e,t-e,...n);for(let e=0;e<n.length;e++)n[e].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new ChildCursor(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+("Text"==e?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,i,r,s){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!(8&(this.flags|e.flags))}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}function rm$1(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}ContentView.prototype.breakAfter=0;class ChildCursor{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||0==this.i||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function replaceRange(e,t,n,i,r,s,o,a,l){let{children:c}=e,h=c.length?c[t]:null,d=s.length?s[s.length-1]:null,u=d?d.breakAfter:o;if(!(t==i&&h&&!o&&!u&&s.length<2&&h.merge(n,r,s.length?d:null,0==n,a,l))){if(i<c.length){let e=c[i];e&&(r<e.length||e.breakAfter&&(null==d?void 0:d.breakAfter))?(t==i&&(e=e.split(r),r=0),!u&&d&&e.merge(0,r,d,!0,0,l)?s[s.length-1]=e:((r||e.children.length&&!e.children[0].length)&&e.merge(0,r,null,!1,0,l),s.push(e))):(null==e?void 0:e.breakAfter)&&(d?d.breakAfter=1:o=1),i++}for(h&&(h.breakAfter=o,n>0&&(!o&&s.length&&h.merge(n,h.length,s[0],!1,a,0)?h.breakAfter=s.shift().breakAfter:(n<h.length||h.children.length&&0==h.children[h.children.length-1].length)&&h.merge(n,h.length,null,!1,a,0),t++));t<i&&s.length;)if(c[i-1].become(s[s.length-1]))i--,s.pop(),l=s.length?0:a;else{if(!c[t].become(s[0]))break;t++,s.shift(),a=s.length?0:l}!s.length&&t&&i<c.length&&!c[t-1].breakAfter&&c[i].merge(0,0,c[t-1],!1,a,l)&&t--,(t<i||s.length)&&e.replaceChildren(t,i,s)}}function mergeChildrenInto(e,t,n,i,r,s){let o=e.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:c,off:h}=o.findPos(t,-1),d=t-n;for(let e of i)d+=e.length;e.length+=d,replaceRange(e,c,h,a,l,i,0,r,s)}let nav="undefined"!=typeof navigator?navigator:{userAgent:"",vendor:"",platform:""},doc="undefined"!=typeof document?document:{documentElement:{style:{}}};const ie_edge=/Edge\/(\d+)/.exec(nav.userAgent),ie_upto10=/MSIE \d/.test(nav.userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(nav.userAgent),ie=!!(ie_upto10||ie_11up||ie_edge),gecko=!ie&&/gecko\/(\d+)/i.test(nav.userAgent),chrome=!ie&&/Chrome\/(\d+)/.exec(nav.userAgent),webkit="webkitFontSmoothing"in doc.documentElement.style,safari=!ie&&/Apple Computer/.test(nav.vendor),ios=safari&&(/Mobile\/\w+/.test(nav.userAgent)||nav.maxTouchPoints>2);var browser={mac:ios||/Mac/.test(nav.platform),windows:/Win/.test(nav.platform),linux:/Linux|X11/.test(nav.platform),ie:ie,ie_version:ie_upto10?doc.documentMode||6:ie_11up?+ie_11up[1]:ie_edge?+ie_edge[1]:0,gecko:gecko,gecko_version:gecko?+(/Firefox\/(\d+)/.exec(nav.userAgent)||[0,0])[1]:0,chrome:!!chrome,chrome_version:chrome?+chrome[1]:0,ios:ios,android:/Android\b/.test(nav.userAgent),webkit:webkit,safari:safari,webkit_version:webkit?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:null!=doc.documentElement.style.tabSize?"tab-size":"-moz-tab-size"};const MaxJoinLen=256;class TextView extends ContentView{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){3==e.nodeType&&this.createDOM(e)}merge(e,t,n){return!(8&this.flags||n&&(!(n instanceof TextView)||this.length-(t-e)+n.length>MaxJoinLen||8&n.flags))&&(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new TextView(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=8&this.flags,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new DOMPos(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return textCoords(this.dom,e,t)}}class MarkView extends ContentView{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let e of t)e.setParent(this)}setAttrs(e){if(clearAttributes(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!(8&(this.flags|e.flags))}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?4&this.flags&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,i,r,s){return(!n||!(!(n instanceof MarkView&&n.mark.eq(this.mark))||e&&r<=0||t<this.length&&s<=0))&&(mergeChildrenInto(this,e,t,n?n.children.slice():[],r-1,s-1),this.markDirty(),!0)}split(e){let t=[],n=0,i=-1,r=0;for(let s of this.children){let o=n+s.length;o>e&&t.push(n<e?s.split(e-n):s),i<0&&n>=e&&(i=r),n=o,r++}let s=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new MarkView(this.mark,t,s)}domAtPos(e){return inlineDOMAtPos(this,e)}coordsAt(e,t){return coordsInChildren(this,e,t)}}function textCoords(e,t,n){let i=e.nodeValue.length;t>i&&(t=i);let r=t,s=t,o=0;0==t&&n<0||t==i&&n>=0?browser.chrome||browser.gecko||(t?(r--,o=1):s<i&&(s++,o=-1)):n<0?r--:s<i&&s++;let a=textRange(e,r,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return browser.safari&&!o&&0==l.width&&(l=Array.prototype.find.call(a,(e=>e.width))||l),o?flattenRect(l,o<0):l||null}class WidgetView extends ContentView{static create(e,t,n){return new WidgetView(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=WidgetView.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,n,i,r,s){return!(n&&(!(n instanceof WidgetView&&this.widget.compare(n.widget))||e>0&&r<=0||t<this.length&&s<=0))&&(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof WidgetView&&e.side==this.side&&this.widget.constructor==e.widget.constructor&&(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(0==this.length)return Text.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,i=this.posAtStart;return n?n.slice(i,i+this.length):Text.empty}domAtPos(e){return(this.length?0==e:this.side>0)?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let i=this.dom.getClientRects(),r=null;if(!i.length)return null;let s=this.side?this.side<0:e>0;for(let t=s?i.length-1:0;r=i[t],!(e>0?0==t:t==i.length-1||r.top<r.bottom);t+=s?-1:1);return flattenRect(r,!s)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class WidgetBufferView extends ContentView{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof WidgetBufferView&&e.side==this.side}split(){return new WidgetBufferView(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?DOMPos.before(this.dom):DOMPos.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Text.empty}get isHidden(){return!0}}function inlineDOMAtPos(e,t){let n=e.dom,{children:i}=e,r=0;for(let e=0;r<i.length;r++){let s=i[r],o=e+s.length;if(!(o==e&&s.getSide()<=0)){if(t>e&&t<o&&s.dom.parentNode==n)return s.domAtPos(t-e);if(t<=e)break;e=o}}for(let e=r;e>0;e--){let t=i[e-1];if(t.dom.parentNode==n)return t.domAtPos(t.length)}for(let e=r;e<i.length;e++){let t=i[e];if(t.dom.parentNode==n)return t.domAtPos(0)}return new DOMPos(n,0)}function joinInlineInto(e,t,n){let i,{children:r}=e;n>0&&t instanceof MarkView&&r.length&&(i=r[r.length-1])instanceof MarkView&&i.mark.eq(t.mark)?joinInlineInto(i,t.children[0],n-1):(r.push(t),t.setParent(e)),e.length+=t.length}function coordsInChildren(e,t,n){let i=null,r=-1,s=null,o=-1;!function e(t,a){for(let l=0,c=0;l<t.children.length&&c<=a;l++){let h=t.children[l],d=c+h.length;d>=a&&(h.children.length?e(h,a-c):(!s||s.isHidden&&n>0)&&(d>a||c==d&&h.getSide()>0)?(s=h,o=a-c):(c<a||c==d&&h.getSide()<0&&!h.isHidden)&&(i=h,r=a-c)),c=d}}(e,t);let a=(n<0?i:s)||i||s;return a?a.coordsAt(Math.max(0,a==i?r:o),n):fallbackRect(e)}function fallbackRect(e){let t=e.dom.lastChild;if(!t)return e.dom.getBoundingClientRect();let n=clientRectsFor(t);return n[n.length-1]||null}function combineAttrs(e,t){for(let n in e)"class"==n&&t.class?t.class+=" "+e.class:"style"==n&&t.style?t.style+=";"+e.style:t[n]=e[n];return t}TextView.prototype.children=WidgetView.prototype.children=WidgetBufferView.prototype.children=noChildren;const noAttrs=Object.create(null);function attrsEq(e,t,n){if(e==t)return!0;e||(e=noAttrs),t||(t=noAttrs);let i=Object.keys(e),r=Object.keys(t);if(i.length-(n&&i.indexOf(n)>-1?1:0)!=r.length-(n&&r.indexOf(n)>-1?1:0))return!1;for(let s of i)if(s!=n&&(-1==r.indexOf(s)||e[s]!==t[s]))return!1;return!0}function updateAttrs(e,t,n){let i=!1;if(t)for(let r in t)n&&r in n||(i=!0,"style"==r?e.style.cssText="":e.removeAttribute(r));if(n)for(let r in n)t&&t[r]==n[r]||(i=!0,"style"==r?e.style.cssText=n[r]:e.setAttribute(r,n[r]));return i}function getAttrs$1(e){let t=Object.create(null);for(let n=0;n<e.attributes.length;n++){let i=e.attributes[n];t[i.name]=i.value}return t}class LineView extends ContentView{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,i,r,s){if(n){if(!(n instanceof LineView))return!1;this.dom||n.transferDOM(this)}return i&&this.setDeco(n?n.attrs:null),mergeChildrenInto(this,e,t,n?n.children.slice():[],r,s),!0}split(e){let t=new LineView;if(t.breakAfter=this.breakAfter,0==this.length)return t;let{i:n,off:i}=this.childPos(e);i&&(t.append(this.children[n].split(i),0),this.children[n].merge(i,this.children[n].length,null,!1,0,0),n++);for(let e=n;e<this.children.length;e++)t.append(this.children[e],0);for(;n>0&&0==this.children[n-1].length;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=void 0===this.prevAttrs?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){attrsEq(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){joinInlineInto(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=combineAttrs(t,this.attrs||{})),n&&(this.attrs=combineAttrs({class:n},this.attrs||{}))}domAtPos(e){return inlineDOMAtPos(this,e)}reuseDOM(e){"DIV"==e.nodeName&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?4&this.flags&&(clearAttributes(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),void 0!==this.prevAttrs&&(updateAttrs(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&ContentView.get(i)instanceof MarkView;)i=i.lastChild;if(!(i&&this.length&&("BR"==i.nodeName||0!=(null===(n=ContentView.get(i))||void 0===n?void 0:n.isEditable)||browser.ios&&this.children.some((e=>e instanceof TextView))))){let e=document.createElement("BR");e.cmIgnore=!0,this.dom.appendChild(e)}}measureTextSize(){if(0==this.children.length||this.length>20)return null;let e,t=0;for(let n of this.children){if(!(n instanceof TextView)||/[^ -~]/.test(n.text))return null;let i=clientRectsFor(n.dom);if(1!=i.length)return null;t+=i[0].width,e=i[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:e}:null}coordsAt(e,t){let n=coordsInChildren(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:e}=this.parent.view.viewState,t=n.bottom-n.top;if(Math.abs(t-e.lineHeight)<2&&e.textHeight<t){let i=(t-e.textHeight)/2;return{top:n.top+i,bottom:n.bottom-i,left:n.left,right:n.left}}}return n}become(e){return!1}covers(){return!0}static find(e,t){for(let n=0,i=0;n<e.children.length;n++){let r=e.children[n],s=i+r.length;if(s>=t){if(r instanceof LineView)return r;if(s>t)break}i=s+r.breakAfter}return null}}class BlockWidgetView extends ContentView{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,i,r,s){return!(n&&(!(n instanceof BlockWidgetView&&this.widget.compare(n.widget))||e>0&&r<=0||t<this.length&&s<=0))&&(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return 0==e?DOMPos.before(this.dom):DOMPos.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new BlockWidgetView(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return noChildren}sync(e){this.dom&&this.widget.updateDOM(this.dom,e)||(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Text.empty}domBoundsAround(){return null}become(e){return e instanceof BlockWidgetView&&e.widget.constructor==this.widget.constructor&&(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0)}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t!=n&&(e<0?t<0:n>0)}}class WidgetType{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var BlockType=function(e){return e[e.Text=0]="Text",e[e.WidgetBefore=1]="WidgetBefore",e[e.WidgetAfter=2]="WidgetAfter",e[e.WidgetRange=3]="WidgetRange",e}(BlockType||(BlockType={}));class Decoration extends RangeValue{constructor(e,t,n,i){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=i}get heightRelevant(){return!1}static mark(e){return new MarkDecoration(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new PointDecoration(e,t,t,n,e.widget||null,!1)}static replace(e){let t,n,i=!!e.block;if(e.isBlockGap)t=-5e8,n=4e8;else{let{start:r,end:s}=getInclusive(e,i);t=(r?i?-3e8:-1:5e8)-1,n=1+(s?i?2e8:1:-6e8)}return new PointDecoration(e,t,n,i,e.widget||null,!0)}static line(e){return new LineDecoration(e)}static set(e,t=!1){return RangeSet.of(e,t)}hasHeight(){return!!this.widget&&this.widget.estimatedHeight>-1}}Decoration.none=RangeSet.empty;class MarkDecoration extends Decoration{constructor(e){let{start:t,end:n}=getInclusive(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof MarkDecoration&&this.tagName==e.tagName&&(this.class||(null===(t=this.attrs)||void 0===t?void 0:t.class))==(e.class||(null===(n=e.attrs)||void 0===n?void 0:n.class))&&attrsEq(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}MarkDecoration.prototype.point=!1;class LineDecoration extends Decoration{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof LineDecoration&&this.spec.class==e.spec.class&&attrsEq(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}LineDecoration.prototype.mapMode=MapMode.TrackBefore,LineDecoration.prototype.point=!0;class PointDecoration extends Decoration{constructor(e,t,n,i,r,s){super(t,n,r,e),this.block=i,this.isReplace=s,this.mapMode=i?t<=0?MapMode.TrackBefore:MapMode.TrackAfter:MapMode.TrackDel}get type(){return this.startSide!=this.endSide?BlockType.WidgetRange:this.startSide<=0?BlockType.WidgetBefore:BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof PointDecoration&&widgetsEq(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}function getInclusive(e,t=!1){let{inclusiveStart:n,inclusiveEnd:i}=e;return null==n&&(n=e.inclusive),null==i&&(i=e.inclusive),{start:null!=n?n:t,end:null!=i?i:t}}function widgetsEq(e,t){return e==t||!!(e&&t&&e.compare(t))}function addRange(e,t,n,i=0){let r=n.length-1;r>=0&&n[r]+i>=e?n[r]=Math.max(n[r],t):n.push(e,t)}PointDecoration.prototype.point=!0;class ContentBuilder{constructor(e,t,n,i){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(0==this.content.length)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof BlockWidgetView&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new LineView),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(wrapMarks(new WidgetBufferView(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||e&&this.content.length&&this.content[this.content.length-1]instanceof BlockWidgetView||this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:t,lineBreak:n,done:i}=this.cursor.next(this.skip);if(this.skip=0,i)throw new Error("Ran out of text content when drawing inline views");if(n){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}this.text=t,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(wrapMarks(new TextView(this.text.slice(this.textOff,this.textOff+i)),t),n),this.atCursorPos=!0,this.textOff+=i,e-=i,n=0}}span(e,t,n,i){this.buildText(t-e,n,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,n,i,r,s){if(this.disallowBlockEffectsFor[s]&&n instanceof PointDecoration){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let o=t-e;if(n instanceof PointDecoration)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new BlockWidgetView(n.widget||new NullWidget("div"),o,n));else{let s=WidgetView.create(n.widget||new NullWidget("span"),o,o?0:n.startSide),a=this.atCursorPos&&!s.isEditable&&r<=i.length&&(e<t||n.startSide>0),l=!s.isEditable&&(e<t||r>i.length||n.startSide<=0),c=this.getLine();2!=this.pendingBuffer||a||s.isEditable||(this.pendingBuffer=0),this.flushBuffer(i),a&&(c.append(wrapMarks(new WidgetBufferView(1),i),r),r=i.length+Math.max(0,r-i.length)),c.append(wrapMarks(s,i),r),this.atCursorPos=l,this.pendingBuffer=l?e<t||r>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);o&&(this.textOff+o<=this.text.length?this.textOff+=o:(this.skip+=o-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=r)}static build(e,t,n,i,r){let s=new ContentBuilder(e,t,n,r);return s.openEnd=RangeSet.spans(i,t,n,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function wrapMarks(e,t){for(let n of t)e=new MarkView(n,[e],e.length);return e}class NullWidget extends WidgetType{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}var Direction=function(e){return e[e.LTR=0]="LTR",e[e.RTL=1]="RTL",e}(Direction||(Direction={}));const LTR=Direction.LTR,RTL=Direction.RTL;function dec(e){let t=[];for(let n=0;n<e.length;n++)t.push(1<<+e[n]);return t}const LowTypes=dec("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),ArabicTypes=dec("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Brackets=Object.create(null),BracketStack=[];for(let e of["()","[]","{}"]){let t=e.charCodeAt(0),n=e.charCodeAt(1);Brackets[t]=n,Brackets[n]=-t}function charType(e){return e<=247?LowTypes[e]:1424<=e&&e<=1524?2:1536<=e&&e<=1785?ArabicTypes[e-1536]:1774<=e&&e<=2220?4:8192<=e&&e<=8204?256:64336<=e&&e<=65023?4:1}const BidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class BidiSpan{get dir(){return this.level%2?RTL:LTR}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,n,i){let r=-1;for(let s=0;s<e.length;s++){let o=e[s];if(o.from<=t&&o.to>=t){if(o.level==n)return s;(r<0||(0!=i?i<0?o.from<t:o.to>t:e[r].level>o.level))&&(r=s)}}if(r<0)throw new RangeError("Index out of range");return r}}function isolatesEq(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.direction!=r.direction||!isolatesEq(i.inner,r.inner))return!1}return!0}const types=[];function computeCharTypes(e,t,n,i,r){for(let s=0;s<=i.length;s++){let o=s?i[s-1].to:t,a=s<i.length?i[s].from:n,l=s?256:r;for(let t=o,n=l,i=l;t<a;t++){let r=charType(e.charCodeAt(t));512==r?r=n:8==r&&4==i&&(r=16),types[t]=4==r?2:r,7&r&&(i=r),n=r}for(let e=o,t=l,i=l;e<a;e++){let r=types[e];if(128==r)e<a-1&&t==types[e+1]&&24&t?r=types[e]=t:types[e]=256;else if(64==r){let r=e+1;for(;r<a&&64==types[r];)r++;let s=e&&8==t||r<n&&8==types[r]?1==i?1:8:256;for(let t=e;t<r;t++)types[t]=s;e=r-1}else 8==r&&1==i&&(types[e]=1);t=r,7&r&&(i=r)}}}function processBracketPairs(e,t,n,i,r){let s=1==r?2:1;for(let o=0,a=0,l=0;o<=i.length;o++){let c=o?i[o-1].to:t,h=o<i.length?i[o].from:n;for(let t,n,i,o=c;o<h;o++)if(n=Brackets[t=e.charCodeAt(o)])if(n<0){for(let e=a-3;e>=0;e-=3)if(BracketStack[e+1]==-n){let t=BracketStack[e+2],n=2&t?r:4&t?1&t?s:r:0;n&&(types[o]=types[BracketStack[e]]=n),a=e;break}}else{if(189==BracketStack.length)break;BracketStack[a++]=o,BracketStack[a++]=t,BracketStack[a++]=l}else if(2==(i=types[o])||1==i){let e=i==r;l=e?0:1;for(let t=a-3;t>=0;t-=3){let n=BracketStack[t+2];if(2&n)break;if(e)BracketStack[t+2]|=2;else{if(4&n)break;BracketStack[t+2]|=4}}}}}function processNeutrals(e,t,n,i){for(let r=0,s=i;r<=n.length;r++){let o=r?n[r-1].to:e,a=r<n.length?n[r].from:t;for(let l=o;l<a;){let o=types[l];if(256==o){let o=l+1;for(;;)if(o==a){if(r==n.length)break;o=n[r++].to,a=r<n.length?n[r].from:t}else{if(256!=types[o])break;o++}let c=1==s,h=c==(1==(o<t?types[o]:i))?c?1:2:i;for(let t=o,i=r,s=i?n[i-1].to:e;t>l;)t==s&&(t=n[--i].from,s=i?n[i-1].to:e),types[--t]=h;l=o}else s=o,l++}}}function emitSpans(e,t,n,i,r,s,o){let a=i%2?2:1;if(i%2==r%2)for(let l=t,c=0;l<n;){let t=!0,h=!1;if(c==s.length||l<s[c].from){let e=types[l];e!=a&&(t=!1,h=16==e)}let d=t||1!=a?null:[],u=t?i:i+1,p=l;e:for(;;)if(c<s.length&&p==s[c].from){if(h)break e;let f=s[c];if(!t)for(let e=f.to,t=c+1;;){if(e==n)break e;if(!(t<s.length&&s[t].from==e)){if(types[e]==a)break e;break}e=s[t++].to}if(c++,d)d.push(f);else{f.from>l&&o.push(new BidiSpan(l,f.from,u)),computeSectionOrder(e,f.direction==LTR!=!(u%2)?i+1:i,r,f.inner,f.from,f.to,o),l=f.to}p=f.to}else{if(p==n||(t?types[p]!=a:types[p]==a))break;p++}d?emitSpans(e,l,p,i+1,r,d,o):l<p&&o.push(new BidiSpan(l,p,u)),l=p}else for(let l=n,c=s.length;l>t;){let n=!0,h=!1;if(!c||l>s[c-1].to){let e=types[l-1];e!=a&&(n=!1,h=16==e)}let d=n||1!=a?null:[],u=n?i:i+1,p=l;e:for(;;)if(c&&p==s[c-1].to){if(h)break e;let f=s[--c];if(!n)for(let e=f.from,n=c;;){if(e==t)break e;if(!n||s[n-1].to!=e){if(types[e-1]==a)break e;break}e=s[--n].from}if(d)d.push(f);else{f.to<l&&o.push(new BidiSpan(f.to,l,u)),computeSectionOrder(e,f.direction==LTR!=!(u%2)?i+1:i,r,f.inner,f.from,f.to,o),l=f.from}p=f.from}else{if(p==t||(n?types[p-1]!=a:types[p-1]==a))break;p--}d?emitSpans(e,p,l,i+1,r,d,o):p<l&&o.push(new BidiSpan(p,l,u)),l=p}}function computeSectionOrder(e,t,n,i,r,s,o){let a=t%2?2:1;computeCharTypes(e,r,s,i,a),processBracketPairs(e,r,s,i,a),processNeutrals(r,s,i,a),emitSpans(e,r,s,t,n,i,o)}function computeOrder(e,t,n){if(!e)return[new BidiSpan(0,0,t==RTL?1:0)];if(t==LTR&&!n.length&&!BidiRE.test(e))return trivialOrder(e.length);if(n.length)for(;e.length>types.length;)types[types.length]=256;let i=[],r=t==LTR?0:1;return computeSectionOrder(e,r,r,n,0,e.length,i),i}function trivialOrder(e){return[new BidiSpan(0,e,0)]}let movedOver="";function moveVisually(e,t,n,i,r){var s;let o=i.head-e.from,a=BidiSpan.find(t,o,null!==(s=i.bidiLevel)&&void 0!==s?s:-1,i.assoc),l=t[a],c=l.side(r,n);if(o==c){let e=a+=r?1:-1;if(e<0||e>=t.length)return null;l=t[a=e],o=l.side(!r,n),c=l.side(r,n)}let h=findClusterBreak(e.text,o,l.forward(r,n));(h<l.from||h>l.to)&&(h=c),movedOver=e.text.slice(Math.min(o,h),Math.max(o,h));let d=a==(r?t.length-1:0)?null:t[a+(r?1:-1)];return d&&h==c&&d.level+(r?0:1)<l.level?EditorSelection.cursor(d.side(!r,n)+e.from,d.forward(r,n)?1:-1,d.level):EditorSelection.cursor(h+e.from,l.forward(r,n)?-1:1,l.level)}function autoDirection(e,t,n){for(let i=t;i<n;i++){let t=charType(e.charCodeAt(i));if(1==t)return LTR;if(2==t||4==t)return RTL}return LTR}const clickAddsSelectionRange=Facet.define(),dragMovesSelection$1=Facet.define(),mouseSelectionStyle=Facet.define(),exceptionSink=Facet.define(),updateListener=Facet.define(),inputHandler$1=Facet.define(),focusChangeEffect=Facet.define(),perLineTextDirection=Facet.define({combine:e=>e.some((e=>e))}),nativeSelectionHidden=Facet.define({combine:e=>e.some((e=>e))});class ScrollTarget{constructor(e,t="nearest",n="nearest",i=5,r=5,s=!1){this.range=e,this.y=t,this.x=n,this.yMargin=i,this.xMargin=r,this.isSnapshot=s}map(e){return e.empty?this:new ScrollTarget(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new ScrollTarget(EditorSelection.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const scrollIntoView$1=StateEffect.define({map:(e,t)=>e.map(t)});function logException(e,t,n){let i=e.facet(exceptionSink);i.length?i[0](t):window.onerror?window.onerror(String(t),n,void 0,void 0,t):n?console.error(n+":",t):console.error(t)}const editable=Facet.define({combine:e=>!e.length||e[0]});let nextPluginID=0;const viewPlugin=Facet.define();class ViewPlugin{constructor(e,t,n,i,r){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=i,this.extension=r(this)}static define(e,t){const{eventHandlers:n,eventObservers:i,provide:r,decorations:s}=t||{};return new ViewPlugin(nextPluginID++,e,n,i,(e=>{let t=[viewPlugin.of(e)];return s&&t.push(decorations.of((t=>{let n=t.plugin(e);return n?s(n):Decoration.none}))),r&&t.push(r(e)),t}))}static fromClass(e,t){return ViewPlugin.define((t=>new e(t)),t)}}class PluginInstance{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(t){if(logException(e.state,t,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch(e){}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){logException(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(null===(t=this.value)||void 0===t?void 0:t.destroy)try{this.value.destroy()}catch(t){logException(e.state,t,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const editorAttributes=Facet.define(),contentAttributes=Facet.define(),decorations=Facet.define(),outerDecorations=Facet.define(),atomicRanges=Facet.define(),bidiIsolatedRanges=Facet.define();function getIsolatedRanges(e,t){let n=e.state.facet(bidiIsolatedRanges);if(!n.length)return n;let i=n.map((t=>t instanceof Function?t(e):t)),r=[];return RangeSet.spans(i,t.from,t.to,{point(){},span(e,n,i,s){let o=e-t.from,a=n-t.from,l=r;for(let e=i.length-1;e>=0;e--,s--){let n,r=i[e].spec.bidiIsolate;if(null==r&&(r=autoDirection(t.text,o,a)),s>0&&l.length&&(n=l[l.length-1]).to==o&&n.direction==r)n.to=a,l=n.inner;else{let e={from:o,to:a,direction:r,inner:[]};l.push(e),l=e.inner}}}}),r}const scrollMargins=Facet.define();function getScrollMargins(e){let t=0,n=0,i=0,r=0;for(let s of e.state.facet(scrollMargins)){let o=s(e);o&&(null!=o.left&&(t=Math.max(t,o.left)),null!=o.right&&(n=Math.max(n,o.right)),null!=o.top&&(i=Math.max(i,o.top)),null!=o.bottom&&(r=Math.max(r,o.bottom)))}return{left:t,right:n,top:i,bottom:r}}const styleModule=Facet.define();class ChangedRange{constructor(e,t,n,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=i}join(e){return new ChangedRange(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>n.toA)){if(i.toA<n.fromA)break;n=n.join(i),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(0==t.length)return e;let n=[];for(let i=0,r=0,s=0,o=0;;i++){let a=i==e.length?null:e[i],l=s-o,c=a?a.fromB:1e9;for(;r<t.length&&t[r]<c;){let e=t[r],i=t[r+1],s=Math.max(o,e),a=Math.min(c,i);if(s<=a&&new ChangedRange(s+l,a+l,s,a).addToSet(n),i>c)break;r+=2}if(!a)return n;new ChangedRange(a.fromA,a.toA,a.fromB,a.toB).addToSet(n),s=a.toA,o=a.toB}}}class ViewUpdate{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=ChangeSet.empty(this.startState.doc.length);for(let e of n)this.changes=this.changes.compose(e.changes);let i=[];this.changes.iterChangedRanges(((e,t,n,r)=>i.push(new ChangedRange(e,t,n,r)))),this.changedRanges=i}static create(e,t,n){return new ViewUpdate(e,t,n)}get viewportChanged(){return(4&this.flags)>0}get heightChanged(){return(2&this.flags)>0}get geometryChanged(){return this.docChanged||(10&this.flags)>0}get focusChanged(){return(1&this.flags)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some((e=>e.selection))}get empty(){return 0==this.flags&&0==this.transactions.length}}class DocView extends ContentView{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new LineView],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ChangedRange(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every((({fromA:e,toA:t})=>t<this.minWidthFrom||e>this.minWidthTo))?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let i=-1;this.view.inputState.composing>=0&&((null===(t=this.domChanged)||void 0===t?void 0:t.newSel)?i=this.domChanged.newSel.head:touchesComposition(e.changes,this.hasComposition)||e.selectionSet||(i=e.state.selection.main.head));let r=i>-1?findCompositionRange(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:t,to:i}=this.hasComposition;n=new ChangedRange(t,i,e.changes.mapPos(t,-1),e.changes.mapPos(i,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(browser.ie||browser.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let s=findChangedDeco(this.decorations,this.updateDeco(),e.changes);return n=ChangedRange.extendWithRanges(n,s),!!(7&this.flags||0!=n.length)&&(this.updateInner(n,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:i}=this.view;i.ignore((()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let e=browser.chrome||browser.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,e),this.flags&=-8,e&&(e.written||i.selectionRange.focusNode!=e.node)&&(this.forceSelection=!0),this.dom.style.height=""})),this.markedForComposition.forEach((e=>e.flags&=-9));let r=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let e of this.children)e instanceof BlockWidgetView&&e.widget instanceof BlockGapWidget&&r.push(e.dom);i.updateGaps(r)}updateChildren(e,t,n){let i=n?n.range.addToSet(e.slice()):e,r=this.childCursor(t);for(let e=i.length-1;;e--){let t=e>=0?i[e]:null;if(!t)break;let s,o,a,l,{fromA:c,toA:h,fromB:d,toB:u}=t;if(n&&n.range.fromB<u&&n.range.toB>d){let e=ContentBuilder.build(this.view.state.doc,d,n.range.fromB,this.decorations,this.dynamicDecorationMap),t=ContentBuilder.build(this.view.state.doc,n.range.toB,u,this.decorations,this.dynamicDecorationMap);o=e.breakAtStart,a=e.openStart,l=t.openEnd;let i=this.compositionView(n);t.breakAtStart?i.breakAfter=1:t.content.length&&i.merge(i.length,i.length,t.content[0],!1,t.openStart,0)&&(i.breakAfter=t.content[0].breakAfter,t.content.shift()),e.content.length&&i.merge(0,0,e.content[e.content.length-1],!0,0,e.openEnd)&&e.content.pop(),s=e.content.concat(i).concat(t.content)}else({content:s,breakAtStart:o,openStart:a,openEnd:l}=ContentBuilder.build(this.view.state.doc,d,u,this.decorations,this.dynamicDecorationMap));let{i:p,off:f}=r.findPos(h,1),{i:m,off:g}=r.findPos(c,-1);replaceRange(this,m,g,p,f,s,o,a,l)}n&&this.fixCompositionDOM(n)}compositionView(e){let t=new TextView(e.text.nodeValue);t.flags|=8;for(let{deco:n}of e.marks)t=new MarkView(n,[t],t.length);let n=new LineView;return n.append(t,0),n}fixCompositionDOM(e){let t=(e,t)=>{t.flags|=8|(t.children.some((e=>7&e.flags))?1:0),this.markedForComposition.add(t);let n=ContentView.get(e);n&&n!=t&&(n.dom=null),t.setDOM(e)},n=this.childPos(e.range.fromB,1),i=this.children[n.i];t(e.line,i);for(let r=e.marks.length-1;r>=-1;r--)n=i.childPos(n.off,1),i=i.children[n.i],t(r>=0?e.marks[r].node:e.text,i)}updateSelection(e=!1,t=!1){!e&&this.view.observer.selectionRange.focusNode||this.view.observer.readSelectionRange();let n=this.view.root.activeElement,i=n==this.dom,r=!i&&hasSelection(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(i||t||r))return;let s=this.forceSelection;this.forceSelection=!1;let o=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(o.anchor)),l=o.empty?a:this.moveToLine(this.domAtPos(o.head));if(browser.gecko&&o.empty&&!this.hasComposition&&betweenUneditable(a)){let e=document.createTextNode("");this.view.observer.ignore((()=>a.node.insertBefore(e,a.node.childNodes[a.offset]||null))),a=l=new DOMPos(e,0),s=!0}let c=this.view.observer.selectionRange;!s&&c.focusNode&&(isEquivalentPosition(a.node,a.offset,c.anchorNode,c.anchorOffset)&&isEquivalentPosition(l.node,l.offset,c.focusNode,c.focusOffset)||this.suppressWidgetCursorChange(c,o))||(this.view.observer.ignore((()=>{browser.android&&browser.chrome&&this.dom.contains(c.focusNode)&&inUneditable(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let e=getSelection(this.view.root);if(e)if(o.empty){if(browser.gecko){let e=nextToUneditable(a.node,a.offset);if(e&&3!=e){let t=nearbyTextNode(a.node,a.offset,1==e?1:-1);t&&(a=new DOMPos(t.node,t.offset))}}e.collapse(a.node,a.offset),null!=o.bidiLevel&&void 0!==e.caretBidiLevel&&(e.caretBidiLevel=o.bidiLevel)}else if(e.extend){e.collapse(a.node,a.offset);try{e.extend(l.node,l.offset)}catch(e){}}else{let t=document.createRange();o.anchor>o.head&&([a,l]=[l,a]),t.setEnd(l.node,l.offset),t.setStart(a.node,a.offset),e.removeAllRanges(),e.addRange(t)}else;r&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())})),this.view.observer.setSelectionRange(a,l)),this.impreciseAnchor=a.precise?null:new DOMPos(c.anchorNode,c.anchorOffset),this.impreciseHead=l.precise?null:new DOMPos(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&isEquivalentPosition(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=getSelection(e.root),{anchorNode:i,anchorOffset:r}=e.observer.selectionRange;if(!(n&&t.empty&&t.assoc&&n.modify))return;let s=LineView.find(this,t.head);if(!s)return;let o=s.posAtStart;if(t.head==o||t.head==o+s.length)return;let a=this.coordsAt(t.head,-1),l=this.coordsAt(t.head,1);if(!a||!l||a.bottom>l.top)return;let c=this.domAtPos(t.head+t.assoc);n.collapse(c.node,c.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=t.from&&n.collapse(i,r)}moveToLine(e){let t,n=this.dom;if(e.node!=n)return e;for(let i=e.offset;!t&&i<n.childNodes.length;i++){let e=ContentView.get(n.childNodes[i]);e instanceof LineView&&(t=e.domAtPos(0))}for(let i=e.offset-1;!t&&i>=0;i--){let e=ContentView.get(n.childNodes[i]);e instanceof LineView&&(t=e.domAtPos(e.length))}return t?new DOMPos(t.node,t.offset,!0):e}nearest(e){for(let t=e;t;){let e=ContentView.get(t);if(e&&e.rootView==this)return e;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let e=this.children[t];if(n<e.length||e instanceof LineView)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,i=0;for(let r=this.length,s=this.children.length-1;s>=0;s--){let o=this.children[s],a=r-o.breakAfter,l=a-o.length;if(a<e)break;l<=e&&(l<e||o.covers(-1))&&(a>e||o.covers(1))&&(!n||o instanceof LineView&&!(n instanceof LineView&&t>=0))&&(n=o,i=l),r=l}return n?n.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),i=this.children[t];if(!(i instanceof LineView))return null;for(;i.children.length;){let{i:e,off:t}=i.childPos(n,1);for(;;e++){if(e==i.children.length)return null;if((i=i.children[e]).length)break}n=t}if(!(i instanceof TextView))return null;let r=findClusterBreak(i.text,n);if(r==n)return null;let s=textRange(i.dom,n,r).getClientRects();for(let e=0;e<s.length;e++){let t=s[e];if(e==s.length-1||t.top<t.bottom&&t.left<t.right)return t}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:i}=e,r=this.view.contentDOM.clientWidth,s=r>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,o=-1,a=this.view.textDirection==Direction.LTR;for(let e=0,l=0;l<this.children.length;l++){let c=this.children[l],h=e+c.length;if(h>i)break;if(e>=n){let n=c.dom.getBoundingClientRect();if(t.push(n.height),s){let t=c.dom.lastChild,i=t?clientRectsFor(t):[];if(i.length){let t=i[i.length-1],s=a?t.right-n.left:n.right-t.left;s>o&&(o=s,this.minWidth=r,this.minWidthFrom=e,this.minWidthTo=h)}}}e=h+c.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return"rtl"==getComputedStyle(this.children[t].dom).direction?Direction.RTL:Direction.LTR}measureTextSize(){for(let e of this.children)if(e instanceof LineView){let t=e.measureTextSize();if(t)return t}let e,t,n,i=document.createElement("div");return i.className="cm-line",i.style.width="99999px",i.style.position="absolute",i.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore((()=>{this.dom.appendChild(i);let r=clientRectsFor(i.firstChild)[0];e=i.getBoundingClientRect().height,t=r?r.width/27:7,n=r?r.height:e,i.remove()})),{lineHeight:e,charWidth:t,textHeight:n}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new ChildCursor(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,i=0;;i++){let r=i==t.viewports.length?null:t.viewports[i],s=r?r.from-1:this.length;if(s>n){let i=(t.lineBlockAt(s).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(Decoration.replace({widget:new BlockGapWidget(i),block:!0,inclusive:!0,isBlockGap:!0}).range(n,s))}if(!r)break;n=r.to+1}return Decoration.set(e)}updateDeco(){let e=this.view.state.facet(decorations).map(((e,t)=>(this.dynamicDecorationMap[t]="function"==typeof e)?e(this.view):e)),t=!1,n=this.view.state.facet(outerDecorations).map(((e,n)=>{let i="function"==typeof e;return i&&(t=!0),i?e(this.view):e}));n.length&&(this.dynamicDecorationMap[e.length]=t,e.push(RangeSet.join(n)));for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){if(e.isSnapshot){let t=this.view.viewState.lineBlockAt(e.range.head);return this.view.scrollDOM.scrollTop=t.top-e.yMargin,void(this.view.scrollDOM.scrollLeft=e.xMargin)}let t,{range:n}=e,i=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1);if(!i)return;!n.empty&&(t=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(i={left:Math.min(i.left,t.left),top:Math.min(i.top,t.top),right:Math.max(i.right,t.right),bottom:Math.max(i.bottom,t.bottom)});let r=getScrollMargins(this.view),s={left:i.left-r.left,top:i.top-r.top,right:i.right+r.right,bottom:i.bottom+r.bottom},{offsetWidth:o,offsetHeight:a}=this.view.scrollDOM;scrollRectIntoView(this.view.scrollDOM,s,n.head<n.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,o),-o),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==Direction.LTR)}}function betweenUneditable(e){return 1==e.node.nodeType&&e.node.firstChild&&(0==e.offset||"false"==e.node.childNodes[e.offset-1].contentEditable)&&(e.offset==e.node.childNodes.length||"false"==e.node.childNodes[e.offset].contentEditable)}class BlockGapWidget extends WidgetType{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}}function findCompositionNode(e,t){let n=e.observer.selectionRange,i=n.focusNode&&nearbyTextNode(n.focusNode,n.focusOffset,0);if(!i)return null;let r=t-i.offset;return{from:r,to:r+i.node.nodeValue.length,node:i.node}}function findCompositionRange(e,t,n){let i=findCompositionNode(e,n);if(!i)return null;let{node:r,from:s,to:o}=i,a=r.nodeValue;if(/[\n\r]/.test(a))return null;if(e.state.doc.sliceString(i.from,i.to)!=a)return null;let l=t.invertedDesc,c=new ChangedRange(l.mapPos(s),l.mapPos(o),s,o),h=[];for(let t=r.parentNode;;t=t.parentNode){let n=ContentView.get(t);if(n instanceof MarkView)h.push({node:t,deco:n.mark});else{if(n instanceof LineView||"DIV"==t.nodeName&&t.parentNode==e.contentDOM)return{range:c,text:r,marks:h,line:t};if(t==e.contentDOM)return null;h.push({node:t,deco:new MarkDecoration({inclusive:!0,attributes:getAttrs$1(t),tagName:t.tagName.toLowerCase()})})}}}function nearbyTextNode(e,t,n){if(n<=0)for(let n=e,i=t;;){if(3==n.nodeType)return{node:n,offset:i};if(!(1==n.nodeType&&i>0))break;n=n.childNodes[i-1],i=maxOffset(n)}if(n>=0)for(let i=e,r=t;;){if(3==i.nodeType)return{node:i,offset:r};if(!(1==i.nodeType&&r<i.childNodes.length&&n>=0))break;i=i.childNodes[r],r=0}return null}function nextToUneditable(e,t){return 1!=e.nodeType?0:(t&&"false"==e.childNodes[t-1].contentEditable?1:0)|(t<e.childNodes.length&&"false"==e.childNodes[t].contentEditable?2:0)}let DecorationComparator$1=class{constructor(){this.changes=[]}compareRange(e,t){addRange(e,t,this.changes)}comparePoint(e,t){addRange(e,t,this.changes)}};function findChangedDeco(e,t,n){let i=new DecorationComparator$1;return RangeSet.compare(e,t,n,i),i.changes}function inUneditable(e,t){for(let n=e;n&&n!=t;n=n.assignedSlot||n.parentNode)if(1==n.nodeType&&"false"==n.contentEditable)return!0;return!1}function touchesComposition(e,t){let n=!1;return t&&e.iterChangedRanges(((e,i)=>{e<t.to&&i>t.from&&(n=!0)})),n}function groupAt(e,t,n=1){let i=e.charCategorizer(t),r=e.doc.lineAt(t),s=t-r.from;if(0==r.length)return EditorSelection.cursor(t);0==s?n=1:s==r.length&&(n=-1);let o=s,a=s;n<0?o=findClusterBreak(r.text,s,!1):a=findClusterBreak(r.text,s);let l=i(r.text.slice(o,a));for(;o>0;){let e=findClusterBreak(r.text,o,!1);if(i(r.text.slice(e,o))!=l)break;o=e}for(;a<r.length;){let e=findClusterBreak(r.text,a);if(i(r.text.slice(a,e))!=l)break;a=e}return EditorSelection.range(o+r.from,a+r.from)}function getdx(e,t){return t.left>e?t.left-e:Math.max(0,e-t.right)}function getdy(e,t){return t.top>e?t.top-e:Math.max(0,e-t.bottom)}function yOverlap(e,t){return e.top<t.bottom-1&&e.bottom>t.top+1}function upTop(e,t){return t<e.top?{top:t,left:e.left,right:e.right,bottom:e.bottom}:e}function upBot(e,t){return t>e.bottom?{top:e.top,left:e.left,right:e.right,bottom:t}:e}function domPosAtCoords(e,t,n){let i,r,s,o,a,l,c,h,d=!1;for(let u=e.firstChild;u;u=u.nextSibling){let e=clientRectsFor(u);for(let p=0;p<e.length;p++){let f=e[p];r&&yOverlap(r,f)&&(f=upTop(upBot(f,r.bottom),r.top));let m=getdx(t,f),g=getdy(n,f);if(0==m&&0==g)return 3==u.nodeType?domPosInText(u,t,n):domPosAtCoords(u,t,n);if(!i||o>g||o==g&&s>m){i=u,r=f,s=m,o=g;let a=g?n<f.top?-1:1:m?t<f.left?-1:1:0;d=!a||(a>0?p<e.length-1:p>0)}0==m?n>f.bottom&&(!c||c.bottom<f.bottom)?(a=u,c=f):n<f.top&&(!h||h.top>f.top)&&(l=u,h=f):c&&yOverlap(c,f)?c=upBot(c,f.bottom):h&&yOverlap(h,f)&&(h=upTop(h,f.top))}}if(c&&c.bottom>=n?(i=a,r=c):h&&h.top<=n&&(i=l,r=h),!i)return{node:e,offset:0};let u=Math.max(r.left,Math.min(r.right,t));return 3==i.nodeType?domPosInText(i,u,n):d&&"false"!=i.contentEditable?domPosAtCoords(i,u,n):{node:e,offset:Array.prototype.indexOf.call(e.childNodes,i)+(t>=(r.left+r.right)/2?1:0)}}function domPosInText(e,t,n){let i=e.nodeValue.length,r=-1,s=1e9,o=0;for(let a=0;a<i;a++){let i=textRange(e,a,a+1).getClientRects();for(let l=0;l<i.length;l++){let c=i[l];if(c.top==c.bottom)continue;o||(o=t-c.left);let h=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=t&&c.right+1>=t&&h<s){let n=t>=(c.left+c.right)/2,i=n;if(browser.chrome||browser.gecko){textRange(e,a).getBoundingClientRect().left==c.right&&(i=!n)}if(h<=0)return{node:e,offset:a+(i?1:0)};r=a+(i?1:0),s=h}}}return{node:e,offset:r>-1?r:o>0?e.nodeValue.length:0}}function posAtCoords(e,t,n,i=-1){var r,s;let o,a=e.contentDOM.getBoundingClientRect(),l=a.top+e.viewState.paddingTop,{docHeight:c}=e.viewState,{x:h,y:d}=t,u=d-l;if(u<0)return 0;if(u>c)return e.state.doc.length;for(let t=e.viewState.heightOracle.textHeight/2,r=!1;o=e.elementAtHeight(u),o.type!=BlockType.Text;)for(;u=i>0?o.bottom+t:o.top-t,!(u>=0&&u<=c);){if(r)return n?null:0;r=!0,i=-i}d=l+u;let p=o.from;if(p<e.viewport.from)return 0==e.viewport.from?0:n?null:posAtCoordsImprecise(e,a,o,h,d);if(p>e.viewport.to)return e.viewport.to==e.state.doc.length?e.state.doc.length:n?null:posAtCoordsImprecise(e,a,o,h,d);let f=e.dom.ownerDocument,m=e.root.elementFromPoint?e.root:f,g=m.elementFromPoint(h,d);g&&!e.contentDOM.contains(g)&&(g=null),g||(h=Math.max(a.left+1,Math.min(a.right-1,h)),g=m.elementFromPoint(h,d),g&&!e.contentDOM.contains(g)&&(g=null));let O,y=-1;if(g&&0!=(null===(r=e.docView.nearest(g))||void 0===r?void 0:r.isEditable))if(f.caretPositionFromPoint){let e=f.caretPositionFromPoint(h,d);e&&({offsetNode:O,offset:y}=e)}else if(f.caretRangeFromPoint){let t=f.caretRangeFromPoint(h,d);t&&(({startContainer:O,startOffset:y}=t),(!e.contentDOM.contains(O)||browser.safari&&isSuspiciousSafariCaretResult(O,y,h)||browser.chrome&&isSuspiciousChromeCaretResult(O,y,h))&&(O=void 0))}if(!O||!e.docView.dom.contains(O)){let t=LineView.find(e.docView,p);if(!t)return u>o.top+o.height/2?o.to:o.from;({node:O,offset:y}=domPosAtCoords(t.dom,h,d))}let v=e.docView.nearest(O);if(!v)return null;if(v.isWidget&&1==(null===(s=v.dom)||void 0===s?void 0:s.nodeType)){let e=v.dom.getBoundingClientRect();return t.y<e.top||t.y<=e.bottom&&t.x<=(e.left+e.right)/2?v.posAtStart:v.posAtEnd}return v.localPosFromDOM(O,y)+v.posAtStart}function posAtCoordsImprecise(e,t,n,i,r){let s=Math.round((i-t.left)*e.defaultCharacterWidth);if(e.lineWrapping&&n.height>1.5*e.defaultLineHeight){let t=e.viewState.heightOracle.textHeight;s+=Math.floor((r-n.top-.5*(e.defaultLineHeight-t))/t)*e.viewState.heightOracle.lineLength}let o=e.state.sliceDoc(n.from,n.to);return n.from+findColumn(o,s,e.state.tabSize)}function isSuspiciousSafariCaretResult(e,t,n){let i;if(3!=e.nodeType||t!=(i=e.nodeValue.length))return!1;for(let t=e.nextSibling;t;t=t.nextSibling)if(1!=t.nodeType||"BR"!=t.nodeName)return!1;return textRange(e,i-1,i).getBoundingClientRect().left>n}function isSuspiciousChromeCaretResult(e,t,n){if(0!=t)return!1;for(let t=e;;){let e=t.parentNode;if(!e||1!=e.nodeType||e.firstChild!=t)return!1;if(e.classList.contains("cm-line"))break;t=e}return n-(1==e.nodeType?e.getBoundingClientRect():textRange(e,0,Math.max(e.nodeValue.length,1)).getBoundingClientRect()).left>5}function blockAt(e,t){let n=e.lineBlockAt(t);if(Array.isArray(n.type))for(let e of n.type)if(e.to>t||e.to==t&&(e.to==n.to||e.type==BlockType.Text))return e;return n}function moveToLineBoundary(e,t,n,i){let r=blockAt(e,t.head),s=i&&r.type==BlockType.Text&&(e.lineWrapping||r.widgetLineBreaks)?e.coordsAtPos(t.assoc<0&&t.head>r.from?t.head-1:t.head):null;if(s){let t=e.dom.getBoundingClientRect(),i=e.textDirectionAt(r.from),o=e.posAtCoords({x:n==(i==Direction.LTR)?t.right-1:t.left+1,y:(s.top+s.bottom)/2});if(null!=o)return EditorSelection.cursor(o,n?-1:1)}return EditorSelection.cursor(n?r.to:r.from,n?-1:1)}function moveByChar(e,t,n,i){let r=e.state.doc.lineAt(t.head),s=e.bidiSpans(r),o=e.textDirectionAt(r.from);for(let a=t,l=null;;){let t=moveVisually(r,s,o,a,n),c=movedOver;if(!t){if(r.number==(n?e.state.doc.lines:1))return a;c="\n",r=e.state.doc.line(r.number+(n?1:-1)),s=e.bidiSpans(r),t=e.visualLineSide(r,!n)}if(l){if(!l(c))return a}else{if(!i)return t;l=i(c)}a=t}}function byGroup(e,t,n){let i=e.state.charCategorizer(t),r=i(n);return e=>{let t=i(e);return r==CharCategory.Space&&(r=t),r==t}}function moveVertically(e,t,n,i){let r=t.head,s=n?1:-1;if(r==(n?e.state.doc.length:0))return EditorSelection.cursor(r,t.assoc);let o,a=t.goalColumn,l=e.contentDOM.getBoundingClientRect(),c=e.coordsAtPos(r,t.assoc||-1),h=e.documentTop;if(c)null==a&&(a=c.left-l.left),o=s<0?c.top:c.bottom;else{let t=e.viewState.lineBlockAt(r);null==a&&(a=Math.min(l.right-l.left,e.defaultCharacterWidth*(r-t.from))),o=(s<0?t.top:t.bottom)+h}let d=l.left+a,u=null!=i?i:e.viewState.heightOracle.textHeight>>1;for(let t=0;;t+=10){let n=o+(u+t)*s,i=posAtCoords(e,{x:d,y:n},!1,s);if(n<l.top||n>l.bottom||(s<0?i<r:i>r)){let t=e.docView.coordsForChar(i),r=!t||n<t.top?-1:1;return EditorSelection.cursor(i,r,void 0,a)}}}function skipAtomicRanges(e,t,n){for(;;){let i=0;for(let r of e)r.between(t-1,t+1,((e,r,s)=>{if(t>e&&t<r){let s=i||n||(t-e<r-t?-1:1);t=s<0?e:r,i=s}}));if(!i)return t}}function skipAtoms(e,t,n){let i=skipAtomicRanges(e.state.facet(atomicRanges).map((t=>t(e))),n.from,t.head>n.from?-1:1);return i==n.from?n:EditorSelection.cursor(i,i<n.from?1:-1)}class InputState{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,browser.safari&&e.contentDOM.addEventListener("input",(()=>null)),browser.gecko&&firefoxCopyCutHack(e.contentDOM.ownerDocument)}handleEvent(e){eventBelongsToEditor(this.view,e)&&!this.ignoreDuringComposition(e)&&("keydown"==e.type&&this.keydown(e)||this.runHandlers(e.type,e))}runHandlers(e,t){let n=this.handlers[e];if(n){for(let e of n.observers)e(this.view,t);for(let e of n.handlers){if(t.defaultPrevented)break;if(e(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=computeHandlers(e),n=this.handlers,i=this.view.contentDOM;for(let e in t)if("scroll"!=e){let r=!t[e].handlers.length,s=n[e];s&&r!=!s.handlers.length&&(i.removeEventListener(e,this.handleEvent),s=null),s||i.addEventListener(e,this.handleEvent,{passive:r})}for(let e in n)"scroll"==e||t[e]||i.removeEventListener(e,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),9==e.keyCode&&Date.now()<this.lastEscPress+2e3)return!0;if(27!=e.keyCode&&modifierCodes.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),browser.android&&browser.chrome&&!e.synthetic&&(13==e.keyCode||8==e.keyCode))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return!browser.ios||e.synthetic||e.altKey||e.metaKey||!((t=PendingKeys.find((t=>t.keyCode==e.keyCode)))&&!e.ctrlKey||EmacsyPendingKeys.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(229!=e.keyCode&&this.view.observer.forceFlush(),!1):(this.pendingIOSKey=t||e,setTimeout((()=>this.flushIOSKey()),250),!0)}flushIOSKey(){let e=this.pendingIOSKey;return!!e&&(this.pendingIOSKey=void 0,dispatchKey(this.view.contentDOM,e.key,e.keyCode))}ignoreDuringComposition(e){return!!/^key/.test(e.type)&&(this.composing>0||!!(browser.safari&&!browser.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100)&&(this.compositionPendingKey=!1,!0))}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function bindHandler(e,t){return(n,i)=>{try{return t.call(e,i,n)}catch(e){logException(n.state,e)}}}function computeHandlers(e){let t=Object.create(null);function n(e){return t[e]||(t[e]={observers:[],handlers:[]})}for(let t of e){let e=t.spec;if(e&&e.domEventHandlers)for(let i in e.domEventHandlers){let r=e.domEventHandlers[i];r&&n(i).handlers.push(bindHandler(t.value,r))}if(e&&e.domEventObservers)for(let i in e.domEventObservers){let r=e.domEventObservers[i];r&&n(i).observers.push(bindHandler(t.value,r))}}for(let e in handlers)n(e).handlers.push(handlers[e]);for(let e in observers)n(e).observers.push(observers[e]);return t}const PendingKeys=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],EmacsyPendingKeys="dthko",modifierCodes=[16,17,18,20,91,92,224,225],dragScrollMargin=6;function dragScrollSpeed(e){return.7*Math.max(0,e)+8}function dist(e,t){return Math.max(Math.abs(e.clientX-t.clientX),Math.abs(e.clientY-t.clientY))}class MouseSelection{constructor(e,t,n,i){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=scrollableParent(e.contentDOM),this.atoms=e.state.facet(atomicRanges).map((t=>t(e)));let r=e.contentDOM.ownerDocument;r.addEventListener("mousemove",this.move=this.move.bind(this)),r.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(EditorState.allowMultipleSelections)&&addsSelectionRange(e,t),this.dragging=!(!isInPrimarySelection(e,t)||1!=getClickType(t))&&null}start(e){!1===this.dragging&&this.select(e)}move(e){var t;if(0==e.buttons)return this.destroy();if(this.dragging||null==this.dragging&&dist(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,i=0,r=(null===(t=this.scrollParent)||void 0===t?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},s=getScrollMargins(this.view);e.clientX-s.left<=r.left+dragScrollMargin?n=-dragScrollSpeed(r.left-e.clientX):e.clientX+s.right>=r.right-dragScrollMargin&&(n=dragScrollSpeed(e.clientX-r.right)),e.clientY-s.top<=r.top+dragScrollMargin?i=-dragScrollSpeed(r.top-e.clientY):e.clientY+s.bottom>=r.bottom-dragScrollMargin&&(i=dragScrollSpeed(e.clientY-r.bottom)),this.setScrollSpeed(n,i)}up(e){null==this.dragging&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval((()=>this.scroll()),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),!1===this.dragging&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let i=e.ranges[n],r=null;if(i.empty){let e=skipAtomicRanges(this.atoms,i.from,0);e!=i.from&&(r=EditorSelection.cursor(e,-1))}else{let e=skipAtomicRanges(this.atoms,i.from,-1),t=skipAtomicRanges(this.atoms,i.to,1);e==i.from&&t==i.to||(r=EditorSelection.range(i.from==i.anchor?e:t,i.from==i.head?e:t))}r&&(t||(t=e.ranges.slice()),t[n]=r)}return t?EditorSelection.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));!this.mustSelect&&n.eq(t.state.selection,!1===this.dragging)||this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout((()=>this.select(this.lastEvent)),20)}}function addsSelectionRange(e,t){let n=e.state.facet(clickAddsSelectionRange);return n.length?n[0](t):browser.mac?t.metaKey:t.ctrlKey}function dragMovesSelection(e,t){let n=e.state.facet(dragMovesSelection$1);return n.length?n[0](t):browser.mac?!t.altKey:!t.ctrlKey}function isInPrimarySelection(e,t){let{main:n}=e.state.selection;if(n.empty)return!1;let i=getSelection(e.root);if(!i||0==i.rangeCount)return!0;let r=i.getRangeAt(0).getClientRects();for(let e=0;e<r.length;e++){let n=r[e];if(n.left<=t.clientX&&n.right>=t.clientX&&n.top<=t.clientY&&n.bottom>=t.clientY)return!0}return!1}function eventBelongsToEditor(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n,i=t.target;i!=e.contentDOM;i=i.parentNode)if(!i||11==i.nodeType||(n=ContentView.get(i))&&n.ignoreEvent(t))return!1;return!0}const handlers=Object.create(null),observers=Object.create(null),brokenClipboardAPI=browser.ie&&browser.ie_version<15||browser.ios&&browser.webkit_version<604;function capturePaste(e){let t=e.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout((()=>{e.focus(),n.remove(),doPaste(e,n.value)}),50)}function doPaste(e,t){let n,{state:i}=e,r=1,s=i.toText(t),o=s.lines==i.selection.ranges.length;if(null!=lastLinewiseCopy&&i.selection.ranges.every((e=>e.empty))&&lastLinewiseCopy==s.toString()){let e=-1;n=i.changeByRange((n=>{let a=i.doc.lineAt(n.from);if(a.from==e)return{range:n};e=a.from;let l=i.toText((o?s.line(r++).text:t)+i.lineBreak);return{changes:{from:a.from,insert:l},range:EditorSelection.cursor(n.from+l.length)}}))}else n=o?i.changeByRange((e=>{let t=s.line(r++);return{changes:{from:e.from,to:e.to,insert:t.text},range:EditorSelection.cursor(e.from+t.length)}})):i.replaceSelection(s);e.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}function rangeForClick(e,t,n,i){if(1==i)return EditorSelection.cursor(t,n);if(2==i)return groupAt(e.state,t,n);{let n=LineView.find(e.docView,t),i=e.state.doc.lineAt(n?n.posAtEnd:t),r=n?n.posAtStart:i.from,s=n?n.posAtEnd:i.to;return s<e.state.doc.length&&s==i.to&&s++,EditorSelection.range(r,s)}}observers.scroll=e=>{e.inputState.lastScrollTop=e.scrollDOM.scrollTop,e.inputState.lastScrollLeft=e.scrollDOM.scrollLeft},handlers.keydown=(e,t)=>(e.inputState.setSelectionOrigin("select"),27==t.keyCode&&(e.inputState.lastEscPress=Date.now()),!1),observers.touchstart=(e,t)=>{e.inputState.lastTouchTime=Date.now(),e.inputState.setSelectionOrigin("select.pointer")},observers.touchmove=e=>{e.inputState.setSelectionOrigin("select.pointer")},handlers.mousedown=(e,t)=>{if(e.observer.flush(),e.inputState.lastTouchTime>Date.now()-2e3)return!1;let n=null;for(let i of e.state.facet(mouseSelectionStyle))if(n=i(e,t),n)break;if(n||0!=t.button||(n=basicMouseSelection(e,t)),n){let i=!e.hasFocus;e.inputState.startMouseSelection(new MouseSelection(e,t,n,i)),i&&e.observer.ignore((()=>focusPreventScroll(e.contentDOM)));let r=e.inputState.mouseSelection;if(r)return r.start(t),!1===r.dragging}return!1};let insideY=(e,t)=>e>=t.top&&e<=t.bottom,inside=(e,t,n)=>insideY(t,n)&&e>=n.left&&e<=n.right;function findPositionSide(e,t,n,i){let r=LineView.find(e.docView,t);if(!r)return 1;let s=t-r.posAtStart;if(0==s)return 1;if(s==r.length)return-1;let o=r.coordsAt(s,-1);if(o&&inside(n,i,o))return-1;let a=r.coordsAt(s,1);return a&&inside(n,i,a)?1:o&&insideY(i,o)?-1:1}function queryPos(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:n,bias:findPositionSide(e,n,t.clientX,t.clientY)}}const BadMouseDetail=browser.ie&&browser.ie_version<=11;let lastMouseDown=null,lastMouseDownCount=0,lastMouseDownTime=0;function getClickType(e){if(!BadMouseDetail)return e.detail;let t=lastMouseDown,n=lastMouseDownTime;return lastMouseDown=e,lastMouseDownTime=Date.now(),lastMouseDownCount=!t||n>Date.now()-400&&Math.abs(t.clientX-e.clientX)<2&&Math.abs(t.clientY-e.clientY)<2?(lastMouseDownCount+1)%3:1}function basicMouseSelection(e,t){let n=queryPos(e,t),i=getClickType(t),r=e.state.selection;return{update(e){e.docChanged&&(n.pos=e.changes.mapPos(n.pos),r=r.map(e.changes))},get(t,s,o){let a,l=queryPos(e,t),c=rangeForClick(e,l.pos,l.bias,i);if(n.pos!=l.pos&&!s){let t=rangeForClick(e,n.pos,n.bias,i),r=Math.min(t.from,c.from),s=Math.max(t.to,c.to);c=r<c.from?EditorSelection.range(r,s):EditorSelection.range(s,r)}return s?r.replaceRange(r.main.extend(c.from,c.to)):o&&1==i&&r.ranges.length>1&&(a=removeRangeAround(r,l.pos))?a:o?r.addRange(c):EditorSelection.create([c])}}}function removeRangeAround(e,t){for(let n=0;n<e.ranges.length;n++){let{from:i,to:r}=e.ranges[n];if(i<=t&&r>=t)return EditorSelection.create(e.ranges.slice(0,n).concat(e.ranges.slice(n+1)),e.mainIndex==n?0:e.mainIndex-(e.mainIndex>n?1:0))}return null}function dropText(e,t,n,i){if(!n)return;let r=e.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:s}=e.inputState,o=i&&s&&dragMovesSelection(e,t)?{from:s.from,to:s.to}:null,a={from:r,insert:n},l=e.state.changes(o?[o,a]:a);e.focus(),e.dispatch({changes:l,selection:{anchor:l.mapPos(r,-1),head:l.mapPos(r,1)},userEvent:o?"move.drop":"input.drop"}),e.inputState.draggedContent=null}function captureCopy(e,t){let n=e.dom.parentNode;if(!n)return;let i=n.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout((()=>{i.remove(),e.focus()}),50)}function copiedRange(e){let t=[],n=[],i=!1;for(let i of e.selection.ranges)i.empty||(t.push(e.sliceDoc(i.from,i.to)),n.push(i));if(!t.length){let r=-1;for(let{from:i}of e.selection.ranges){let s=e.doc.lineAt(i);s.number>r&&(t.push(s.text),n.push({from:s.from,to:Math.min(e.doc.length,s.to+1)})),r=s.number}i=!0}return{text:t.join(e.lineBreak),ranges:n,linewise:i}}handlers.dragstart=(e,t)=>{let{selection:{main:n}}=e.state;if(t.target.draggable){let i=e.docView.nearest(t.target);if(i&&i.isWidget){let e=i.posAtStart,t=e+i.length;(e>=n.to||t<=n.from)&&(n=EditorSelection.range(e,t))}}let{inputState:i}=e;return i.mouseSelection&&(i.mouseSelection.dragging=!0),i.draggedContent=n,t.dataTransfer&&(t.dataTransfer.setData("Text",e.state.sliceDoc(n.from,n.to)),t.dataTransfer.effectAllowed="copyMove"),!1},handlers.dragend=e=>(e.inputState.draggedContent=null,!1),handlers.drop=(e,t)=>{if(!t.dataTransfer)return!1;if(e.state.readOnly)return!0;let n=t.dataTransfer.files;if(n&&n.length){let i=Array(n.length),r=0,s=()=>{++r==n.length&&dropText(e,t,i.filter((e=>null!=e)).join(e.state.lineBreak),!1)};for(let e=0;e<n.length;e++){let t=new FileReader;t.onerror=s,t.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(t.result)||(i[e]=t.result),s()},t.readAsText(n[e])}return!0}{let n=t.dataTransfer.getData("Text");if(n)return dropText(e,t,n,!0),!0}return!1},handlers.paste=(e,t)=>{if(e.state.readOnly)return!0;e.observer.flush();let n=brokenClipboardAPI?null:t.clipboardData;return n?(doPaste(e,n.getData("text/plain")||n.getData("text/uri-text")),!0):(capturePaste(e),!1)};let lastLinewiseCopy=null;handlers.copy=handlers.cut=(e,t)=>{let{text:n,ranges:i,linewise:r}=copiedRange(e.state);if(!n&&!r)return!1;lastLinewiseCopy=r?n:null,"cut"!=t.type||e.state.readOnly||e.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"});let s=brokenClipboardAPI?null:t.clipboardData;return s?(s.clearData(),s.setData("text/plain",n),!0):(captureCopy(e,n),!1)};const isFocusChange=Annotation.define();function focusChangeTransaction(e,t){let n=[];for(let i of e.facet(focusChangeEffect)){let r=i(e,t);r&&n.push(r)}return n?e.update({effects:n,annotations:isFocusChange.of(!0)}):null}function updateForFocusChange(e){setTimeout((()=>{let t=e.hasFocus;if(t!=e.inputState.notifiedFocused){let n=focusChangeTransaction(e.state,t);n?e.dispatch(n):e.update([])}}),10)}observers.focus=e=>{e.inputState.lastFocusTime=Date.now(),e.scrollDOM.scrollTop||!e.inputState.lastScrollTop&&!e.inputState.lastScrollLeft||(e.scrollDOM.scrollTop=e.inputState.lastScrollTop,e.scrollDOM.scrollLeft=e.inputState.lastScrollLeft),updateForFocusChange(e)},observers.blur=e=>{e.observer.clearSelectionRange(),updateForFocusChange(e)},observers.compositionstart=observers.compositionupdate=e=>{null==e.inputState.compositionFirstChange&&(e.inputState.compositionFirstChange=!0),e.inputState.composing<0&&(e.inputState.composing=0)},observers.compositionend=e=>{e.inputState.composing=-1,e.inputState.compositionEndedAt=Date.now(),e.inputState.compositionPendingKey=!0,e.inputState.compositionPendingChange=e.observer.pendingRecords().length>0,e.inputState.compositionFirstChange=null,browser.chrome&&browser.android?e.observer.flushSoon():e.inputState.compositionPendingChange?Promise.resolve().then((()=>e.observer.flush())):setTimeout((()=>{e.inputState.composing<0&&e.docView.hasComposition&&e.update([])}),50)},observers.contextmenu=e=>{e.inputState.lastContextMenu=Date.now()},handlers.beforeinput=(e,t)=>{var n;let i;if(browser.chrome&&browser.android&&(i=PendingKeys.find((e=>e.inputType==t.inputType)))&&(e.observer.delayAndroidKey(i.key,i.keyCode),"Backspace"==i.key||"Delete"==i.key)){let t=(null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0;setTimeout((()=>{var n;((null===(n=window.visualViewport)||void 0===n?void 0:n.height)||0)>t+10&&e.hasFocus&&(e.contentDOM.blur(),e.focus())}),100)}return!1};const appliedFirefoxHack=new Set;function firefoxCopyCutHack(e){appliedFirefoxHack.has(e)||(appliedFirefoxHack.add(e),e.addEventListener("copy",(()=>{})),e.addEventListener("cut",(()=>{})))}const wrappingWhiteSpace=["pre-wrap","normal","pre-line","break-spaces"];class HeightOracle{constructor(e){this.lineWrapping=e,this.doc=Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){if(!this.lineWrapping)return this.lineHeight;return(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return wrappingWhiteSpace.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let i=e[n];i<0?n++:this.heightSamples[Math.floor(10*i)]||(t=!0,this.heightSamples[Math.floor(10*i)]=!0)}return t}refresh(e,t,n,i,r,s){let o=wrappingWhiteSpace.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=o;if(this.lineWrapping=o,this.lineHeight=t,this.charWidth=n,this.textHeight=i,this.lineLength=r,a){this.heightSamples={};for(let e=0;e<s.length;e++){let t=s[e];t<0?e++:this.heightSamples[Math.floor(10*t)]=!0}}return a}}class MeasuredHeights{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class BlockInfo{constructor(e,t,n,i,r){this.from=e,this.length=t,this.top=n,this.height=i,this._content=r}get type(){return"number"==typeof this._content?BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof PointDecoration?this._content.widget:null}get widgetLineBreaks(){return"number"==typeof this._content?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new BlockInfo(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var QueryType$1=function(e){return e[e.ByPos=0]="ByPos",e[e.ByHeight=1]="ByHeight",e[e.ByPosNoHeight=2]="ByPosNoHeight",e}(QueryType$1||(QueryType$1={}));const Epsilon=.001;class HeightMap{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(2&this.flags)>0}set outdated(e){this.flags=(e?2:0)|-3&this.flags}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>Epsilon&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return HeightMap.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,i){let r=this,s=n.doc;for(let o=i.length-1;o>=0;o--){let{fromA:a,toA:l,fromB:c,toB:h}=i[o],d=r.lineAt(a,QueryType$1.ByPosNoHeight,n.setDoc(t),0,0),u=d.to>=l?d:r.lineAt(l,QueryType$1.ByPosNoHeight,n,0,0);for(h+=u.to-l,l=u.to;o>0&&d.from<=i[o-1].toA;)a=i[o-1].fromA,c=i[o-1].fromB,o--,a<d.from&&(d=r.lineAt(a,QueryType$1.ByPosNoHeight,n,0,0));c+=d.from-a,a=d.from;let p=NodeBuilder.build(n.setDoc(s),e,c,h);r=r.replace(a,l,p)}return r.updateHeight(n,0)}static empty(){return new HeightMapText(0,0)}static of(e){if(1==e.length)return e[0];let t=0,n=e.length,i=0,r=0;for(;;)if(t==n)if(i>2*r){let r=e[t-1];r.break?e.splice(--t,1,r.left,null,r.right):e.splice(--t,1,r.left,r.right),n+=1+r.break,i-=r.size}else{if(!(r>2*i))break;{let t=e[n];t.break?e.splice(n,1,t.left,null,t.right):e.splice(n,1,t.left,t.right),n+=2+t.break,r-=t.size}}else if(i<r){let n=e[t++];n&&(i+=n.size)}else{let t=e[--n];t&&(r+=t.size)}let s=0;return null==e[t-1]?(s=1,t--):null==e[t]&&(s=1,n++),new HeightMapBranch(HeightMap.of(e.slice(0,t)),s,HeightMap.of(e.slice(n)))}}HeightMap.prototype.size=1;class HeightMapBlock extends HeightMap{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,i){return new BlockInfo(i,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,i,r){return this.blockAt(0,n,i,r)}forEachLine(e,t,n,i,r,s){e<=r+this.length&&t>=r&&s(this.blockAt(0,n,i,r))}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(e,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class HeightMapText extends HeightMapBlock{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,i){return new BlockInfo(i,this.length,n,this.height,this.breaks)}replace(e,t,n){let i=n[0];return 1==n.length&&(i instanceof HeightMapText||i instanceof HeightMapGap&&4&i.flags)&&Math.abs(this.length-i.length)<10?(i instanceof HeightMapGap?i=new HeightMapText(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):HeightMap.of(n)}updateHeight(e,t=0,n=!1,i){return i&&i.from<=t&&i.more?this.setHeight(e,i.heights[i.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class HeightMapGap extends HeightMap{constructor(e){super(e,0)}heightMetrics(e,t){let n,i=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,s=r-i+1,o=0;if(e.lineWrapping){let t=Math.min(this.height,e.lineHeight*s);n=t/s,this.length>s+1&&(o=(this.height-t)/(this.length-s-1))}else n=this.height/s;return{firstLine:i,lastLine:r,perLine:n,perChar:o}}blockAt(e,t,n,i){let{firstLine:r,lastLine:s,perLine:o,perChar:a}=this.heightMetrics(t,i);if(t.lineWrapping){let r=i+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),s=t.doc.lineAt(r),l=o+s.length*a,c=Math.max(n,e-l/2);return new BlockInfo(s.from,s.length,c,l,0)}{let i=Math.max(0,Math.min(s-r,Math.floor((e-n)/o))),{from:a,length:l}=t.doc.line(r+i);return new BlockInfo(a,l,n+o*i,o,0)}}lineAt(e,t,n,i,r){if(t==QueryType$1.ByHeight)return this.blockAt(e,n,i,r);if(t==QueryType$1.ByPosNoHeight){let{from:t,to:i}=n.doc.lineAt(e);return new BlockInfo(t,i-t,0,0,0)}let{firstLine:s,perLine:o,perChar:a}=this.heightMetrics(n,r),l=n.doc.lineAt(e),c=o+l.length*a,h=l.number-s,d=i+o*h+a*(l.from-r-h);return new BlockInfo(l.from,l.length,Math.max(i,Math.min(d,i+this.height-c)),c,0)}forEachLine(e,t,n,i,r,s){e=Math.max(e,r),t=Math.min(t,r+this.length);let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,r);for(let c=e,h=i;c<=t;){let t=n.doc.lineAt(c);if(c==e){let n=t.number-o;h+=a*n+l*(e-r-n)}let i=a+l*t.length;s(new BlockInfo(t.from,t.length,h,i,0)),h+=i,c=t.to+1}}replace(e,t,n){let i=this.length-t;if(i>0){let e=n[n.length-1];e instanceof HeightMapGap?n[n.length-1]=new HeightMapGap(e.length+i):n.push(null,new HeightMapGap(i-1))}if(e>0){let t=n[0];t instanceof HeightMapGap?n[0]=new HeightMapGap(e+t.length):n.unshift(new HeightMapGap(e-1),null)}return HeightMap.of(n)}decomposeLeft(e,t){t.push(new HeightMapGap(e-1),null)}decomposeRight(e,t){t.push(null,new HeightMapGap(this.length-e-1))}updateHeight(e,t=0,n=!1,i){let r=t+this.length;if(i&&i.from<=t+this.length&&i.more){let n=[],s=Math.max(t,i.from),o=-1;for(i.from>t&&n.push(new HeightMapGap(i.from-t-1).updateHeight(e,t));s<=r&&i.more;){let t=e.doc.lineAt(s).length;n.length&&n.push(null);let r=i.heights[i.index++];-1==o?o=r:Math.abs(r-o)>=Epsilon&&(o=-2);let a=new HeightMapText(t,r);a.outdated=!1,n.push(a),s+=t+1}s<=r&&n.push(null,new HeightMapGap(r-s).updateHeight(e,s));let a=HeightMap.of(n);return(o<0||Math.abs(a.height-this.height)>=Epsilon||Math.abs(o-this.heightMetrics(e,t).perLine)>=Epsilon)&&(e.heightChanged=!0),a}return(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1),this}toString(){return`gap(${this.length})`}}class HeightMapBranch extends HeightMap{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return 1&this.flags}blockAt(e,t,n,i){let r=n+this.left.height;return e<r?this.left.blockAt(e,t,n,i):this.right.blockAt(e,t,r,i+this.left.length+this.break)}lineAt(e,t,n,i,r){let s=i+this.left.height,o=r+this.left.length+this.break,a=t==QueryType$1.ByHeight?e<s:e<o,l=a?this.left.lineAt(e,t,n,i,r):this.right.lineAt(e,t,n,s,o);if(this.break||(a?l.to<o:l.from>o))return l;let c=t==QueryType$1.ByPosNoHeight?QueryType$1.ByPosNoHeight:QueryType$1.ByPos;return a?l.join(this.right.lineAt(o,c,n,s,o)):this.left.lineAt(o,c,n,i,r).join(l)}forEachLine(e,t,n,i,r,s){let o=i+this.left.height,a=r+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,n,i,r,s),t>=a&&this.right.forEachLine(e,t,n,o,a,s);else{let l=this.lineAt(a,QueryType$1.ByPos,n,i,r);e<l.from&&this.left.forEachLine(e,l.from-1,n,i,r,s),l.to>=e&&l.from<=t&&s(l),t>l.to&&this.right.forEachLine(l.to+1,t,n,o,a,s)}}replace(e,t,n){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,n));let r=[];e>0&&this.decomposeLeft(e,r);let s=r.length;for(let e of n)r.push(e);if(e>0&&mergeGaps(r,s-1),t<this.length){let e=r.length;this.decomposeRight(t,r),mergeGaps(r,e)}return HeightMap.of(r)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,i=n+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?HeightMap.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,i){let{left:r,right:s}=this,o=t+r.length+this.break,a=null;return i&&i.from<=t+r.length&&i.more?a=r=r.updateHeight(e,t,n,i):r.updateHeight(e,t,n),i&&i.from<=o+s.length&&i.more?a=s=s.updateHeight(e,o,n,i):s.updateHeight(e,o,n),a?this.balanced(r,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function mergeGaps(e,t){let n,i;null==e[t]&&(n=e[t-1])instanceof HeightMapGap&&(i=e[t+1])instanceof HeightMapGap&&e.splice(t-1,3,new HeightMapGap(n.length+1+i.length))}const relevantWidgetHeight=5;class NodeBuilder{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let e=Math.min(t,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof HeightMapText?n.length+=e-this.pos:(e>this.pos||!this.isCovered)&&this.nodes.push(new HeightMapText(e-this.pos,-1)),this.writtenTo=e,t>e&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let i=n.widget?n.widget.estimatedHeight:0,r=n.widget?n.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let s=t-e;n.block?this.addBlock(new HeightMapBlock(s,i,n)):(s||r||i>=relevantWidgetHeight)&&this.addLineDeco(i,r,s)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||null==this.nodes[this.nodes.length-1])&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new HeightMapText(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new HeightMapGap(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof HeightMapText)return e;let t=new HeightMapText(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let i=this.ensureLine();i.length+=n,i.collapsed+=n,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=0==this.nodes.length?null:this.nodes[this.nodes.length-1];!(this.lineStart>-1)||t instanceof HeightMapText||this.isCovered?(this.writtenTo<this.pos||null==t)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos)):this.nodes.push(new HeightMapText(0,-1));let n=e;for(let e of this.nodes)e instanceof HeightMapText&&e.updateHeight(this.oracle,n),n+=e?e.length:1;return this.nodes}static build(e,t,n,i){let r=new NodeBuilder(n,e);return RangeSet.spans(t,n,i,r,0),r.finish(n)}}function heightRelevantDecoChanges(e,t,n){let i=new DecorationComparator;return RangeSet.compare(e,t,n,i,0),i.changes}class DecorationComparator{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,i){(e<t||n&&n.heightRelevant||i&&i.heightRelevant)&&addRange(e,t,this.changes,5)}}function visiblePixelRange(e,t){let n=e.getBoundingClientRect(),i=e.ownerDocument,r=i.defaultView||window,s=Math.max(0,n.left),o=Math.min(r.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(r.innerHeight,n.bottom);for(let t=e.parentNode;t&&t!=i.body;)if(1==t.nodeType){let n=t,i=window.getComputedStyle(n);if((n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)&&"visible"!=i.overflow){let i=n.getBoundingClientRect();s=Math.max(s,i.left),o=Math.min(o,i.right),a=Math.max(a,i.top),l=t==e.parentNode?i.bottom:Math.min(l,i.bottom)}t="absolute"==i.position||"fixed"==i.position?n.offsetParent:n.parentNode}else{if(11!=t.nodeType)break;t=t.host}return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+t),bottom:Math.max(a,l)-(n.top+t)}}function fullPixelRange(e,t){let n=e.getBoundingClientRect();return{left:0,right:n.right-n.left,top:t,bottom:n.bottom-(n.top+t)}}class LineGap{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let i=e[n],r=t[n];if(i.from!=r.from||i.to!=r.to||i.size!=r.size)return!1}return!0}draw(e,t){return Decoration.replace({widget:new LineGapWidget(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class LineGapWidget extends WidgetType{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ViewState{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=IdScaler,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(contentAttributes).some((e=>"function"!=typeof e&&"cm-lineWrapping"==e.class));this.heightOracle=new HeightOracle(t),this.stateDeco=e.facet(decorations).filter((e=>"function"!=typeof e)),this.heightMap=HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle.setDoc(e.doc),[new ChangedRange(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Decoration.set(this.lineGaps.map((e=>e.draw(this,!1)))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let i=n?t.head:t.anchor;if(!e.some((({from:e,to:t})=>i>=e&&i<=t))){let{from:t,to:n}=this.lineBlockAt(i);e.push(new Viewport(t,n))}}this.viewports=e.sort(((e,t)=>e.from-t.from)),this.scaler=this.heightMap.height<=7e6?IdScaler:new BigScaler(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,(e=>{this.viewportLines.push(1==this.scaler.scale?e:scaleBlock(e,this.scaler))}))}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(decorations).filter((e=>"function"!=typeof e));let i=e.changedRanges,r=ChangedRange.extendWithRanges(i,heightRelevantDecoChanges(n,this.stateDeco,e?e.changes:ChangeSet.empty(this.state.doc.length))),s=this.heightMap.height,o=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),r),this.heightMap.height!=s&&(e.flags|=2),o?(this.scrollAnchorPos=e.changes.mapPos(o.from,-1),this.scrollAnchorHeight=o.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=r.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let l=!e.changes.empty||2&e.flags||a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,this.updateForViewport(),l&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(nativeSelectionHidden)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),i=this.heightOracle,r=n.whiteSpace;this.defaultTextDirection="rtl"==n.direction?Direction.RTL:Direction.LTR;let s=this.heightOracle.mustRefreshForWrapping(r),o=t.getBoundingClientRect(),a=s||this.mustMeasureContent||this.contentDOMHeight!=o.height;this.contentDOMHeight=o.height,this.mustMeasureContent=!1;let l=0,c=0;if(o.width&&o.height){let{scaleX:e,scaleY:n}=getScale(t,o);this.scaleX==e&&this.scaleY==n||(this.scaleX=e,this.scaleY=n,l|=8,s=a=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,d=(parseInt(n.paddingBottom)||0)*this.scaleY;this.paddingTop==h&&this.paddingBottom==d||(this.paddingTop=h,this.paddingBottom=d,l|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,l|=8);let u=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=u&&(this.scrollAnchorHeight=-1,this.scrollTop=u),this.scrolledToBottom=isScrolledToBottom(e.scrollDOM);let p=(this.printing?fullPixelRange:visiblePixelRange)(t,this.paddingTop),f=p.top-this.pixelViewport.top,m=p.bottom-this.pixelViewport.bottom;this.pixelViewport=p;let g=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(g!=this.inView&&(this.inView=g,g&&(a=!0)),!this.inView&&!this.scrollTarget)return 0;let O=o.width;if(this.contentDOMWidth==O&&this.editorHeight==e.scrollDOM.clientHeight||(this.contentDOMWidth=o.width,this.editorHeight=e.scrollDOM.clientHeight,l|=8),a){let t=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(t)&&(s=!0),s||i.lineWrapping&&Math.abs(O-this.contentDOMWidth)>i.charWidth){let{lineHeight:n,charWidth:o,textHeight:a}=e.docView.measureTextSize();s=n>0&&i.refresh(r,n,o,a,O/o,t),s&&(e.docView.minWidth=0,l|=8)}f>0&&m>0?c=Math.max(f,m):f<0&&m<0&&(c=Math.min(f,m)),i.heightChanged=!1;for(let n of this.viewports){let r=n.from==this.viewport.from?t:e.docView.measureVisibleLineHeights(n);this.heightMap=(s?HeightMap.empty().applyChanges(this.stateDeco,Text.empty,this.heightOracle,[new ChangedRange(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,s,new MeasuredHeights(n.from,r))}i.heightChanged&&(l|=2)}let y=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return y&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(2&l||y)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,e)),l|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),l}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,r=this.heightOracle,{visibleTop:s,visibleBottom:o}=this,a=new Viewport(i.lineAt(s-1e3*n,QueryType$1.ByHeight,r,0,0).from,i.lineAt(o+1e3*(1-n),QueryType$1.ByHeight,r,0,0).to);if(t){let{head:e}=t.range;if(e<a.from||e>a.to){let n,s=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),o=i.lineAt(e,QueryType$1.ByPos,r,0,0);n="center"==t.y?(o.top+o.bottom)/2-s/2:"start"==t.y||"nearest"==t.y&&e<a.from?o.top:o.bottom-s,a=new Viewport(i.lineAt(n-500,QueryType$1.ByHeight,r,0,0).from,i.lineAt(n+s+500,QueryType$1.ByHeight,r,0,0).to)}}return a}mapViewport(e,t){let n=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new Viewport(this.heightMap.lineAt(n,QueryType$1.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,QueryType$1.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),{bottom:r}=this.heightMap.lineAt(t,QueryType$1.ByPos,this.heightOracle,0,0),{visibleTop:s,visibleBottom:o}=this;return(0==e||i<=s-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||r>=o+Math.max(10,Math.min(n,250)))&&i>s-2e3&&r<o+2e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let i of e)t.touchesRange(i.from,i.to)||n.push(new LineGap(t.mapPos(i.from),t.mapPos(i.to),i.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,i=n?1e4:2e3,r=i>>1,s=i<<1;if(this.defaultTextDirection!=Direction.LTR&&!n)return[];let o=[],a=(i,s,l,c)=>{if(s-i<r)return;let h=this.state.selection.main,d=[h.from];h.empty||d.push(h.to);for(let e of d)if(e>i&&e<s)return a(i,e-10,l,c),void a(e+10,s,l,c);let u=find(e,(e=>e.from>=l.from&&e.to<=l.to&&Math.abs(e.from-i)<r&&Math.abs(e.to-s)<r&&!d.some((t=>e.from<t&&e.to>t))));if(!u){if(s<l.to&&t&&n&&t.visibleRanges.some((e=>e.from<=s&&e.to>=s))){let e=t.moveToLineBoundary(EditorSelection.cursor(s),!1,!0).head;e>i&&(s=e)}u=new LineGap(i,s,this.gapSize(l,i,s,c))}o.push(u)};for(let e of this.viewportLines){if(e.length<s)continue;let t=lineStructure(e.from,e.to,this.stateDeco);if(t.total<s)continue;let r,o,l=this.scrollTarget?this.scrollTarget.range.head:null;if(n){let n,s,a=i/this.heightOracle.lineLength*this.heightOracle.lineHeight;if(null!=l){let i=findFraction(t,l),r=((this.visibleBottom-this.visibleTop)/2+a)/e.height;n=i-r,s=i+r}else n=(this.visibleTop-e.top-a)/e.height,s=(this.visibleBottom-e.top+a)/e.height;r=findPosition(t,n),o=findPosition(t,s)}else{let e,n,s=t.total*this.heightOracle.charWidth,a=i*this.heightOracle.charWidth;if(null!=l){let i=findFraction(t,l),r=((this.pixelViewport.right-this.pixelViewport.left)/2+a)/s;e=i-r,n=i+r}else e=(this.pixelViewport.left-a)/s,n=(this.pixelViewport.right+a)/s;r=findPosition(t,e),o=findPosition(t,n)}r>e.from&&a(e.from,r,e,t),o<e.to&&a(o,e.to,e,t)}return o}gapSize(e,t,n,i){let r=findFraction(i,n)-findFraction(i,t);return this.heightOracle.lineWrapping?e.height*r:i.total*this.heightOracle.charWidth*r}updateLineGaps(e){LineGap.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Decoration.set(e.map((e=>e.draw(this,this.heightOracle.lineWrapping)))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];RangeSet.spans(e,this.viewport.from,this.viewport.to,{span(e,n){t.push({from:e,to:n})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some(((e,n)=>e.from!=t[n].from||e.to!=t[n].to));return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find((t=>t.from<=e&&t.to>=e))||scaleBlock(this.heightMap.lineAt(e,QueryType$1.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return scaleBlock(this.heightMap.lineAt(this.scaler.fromDOM(e),QueryType$1.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return scaleBlock(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Viewport{constructor(e,t){this.from=e,this.to=t}}function lineStructure(e,t,n){let i=[],r=e,s=0;return RangeSet.spans(n,e,t,{span(){},point(e,t){e>r&&(i.push({from:r,to:e}),s+=e-r),r=t}},20),r<t&&(i.push({from:r,to:t}),s+=t-r),{total:s,ranges:i}}function findPosition({total:e,ranges:t},n){if(n<=0)return t[0].from;if(n>=1)return t[t.length-1].to;let i=Math.floor(e*n);for(let e=0;;e++){let{from:n,to:r}=t[e],s=r-n;if(i<=s)return n+i;i-=s}}function findFraction(e,t){let n=0;for(let{from:i,to:r}of e.ranges){if(t<=r){n+=t-i;break}n+=r-i}return n/e.total}function find(e,t){for(let n of e)if(t(n))return n}const IdScaler={toDOM:e=>e,fromDOM:e=>e,scale:1};class BigScaler{constructor(e,t,n){let i=0,r=0,s=0;this.viewports=n.map((({from:n,to:r})=>{let s=t.lineAt(n,QueryType$1.ByPos,e,0,0).top,o=t.lineAt(r,QueryType$1.ByPos,e,0,0).bottom;return i+=o-s,{from:n,to:r,top:s,bottom:o,domTop:0,domBottom:0}})),this.scale=(7e6-i)/(t.height-i);for(let e of this.viewports)e.domTop=s+(e.top-r)*this.scale,s=e.domBottom=e.domTop+(e.bottom-e.top),r=e.bottom}toDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.top)return i+(e-n)*this.scale;if(e<=r.bottom)return r.domTop+(e-r.top);n=r.bottom,i=r.domBottom}}fromDOM(e){for(let t=0,n=0,i=0;;t++){let r=t<this.viewports.length?this.viewports[t]:null;if(!r||e<r.domTop)return n+(e-i)/this.scale;if(e<=r.domBottom)return r.top+(e-r.domTop);n=r.bottom,i=r.domBottom}}}function scaleBlock(e,t){if(1==t.scale)return e;let n=t.toDOM(e.top),i=t.toDOM(e.bottom);return new BlockInfo(e.from,e.length,n,i-n,Array.isArray(e._content)?e._content.map((e=>scaleBlock(e,t))):e._content)}const theme=Facet.define({combine:e=>e.join(" ")}),darkTheme=Facet.define({combine:e=>e.indexOf(!0)>-1}),baseThemeID=StyleModule.newName(),baseLightID=StyleModule.newName(),baseDarkID=StyleModule.newName(),lightDarkIDs={"&light":"."+baseLightID,"&dark":"."+baseDarkID};function buildTheme(e,t,n){return new StyleModule(t,{finish:t=>/&/.test(t)?t.replace(/&\w*/,(t=>{if("&"==t)return e;if(!n||!n[t])throw new RangeError(`Unsupported selector: ${t}`);return n[t]})):e+" "+t})}const baseTheme$1$3=buildTheme("."+baseThemeID,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:'url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>\')',backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},lightDarkIDs),LineBreakPlaceholder="";class DOMReader{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(EditorState.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=LineBreakPlaceholder}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let i=e;;){this.findPointBefore(n,i);let e=this.text.length;this.readNode(i);let r=i.nextSibling;if(r==t)break;let s=ContentView.get(i),o=ContentView.get(r);(s&&o?s.breakAfter:(s?s.breakAfter:isBlockElement(i))||isBlockElement(r)&&("BR"!=i.nodeName||i.cmIgnore)&&this.text.length>e)&&this.lineBreak(),i=r}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let r,s=-1,o=1;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(r=i.exec(t))&&(s=r.index,o=r[0].length),this.append(t.slice(n,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let t of this.points)t.node==e&&t.pos>this.text.length&&(t.pos-=o-1);n=s+o}}readNode(e){if(e.cmIgnore)return;let t=ContentView.get(e),n=t&&t.overrideDOMText;if(null!=n){this.findPointInside(e,n.length);for(let e=n.iter();!e.next().done;)e.lineBreak?this.lineBreak():this.append(e.value)}else 3==e.nodeType?this.readTextNode(e):"BR"==e.nodeName?e.nextSibling&&this.lineBreak():1==e.nodeType&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(3==e.nodeType?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(isAtEnd(e,n.node,n.offset)?t:0))}}function isAtEnd(e,t,n){for(;;){if(!t||n<maxOffset(t))return!1;if(t==e)return!0;n=domIndex(t)+1,t=t.parentNode}}function isBlockElement(e){return 1==e.nodeType&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(e.nodeName)}class DOMPoint{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class DOMChange{constructor(e,t,n,i){this.typeOver=i,this.bounds=null,this.text="";let{impreciseHead:r,impreciseAnchor:s}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let t=r||s?[]:selectionPoints(e),n=new DOMReader(t,e.state);n.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=n.text,this.newSel=selectionFromPoints(t,this.bounds.from)}else{let t=e.observer.selectionRange,n=r&&r.node==t.focusNode&&r.offset==t.focusOffset||!contains(e.contentDOM,t.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(t.focusNode,t.focusOffset),i=s&&s.node==t.anchorNode&&s.offset==t.anchorOffset||!contains(e.contentDOM,t.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(t.anchorNode,t.anchorOffset),o=e.viewport;if(browser.ios&&e.state.selection.main.empty&&n!=i&&(o.from>0||o.to<e.state.doc.length)){let t=o.from-Math.min(n,i),r=o.to-Math.max(n,i);0!=t&&1!=t||0!=r&&-1!=r||(n=0,i=e.state.doc.length)}this.newSel=EditorSelection.single(i,n)}}}function applyDOMChange(e,t){let n,{newSel:i}=t,r=e.state.selection.main,s=e.inputState.lastKeyTime>Date.now()-100?e.inputState.lastKeyCode:-1;if(t.bounds){let{from:i,to:o}=t.bounds,a=r.from,l=null;(8===s||browser.android&&t.text.length<o-i)&&(a=r.to,l="end");let c=findDiff(e.state.doc.sliceString(i,o,LineBreakPlaceholder),t.text,a-i,l);c&&(browser.chrome&&13==s&&c.toB==c.from+2&&t.text.slice(c.from,c.toB)==LineBreakPlaceholder+LineBreakPlaceholder&&c.toB--,n={from:i+c.from,to:i+c.toA,insert:Text.of(t.text.slice(c.from,c.toB).split(LineBreakPlaceholder))})}else i&&(!e.hasFocus&&e.state.facet(editable)||i.main.eq(r))&&(i=null);if(!n&&!i)return!1;if(!n&&t.typeOver&&!r.empty&&i&&i.main.empty?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,r.to)}:n&&n.from>=r.from&&n.to<=r.to&&(n.from!=r.from||n.to!=r.to)&&r.to-r.from-(n.to-n.from)<=4?n={from:r.from,to:r.to,insert:e.state.doc.slice(r.from,n.from).append(n.insert).append(e.state.doc.slice(n.to,r.to))}:(browser.mac||browser.android)&&n&&n.from==n.to&&n.from==r.head-1&&/^\. ?$/.test(n.insert.toString())&&"off"==e.contentDOM.getAttribute("autocorrect")?(i&&2==n.insert.length&&(i=EditorSelection.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:Text.of([" "])}):browser.chrome&&n&&n.from==n.to&&n.from==r.head&&"\n "==n.insert.toString()&&e.lineWrapping&&(i&&(i=EditorSelection.single(i.main.anchor-1,i.main.head-1)),n={from:r.from,to:r.to,insert:Text.of([" "])}),n){if(browser.ios&&e.inputState.flushIOSKey())return!0;if(browser.android&&(n.from==r.from&&n.to==r.to&&1==n.insert.length&&2==n.insert.lines&&dispatchKey(e.contentDOM,"Enter",13)||(n.from==r.from-1&&n.to==r.to&&0==n.insert.length||8==s&&n.insert.length<n.to-n.from&&n.to>r.head)&&dispatchKey(e.contentDOM,"Backspace",8)||n.from==r.from&&n.to==r.to+1&&0==n.insert.length&&dispatchKey(e.contentDOM,"Delete",46)))return!0;let t,o=n.insert.toString();e.inputState.composing>=0&&e.inputState.composing++;let a=()=>t||(t=applyDefaultInsert(e,n,i));return e.state.facet(inputHandler$1).some((t=>t(e,n.from,n.to,o,a)))||e.dispatch(a()),!0}if(i&&!i.main.eq(r)){let t=!1,n="select";return e.inputState.lastSelectionTime>Date.now()-50&&("select"==e.inputState.lastSelectionOrigin&&(t=!0),n=e.inputState.lastSelectionOrigin),e.dispatch({selection:i,scrollIntoView:t,userEvent:n}),!0}return!1}function applyDefaultInsert(e,t,n){let i,r=e.state,s=r.selection.main;if(t.from>=s.from&&t.to<=s.to&&t.to-t.from>=(s.to-s.from)/3&&(!n||n.main.empty&&n.main.from==t.from+t.insert.length)&&e.inputState.composing<0){let n=s.from<t.from?r.sliceDoc(s.from,t.from):"",o=s.to>t.to?r.sliceDoc(t.to,s.to):"";i=r.replaceSelection(e.state.toText(n+t.insert.sliceString(0,void 0,e.state.lineBreak)+o))}else{let o=r.changes(t),a=n&&n.main.to<=o.newLength?n.main:void 0;if(r.selection.ranges.length>1&&e.inputState.composing>=0&&t.to<=s.to&&t.to>=s.to-10){let l,c=e.state.sliceDoc(t.from,t.to),h=n&&findCompositionNode(e,n.main.head);if(h){let e=t.insert.length-(t.to-t.from);l={from:h.from,to:h.to-e}}else l=e.state.doc.lineAt(s.head);let d=s.to-t.to,u=s.to-s.from;i=r.changeByRange((n=>{if(n.from==s.from&&n.to==s.to)return{changes:o,range:a||n.map(o)};let i=n.to-d,h=i-c.length;if(n.to-n.from!=u||e.state.sliceDoc(h,i)!=c||n.to>=l.from&&n.from<=l.to)return{range:n};let p=r.changes({from:h,to:i,insert:t.insert}),f=n.to-s.to;return{changes:p,range:a?EditorSelection.range(Math.max(0,a.anchor+f),Math.max(0,a.head+f)):n.map(p)}}))}else i={changes:o,selection:a&&r.selection.replaceRange(a)}}let o="input.type";return(e.composing||e.inputState.compositionPendingChange&&e.inputState.compositionEndedAt>Date.now()-50)&&(e.inputState.compositionPendingChange=!1,o+=".compose",e.inputState.compositionFirstChange&&(o+=".start",e.inputState.compositionFirstChange=!1)),r.update(i,{userEvent:o,scrollIntoView:!0})}function findDiff(e,t,n,i){let r=Math.min(e.length,t.length),s=0;for(;s<r&&e.charCodeAt(s)==t.charCodeAt(s);)s++;if(s==r&&e.length==t.length)return null;let o=e.length,a=t.length;for(;o>0&&a>0&&e.charCodeAt(o-1)==t.charCodeAt(a-1);)o--,a--;if("end"==i){n-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.length<t.length){s-=n<=s&&n>=o?s-n:0,a=s+(a-o),o=s}else if(a<s){s-=n<=s&&n>=a?s-n:0,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function selectionPoints(e){let t=[];if(e.root.activeElement!=e.contentDOM)return t;let{anchorNode:n,anchorOffset:i,focusNode:r,focusOffset:s}=e.observer.selectionRange;return n&&(t.push(new DOMPoint(n,i)),r==n&&s==i||t.push(new DOMPoint(r,s))),t}function selectionFromPoints(e,t){if(0==e.length)return null;let n=e[0].pos,i=2==e.length?e[1].pos:n;return n>-1&&i>-1?EditorSelection.single(n+t,i+t):null}const observeOptions={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},useCharData=browser.ie&&browser.ie_version<=11;class DOMObserver{constructor(e){this.view=e,this.active=!1,this.selectionRange=new DOMSelectionState,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver((t=>{for(let e of t)this.queue.push(e);(browser.ie&&browser.ie_version<=11||browser.ios&&e.composing)&&t.some((e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length))?this.flushSoon():this.flush()})),useCharData&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),"function"==typeof ResizeObserver&&(this.resizeScroll=new ResizeObserver((()=>{var e;(null===(e=this.view.docView)||void 0===e?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()})),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),"function"==typeof IntersectionObserver&&(this.intersection=new IntersectionObserver((e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))}),{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver((e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))}),{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout((()=>{this.resizeTimeout=-1,this.view.requestMeasure()}),50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout((()=>{this.view.viewState.printing=!1,this.view.requestMeasure()}),500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some(((t,n)=>t!=e[n])))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,i=this.selectionRange;if(n.state.facet(editable)?n.root.activeElement!=this.dom:!hasSelection(n.dom,i))return;let r=i.anchorNode&&n.docView.nearest(i.anchorNode);r&&r.ignoreEvent(e)?t||(this.selectionChanged=!1):(browser.ie&&browser.ie_version<=11||browser.android&&browser.chrome)&&!n.state.selection.main.empty&&i.focusNode&&isEquivalentPosition(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=browser.safari&&11==e.root.nodeType&&deepActiveElement(this.dom.ownerDocument)==this.dom&&safariSelectionRangeHack(this.view)||getSelection(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=hasSelection(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&atElementStart(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(1==n.nodeType)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else{if(11!=n.nodeType)break;n=n.host}if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);for(let e of this.scrollTargets=t)e.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,observeOptions),useCharData&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),useCharData&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let e=()=>{let e=this.delayedAndroidKey;if(e){this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=e.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&e.force&&dispatchKey(this.dom,e.key,e.keyCode)}};this.flushingAndroidKey=this.view.win.requestAnimationFrame(e)}this.delayedAndroidKey&&"Enter"!=e||(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(null===(n=this.delayedAndroidKey)||void 0===n?void 0:n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame((()=>{this.delayedFlush=-1,this.flush()})))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,i=!1;for(let r of e){let e=this.readMutation(r);e&&(e.typeOver&&(i=!0),-1==t?({from:t,to:n}=e):(t=Math.min(e.from,t),n=Math.max(e.to,n)))}return{from:t,to:n,typeOver:i}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),i=this.selectionChanged&&hasSelection(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let r=new DOMChange(this.view,e,t,n);return this.view.docView.domChanged={newSel:r.newSel?r.newSel.main:null},r}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,i=applyDOMChange(this.view,t);return this.view.state==n&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty("attributes"==e.type),"attributes"==e.type&&(t.flags|=4),"childList"==e.type){let n=findChild(t,e.previousSibling||e.target.previousSibling,-1),i=findChild(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}return"characterData"==e.type?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n;this.stop(),null===(e=this.intersection)||void 0===e||e.disconnect(),null===(t=this.gapIntersection)||void 0===t||t.disconnect(),null===(n=this.resizeScroll)||void 0===n||n.disconnect();for(let e of this.scrollTargets)e.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function findChild(e,t,n){for(;t;){let i=ContentView.get(t);if(i&&i.parent==e)return i;let r=t.parentNode;t=r!=e.dom?r:n>0?t.nextSibling:t.previousSibling}return null}function safariSelectionRangeHack(e){let t=null;function n(e){e.preventDefault(),e.stopImmediatePropagation(),t=e.getTargetRanges()[0]}if(e.contentDOM.addEventListener("beforeinput",n,!0),e.dom.ownerDocument.execCommand("indent"),e.contentDOM.removeEventListener("beforeinput",n,!0),!t)return null;let i=t.startContainer,r=t.startOffset,s=t.endContainer,o=t.endOffset,a=e.docView.domAtPos(e.state.selection.main.anchor);return isEquivalentPosition(a.node,a.offset,s,o)&&([i,r,s,o]=[s,o,i,r]),{anchorNode:i,anchorOffset:r,focusNode:s,focusOffset:o}}class EditorView{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(e=>e.forEach((e=>t(e,this))))||(e=>this.update(e)),this.dispatch=this.dispatch.bind(this),this._root=e.root||getRoot(e.parent)||document,this.viewState=new ViewState(e.state||EditorState.create(e)),e.scrollTo&&e.scrollTo.is(scrollIntoView$1)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(viewPlugin).map((e=>new PluginInstance(e)));for(let e of this.plugins)e.update(this);this.observer=new DOMObserver(this),this.inputState=new InputState(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DocView(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let t=1==e.length&&e[0]instanceof Transaction?e:1==e.length&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(0!=this.updateState)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t,n=!1,i=!1,r=this.state;for(let t of e){if(t.startState!=r)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");r=t.state}if(this.destroyed)return void(this.viewState.state=r);let s=this.hasFocus,o=0,a=null;e.some((e=>e.annotation(isFocusChange)))?(this.inputState.notifiedFocused=s,o=1):s!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=s,a=focusChangeTransaction(r,s),a||(o=1));let l=this.observer.delayedAndroidKey,c=null;if(l?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(r.doc)||!this.state.selection.eq(r.selection))&&(c=null)):this.observer.clear(),r.facet(EditorState.phrases)!=this.state.facet(EditorState.phrases))return this.setState(r);t=ViewUpdate.create(this,r,e),t.flags|=o;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let t of e){if(h&&(h=h.map(t.changes)),t.scrollIntoView){let{main:e}=t.state.selection;h=new ScrollTarget(e.empty?e:EditorSelection.cursor(e.head,e.head>e.anchor?-1:1))}for(let e of t.effects)e.is(scrollIntoView$1)&&(h=e.value.clip(this.state))}this.viewState.update(t,h),this.bidiCache=CachedOrder.update(this.bidiCache,t.changes),t.empty||(this.updatePlugins(t),this.inputState.update(t)),n=this.docView.update(t),this.state.facet(styleModule)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some((e=>e.isUserEvent("select.pointer"))))}finally{this.updateState=0}if(t.startState.facet(theme)!=t.state.facet(theme)&&(this.viewState.mustMeasureContent=!0),(n||i||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!t.empty)for(let e of this.state.facet(updateListener))try{e(t)}catch(e){logException(this.state,e,"update listener")}(a||c)&&Promise.resolve().then((()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!applyDOMChange(this,c)&&l.force&&dispatchKey(this.contentDOM,l.key,l.keyCode)}))}setState(e){if(0!=this.updateState)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed)return void(this.viewState.state=e);this.updateState=2;let t=this.hasFocus;try{for(let e of this.plugins)e.destroy(this);this.viewState=new ViewState(e),this.plugins=e.facet(viewPlugin).map((e=>new PluginInstance(e))),this.pluginMap.clear();for(let e of this.plugins)e.update(this);this.docView.destroy(),this.docView=new DocView(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(viewPlugin),n=e.state.facet(viewPlugin);if(t!=n){let i=[];for(let r of n){let n=t.indexOf(r);if(n<0)i.push(new PluginInstance(r));else{let t=this.plugins[n];t.mustUpdate=e,i.push(t)}}for(let t of this.plugins)t.mustUpdate!=e&&t.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let t of this.plugins)t.mustUpdate=e;for(let e=0;e<this.plugins.length;e++)this.plugins[e].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey)return this.measureScheduled=-1,void this.requestMeasure();this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,i=n.scrollTop*this.scaleY,{scrollAnchorPos:r,scrollAnchorHeight:s}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(s=-1),this.viewState.scrollAnchorHeight=-1;try{for(let e=0;;e++){if(s<0)if(isScrolledToBottom(n))r=-1,s=this.viewState.heightMap.height;else{let e=this.viewState.scrollAnchorAt(i);r=e.from,s=e.top}this.updateState=1;let o=this.viewState.measure(this);if(!o&&!this.measureRequests.length&&null==this.viewState.scrollTarget)break;if(e>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let a=[];4&o||([this.measureRequests,a]=[a,this.measureRequests]);let l=a.map((e=>{try{return e.read(this)}catch(e){return logException(this.state,e),BadMeasure}})),c=ViewUpdate.create(this,this.state,[]),h=!1;c.flags|=o,t?t.flags|=o:t=c,this.updateState=2,c.empty||(this.updatePlugins(c),this.inputState.update(c),this.updateAttrs(),h=this.docView.update(c));for(let e=0;e<a.length;e++)if(l[e]!=BadMeasure)try{let t=a[e];t.write&&t.write(l[e],this)}catch(e){logException(this.state,e)}if(h&&this.docView.updateSelection(!0),!c.viewportChanged&&0==this.measureRequests.length){if(this.viewState.editorHeight){if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,s=-1;continue}{let e=(r<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(r).top)-s;if(e>1||e<-1){i+=e,n.scrollTop=i/this.scaleY,s=-1;continue}}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let e of this.state.facet(updateListener))e(t)}get themeClasses(){return baseThemeID+" "+(this.state.facet(darkTheme)?baseDarkID:baseLightID)+" "+this.state.facet(theme)}updateAttrs(){let e=attrsFromFacet(this,editorAttributes,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(editable)?"true":"false",class:"cm-content",style:`${browser.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),attrsFromFacet(this,contentAttributes,t);let n=this.observer.ignore((()=>{let n=updateAttrs(this.contentDOM,this.contentAttrs,t),i=updateAttrs(this.dom,this.editorAttrs,e);return n||i}));return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let e of n.effects)if(e.is(EditorView.announce)){t&&(this.announceDOM.textContent=""),t=!1,this.announceDOM.appendChild(document.createElement("div")).textContent=e.value}}mountStyles(){this.styleModules=this.state.facet(styleModule);let e=this.state.facet(EditorView.cspNonce);StyleModule.mount(this.root,this.styleModules.concat(baseTheme$1$3).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(2==this.updateState)throw new Error("Reading the editor layout isn't allowed during an update");0==this.updateState&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame((()=>this.measure()))),e){if(this.measureRequests.indexOf(e)>-1)return;if(null!=e.key)for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key)return void(this.measureRequests[t]=e);this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(void 0===t||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find((t=>t.spec==e))||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return skipAtoms(this,e,moveByChar(this,e,t,n))}moveByGroup(e,t){return skipAtoms(this,e,moveByChar(this,e,t,(t=>byGroup(this,e.head,t))))}visualLineSide(e,t){let n=this.bidiSpans(e),i=this.textDirectionAt(e.from),r=n[t?n.length-1:0];return EditorSelection.cursor(r.side(t,i)+e.from,r.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,n=!0){return moveToLineBoundary(this,e,t,n)}moveVertically(e,t,n){return skipAtoms(this,e,moveVertically(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),posAtCoords(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let i=this.state.doc.lineAt(e),r=this.bidiSpans(i);return flattenRect(n,r[BidiSpan.find(r,e-i.from,-1,t)].dir==Direction.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(perLineTextDirection)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>MaxBidiLine)return trivialOrder(e.length);let t,n=this.textDirectionAt(e.from);for(let i of this.bidiCache)if(i.from==e.from&&i.dir==n&&(i.fresh||isolatesEq(i.isolates,t=getIsolatedRanges(this,e))))return i.order;t||(t=getIsolatedRanges(this,e));let i=computeOrder(e.text,n,t);return this.bidiCache.push(new CachedOrder(e.from,e.to,n,t,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||browser.safari&&(null===(e=this.inputState)||void 0===e?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore((()=>{focusPreventScroll(this.contentDOM),this.docView.updateSelection()}))}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((9==e.nodeType?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return scrollIntoView$1.of(new ScrollTarget("number"==typeof e?EditorSelection.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return scrollIntoView$1.of(new ScrollTarget(EditorSelection.cursor(n.from),"start","start",n.top-e,t,!0))}static domEventHandlers(e){return ViewPlugin.define((()=>({})),{eventHandlers:e})}static domEventObservers(e){return ViewPlugin.define((()=>({})),{eventObservers:e})}static theme(e,t){let n=StyleModule.newName(),i=[theme.of(n),styleModule.of(buildTheme(`.${n}`,e))];return t&&t.dark&&i.push(darkTheme.of(!0)),i}static baseTheme(e){return Prec.lowest(styleModule.of(buildTheme("."+baseThemeID,e,lightDarkIDs)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),i=n&&ContentView.get(n)||ContentView.get(e);return(null===(t=null==i?void 0:i.rootView)||void 0===t?void 0:t.view)||null}}EditorView.styleModule=styleModule,EditorView.inputHandler=inputHandler$1,EditorView.focusChangeEffect=focusChangeEffect,EditorView.perLineTextDirection=perLineTextDirection,EditorView.exceptionSink=exceptionSink,EditorView.updateListener=updateListener,EditorView.editable=editable,EditorView.mouseSelectionStyle=mouseSelectionStyle,EditorView.dragMovesSelection=dragMovesSelection$1,EditorView.clickAddsSelectionRange=clickAddsSelectionRange,EditorView.decorations=decorations,EditorView.outerDecorations=outerDecorations,EditorView.atomicRanges=atomicRanges,EditorView.bidiIsolatedRanges=bidiIsolatedRanges,EditorView.scrollMargins=scrollMargins,EditorView.darkTheme=darkTheme,EditorView.cspNonce=Facet.define({combine:e=>e.length?e[0]:""}),EditorView.contentAttributes=contentAttributes,EditorView.editorAttributes=editorAttributes,EditorView.lineWrapping=EditorView.contentAttributes.of({class:"cm-lineWrapping"}),EditorView.announce=StateEffect.define();const MaxBidiLine=4096,BadMeasure={};class CachedOrder{constructor(e,t,n,i,r,s){this.from=e,this.to=t,this.dir=n,this.isolates=i,this.fresh=r,this.order=s}static update(e,t){if(t.empty&&!e.some((e=>e.fresh)))return e;let n=[],i=e.length?e[e.length-1].dir:Direction.LTR;for(let r=Math.max(0,e.length-10);r<e.length;r++){let s=e[r];s.dir!=i||t.touchesRange(s.from,s.to)||n.push(new CachedOrder(t.mapPos(s.from,1),t.mapPos(s.to,-1),s.dir,s.isolates,!1,s.order))}return n}}function attrsFromFacet(e,t,n){for(let i=e.state.facet(t),r=i.length-1;r>=0;r--){let t=i[r],s="function"==typeof t?t(e):t;s&&combineAttrs(s,n)}return n}const currentPlatform=browser.mac?"mac":browser.windows?"win":browser.linux?"linux":"key";function normalizeKeyName(e,t){const n=e.split(/-(?!$)/);let i,r,s,o,a=n[n.length-1];"Space"==a&&(a=" ");for(let e=0;e<n.length-1;++e){const a=n[e];if(/^(cmd|meta|m)$/i.test(a))o=!0;else if(/^a(lt)?$/i.test(a))i=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))s=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);"mac"==t?o=!0:r=!0}}return i&&(a="Alt-"+a),r&&(a="Ctrl-"+a),o&&(a="Meta-"+a),s&&(a="Shift-"+a),a}function modifiers(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}const handleKeyEvents=Prec.default(EditorView.domEventHandlers({keydown:(e,t)=>runHandlers(getKeymap(t.state),e,t,"editor")})),keymap=Facet.define({enables:handleKeyEvents}),Keymaps=new WeakMap;function getKeymap(e){let t=e.facet(keymap),n=Keymaps.get(t);return n||Keymaps.set(t,n=buildKeymap(t.reduce(((e,t)=>e.concat(t)),[]))),n}function runScopeHandlers(e,t,n){return runHandlers(getKeymap(e.state),t,e,n)}let storedPrefix=null;const PrefixTimeout=4e3;function buildKeymap(e,t=currentPlatform){let n=Object.create(null),i=Object.create(null),r=(e,t)=>{let n=i[e];if(null==n)i[e]=t;else if(n!=t)throw new Error("Key binding "+e+" is used both as a regular binding and as a multi-stroke prefix")},s=(e,i,s,o,a)=>{var l,c;let h=n[e]||(n[e]=Object.create(null)),d=i.split(/ (?!$)/).map((e=>normalizeKeyName(e,t)));for(let t=1;t<d.length;t++){let n=d.slice(0,t).join(" ");r(n,!0),h[n]||(h[n]={preventDefault:!0,stopPropagation:!1,run:[t=>{let i=storedPrefix={view:t,prefix:n,scope:e};return setTimeout((()=>{storedPrefix==i&&(storedPrefix=null)}),PrefixTimeout),!0}]})}let u=d.join(" ");r(u,!1);let p=h[u]||(h[u]={preventDefault:!1,stopPropagation:!1,run:(null===(c=null===(l=h._any)||void 0===l?void 0:l.run)||void 0===c?void 0:c.slice())||[]});s&&p.run.push(s),o&&(p.preventDefault=!0),a&&(p.stopPropagation=!0)};for(let i of e){let e=i.scope?i.scope.split(" "):["editor"];if(i.any)for(let t of e){let e=n[t]||(n[t]=Object.create(null));e._any||(e._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let t in e)e[t].run.push(i.any)}let r=i[t]||i.key;if(r)for(let t of e)s(t,r,i.run,i.preventDefault,i.stopPropagation),i.shift&&s(t,"Shift-"+r,i.shift,i.preventDefault,i.stopPropagation)}return n}function runHandlers(e,t,n,i){let r=keyName(t),s=codePointSize(codePointAt(r,0))==r.length&&" "!=r,o="",a=!1,l=!1,c=!1;storedPrefix&&storedPrefix.view==n&&storedPrefix.scope==i&&(o=storedPrefix.prefix+" ",modifierCodes.indexOf(t.keyCode)<0&&(l=!0,storedPrefix=null));let h,d,u=new Set,p=e=>{if(e){for(let i of e.run)if(!u.has(i)&&(u.add(i),i(n,t)))return e.stopPropagation&&(c=!0),!0;e.preventDefault&&(e.stopPropagation&&(c=!0),l=!0)}return!1},f=e[i];return f&&(p(f[o+modifiers(r,t,!s)])?a=!0:s&&(t.altKey||t.metaKey||t.ctrlKey)&&!(browser.windows&&t.ctrlKey&&t.altKey)&&(h=base[t.keyCode])&&h!=r?(p(f[o+modifiers(h,t,!0)])||t.shiftKey&&(d=shift[t.keyCode])!=r&&d!=h&&p(f[o+modifiers(d,t,!1)]))&&(a=!0):s&&t.shiftKey&&p(f[o+modifiers(r,t,!0)])&&(a=!0),!a&&p(f._any)&&(a=!0)),l&&(a=!0),a&&c&&t.stopPropagation(),a}class RectangleMarker{constructor(e,t,n,i,r){this.className=e,this.left=t,this.top=n,this.width=i,this.height=r}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className==this.className&&(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",null!=this.width&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let i=e.coordsAtPos(n.head,n.assoc||1);if(!i)return[];let r=getBase(e);return[new RectangleMarker(t,i.left-r.left,i.top-r.top,null,i.bottom-i.top)]}return rectanglesForRange(e,t,n)}}function getBase(e){let t=e.scrollDOM.getBoundingClientRect();return{left:(e.textDirection==Direction.LTR?t.left:t.right-e.scrollDOM.clientWidth*e.scaleX)-e.scrollDOM.scrollLeft*e.scaleX,top:t.top-e.scrollDOM.scrollTop*e.scaleY}}function wrappedLine(e,t,n){let i=EditorSelection.cursor(t);return{from:Math.max(n.from,e.moveToLineBoundary(i,!1,!0).from),to:Math.min(n.to,e.moveToLineBoundary(i,!0,!0).from),type:BlockType.Text}}function rectanglesForRange(e,t,n){if(n.to<=e.viewport.from||n.from>=e.viewport.to)return[];let i=Math.max(n.from,e.viewport.from),r=Math.min(n.to,e.viewport.to),s=e.textDirection==Direction.LTR,o=e.contentDOM,a=o.getBoundingClientRect(),l=getBase(e),c=o.querySelector(".cm-line"),h=c&&window.getComputedStyle(c),d=a.left+(h?parseInt(h.paddingLeft)+Math.min(0,parseInt(h.textIndent)):0),u=a.right-(h?parseInt(h.paddingRight):0),p=blockAt(e,i),f=blockAt(e,r),m=p.type==BlockType.Text?p:null,g=f.type==BlockType.Text?f:null;if(m&&(e.lineWrapping||p.widgetLineBreaks)&&(m=wrappedLine(e,i,m)),g&&(e.lineWrapping||f.widgetLineBreaks)&&(g=wrappedLine(e,r,g)),m&&g&&m.from==g.from)return y(v(n.from,n.to,m));{let t=m?v(n.from,null,m):b(p,!1),i=g?v(null,n.to,g):b(f,!0),r=[];return(m||p).to<(g||f).from-(m&&g?1:0)||p.widgetLineBreaks>1&&t.bottom+e.defaultLineHeight/2<i.top?r.push(O(d,t.bottom,u,i.top)):t.bottom<i.top&&e.elementAtHeight((t.bottom+i.top)/2).type==BlockType.Text&&(t.bottom=i.top=(t.bottom+i.top)/2),y(t).concat(r).concat(y(i))}function O(e,n,i,r){return new RectangleMarker(t,e-l.left,n-l.top-.01,i-e,r-n+.01)}function y({top:e,bottom:t,horizontal:n}){let i=[];for(let r=0;r<n.length;r+=2)i.push(O(n[r],e,n[r+1],t));return i}function v(t,n,i){let r=1e9,o=-1e9,a=[];function l(t,n,l,c,h){let p=e.coordsAtPos(t,t==i.to?-2:2),f=e.coordsAtPos(l,l==i.from?2:-2);p&&f&&(r=Math.min(p.top,f.top,r),o=Math.max(p.bottom,f.bottom,o),h==Direction.LTR?a.push(s&&n?d:p.left,s&&c?u:f.right):a.push(!s&&c?d:f.left,!s&&n?u:p.right))}let c=null!=t?t:i.from,h=null!=n?n:i.to;for(let i of e.visibleRanges)if(i.to>c&&i.from<h)for(let r=Math.max(i.from,c),s=Math.min(i.to,h);;){let i=e.state.doc.lineAt(r);for(let o of e.bidiSpans(i)){let e=o.from+i.from,a=o.to+i.from;if(e>=s)break;a>r&&l(Math.max(e,r),null==t&&e<=c,Math.min(a,s),null==n&&a>=h,o.dir)}if(r=i.to+1,r>=s)break}return 0==a.length&&l(c,null==t,h,null==n,e.textDirection),{top:r,bottom:o,horizontal:a}}function b(e,t){let n=a.top+(t?e.top:e.bottom);return{top:n,bottom:n,horizontal:[]}}}function sameMarker(e,t){return e.constructor==t.constructor&&e.eq(t)}class LayerView{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(layerOrder)!=e.state.facet(layerOrder)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}setOrder(e){let t=0,n=e.facet(layerOrder);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;e==this.scaleX&&t==this.scaleY||(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some(((e,t)=>!sameMarker(e,this.drawn[t])))){let t=this.dom.firstChild,n=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[n].constructor&&i.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(i.draw(),t);for(;t;){let e=t.nextSibling;t.remove(),t=e}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const layerOrder=Facet.define();function layer(e){return[ViewPlugin.define((t=>new LayerView(t,e))),layerOrder.of(e)]}const CanHidePrimary=!browser.ios,selectionConfig=Facet.define({combine:e=>combineConfig(e,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})});function drawSelection(e={}){return[selectionConfig.of(e),cursorLayer,selectionLayer,hideNativeSelection,nativeSelectionHidden.of(!0)]}function configChanged(e){return e.startState.facet(selectionConfig)!=e.state.facet(selectionConfig)}const cursorLayer=layer({above:!0,markers(e){let{state:t}=e,n=t.facet(selectionConfig),i=[];for(let r of t.selection.ranges){let s=r==t.selection.main;if(r.empty?!s||CanHidePrimary:n.drawRangeCursor){let t=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",n=r.empty?r:EditorSelection.cursor(r.head,r.head>r.anchor?-1:1);for(let r of RectangleMarker.forRange(e,t,n))i.push(r)}}return i},update(e,t){e.transactions.some((e=>e.selection))&&(t.style.animationName="cm-blink"==t.style.animationName?"cm-blink2":"cm-blink");let n=configChanged(e);return n&&setBlinkRate(e.state,t),e.docChanged||e.selectionSet||n},mount(e,t){setBlinkRate(t.state,e)},class:"cm-cursorLayer"});function setBlinkRate(e,t){t.style.animationDuration=e.facet(selectionConfig).cursorBlinkRate+"ms"}const selectionLayer=layer({above:!1,markers:e=>e.state.selection.ranges.map((t=>t.empty?[]:RectangleMarker.forRange(e,"cm-selectionBackground",t))).reduce(((e,t)=>e.concat(t))),update:(e,t)=>e.docChanged||e.selectionSet||e.viewportChanged||configChanged(e),class:"cm-selectionLayer"}),themeSpec={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};CanHidePrimary&&(themeSpec[".cm-line"].caretColor="transparent !important",themeSpec[".cm-content"]={caretColor:"transparent !important"});const hideNativeSelection=Prec.highest(EditorView.theme(themeSpec)),setDropCursorPos=StateEffect.define({map:(e,t)=>null==e?null:t.mapPos(e)}),dropCursorPos=StateField.define({create:()=>null,update:(e,t)=>(null!=e&&(e=t.changes.mapPos(e)),t.effects.reduce(((e,t)=>t.is(setDropCursorPos)?t.value:e),e))}),drawDropCursor=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(e){var t;let n=e.state.field(dropCursorPos);null==n?null!=this.cursor&&(null===(t=this.cursor)||void 0===t||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(e.startState.field(dropCursorPos)!=n||e.docChanged||e.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:e}=this,t=e.state.field(dropCursorPos),n=null!=t&&e.coordsAtPos(t);if(!n)return null;let i=e.scrollDOM.getBoundingClientRect();return{left:n.left-i.left+e.scrollDOM.scrollLeft*e.scaleX,top:n.top-i.top+e.scrollDOM.scrollTop*e.scaleY,height:n.bottom-n.top}}drawCursor(e){if(this.cursor){let{scaleX:t,scaleY:n}=this.view;e?(this.cursor.style.left=e.left/t+"px",this.cursor.style.top=e.top/n+"px",this.cursor.style.height=e.height/n+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(e){this.view.state.field(dropCursorPos)!=e&&this.view.dispatch({effects:setDropCursorPos.of(e)})}},{eventObservers:{dragover(e){this.setDropPos(this.view.posAtCoords({x:e.clientX,y:e.clientY}))},dragleave(e){e.target!=this.view.contentDOM&&this.view.contentDOM.contains(e.relatedTarget)||this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function dropCursor(){return[dropCursorPos,drawDropCursor]}function iterMatches(e,t,n,i,r){t.lastIndex=0;for(let s,o=e.iterRange(n,i),a=n;!o.next().done;a+=o.value.length)if(!o.lineBreak)for(;s=t.exec(o.value);)r(a+s.index,s)}function matchRanges(e,t){let n=e.visibleRanges;if(1==n.length&&n[0].from==e.viewport.from&&n[0].to==e.viewport.to)return n;let i=[];for(let{from:r,to:s}of n)r=Math.max(e.state.doc.lineAt(r).from,r-t),s=Math.min(e.state.doc.lineAt(s).to,s+t),i.length&&i[i.length-1].to>=r?i[i.length-1].to=s:i.push({from:r,to:s});return i}class MatchDecorator{constructor(e){const{regexp:t,decoration:n,decorate:i,boundary:r,maxLength:s=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(e,t,n,r)=>i(r,n,n+e[0].length,e,t);else if("function"==typeof n)this.addMatch=(e,t,i,r)=>{let s=n(e,t,i);s&&r(i,i+e[0].length,s)};else{if(!n)throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.addMatch=(e,t,i,r)=>r(i,i+e[0].length,n)}this.boundary=r,this.maxLength=s}createDeco(e){let t=new RangeSetBuilder,n=t.add.bind(t);for(let{from:t,to:i}of matchRanges(e,this.maxLength))iterMatches(e.state.doc,this.regexp,t,i,((t,i)=>this.addMatch(i,e,t,n)));return t.finish()}updateDeco(e,t){let n=1e9,i=-1;return e.docChanged&&e.changes.iterChanges(((t,r,s,o)=>{o>e.view.viewport.from&&s<e.view.viewport.to&&(n=Math.min(s,n),i=Math.max(o,i))})),e.viewportChanged||i-n>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),n,i):t}updateRange(e,t,n,i){for(let r of e.visibleRanges){let s=Math.max(r.from,n),o=Math.min(r.to,i);if(o>s){let n=e.state.doc.lineAt(s),i=n.to<o?e.state.doc.lineAt(o):n,a=Math.max(r.from,n.from),l=Math.min(r.to,i.to);if(this.boundary){for(;s>n.from;s--)if(this.boundary.test(n.text[s-1-n.from])){a=s;break}for(;o<i.to;o++)if(this.boundary.test(i.text[o-i.from])){l=o;break}}let c,h=[],d=(e,t,n)=>h.push(n.range(e,t));if(n==i)for(this.regexp.lastIndex=a-n.from;(c=this.regexp.exec(n.text))&&c.index<l-n.from;)this.addMatch(c,e,c.index+n.from,d);else iterMatches(e.state.doc,this.regexp,a,l,((t,n)=>this.addMatch(n,e,t,d)));t=t.update({filterFrom:a,filterTo:l,filter:(e,t)=>e<a||t>l,add:h})}}return t}}const UnicodeRegexpSupport=null!=/x/.unicode?"gu":"g",Specials=new RegExp("[\0-\b\n--\u2028\u2029\ufeff-]",UnicodeRegexpSupport),Names={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let _supportsTabSize=null;function supportsTabSize(){var e;if(null==_supportsTabSize&&"undefined"!=typeof document&&document.body){let t=document.body.style;_supportsTabSize=null!=(null!==(e=t.tabSize)&&void 0!==e?e:t.MozTabSize)}return _supportsTabSize||!1}const specialCharConfig=Facet.define({combine(e){let t=combineConfig(e,{render:null,specialChars:Specials,addSpecialChars:null});return(t.replaceTabs=!supportsTabSize())&&(t.specialChars=new RegExp("\t|"+t.specialChars.source,UnicodeRegexpSupport)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,UnicodeRegexpSupport)),t}});function highlightSpecialChars(e={}){return[specialCharConfig.of(e),specialCharPlugin()]}let _plugin=null;function specialCharPlugin(){return _plugin||(_plugin=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.decorations=Decoration.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(e.state.facet(specialCharConfig)),this.decorations=this.decorator.createDeco(e)}makeDecorator(e){return new MatchDecorator({regexp:e.specialChars,decoration:(t,n,i)=>{let{doc:r}=n.state,s=codePointAt(t[0],0);if(9==s){let e=r.lineAt(i),t=n.state.tabSize,s=countColumn(e.text,t,i-e.from);return Decoration.replace({widget:new TabWidget((t-s%t)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=Decoration.replace({widget:new SpecialCharWidget(e,s)}))},boundary:e.replaceTabs?void 0:/[^]/})}update(e){let t=e.state.facet(specialCharConfig);e.startState.facet(specialCharConfig)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(e.view)):this.decorations=this.decorator.updateDeco(e,this.decorations)}},{decorations:e=>e.decorations}))}const DefaultPlaceholder="";function placeholder$1(e){return e>=32?DefaultPlaceholder:10==e?"":String.fromCharCode(9216+e)}class SpecialCharWidget extends WidgetType{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=placeholder$1(this.code),n=e.state.phrase("Control character")+" "+(Names[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,n,t);if(i)return i;let r=document.createElement("span");return r.textContent=t,r.title=n,r.setAttribute("aria-label",n),r.className="cm-specialChar",r}ignoreEvent(){return!1}}class TabWidget extends WidgetType{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="\t",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function highlightActiveLine(){return activeLineHighlighter}const lineDeco=Decoration.line({class:"cm-activeLine"}),activeLineHighlighter=ViewPlugin.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.docChanged||e.selectionSet)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=-1,n=[];for(let i of e.state.selection.ranges){let r=e.lineBlockAt(i.head);r.from>t&&(n.push(lineDeco.range(r.from)),t=r.from)}return Decoration.set(n)}},{decorations:e=>e.decorations});class Placeholder extends WidgetType{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild("string"==typeof this.content?document.createTextNode(this.content):this.content),"string"==typeof this.content?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?clientRectsFor(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),i=flattenRect(t[0],"rtl"!=n.direction),r=parseInt(n.lineHeight);return i.bottom-i.top>1.5*r?{left:i.left,right:i.right,top:i.top,bottom:i.top+r}:i}ignoreEvent(){return!1}}function placeholder(e){return ViewPlugin.fromClass(class{constructor(t){this.view=t,this.placeholder=e?Decoration.set([Decoration.widget({widget:new Placeholder(e),side:1}).range(0)]):Decoration.none}get decorations(){return this.view.state.doc.length?Decoration.none:this.placeholder}},{decorations:e=>e.decorations})}const MaxOff=2e3;function rectangleFor(e,t,n){let i=Math.min(t.line,n.line),r=Math.max(t.line,n.line),s=[];if(t.off>MaxOff||n.off>MaxOff||t.col<0||n.col<0){let o=Math.min(t.off,n.off),a=Math.max(t.off,n.off);for(let t=i;t<=r;t++){let n=e.doc.line(t);n.length<=a&&s.push(EditorSelection.range(n.from+o,n.to+a))}}else{let o=Math.min(t.col,n.col),a=Math.max(t.col,n.col);for(let t=i;t<=r;t++){let n=e.doc.line(t),i=findColumn(n.text,o,e.tabSize,!0);if(i<0)s.push(EditorSelection.cursor(n.to));else{let t=findColumn(n.text,a,e.tabSize);s.push(EditorSelection.range(n.from+i,n.from+t))}}}return s}function absoluteColumn(e,t){let n=e.coordsAtPos(e.viewport.from);return n?Math.round(Math.abs((n.left-t)/e.defaultCharacterWidth)):-1}function getPos(e,t){let n=e.posAtCoords({x:t.clientX,y:t.clientY},!1),i=e.state.doc.lineAt(n),r=n-i.from,s=r>MaxOff?-1:r==i.length?absoluteColumn(e,t.clientX):countColumn(i.text,e.state.tabSize,n-i.from);return{line:i.number,col:s,off:r}}function rectangleSelectionStyle(e,t){let n=getPos(e,t),i=e.state.selection;return n?{update(e){if(e.docChanged){let t=e.changes.mapPos(e.startState.doc.line(n.line).from),r=e.state.doc.lineAt(t);n={line:r.number,col:n.col,off:Math.min(n.off,r.length)},i=i.map(e.changes)}},get(t,r,s){let o=getPos(e,t);if(!o)return i;let a=rectangleFor(e.state,n,o);return a.length?s?EditorSelection.create(a.concat(i.ranges)):EditorSelection.create(a):i}}:null}function rectangularSelection(e){let t=(null==e?void 0:e.eventFilter)||(e=>e.altKey&&0==e.button);return EditorView.mouseSelectionStyle.of(((e,n)=>t(n)?rectangleSelectionStyle(e,n):null))}const keys={Alt:[18,e=>!!e.altKey],Control:[17,e=>!!e.ctrlKey],Shift:[16,e=>!!e.shiftKey],Meta:[91,e=>!!e.metaKey]},showCrosshair={style:"cursor: crosshair"};function crosshairCursor(e={}){let[t,n]=keys[e.key||"Alt"],i=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.isDown=!1}set(e){this.isDown!=e&&(this.isDown=e,this.view.update([]))}},{eventObservers:{keydown(e){this.set(e.keyCode==t||n(e))},keyup(e){e.keyCode!=t&&n(e)||this.set(!1)},mousemove(e){this.set(n(e))}}});return[i,EditorView.contentAttributes.of((e=>{var t;return(null===(t=e.plugin(i))||void 0===t?void 0:t.isDown)?showCrosshair:null}))]}const Outside="-10000px";class TooltipViewManager{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter((e=>e)),this.tooltipViews=this.tooltips.map(n)}update(e,t){var n;let i=e.state.facet(this.facet),r=i.filter((e=>e));if(i===this.input){for(let t of this.tooltipViews)t.update&&t.update(e);return!1}let s=[],o=t?[]:null;for(let n=0;n<r.length;n++){let i=r[n],a=-1;if(i){for(let e=0;e<this.tooltips.length;e++){let t=this.tooltips[e];t&&t.create==i.create&&(a=e)}if(a<0)s[n]=this.createTooltipView(i),o&&(o[n]=!!i.above);else{let i=s[n]=this.tooltipViews[a];o&&(o[n]=t[a]),i.update&&i.update(e)}}}for(let e of this.tooltipViews)s.indexOf(e)<0&&(e.dom.remove(),null===(n=e.destroy)||void 0===n||n.call(e));return t&&(o.forEach(((e,n)=>t[n]=e)),t.length=o.length),this.input=i,this.tooltips=r,this.tooltipViews=s,!0}}function windowSpace(e){let{win:t}=e;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const tooltipConfig=Facet.define({combine:e=>{var t,n,i;return{position:browser.ios?"absolute":(null===(t=e.find((e=>e.position)))||void 0===t?void 0:t.position)||"fixed",parent:(null===(n=e.find((e=>e.parent)))||void 0===n?void 0:n.parent)||null,tooltipSpace:(null===(i=e.find((e=>e.tooltipSpace)))||void 0===i?void 0:i.tooltipSpace)||windowSpace}}}),knownHeight=new WeakMap,tooltipPlugin=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=e.state.facet(tooltipConfig);this.position=t.position,this.parent=t.parent,this.classes=e.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new TooltipViewManager(e,showTooltip,(e=>this.createTooltip(e))),this.intersectionObserver="function"==typeof IntersectionObserver?new IntersectionObserver((e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()}),{threshold:[1]}):null,this.observeIntersection(),e.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let e of this.manager.tooltipViews)this.intersectionObserver.observe(e.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout((()=>{this.measureTimeout=-1,this.maybeMeasure()}),50))}update(e){e.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(e,this.above);t&&this.observeIntersection();let n=t||e.geometryChanged,i=e.state.facet(tooltipConfig);if(i.position!=this.position&&!this.madeAbsolute){this.position=i.position;for(let e of this.manager.tooltipViews)e.dom.style.position=this.position;n=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let e of this.manager.tooltipViews)this.container.appendChild(e.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(e){let t=e.create(this.view);if(t.dom.classList.add("cm-tooltip"),e.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",t.dom.appendChild(e)}return t.dom.style.position=this.position,t.dom.style.top=Outside,t.dom.style.left="0px",this.container.appendChild(t.dom),t.mount&&t.mount(this.view),t}destroy(){var e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),null===(e=t.destroy)||void 0===e||e.call(t);this.parent&&this.container.remove(),null===(t=this.intersectionObserver)||void 0===t||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let e=this.view.dom.getBoundingClientRect(),t=1,n=1,i=!1;if("fixed"==this.position&&this.manager.tooltipViews.length){let{dom:e}=this.manager.tooltipViews[0];if(browser.gecko)i=e.offsetParent!=this.container.ownerDocument.body;else if(e.style.top==Outside&&"0px"==e.style.left){let t=e.getBoundingClientRect();i=Math.abs(t.top+1e4)>1||Math.abs(t.left)>1}}if(i||"absolute"==this.position)if(this.parent){let e=this.parent.getBoundingClientRect();e.width&&e.height&&(t=e.width/this.parent.offsetWidth,n=e.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:n}=this.view.viewState);return{editor:e,parent:this.parent?this.container.getBoundingClientRect():e,pos:this.manager.tooltips.map(((e,t)=>{let n=this.manager.tooltipViews[t];return n.getCoords?n.getCoords(e.pos):this.view.coordsAtPos(e.pos)})),size:this.manager.tooltipViews.map((({dom:e})=>e.getBoundingClientRect())),space:this.view.state.facet(tooltipConfig).tooltipSpace(this.view),scaleX:t,scaleY:n,makeAbsolute:i}}writeMeasure(e){var t;if(e.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let e of this.manager.tooltipViews)e.dom.style.position="absolute"}let{editor:n,space:i,scaleX:r,scaleY:s}=e,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:h}=c,d=e.pos[a],u=e.size[a];if(!d||d.bottom<=Math.max(n.top,i.top)||d.top>=Math.min(n.bottom,i.bottom)||d.right<Math.max(n.left,i.left)-.1||d.left>Math.min(n.right,i.right)+.1){h.style.top=Outside;continue}let p=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,f=p?7:0,m=u.right-u.left,g=null!==(t=knownHeight.get(c))&&void 0!==t?t:u.bottom-u.top,O=c.offset||noOffset,y=this.view.textDirection==Direction.LTR,v=u.width>i.right-i.left?y?i.left:i.right-u.width:y?Math.min(d.left-(p?14:0)+O.x,i.right-m):Math.max(i.left,d.left-m+(p?14:0)-O.x),b=this.above[a];!l.strictSide&&(b?d.top-(u.bottom-u.top)-O.y<i.top:d.bottom+(u.bottom-u.top)+O.y>i.bottom)&&b==i.bottom-d.bottom>d.top-i.top&&(b=this.above[a]=!b);let w=(b?d.top-i.top:i.bottom-d.bottom)-f;if(w<g&&!1!==c.resize){if(w<this.view.defaultLineHeight){h.style.top=Outside;continue}knownHeight.set(c,g),h.style.height=(g=w)/s+"px"}else h.style.height&&(h.style.height="");let S=b?d.top-g-f-O.y:d.bottom+f+O.y,x=v+m;if(!0!==c.overlap)for(let e of o)e.left<x&&e.right>v&&e.top<S+g&&e.bottom>S&&(S=b?e.top-g-2-f:e.bottom+f+2);if("absolute"==this.position?(h.style.top=(S-e.parent.top)/s+"px",h.style.left=(v-e.parent.left)/r+"px"):(h.style.top=S/s+"px",h.style.left=v/r+"px"),p){let e=d.left+(y?O.x:-O.x)-(v+14-7);p.style.left=e/r+"px"}!0!==c.overlap&&o.push({left:v,top:S,right:x,bottom:S+g}),h.classList.toggle("cm-tooltip-above",b),h.classList.toggle("cm-tooltip-below",!b),c.positioned&&c.positioned(e.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let e of this.manager.tooltipViews)e.dom.style.top=Outside}},{eventObservers:{scroll(){this.maybeMeasure()}}}),baseTheme$4=EditorView.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:"14px",position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),noOffset={x:0,y:0},showTooltip=Facet.define({enables:[tooltipPlugin,baseTheme$4]}),showHoverTooltip=Facet.define();class HoverTooltipHost{static create(e){return new HoverTooltipHost(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TooltipViewManager(e,showHoverTooltip,(e=>this.createHostedView(e)))}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)null===(e=t.destroy)||void 0===e||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let i=n[e];if(void 0!==i)if(void 0===t)t=i;else if(t!==i)return}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const showHoverTooltipHost=showTooltip.compute([showHoverTooltip],(e=>{let t=e.facet(showHoverTooltip).filter((e=>e));return 0===t.length?null:{pos:Math.min(...t.map((e=>e.pos))),end:Math.max(...t.map((e=>{var t;return null!==(t=e.end)&&void 0!==t?t:e.pos}))),create:HoverTooltipHost.create,above:t[0].above,arrow:t.some((e=>e.arrow))}}));class HoverPlugin{constructor(e,t,n,i,r){this.view=e,this.source=t,this.field=n,this.setHover=i,this.hoverTime=r,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout((()=>this.startHover()),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let i,r=1;if(n instanceof WidgetView)i=n.posAtStart;else{if(i=e.posAtCoords(t),null==i)return;let n=e.coordsAtPos(i);if(!n||t.y<n.top||t.y>n.bottom||t.x<n.left-e.defaultCharacterWidth||t.x>n.right+e.defaultCharacterWidth)return;let s=e.bidiSpans(e.state.doc.lineAt(i)).find((e=>e.from<=i&&e.to>=i)),o=s&&s.dir==Direction.RTL?-1:1;r=t.x<n.left?-o:o}let s=this.source(e,i,r);if(null==s?void 0:s.then){let t=this.pending={pos:i};s.then((n=>{this.pending==t&&(this.pending=null,n&&e.dispatch({effects:this.setHover.of(n)}))}),(t=>logException(e.state,t,"hover tooltip")))}else s&&e.dispatch({effects:this.setHover.of(s)})}get tooltip(){let e=this.view.plugin(tooltipPlugin),t=e?e.manager.tooltips.findIndex((e=>e.create==HoverTooltipHost.create)):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:i}=this;if(n&&i&&!isInTooltip(i.dom,e)||this.pending){let{pos:i}=n||this.pending,r=null!==(t=null==n?void 0:n.end)&&void 0!==t?t:i;(i==r?this.view.posAtCoords(this.lastMove)==i:isOverRange(this.view,i,r,e.clientX,e.clientY))||(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t){let{tooltip:t}=this;t&&t.dom.contains(e.relatedTarget)?this.watchTooltipLeave(t.dom):this.view.dispatch({effects:this.setHover.of(null)})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const tooltipMargin=4;function isInTooltip(e,t){let n=e.getBoundingClientRect();return t.clientX>=n.left-tooltipMargin&&t.clientX<=n.right+tooltipMargin&&t.clientY>=n.top-tooltipMargin&&t.clientY<=n.bottom+tooltipMargin}function isOverRange(e,t,n,i,r,s){let o=e.scrollDOM.getBoundingClientRect(),a=e.documentTop+e.documentPadding.top+e.contentHeight;if(o.left>i||o.right<i||o.top>r||Math.min(o.bottom,a)<r)return!1;let l=e.posAtCoords({x:i,y:r},!1);return l>=t&&l<=n}function hoverTooltip(e,t={}){let n=StateEffect.define(),i=StateField.define({create:()=>null,update(e,i){if(e&&(t.hideOnChange&&(i.docChanged||i.selection)||t.hideOn&&t.hideOn(i,e)))return null;if(e&&i.docChanged){let t=i.changes.mapPos(e.pos,-1,MapMode.TrackDel);if(null==t)return null;let n=Object.assign(Object.create(null),e);n.pos=t,null!=e.end&&(n.end=i.changes.mapPos(e.end)),e=n}for(let t of i.effects)t.is(n)&&(e=t.value),t.is(closeHoverTooltipEffect)&&(e=null);return e},provide:e=>showHoverTooltip.from(e)});return[i,ViewPlugin.define((r=>new HoverPlugin(r,e,i,n,t.hoverTime||300))),showHoverTooltipHost]}function getTooltip(e,t){let n=e.plugin(tooltipPlugin);if(!n)return null;let i=n.manager.tooltips.indexOf(t);return i<0?null:n.manager.tooltipViews[i]}const closeHoverTooltipEffect=StateEffect.define(),panelConfig=Facet.define({combine(e){let t,n;for(let i of e)t=t||i.topContainer,n=n||i.bottomContainer;return{topContainer:t,bottomContainer:n}}});function getPanel(e,t){let n=e.plugin(panelPlugin),i=n?n.specs.indexOf(t):-1;return i>-1?n.panels[i]:null}const panelPlugin=ViewPlugin.fromClass(class{constructor(e){this.input=e.state.facet(showPanel),this.specs=this.input.filter((e=>e)),this.panels=this.specs.map((t=>t(e)));let t=e.state.facet(panelConfig);this.top=new PanelGroup(e,!0,t.topContainer),this.bottom=new PanelGroup(e,!1,t.bottomContainer),this.top.sync(this.panels.filter((e=>e.top))),this.bottom.sync(this.panels.filter((e=>!e.top)));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(e){let t=e.state.facet(panelConfig);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new PanelGroup(e.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new PanelGroup(e.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=e.state.facet(showPanel);if(n!=this.input){let t=n.filter((e=>e)),i=[],r=[],s=[],o=[];for(let n of t){let t,a=this.specs.indexOf(n);a<0?(t=n(e.view),o.push(t)):(t=this.panels[a],t.update&&t.update(e)),i.push(t),(t.top?r:s).push(t)}this.specs=t,this.panels=i,this.top.sync(r),this.bottom.sync(s);for(let e of o)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}else for(let t of this.panels)t.update&&t.update(e)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:e=>EditorView.scrollMargins.of((t=>{let n=t.plugin(e);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}}))});class PanelGroup{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(0==this.panels.length)return void(this.dom&&(this.dom.remove(),this.dom=void 0));if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=rm(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=rm(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(this.container&&this.classes!=this.view.themeClasses){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function rm(e){let t=e.nextSibling;return e.remove(),t}const showPanel=Facet.define({enables:panelPlugin});class GutterMarker extends RangeValue{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}GutterMarker.prototype.elementClass="",GutterMarker.prototype.toDOM=void 0,GutterMarker.prototype.mapMode=MapMode.TrackBefore,GutterMarker.prototype.startSide=GutterMarker.prototype.endSide=-1,GutterMarker.prototype.point=!0;const gutterLineClass=Facet.define(),defaults$1={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},activeGutters=Facet.define();function gutter(e){return[gutters(),activeGutters.of(Object.assign(Object.assign({},defaults$1),e))]}const unfixGutters=Facet.define({combine:e=>e.some((e=>e))});function gutters(e){let t=[gutterView];return e&&!1===e.fixed&&t.push(unfixGutters.of(!0)),t}const gutterView=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.prevViewport=e.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=e.state.facet(activeGutters).map((t=>new SingleGutterView(e,t)));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!e.state.facet(unfixGutters),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),e.scrollDOM.insertBefore(this.dom,e.contentDOM)}update(e){if(this.updateGutters(e)){let t=this.prevViewport,n=e.view.viewport,i=Math.min(t.to,n.to)-Math.max(t.from,n.from);this.syncGutters(i<.8*(n.to-n.from))}e.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(unfixGutters)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=e.view.viewport}syncGutters(e){let t=this.dom.nextSibling;e&&this.dom.remove();let n=RangeSet.iter(this.view.state.facet(gutterLineClass),this.view.viewport.from),i=[],r=this.gutters.map((e=>new UpdateContext(e,this.view.viewport,-this.view.documentPadding.top)));for(let e of this.view.viewportLineBlocks)if(i.length&&(i=[]),Array.isArray(e.type)){let t=!0;for(let s of e.type)if(s.type==BlockType.Text&&t){advanceCursor(n,i,s.from);for(let e of r)e.line(this.view,s,i);t=!1}else if(s.widget)for(let e of r)e.widget(this.view,s)}else if(e.type==BlockType.Text){advanceCursor(n,i,e.from);for(let t of r)t.line(this.view,e,i)}else if(e.widget)for(let t of r)t.widget(this.view,e);for(let e of r)e.finish();e&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(e){let t=e.startState.facet(activeGutters),n=e.state.facet(activeGutters),i=e.docChanged||e.heightChanged||e.viewportChanged||!RangeSet.eq(e.startState.facet(gutterLineClass),e.state.facet(gutterLineClass),e.view.viewport.from,e.view.viewport.to);if(t==n)for(let t of this.gutters)t.update(e)&&(i=!0);else{i=!0;let r=[];for(let i of n){let n=t.indexOf(i);n<0?r.push(new SingleGutterView(this.view,i)):(this.gutters[n].update(e),r.push(this.gutters[n]))}for(let e of this.gutters)e.dom.remove(),r.indexOf(e)<0&&e.destroy();for(let e of r)this.dom.appendChild(e.dom);this.gutters=r}return i}destroy(){for(let e of this.gutters)e.destroy();this.dom.remove()}},{provide:e=>EditorView.scrollMargins.of((t=>{let n=t.plugin(e);return n&&0!=n.gutters.length&&n.fixed?t.textDirection==Direction.LTR?{left:n.dom.offsetWidth*t.scaleX}:{right:n.dom.offsetWidth*t.scaleX}:null}))});function asArray(e){return Array.isArray(e)?e:[e]}function advanceCursor(e,t,n){for(;e.value&&e.from<=n;)e.from==n&&t.push(e.value),e.next()}class UpdateContext{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=RangeSet.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:i}=this,r=(t.top-this.height)/e.scaleY,s=t.height/e.scaleY;if(this.i==i.elements.length){let t=new GutterElement(e,s,r,n);i.elements.push(t),i.dom.appendChild(t.dom)}else i.elements[this.i].update(e,s,r,n);this.height=t.bottom,this.i++}line(e,t,n){let i=[];advanceCursor(this.cursor,i,t.from),n.length&&(i=i.concat(n));let r=this.gutter.config.lineMarker(e,t,i);r&&i.unshift(r);let s=this.gutter;(0!=i.length||s.config.renderEmptyElements)&&this.addElement(e,t,i)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class SingleGutterView{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,(i=>{let r,s=i.target;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let e=s.getBoundingClientRect();r=(e.top+e.bottom)/2}else r=i.clientY;let o=e.lineBlockAtHeight(r-e.documentTop);t.domEventHandlers[n](e,o,i)&&i.preventDefault()}));this.markers=asArray(t.markers(e)),t.initialSpacer&&(this.spacer=new GutterElement(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=asArray(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let t=this.config.updateSpacer(this.spacer.markers[0],e);t!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[t])}let n=e.view.viewport;return!RangeSet.eq(this.markers,t,n.from,n.to)||!!this.config.lineMarkerChange&&this.config.lineMarkerChange(e)}destroy(){for(let e of this.elements)e.destroy()}}class GutterElement{constructor(e,t,n,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,i)}update(e,t,n,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),sameMarkers(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let n="cm-gutterElement",i=this.dom.firstChild;for(let r=0,s=0;;){let o=s,a=r<t.length?t[r++]:null,l=!1;if(a){let e=a.elementClass;e&&(n+=" "+e);for(let e=s;e<this.markers.length;e++)if(this.markers[e].compare(a)){o=e,l=!0;break}}else o=this.markers.length;for(;s<o;){let e=this.markers[s++];if(e.toDOM){e.destroy(i);let t=i.nextSibling;i.remove(),i=t}}if(!a)break;a.toDOM&&(l?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),l&&s++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function sameMarkers(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].compare(t[n]))return!1;return!0}const lineNumberMarkers=Facet.define(),lineNumberConfig=Facet.define({combine:e=>combineConfig(e,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let e in t){let i=n[e],r=t[e];n[e]=i?(e,t,n)=>i(e,t,n)||r(e,t,n):r}return n}})});class NumberMarker extends GutterMarker{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function formatNumber(e,t){return e.state.facet(lineNumberConfig).formatNumber(t,e.state)}const lineNumberGutter=activeGutters.compute([lineNumberConfig],(e=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers:e=>e.state.facet(lineNumberMarkers),lineMarker:(e,t,n)=>n.some((e=>e.toDOM))?null:new NumberMarker(formatNumber(e,e.state.doc.lineAt(t.from).number)),widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(lineNumberConfig)!=e.state.facet(lineNumberConfig),initialSpacer:e=>new NumberMarker(formatNumber(e,maxLineNumber(e.state.doc.lines))),updateSpacer(e,t){let n=formatNumber(t.view,maxLineNumber(t.view.state.doc.lines));return n==e.number?e:new NumberMarker(n)},domEventHandlers:e.facet(lineNumberConfig).domEventHandlers})));function lineNumbers(e={}){return[lineNumberConfig.of(e),gutters(),lineNumberGutter]}function maxLineNumber(e){let t=9;for(;t<e;)t=10*t+9;return t}const activeLineGutterMarker=new class extends GutterMarker{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},activeLineGutterHighlighter=gutterLineClass.compute(["selection"],(e=>{let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.head).from;r>n&&(n=r,t.push(activeLineGutterMarker.range(r)))}return RangeSet.of(t)}));function highlightActiveLineGutter(){return activeLineGutterHighlighter}const DefaultBufferLength=1024;let nextPropID=0;class Range{constructor(e,t){this.from=e,this.to=t}}class NodeProp{constructor(e={}){this.id=nextPropID++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof e&&(e=NodeType.match(e)),t=>{let n=e(t);return void 0===n?null:[this,n]}}}NodeProp.closedBy=new NodeProp({deserialize:e=>e.split(" ")}),NodeProp.openedBy=new NodeProp({deserialize:e=>e.split(" ")}),NodeProp.group=new NodeProp({deserialize:e=>e.split(" ")}),NodeProp.isolate=new NodeProp({deserialize:e=>{if(e&&"rtl"!=e&&"ltr"!=e&&"auto"!=e)throw new RangeError("Invalid value for isolate: "+e);return e||"auto"}}),NodeProp.contextHash=new NodeProp({perNode:!0}),NodeProp.lookAhead=new NodeProp({perNode:!0}),NodeProp.mounted=new NodeProp({perNode:!0});class MountedTree{constructor(e,t,n){this.tree=e,this.overlay=t,this.parser=n}static get(e){return e&&e.props&&e.props[NodeProp.mounted.id]}}const noProps=Object.create(null);class NodeType{constructor(e,t,n,i=0){this.name=e,this.props=t,this.id=n,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):noProps,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(null==e.name?8:0),i=new NodeType(e.name||"",t,e.id,n);if(e.props)for(let n of e.props)if(Array.isArray(n)||(n=n(i)),n){if(n[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[n[0].id]=n[1]}return i}prop(e){return this.props[e.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(e){if("string"==typeof e){if(this.name==e)return!0;let t=this.prop(NodeProp.group);return!!t&&t.indexOf(e)>-1}return this.id==e}static match(e){let t=Object.create(null);for(let n in e)for(let i of n.split(" "))t[i]=e[n];return e=>{for(let n=e.prop(NodeProp.group),i=-1;i<(n?n.length:0);i++){let r=t[i<0?e.name:n[i]];if(r)return r}}}}NodeType.none=new NodeType("",Object.create(null),0,8);class NodeSet{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let n of this.types){let i=null;for(let t of e){let e=t(n);e&&(i||(i=Object.assign({},n.props)),i[e[0].id]=e[1])}t.push(i?new NodeType(n.name,i,n.id,n.flags):n)}return new NodeSet(t)}}const CachedNode=new WeakMap,CachedInnerNode=new WeakMap;var IterMode;!function(e){e[e.ExcludeBuffers=1]="ExcludeBuffers",e[e.IncludeAnonymous=2]="IncludeAnonymous",e[e.IgnoreMounts=4]="IgnoreMounts",e[e.IgnoreOverlays=8]="IgnoreOverlays"}(IterMode||(IterMode={}));class Tree{constructor(e,t,n,i,r){if(this.type=e,this.children=t,this.positions=n,this.length=i,this.props=null,r&&r.length){this.props=Object.create(null);for(let[e,t]of r)this.props["number"==typeof e?e:e.id]=t}}toString(){let e=MountedTree.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let e of this.children){let n=e.toString();n&&(t&&(t+=","),t+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new TreeCursor(this.topNode,e)}cursorAt(e,t=0,n=0){let i=CachedNode.get(this)||this.topNode,r=new TreeCursor(i);return r.moveTo(e,t),CachedNode.set(this,r._tree),r}get topNode(){return new TreeNode(this,0,0,null)}resolve(e,t=0){let n=resolveNode(CachedNode.get(this)||this.topNode,e,t,!1);return CachedNode.set(this,n),n}resolveInner(e,t=0){let n=resolveNode(CachedInnerNode.get(this)||this.topNode,e,t,!0);return CachedInnerNode.set(this,n),n}resolveStack(e,t=0){return stackIterator(this,e,t)}iterate(e){let{enter:t,leave:n,from:i=0,to:r=this.length}=e,s=e.mode||0,o=(s&IterMode.IncludeAnonymous)>0;for(let e=this.cursor(s|IterMode.IncludeAnonymous);;){let s=!1;if(e.from<=r&&e.to>=i&&(!o&&e.type.isAnonymous||!1!==t(e))){if(e.firstChild())continue;s=!0}for(;s&&n&&(o||!e.type.isAnonymous)&&n(e),!e.nextSibling();){if(!e.parent())return;s=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:balanceRange(NodeType.none,this.children,this.positions,0,this.children.length,0,this.length,((e,t,n)=>new Tree(this.type,e,t,n,this.propValues)),e.makeTree||((e,t,n)=>new Tree(NodeType.none,e,t,n)))}static build(e){return buildTree(e)}}Tree.empty=new Tree(NodeType.none,[],[],0);class FlatBufferCursor{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new FlatBufferCursor(this.buffer,this.index)}}class TreeBuffer{constructor(e,t,n){this.buffer=e,this.length=t,this.set=n}get type(){return NodeType.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],n=this.buffer[e+3],i=this.set.types[t],r=i.name;if(/\W/.test(r)&&!i.isError&&(r=JSON.stringify(r)),n==(e+=4))return r;let s=[];for(;e<n;)s.push(this.childString(e)),e=this.buffer[e+3];return r+"("+s.join(",")+")"}findChild(e,t,n,i,r){let{buffer:s}=this,o=-1;for(let a=e;a!=t&&!(checkSide(r,i,s[a+1],s[a+2])&&(o=a,n>0));a=s[a+3]);return o}slice(e,t,n){let i=this.buffer,r=new Uint16Array(t-e),s=0;for(let o=e,a=0;o<t;){r[a++]=i[o++],r[a++]=i[o++]-n;let t=r[a++]=i[o++]-n;r[a++]=i[o++]-e,s=Math.max(s,t)}return new TreeBuffer(r,s,this.set)}}function checkSide(e,t,n,i){switch(e){case-2:return n<t;case-1:return i>=t&&n<t;case 0:return n<t&&i>t;case 1:return n<=t&&i>t;case 2:return i>t;case 4:return!0}}function resolveNode(e,t,n,i){for(var r;e.from==e.to||(n<1?e.from>=t:e.from>t)||(n>-1?e.to<=t:e.to<t);){let t=!i&&e instanceof TreeNode&&e.index<0?null:e.parent;if(!t)return e;e=t}let s=i?0:IterMode.IgnoreOverlays;if(i)for(let i=e,o=i.parent;o;i=o,o=i.parent)i instanceof TreeNode&&i.index<0&&(null===(r=o.enter(t,n,s))||void 0===r?void 0:r.from)!=i.from&&(e=o);for(;;){let i=e.enter(t,n,s);if(!i)return e;e=i}}class BaseNode{cursor(e=0){return new TreeCursor(this,e)}getChild(e,t=null,n=null){let i=getChildren(this,e,t,n);return i.length?i[0]:null}getChildren(e,t=null,n=null){return getChildren(this,e,t,n)}resolve(e,t=0){return resolveNode(this,e,t,!1)}resolveInner(e,t=0){return resolveNode(this,e,t,!0)}matchContext(e){return matchNodeContext(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),n=this;for(;t;){let e=t.lastChild;if(!e||e.to!=t.to)break;e.type.isError&&e.from==e.to?(n=t,t=e.prevSibling):t=e}return n}get node(){return this}get next(){return this.parent}}class TreeNode extends BaseNode{constructor(e,t,n,i){super(),this._tree=e,this.from=t,this.index=n,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,n,i,r=0){for(let s=this;;){for(let{children:o,positions:a}=s._tree,l=t>0?o.length:-1;e!=l;e+=t){let l=o[e],c=a[e]+s.from;if(checkSide(i,n,c,c+l.length))if(l instanceof TreeBuffer){if(r&IterMode.ExcludeBuffers)continue;let o=l.findChild(0,l.buffer.length,t,n-c,i);if(o>-1)return new BufferNode(new BufferContext(s,l,e,c),null,o)}else if(r&IterMode.IncludeAnonymous||!l.type.isAnonymous||hasChild(l)){let o;if(!(r&IterMode.IgnoreMounts)&&(o=MountedTree.get(l))&&!o.overlay)return new TreeNode(o.tree,c,e,s);let a=new TreeNode(l,c,e,s);return r&IterMode.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(t<0?l.children.length-1:0,t,n,i)}}if(r&IterMode.IncludeAnonymous||!s.type.isAnonymous)return null;if(e=s.index>=0?s.index+t:t<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,n=0){let i;if(!(n&IterMode.IgnoreOverlays)&&(i=MountedTree.get(this._tree))&&i.overlay){let n=e-this.from;for(let{from:e,to:r}of i.overlay)if((t>0?e<=n:e<n)&&(t<0?r>=n:r>n))return new TreeNode(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function getChildren(e,t,n,i){let r=e.cursor(),s=[];if(!r.firstChild())return s;if(null!=n)for(;!r.type.is(n);)if(!r.nextSibling())return s;for(;;){if(null!=i&&r.type.is(i))return s;if(r.type.is(t)&&s.push(r.node),!r.nextSibling())return null==i?s:[]}}function matchNodeContext(e,t,n=t.length-1){for(let i=e.parent;n>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[n]&&t[n]!=i.name)return!1;n--}}return!0}class BufferContext{constructor(e,t,n,i){this.parent=e,this.buffer=t,this.index=n,this.start=i}}class BufferNode extends BaseNode{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,n){super(),this.context=e,this._parent=t,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,t,n){let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,n);return r<0?null:new BufferNode(this.context,this,r)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,n=0){if(n&IterMode.ExcludeBuffers)return null;let{buffer:i}=this.context,r=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return r<0?null:new BufferNode(this.context,this,r)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new BufferNode(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new BufferNode(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:n}=this.context,i=this.index+4,r=n.buffer[this.index+3];if(r>i){let s=n.buffer[this.index+1];e.push(n.slice(i,r,s)),t.push(0)}return new Tree(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function iterStack(e){if(!e.length)return null;let t=0,n=e[0];for(let i=1;i<e.length;i++){let r=e[i];(r.from>n.from||r.to<n.to)&&(n=r,t=i)}let i=n instanceof TreeNode&&n.index<0?null:n.parent,r=e.slice();return i?r[t]=i:r.splice(t,1),new StackIterator(r,n)}class StackIterator{constructor(e,t){this.heads=e,this.node=t}get next(){return iterStack(this.heads)}}function stackIterator(e,t,n){let i=e.resolveInner(t,n),r=null;for(let e=i instanceof TreeNode?i:i.context.parent;e;e=e.parent)if(e.index<0){let s=e.parent;(r||(r=[i])).push(s.resolve(t,n)),e=s}else{let s=MountedTree.get(e.tree);if(s&&s.overlay&&s.overlay[0].from<=t&&s.overlay[s.overlay.length-1].to>=t){let o=new TreeNode(s.tree,s.overlay[0].from+e.from,-1,e);(r||(r=[i])).push(resolveNode(o,t,n,!1))}}return r?iterStack(r):i}class TreeCursor{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof TreeNode)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let t=e._parent;t;t=t._parent)this.stack.unshift(t.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return!!e&&(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0)}yieldBuf(e,t){this.index=e;let{start:n,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=n+i.buffer[e+1],this.to=n+i.buffer[e+2],!0}yield(e){return!!e&&(e instanceof TreeNode?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,n,this.mode));let{buffer:i}=this.buffer,r=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,n);return!(r<0)&&(this.stack.push(this.index),this.yieldBuf(r))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,n=this.mode){return this.buffer?!(n&IterMode.ExcludeBuffers)&&this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode));let{buffer:t}=this.buffer,n=this.stack.length-1;if(e<0){let e=n<0?0:this.stack[n]+4;if(this.index!=e)return this.yieldBuf(t.findChild(e,this.index,-1,0,4))}else{let e=t.buffer[this.index+3];if(e<(n<0?t.buffer.length:t.buffer[this.stack[n]+3]))return this.yieldBuf(e)}return n<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,n,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let e=0;e<this.index;e++)if(i.buffer.buffer[e+3]<this.index)return!1;({index:t,parent:n}=i)}else({index:t,_parent:n}=this._tree);for(;n;({index:t,_parent:n}=n))if(t>-1)for(let i=t+e,r=e<0?-1:n._tree.children.length;i!=r;i+=e){let e=n._tree.children[i];if(this.mode&IterMode.IncludeAnonymous||e instanceof TreeBuffer||!e.type.isAnonymous||hasChild(e))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,n=0;if(e&&e.context==this.buffer)e:for(let i=this.index,r=this.stack.length;r>=0;){for(let s=e;s;s=s._parent)if(s.index==i){if(i==this.index)return s;t=s,n=r+1;break e}i=this.stack[--r]}for(let e=n;e<this.stack.length;e++)t=new BufferNode(this.buffer,t,this.stack[e]);return this.bufferNode=new BufferNode(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let n=0;;){let i=!1;if(this.type.isAnonymous||!1!==e(this)){if(this.firstChild()){n++;continue}this.type.isAnonymous||(i=!0)}for(;i&&t&&t(this),i=this.type.isAnonymous,!this.nextSibling();){if(!n)return;this.parent(),n--,i=!0}}}matchContext(e){if(!this.buffer)return matchNodeContext(this.node,e);let{buffer:t}=this.buffer,{types:n}=t.set;for(let i=e.length-1,r=this.stack.length-1;i>=0;r--){if(r<0)return matchNodeContext(this.node,e,i);let s=n[t.buffer[this.stack[r]]];if(!s.isAnonymous){if(e[i]&&e[i]!=s.name)return!1;i--}}return!0}}function hasChild(e){return e.children.some((e=>e instanceof TreeBuffer||!e.type.isAnonymous||hasChild(e)))}function buildTree(e){var t;let{buffer:n,nodeSet:i,maxBufferLength:r=DefaultBufferLength,reused:s=[],minRepeatType:o=i.types.length}=e,a=Array.isArray(n)?new FlatBufferCursor(n,n.length):n,l=i.types,c=0,h=0;function d(e,t,n,g,O,y){let{id:v,start:b,end:w,size:S}=a,x=h;for(;S<0;){if(a.next(),-1==S){let t=s[v];return n.push(t),void g.push(b-e)}if(-3==S)return void(c=v);if(-4==S)return void(h=v);throw new RangeError(`Unrecognized record size: ${S}`)}let C,_,E=l[v],P=b-e;if(w-b<=r&&(_=function(e,t){let n=a.fork(),i=0,s=0,l=0,c=n.end-r,h={size:0,start:0,skip:0};e:for(let r=n.pos-e;n.pos>r;){let e=n.size;if(n.id==t&&e>=0){h.size=i,h.start=s,h.skip=l,l+=4,i+=4,n.next();continue}let a=n.pos-e;if(e<0||a<r||n.start<c)break;let d=n.id>=o?4:0,u=n.start;for(n.next();n.pos>a;){if(n.size<0){if(-3!=n.size)break e;d+=4}else n.id>=o&&(d+=4);n.next()}s=u,i+=e,l+=d}(t<0||i==e)&&(h.size=i,h.start=s,h.skip=l);return h.size>4?h:void 0}(a.pos-t,O))){let t=new Uint16Array(_.size-_.skip),n=a.pos-_.size,r=t.length;for(;a.pos>n;)r=m(_.start,t,r);C=new TreeBuffer(t,w-_.start,i),P=_.start-e}else{let e=a.pos-S;a.next();let t=[],n=[],i=v>=o?v:-1,s=0,l=w;for(;a.pos>e;)i>=0&&a.id==i&&a.size>=0?(a.end<=l-r&&(p(t,n,b,s,a.end,l,i,x),s=t.length,l=a.end),a.next()):y>2500?u(b,e,t,n):d(b,e,t,n,i,y+1);if(i>=0&&s>0&&s<t.length&&p(t,n,b,s,b,l,i,x),t.reverse(),n.reverse(),i>-1&&s>0){let e=function(e){return(t,n,i)=>{let r,s,o=0,a=t.length-1;if(a>=0&&(r=t[a])instanceof Tree){if(!a&&r.type==e&&r.length==i)return r;(s=r.prop(NodeProp.lookAhead))&&(o=n[a]+r.length+s)}return f(e,t,n,i,o)}}(E);C=balanceRange(E,t,n,0,t.length,0,w-b,e,e)}else C=f(E,t,n,w-b,x-w)}n.push(C),g.push(P)}function u(e,t,n,s){let o=[],l=0,c=-1;for(;a.pos>t;){let{id:e,start:t,end:n,size:i}=a;if(i>4)a.next();else{if(c>-1&&t<c)break;c<0&&(c=n-r),o.push(e,t,n),l++,a.next()}}if(l){let t=new Uint16Array(4*l),r=o[o.length-2];for(let e=o.length-3,n=0;e>=0;e-=3)t[n++]=o[e],t[n++]=o[e+1]-r,t[n++]=o[e+2]-r,t[n++]=n;n.push(new TreeBuffer(t,o[2]-r,i)),s.push(r-e)}}function p(e,t,n,r,s,o,a,l){let c=[],h=[];for(;e.length>r;)c.push(e.pop()),h.push(t.pop()+n-s);e.push(f(i.types[a],c,h,o-s,l-o)),t.push(s-n)}function f(e,t,n,i,r=0,s){if(c){let e=[NodeProp.contextHash,c];s=s?[e].concat(s):[e]}if(r>25){let e=[NodeProp.lookAhead,r];s=s?[e].concat(s):[e]}return new Tree(e,t,n,i,s)}function m(e,t,n){let{id:i,start:r,end:s,size:l}=a;if(a.next(),l>=0&&i<o){let o=n;if(l>4){let i=a.pos-(l-4);for(;a.pos>i;)n=m(e,t,n)}t[--n]=o,t[--n]=s-e,t[--n]=r-e,t[--n]=i}else-3==l?c=i:-4==l&&(h=i);return n}let g=[],O=[];for(;a.pos>0;)d(e.start||0,e.bufferStart||0,g,O,-1,0);let y=null!==(t=e.length)&&void 0!==t?t:g.length?O[0]+g[0].length:0;return new Tree(l[e.topID],g.reverse(),O.reverse(),y)}const nodeSizeCache=new WeakMap;function nodeSize(e,t){if(!e.isAnonymous||t instanceof TreeBuffer||t.type!=e)return 1;let n=nodeSizeCache.get(t);if(null==n){n=1;for(let i of t.children){if(i.type!=e||!(i instanceof Tree)){n=1;break}n+=nodeSize(e,i)}nodeSizeCache.set(t,n)}return n}function balanceRange(e,t,n,i,r,s,o,a,l){let c=0;for(let n=i;n<r;n++)c+=nodeSize(e,t[n]);let h=Math.ceil(1.5*c/8),d=[],u=[];return function t(n,i,r,o,a){for(let c=r;c<o;){let r=c,p=i[c],f=nodeSize(e,n[c]);for(c++;c<o;c++){let t=nodeSize(e,n[c]);if(f+t>=h)break;f+=t}if(c==r+1){if(f>h){let e=n[r];t(e.children,e.positions,0,e.children.length,i[r]+a);continue}d.push(n[r])}else{let t=i[c-1]+n[c-1].length-p;d.push(balanceRange(e,n,i,r,c,p,t,null,l))}u.push(p+a-s)}}(t,n,i,r,0),(a||l)(d,u,o)}class NodeWeakMap{constructor(){this.map=new WeakMap}setBuffer(e,t,n){let i=this.map.get(e);i||this.map.set(e,i=new Map),i.set(t,n)}getBuffer(e,t){let n=this.map.get(e);return n&&n.get(t)}set(e,t){e instanceof BufferNode?this.setBuffer(e.context.buffer,e.index,t):e instanceof TreeNode&&this.map.set(e.tree,t)}get(e){return e instanceof BufferNode?this.getBuffer(e.context.buffer,e.index):e instanceof TreeNode?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class TreeFragment{constructor(e,t,n,i,r=!1,s=!1){this.from=e,this.to=t,this.tree=n,this.offset=i,this.open=(r?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(e,t=[],n=!1){let i=[new TreeFragment(0,e.length,e,0,!1,n)];for(let n of t)n.to>e.length&&i.push(n);return i}static applyChanges(e,t,n=128){if(!t.length)return e;let i=[],r=1,s=e.length?e[0]:null;for(let o=0,a=0,l=0;;o++){let c=o<t.length?t[o]:null,h=c?c.fromA:1e9;if(h-a>=n)for(;s&&s.from<h;){let t=s;if(a>=t.from||h<=t.to||l){let e=Math.max(t.from,a)-l,n=Math.min(t.to,h)-l;t=e>=n?null:new TreeFragment(e,n,t.tree,t.offset+l,o>0,!!c)}if(t&&i.push(t),s.to>h)break;s=r<e.length?e[r++]:null}if(!c)break;a=c.toA,l=c.toA-c.toB}return i}}class Parser{startParse(e,t,n){return"string"==typeof e&&(e=new StringInput(e)),n=n?n.length?n.map((e=>new Range(e.from,e.to))):[new Range(0,0)]:[new Range(0,e.length)],this.createParse(e,t||[],n)}parse(e,t,n){let i=this.startParse(e,t,n);for(;;){let e=i.advance();if(e)return e}}}class StringInput{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function parseMixed(e){return(t,n,i,r)=>new MixedParse(t,e,n,i,r)}class InnerParse{constructor(e,t,n,i,r){this.parser=e,this.parse=t,this.overlay=n,this.target=i,this.from=r}}function checkRanges(e){if(!e.length||e.some((e=>e.from>=e.to)))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(e))}class ActiveOverlay{constructor(e,t,n,i,r,s,o){this.parser=e,this.predicate=t,this.mounts=n,this.index=i,this.start=r,this.target=s,this.prev=o,this.depth=0,this.ranges=[]}}const stoppedInner=new NodeProp({perNode:!0});class MixedParse{constructor(e,t,n,i,r){this.nest=t,this.input=n,this.fragments=i,this.ranges=r,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let e=this.baseParse.advance();if(!e)return null;if(this.baseParse=null,this.baseTree=e,this.startInner(),null!=this.stoppedAt)for(let e of this.inner)e.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let e=this.baseTree;return null!=this.stoppedAt&&(e=new Tree(e.type,e.children,e.positions,e.length,e.propValues.concat([[stoppedInner,this.stoppedAt]]))),e}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[NodeProp.mounted.id]=new MountedTree(t,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new FragmentCursor$2(this.fragments),t=null,n=null,i=new TreeCursor(new TreeNode(this.baseTree,this.ranges[0].from,0,null),IterMode.IncludeAnonymous|IterMode.IgnoreMounts);e:for(let r,s;;){let o,a=!0;if(null!=this.stoppedAt&&i.from>=this.stoppedAt)a=!1;else if(e.hasNode(i)){if(t){let e=t.mounts.find((e=>e.frag.from<=i.from&&e.frag.to>=i.to&&e.mount.overlay));if(e)for(let n of e.mount.overlay){let r=n.from+e.pos,s=n.to+e.pos;r>=i.from&&s<=i.to&&!t.ranges.some((e=>e.from<s&&e.to>r))&&t.ranges.push({from:r,to:s})}}a=!1}else if(n&&(s=checkCover(n.ranges,i.from,i.to)))a=2!=s;else if(!i.type.isAnonymous&&(r=this.nest(i,this.input))&&(i.from<i.to||!r.overlay)){i.tree||materialize(i);let s=e.findMounts(i.from,r.parser);if("function"==typeof r.overlay)t=new ActiveOverlay(r.parser,r.overlay,s,this.inner.length,i.from,i.tree,t);else{let e=punchRanges(this.ranges,r.overlay||(i.from<i.to?[new Range(i.from,i.to)]:[]));e.length&&checkRanges(e),!e.length&&r.overlay||this.inner.push(new InnerParse(r.parser,e.length?r.parser.startParse(this.input,enterFragments(s,e),e):r.parser.startParse(""),r.overlay?r.overlay.map((e=>new Range(e.from-i.from,e.to-i.from))):null,i.tree,e.length?e[0].from:i.from)),r.overlay?e.length&&(n={ranges:e,depth:0,prev:n}):a=!1}}else t&&(o=t.predicate(i))&&(!0===o&&(o=new Range(i.from,i.to)),o.from<o.to&&t.ranges.push(o));if(a&&i.firstChild())t&&t.depth++,n&&n.depth++;else for(;!i.nextSibling();){if(!i.parent())break e;if(t&&! --t.depth){let e=punchRanges(this.ranges,t.ranges);e.length&&(checkRanges(e),this.inner.splice(t.index,0,new InnerParse(t.parser,t.parser.startParse(this.input,enterFragments(t.mounts,e),e),t.ranges.map((e=>new Range(e.from-t.start,e.to-t.start))),t.target,e[0].from))),t=t.prev}n&&! --n.depth&&(n=n.prev)}}}}function checkCover(e,t,n){for(let i of e){if(i.from>=n)break;if(i.to>t)return i.from<=t&&i.to>=n?2:1}return 0}function sliceBuf(e,t,n,i,r,s){if(t<n){let o=e.buffer[t+1];i.push(e.slice(t,n,o)),r.push(o-s)}}function materialize(e){let{node:t}=e,n=[],i=t.context.buffer;do{n.push(e.index),e.parent()}while(!e.tree);let r=e.tree,s=r.children.indexOf(i),o=r.children[s],a=o.buffer,l=[s];r.children[s]=function e(i,r,s,c,h,d){let u=n[d],p=[],f=[];sliceBuf(o,i,u,p,f,c);let m=a[u+1],g=a[u+2];l.push(p.length);let O=d?e(u+4,a[u+3],o.set.types[a[u]],m,g-m,d-1):t.toTree();return p.push(O),f.push(m-c),sliceBuf(o,a[u+3],r,p,f,c),new Tree(s,p,f,h)}(0,a.length,NodeType.none,0,o.length,n.length-1);for(let t of l){let n=e.tree.children[t],i=e.tree.positions[t];e.yield(new TreeNode(n,i+e.from,t,e._tree))}}class StructureCursor{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(IterMode.IncludeAnonymous|IterMode.IgnoreMounts)}moveTo(e){let{cursor:t}=this,n=e-this.offset;for(;!this.done&&t.from<n;)t.to>=e&&t.enter(n,1,IterMode.IgnoreOverlays|IterMode.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(!(t.children.length&&0==t.positions[0]&&t.children[0]instanceof Tree))break;t=t.children[0]}return!1}}let FragmentCursor$2=class{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=null!==(t=n.tree.prop(stoppedInner))&&void 0!==t?t:n.to,this.inner=new StructureCursor(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=null!==(e=t.tree.prop(stoppedInner))&&void 0!==e?e:t.to,this.inner=new StructureCursor(t.tree,-t.offset)}}findMounts(e,t){var n;let i=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let e=this.inner.cursor.node;e;e=e.parent){let r=null===(n=e.tree)||void 0===n?void 0:n.prop(NodeProp.mounted);if(r&&r.parser==t)for(let t=this.fragI;t<this.fragments.length;t++){let n=this.fragments[t];if(n.from>=e.to)break;n.tree==this.curFrag.tree&&i.push({frag:n,pos:e.from-n.offset,mount:r})}}}return i}};function punchRanges(e,t){let n=null,i=t;for(let r=1,s=0;r<e.length;r++){let o=e[r-1].to,a=e[r].from;for(;s<i.length;s++){let e=i[s];if(e.from>=a)break;e.to<=o||(n||(i=n=t.slice()),e.from<o?(n[s]=new Range(e.from,o),e.to>a&&n.splice(s+1,0,new Range(a,e.to))):e.to>a?n[s--]=new Range(a,e.to):n.splice(s--,1))}}return i}function findCoverChanges(e,t,n,i){let r=0,s=0,o=!1,a=!1,l=-1e9,c=[];for(;;){let h=r==e.length?1e9:o?e[r].to:e[r].from,d=s==t.length?1e9:a?t[s].to:t[s].from;if(o!=a){let e=Math.max(l,n),t=Math.min(h,d,i);e<t&&c.push(new Range(e,t))}if(l=Math.min(h,d),1e9==l)break;h==l&&(o?(o=!1,r++):o=!0),d==l&&(a?(a=!1,s++):a=!0)}return c}function enterFragments(e,t){let n=[];for(let{pos:i,mount:r,frag:s}of e){let e=i+(r.overlay?r.overlay[0].from:0),o=e+r.tree.length,a=Math.max(s.from,e),l=Math.min(s.to,o);if(r.overlay){let o=findCoverChanges(t,r.overlay.map((e=>new Range(e.from+i,e.to+i))),a,l);for(let t=0,i=a;;t++){let a=t==o.length,c=a?l:o[t].from;if(c>i&&n.push(new TreeFragment(i,c,r.tree,-e,s.from>=i||s.openStart,s.to<=c||s.openEnd)),a)break;i=o[t].to}}else n.push(new TreeFragment(a,l,r.tree,-e,s.from>=e||s.openStart,s.to<=o||s.openEnd))}return n}let nextTagID=0;class Tag{constructor(e,t,n){this.set=e,this.base=t,this.modified=n,this.id=nextTagID++}static define(e){if(null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let t=new Tag([],null,[]);if(t.set.push(t),e)for(let n of e.set)t.set.push(n);return t}static defineModifier(){let e=new Modifier;return t=>t.modified.indexOf(e)>-1?t:Modifier.get(t.base||t,t.modified.concat(e).sort(((e,t)=>e.id-t.id)))}}let nextModifierID=0;class Modifier{constructor(){this.instances=[],this.id=nextModifierID++}static get(e,t){if(!t.length)return e;let n=t[0].instances.find((n=>n.base==e&&sameArray(t,n.modified)));if(n)return n;let i=[],r=new Tag(i,e,t);for(let e of t)e.instances.push(r);let s=powerSet(t);for(let t of e.set)if(!t.modified.length)for(let e of s)i.push(Modifier.get(t,e));return r}}function sameArray(e,t){return e.length==t.length&&e.every(((e,n)=>e==t[n]))}function powerSet(e){let t=[[]];for(let n=0;n<e.length;n++)for(let i=0,r=t.length;i<r;i++)t.push(t[i].concat(e[n]));return t.sort(((e,t)=>t.length-e.length))}function styleTags(e){let t=Object.create(null);for(let n in e){let i=e[n];Array.isArray(i)||(i=[i]);for(let e of n.split(" "))if(e){let n=[],r=2,s=e;for(let t=0;;){if("..."==s&&t>0&&t+3==e.length){r=1;break}let i=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!i)throw new RangeError("Invalid path: "+e);if(n.push("*"==i[0]?"":'"'==i[0][0]?JSON.parse(i[0]):i[0]),t+=i[0].length,t==e.length)break;let o=e[t++];if(t==e.length&&"!"==o){r=0;break}if("/"!=o)throw new RangeError("Invalid path: "+e);s=e.slice(t)}let o=n.length-1,a=n[o];if(!a)throw new RangeError("Invalid path: "+e);let l=new Rule(i,r,o>0?n.slice(0,o):null);t[a]=l.sort(t[a])}}return ruleNodeProp.add(t)}const ruleNodeProp=new NodeProp;class Rule{constructor(e,t,n,i){this.tags=e,this.mode=t,this.context=n,this.next=i}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}function tagHighlighter(e,t){let n=Object.create(null);for(let t of e)if(Array.isArray(t.tag))for(let e of t.tag)n[e.id]=t.class;else n[t.tag.id]=t.class;let{scope:i,all:r=null}=t||{};return{style:e=>{let t=r;for(let i of e)for(let e of i.set){let i=n[e.id];if(i){t=t?t+" "+i:i;break}}return t},scope:i}}function highlightTags(e,t){let n=null;for(let i of e){let e=i.style(t);e&&(n=n?n+" "+e:e)}return n}function highlightTree(e,t,n,i=0,r=e.length){let s=new HighlightBuilder(i,Array.isArray(t)?t:[t],n);s.highlightRange(e.cursor(),i,r,"",s.highlighters),s.flush(r)}Rule.empty=new Rule([],2,null);class HighlightBuilder{constructor(e,t,n){this.at=e,this.highlighters=t,this.span=n,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,n,i,r){let{type:s,from:o,to:a}=e;if(o>=n||a<=t)return;s.isTop&&(r=this.highlighters.filter((e=>!e.scope||e.scope(s))));let l=i,c=getStyleTags(e)||Rule.empty,h=highlightTags(r,c.tags);if(h&&(l&&(l+=" "),l+=h,1==c.mode&&(i+=(i?" ":"")+h)),this.startSpan(Math.max(t,o),l),c.opaque)return;let d=e.tree&&e.tree.prop(NodeProp.mounted);if(d&&d.overlay){let s=e.node.enter(d.overlay[0].from+o,1),c=this.highlighters.filter((e=>!e.scope||e.scope(d.tree.type))),h=e.firstChild();for(let u=0,p=o;;u++){let f=u<d.overlay.length?d.overlay[u]:null,m=f?f.from+o:a,g=Math.max(t,p),O=Math.min(n,m);if(g<O&&h)for(;e.from<O&&(this.highlightRange(e,g,O,i,r),this.startSpan(Math.min(O,e.to),l),!(e.to>=m)&&e.nextSibling()););if(!f||m>n)break;p=f.to+o,p>t&&(this.highlightRange(s.cursor(),Math.max(t,f.from+o),Math.min(n,p),"",c),this.startSpan(Math.min(n,p),l))}h&&e.parent()}else if(e.firstChild()){d&&(i="");do{if(!(e.to<=t)){if(e.from>=n)break;this.highlightRange(e,t,n,i,r),this.startSpan(Math.min(n,e.to),l)}}while(e.nextSibling());e.parent()}}}function getStyleTags(e){let t=e.type.prop(ruleNodeProp);for(;t&&t.context&&!e.matchContext(t.context);)t=t.next;return t||null}const t=Tag.define,comment=t(),name=t(),typeName=t(name),propertyName=t(name),literal=t(),string=t(literal),number=t(literal),content=t(),heading=t(content),keyword=t(),operator=t(),punctuation=t(),bracket=t(punctuation),meta=t(),tags$1={comment:comment,lineComment:t(comment),blockComment:t(comment),docComment:t(comment),name:name,variableName:t(name),typeName:typeName,tagName:t(typeName),propertyName:propertyName,attributeName:t(propertyName),className:t(name),labelName:t(name),namespace:t(name),macroName:t(name),literal:literal,string:string,docString:t(string),character:t(string),attributeValue:t(string),number:number,integer:t(number),float:t(number),bool:t(literal),regexp:t(literal),escape:t(literal),color:t(literal),url:t(literal),keyword:keyword,self:t(keyword),null:t(keyword),atom:t(keyword),unit:t(keyword),modifier:t(keyword),operatorKeyword:t(keyword),controlKeyword:t(keyword),definitionKeyword:t(keyword),moduleKeyword:t(keyword),operator:operator,derefOperator:t(operator),arithmeticOperator:t(operator),logicOperator:t(operator),bitwiseOperator:t(operator),compareOperator:t(operator),updateOperator:t(operator),definitionOperator:t(operator),typeOperator:t(operator),controlOperator:t(operator),punctuation:punctuation,separator:t(punctuation),bracket:bracket,angleBracket:t(bracket),squareBracket:t(bracket),paren:t(bracket),brace:t(bracket),content:content,heading:heading,heading1:t(heading),heading2:t(heading),heading3:t(heading),heading4:t(heading),heading5:t(heading),heading6:t(heading),contentSeparator:t(content),list:t(content),quote:t(content),emphasis:t(content),strong:t(content),link:t(content),monospace:t(content),strikethrough:t(content),inserted:t(),deleted:t(),changed:t(),invalid:t(),meta:meta,documentMeta:t(meta),annotation:t(meta),processingInstruction:t(meta),definition:Tag.defineModifier(),constant:Tag.defineModifier(),function:Tag.defineModifier(),standard:Tag.defineModifier(),local:Tag.defineModifier(),special:Tag.defineModifier()};var _a;tagHighlighter([{tag:tags$1.link,class:"tok-link"},{tag:tags$1.heading,class:"tok-heading"},{tag:tags$1.emphasis,class:"tok-emphasis"},{tag:tags$1.strong,class:"tok-strong"},{tag:tags$1.keyword,class:"tok-keyword"},{tag:tags$1.atom,class:"tok-atom"},{tag:tags$1.bool,class:"tok-bool"},{tag:tags$1.url,class:"tok-url"},{tag:tags$1.labelName,class:"tok-labelName"},{tag:tags$1.inserted,class:"tok-inserted"},{tag:tags$1.deleted,class:"tok-deleted"},{tag:tags$1.literal,class:"tok-literal"},{tag:tags$1.string,class:"tok-string"},{tag:tags$1.number,class:"tok-number"},{tag:[tags$1.regexp,tags$1.escape,tags$1.special(tags$1.string)],class:"tok-string2"},{tag:tags$1.variableName,class:"tok-variableName"},{tag:tags$1.local(tags$1.variableName),class:"tok-variableName tok-local"},{tag:tags$1.definition(tags$1.variableName),class:"tok-variableName tok-definition"},{tag:tags$1.special(tags$1.variableName),class:"tok-variableName2"},{tag:tags$1.definition(tags$1.propertyName),class:"tok-propertyName tok-definition"},{tag:tags$1.typeName,class:"tok-typeName"},{tag:tags$1.namespace,class:"tok-namespace"},{tag:tags$1.className,class:"tok-className"},{tag:tags$1.macroName,class:"tok-macroName"},{tag:tags$1.propertyName,class:"tok-propertyName"},{tag:tags$1.operator,class:"tok-operator"},{tag:tags$1.comment,class:"tok-comment"},{tag:tags$1.meta,class:"tok-meta"},{tag:tags$1.invalid,class:"tok-invalid"},{tag:tags$1.punctuation,class:"tok-punctuation"}]);const languageDataProp=new NodeProp;function defineLanguageFacet(e){return Facet.define({combine:e?t=>t.concat(e):void 0})}const sublanguageProp=new NodeProp;class Language{constructor(e,t,n=[],i=""){this.data=e,this.name=i,EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(EditorState.prototype,"tree",{get(){return syntaxTree(this)}}),this.parser=t,this.extension=[language.of(this),EditorState.languageData.of(((e,t,n)=>{let i=topNodeAt(e,t,n),r=i.type.prop(languageDataProp);if(!r)return[];let s=e.facet(r),o=i.type.prop(sublanguageProp);if(o){let r=i.resolve(t-i.from,n);for(let t of o)if(t.test(r,e)){let n=e.facet(t.facet);return"replace"==t.type?n:n.concat(s)}}return s}))].concat(n)}isActiveAt(e,t,n=-1){return topNodeAt(e,t,n).type.prop(languageDataProp)==this.data}findRegions(e){let t=e.facet(language);if((null==t?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let n=[],i=(e,t)=>{if(e.prop(languageDataProp)==this.data)return void n.push({from:t,to:t+e.length});let r=e.prop(NodeProp.mounted);if(r){if(r.tree.prop(languageDataProp)==this.data){if(r.overlay)for(let e of r.overlay)n.push({from:e.from+t,to:e.to+t});else n.push({from:t,to:t+e.length});return}if(r.overlay){let e=n.length;if(i(r.tree,r.overlay[0].from+t),n.length>e)return}}for(let n=0;n<e.children.length;n++){let r=e.children[n];r instanceof Tree&&i(r,e.positions[n]+t)}};return i(syntaxTree(e),0),n}get allowsNesting(){return!0}}function topNodeAt(e,t,n){let i=e.facet(language),r=syntaxTree(e).topNode;if(!i||i.allowsNesting)for(let e=r;e;e=e.enter(t,n,IterMode.ExcludeBuffers))e.type.isTop&&(r=e);return r}Language.setState=StateEffect.define();class LRLanguage extends Language{constructor(e,t,n){super(e,t,[],n),this.parser=t}static define(e){let t=defineLanguageFacet(e.languageData);return new LRLanguage(t,e.parser.configure({props:[languageDataProp.add((e=>e.isTop?t:void 0))]}),e.name)}configure(e,t){return new LRLanguage(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function syntaxTree(e){let t=e.field(Language.state,!1);return t?t.tree:Tree.empty}class DocInput{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let n=this.cursorPos-this.string.length;return e<n||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-n,t-n)}}let currentContext=null;class ParseContext{constructor(e,t,n=[],i,r,s,o,a){this.parser=e,this.state=t,this.fragments=n,this.tree=i,this.treeLen=r,this.viewport=s,this.skipped=o,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,n){return new ParseContext(e,t,[],Tree.empty,0,n,[],null)}startParse(){return this.parser.startParse(new DocInput(this.state.doc),this.fragments)}work(e,t){return null!=t&&t>=this.state.doc.length&&(t=void 0),this.tree!=Tree.empty&&this.isDone(null!=t?t:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var n;if("number"==typeof e){let t=Date.now()+e;e=()=>Date.now()>t}for(this.parse||(this.parse=this.startParse()),null!=t&&(null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i){if(this.fragments=this.withoutTempSkipped(TreeFragment.addTree(i,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(n=this.parse.stoppedAt)&&void 0!==n?n:this.state.doc.length,this.tree=i,this.parse=null,!(this.treeLen<(null!=t?t:this.state.doc.length)))return!0;this.parse=this.startParse()}if(e())return!1}}))}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext((()=>{for(;!(t=this.parse.advance()););})),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=currentContext;currentContext=this;try{return e()}finally{currentContext=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=cutFragments(e,t.from,t.to);return e}changes(e,t){let{fragments:n,tree:i,treeLen:r,viewport:s,skipped:o}=this;if(this.takeTree(),!e.empty){let t=[];if(e.iterChangedRanges(((e,n,i,r)=>t.push({fromA:e,toA:n,fromB:i,toB:r}))),n=TreeFragment.applyChanges(n,t),i=Tree.empty,r=0,s={from:e.mapPos(s.from,-1),to:e.mapPos(s.to,1)},this.skipped.length){o=[];for(let t of this.skipped){let n=e.mapPos(t.from,1),i=e.mapPos(t.to,-1);n<i&&o.push({from:n,to:i})}}}return new ParseContext(this.parser,t,n,i,r,s,o,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let t=0;t<this.skipped.length;t++){let{from:n,to:i}=this.skipped[t];n<e.to&&i>e.from&&(this.fragments=cutFragments(this.fragments,n,i),this.skipped.splice(t--,1))}return!(this.skipped.length>=t)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Parser{createParse(t,n,i){let r=i[0].from,s=i[i.length-1].to;return{parsedPos:r,advance(){let t=currentContext;if(t){for(let e of i)t.tempSkipped.push(e);e&&(t.scheduleOn=t.scheduleOn?Promise.all([t.scheduleOn,e]):e)}return this.parsedPos=s,new Tree(NodeType.none,[],[],s-r)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&0==t[0].from&&t[0].to>=e}static get(){return currentContext}}function cutFragments(e,t,n){return TreeFragment.applyChanges(e,[{fromA:t,toA:n,fromB:t,toB:n}])}class LanguageState{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,n)||t.takeTree(),new LanguageState(t)}static init(e){let t=Math.min(3e3,e.doc.length),n=ParseContext.create(e.facet(language).parser,e,{from:0,to:t});return n.work(20,t)||n.takeTree(),new LanguageState(n)}}Language.state=StateField.define({create:LanguageState.init,update(e,t){for(let e of t.effects)if(e.is(Language.setState))return e.value;return t.startState.facet(language)!=t.state.facet(language)?LanguageState.init(t.state):e.apply(t)}});let requestIdle=e=>{let t=setTimeout((()=>e()),500);return()=>clearTimeout(t)};"undefined"!=typeof requestIdleCallback&&(requestIdle=e=>{let t=-1,n=setTimeout((()=>{t=requestIdleCallback(e,{timeout:400})}),100);return()=>t<0?clearTimeout(n):cancelIdleCallback(t)});const isInputPending="undefined"!=typeof navigator&&(null===(_a=navigator.scheduling)||void 0===_a?void 0:_a.isInputPending)?()=>navigator.scheduling.isInputPending():null,parseWorker=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(Language.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(Language.state);t.tree==t.context.tree&&t.context.isDone(e.doc.length)||(this.working=requestIdle(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:i}}=this.view,r=n.field(Language.state);if(r.tree==r.context.tree&&r.context.isDone(i+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,e&&!isInputPending?Math.max(25,e.timeRemaining()-5):1e9),o=r.context.treeLen<i&&n.doc.length>i+1e3,a=r.context.work((()=>isInputPending&&isInputPending()||Date.now()>s),i+(o?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(r.context.takeTree(),this.view.dispatch({effects:Language.setState.of(new LanguageState(r.context))})),this.chunkBudget>0&&(!a||o)&&this.scheduleWork(),this.checkAsyncSchedule(r.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then((()=>this.scheduleWork())).catch((e=>logException(this.view.state,e))).then((()=>this.workScheduled--)),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),language=Facet.define({combine:e=>e.length?e[0]:null,enables:e=>[Language.state,parseWorker,EditorView.contentAttributes.compute([e],(t=>{let n=t.facet(e);return n&&n.name?{"data-language":n.name}:{}}))]});class LanguageSupport{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}class LanguageDescription{constructor(e,t,n,i,r,s=void 0){this.name=e,this.alias=t,this.extensions=n,this.filename=i,this.loadFunc=r,this.support=s,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then((e=>this.support=e),(e=>{throw this.loading=null,e})))}static of(e){let{load:t,support:n}=e;if(!t){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");t=()=>Promise.resolve(n)}return new LanguageDescription(e.name,(e.alias||[]).concat(e.name).map((e=>e.toLowerCase())),e.extensions||[],e.filename,t,n)}static matchFilename(e,t){for(let n of e)if(n.filename&&n.filename.test(t))return n;let n=/\.([^.]+)$/.exec(t);if(n)for(let t of e)if(t.extensions.indexOf(n[1])>-1)return t;return null}static matchLanguageName(e,t,n=!0){t=t.toLowerCase();for(let n of e)if(n.alias.some((e=>e==t)))return n;if(n)for(let n of e)for(let e of n.alias){let i=t.indexOf(e);if(i>-1&&(e.length>2||!/\w/.test(t[i-1])&&!/\w/.test(t[i+e.length])))return n}return null}}const indentService=Facet.define(),indentUnit=Facet.define({combine:e=>{if(!e.length)return"  ";let t=e[0];if(!t||/\S/.test(t)||Array.from(t).some((e=>e!=t[0])))throw new Error("Invalid indent unit: "+JSON.stringify(e[0]));return t}});function getIndentUnit(e){let t=e.facet(indentUnit);return 9==t.charCodeAt(0)?e.tabSize*t.length:t.length}function indentString(e,t){let n="",i=e.tabSize,r=e.facet(indentUnit)[0];if("\t"==r){for(;t>=i;)n+="\t",t-=i;r=" "}for(let e=0;e<t;e++)n+=r;return n}function getIndentation(e,t){e instanceof EditorState&&(e=new IndentContext(e));for(let n of e.state.facet(indentService)){let i=n(e,t);if(void 0!==i)return i}let n=syntaxTree(e.state);return n.length>=t?syntaxIndentation(e,n,t):null}class IndentContext{constructor(e,t={}){this.state=e,this.options=t,this.unit=getIndentUnit(e)}lineAt(e,t=1){let n=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:r}=this.options;return null!=i&&i>=n.from&&i<=n.to?r&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:n.text.slice(i-n.from),from:i}:{text:n.text.slice(0,i-n.from),from:n.from}:n}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:i}=this.lineAt(e,t);return n.slice(e-i,Math.min(n.length,e+100-i))}column(e,t=1){let{text:n,from:i}=this.lineAt(e,t),r=this.countColumn(n,e-i),s=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return s>-1&&(r+=s-this.countColumn(n,n.search(/\S|$/))),r}countColumn(e,t=e.length){return countColumn(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:n,from:i}=this.lineAt(e,t),r=this.options.overrideIndentation;if(r){let e=r(i);if(e>-1)return e}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const indentNodeProp=new NodeProp;function syntaxIndentation(e,t,n){let i=t.resolveStack(n),r=i.node.enterUnfinishedNodesBefore(n);if(r!=i.node){let e=[];for(let t=r;t!=i.node;t=t.parent)e.push(t);for(let t=e.length-1;t>=0;t--)i={node:e[t],next:i}}return indentFor(i,e,n)}function indentFor(e,t,n){for(let i=e;i;i=i.next){let e=indentStrategy(i.node);if(e)return e(TreeIndentContext.create(t,n,i))}return 0}function ignoreClosed(e){return e.pos==e.options.simulateBreak&&e.options.simulateDoubleBreak}function indentStrategy(e){let t=e.type.prop(indentNodeProp);if(t)return t;let n,i=e.firstChild;if(i&&(n=i.type.prop(NodeProp.closedBy))){let t=e.lastChild,i=t&&n.indexOf(t.name)>-1;return e=>delimitedStrategy(e,!0,1,void 0,i&&!ignoreClosed(e)?t.from:void 0)}return null==e.parent?topIndent:null}function topIndent(){return 0}class TreeIndentContext extends IndentContext{constructor(e,t,n){super(e.state,e.options),this.base=e,this.pos=t,this.context=n}get node(){return this.context.node}static create(e,t,n){return new TreeIndentContext(e,t,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(t.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(isParent(n,e))break;t=this.state.doc.lineAt(n.from)}return this.lineIndent(t.from)}continue(){return indentFor(this.context.next,this.base,this.pos)}}function isParent(e,t){for(let n=t;n;n=n.parent)if(e==n)return!0;return!1}function bracketedAligned(e){let t=e.node,n=t.childAfter(t.from),i=t.lastChild;if(!n)return null;let r=e.options.simulateBreak,s=e.state.doc.lineAt(n.from),o=null==r||r<=s.from?s.to:Math.min(s.to,r);for(let e=n.to;;){let r=t.childAfter(e);if(!r||r==i)return null;if(!r.type.isSkipped)return r.from<o?n:null;e=r.to}}function delimitedIndent({closing:e,align:t=!0,units:n=1}){return i=>delimitedStrategy(i,t,n,e)}function delimitedStrategy(e,t,n,i,r){let s=e.textAfter,o=s.match(/^\s*/)[0].length,a=i&&s.slice(o,o+i.length)==i||r==e.pos+o,l=t?bracketedAligned(e):null;return l?a?e.column(l.from):e.column(l.to):e.baseIndent+(a?0:e.unit*n)}const flatIndent=e=>e.baseIndent;function continuedIndent({except:e,units:t=1}={}){return n=>{let i=e&&e.test(n.textAfter);return n.baseIndent+(i?0:t*n.unit)}}const DontIndentBeyond=200;function indentOnInput(){return EditorState.transactionFilter.of((e=>{if(!e.docChanged||!e.isUserEvent("input.type")&&!e.isUserEvent("input.complete"))return e;let t=e.startState.languageDataAt("indentOnInput",e.startState.selection.main.head);if(!t.length)return e;let n=e.newDoc,{head:i}=e.newSelection.main,r=n.lineAt(i);if(i>r.from+DontIndentBeyond)return e;let s=n.sliceString(r.from,i);if(!t.some((e=>e.test(s))))return e;let{state:o}=e,a=-1,l=[];for(let{head:e}of o.selection.ranges){let t=o.doc.lineAt(e);if(t.from==a)continue;a=t.from;let n=getIndentation(o,t.from);if(null==n)continue;let i=/^\s*/.exec(t.text)[0],r=indentString(o,n);i!=r&&l.push({from:t.from,to:t.from+i.length,insert:r})}return l.length?[e,{changes:l,sequential:!0}]:e}))}const foldService=Facet.define(),foldNodeProp=new NodeProp;function foldInside(e){let t=e.firstChild,n=e.lastChild;return t&&t.to<n.from?{from:t.to,to:n.type.isError?e.to:n.from}:null}function syntaxFolding(e,t,n){let i=syntaxTree(e);if(i.length<n)return null;let r=null;for(let s=i.resolveStack(n,1);s;s=s.next){let o=s.node;if(o.to<=n||o.from>n)continue;if(r&&o.from<t)break;let a=o.type.prop(foldNodeProp);if(a&&(o.to<i.length-50||i.length==e.doc.length||!isUnfinished(o))){let i=a(o,e);i&&i.from<=n&&i.from>=t&&i.to>n&&(r=i)}}return r}function isUnfinished(e){let t=e.lastChild;return t&&t.to==e.to&&t.type.isError}function foldable(e,t,n){for(let i of e.facet(foldService)){let r=i(e,t,n);if(r)return r}return syntaxFolding(e,t,n)}function mapRange(e,t){let n=t.mapPos(e.from,1),i=t.mapPos(e.to,-1);return n>=i?void 0:{from:n,to:i}}const foldEffect=StateEffect.define({map:mapRange}),unfoldEffect=StateEffect.define({map:mapRange});function selectedLines(e){let t=[];for(let{head:n}of e.state.selection.ranges)t.some((e=>e.from<=n&&e.to>=n))||t.push(e.lineBlockAt(n));return t}const foldState=StateField.define({create:()=>Decoration.none,update(e,t){e=e.map(t.changes);for(let n of t.effects)if(n.is(foldEffect)&&!foldExists(e,n.value.from,n.value.to)){let{preparePlaceholder:i}=t.state.facet(foldConfig),r=i?Decoration.replace({widget:new PreparedFoldWidget(i(t.state,n.value))}):foldWidget;e=e.update({add:[r.range(n.value.from,n.value.to)]})}else n.is(unfoldEffect)&&(e=e.update({filter:(e,t)=>n.value.from!=e||n.value.to!=t,filterFrom:n.value.from,filterTo:n.value.to}));if(t.selection){let n=!1,{head:i}=t.selection.main;e.between(i,i,((e,t)=>{e<i&&t>i&&(n=!0)})),n&&(e=e.update({filterFrom:i,filterTo:i,filter:(e,t)=>t<=i||e>=i}))}return e},provide:e=>EditorView.decorations.from(e),toJSON(e,t){let n=[];return e.between(0,t.doc.length,((e,t)=>{n.push(e,t)})),n},fromJSON(e){if(!Array.isArray(e)||e.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let n=0;n<e.length;){let i=e[n++],r=e[n++];if("number"!=typeof i||"number"!=typeof r)throw new RangeError("Invalid JSON for fold state");t.push(foldWidget.range(i,r))}return Decoration.set(t,!0)}});function findFold(e,t,n){var i;let r=null;return null===(i=e.field(foldState,!1))||void 0===i||i.between(t,n,((e,t)=>{(!r||r.from>e)&&(r={from:e,to:t})})),r}function foldExists(e,t,n){let i=!1;return e.between(t,t,((e,r)=>{e==t&&r==n&&(i=!0)})),i}function maybeEnable(e,t){return e.field(foldState,!1)?t:t.concat(StateEffect.appendConfig.of(codeFolding()))}const foldCode=e=>{for(let t of selectedLines(e)){let n=foldable(e.state,t.from,t.to);if(n)return e.dispatch({effects:maybeEnable(e.state,[foldEffect.of(n),announceFold(e,n)])}),!0}return!1},unfoldCode=e=>{if(!e.state.field(foldState,!1))return!1;let t=[];for(let n of selectedLines(e)){let i=findFold(e.state,n.from,n.to);i&&t.push(unfoldEffect.of(i),announceFold(e,i,!1))}return t.length&&e.dispatch({effects:t}),t.length>0};function announceFold(e,t,n=!0){let i=e.state.doc.lineAt(t.from).number,r=e.state.doc.lineAt(t.to).number;return EditorView.announce.of(`${e.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${e.state.phrase("to")} ${r}.`)}const foldAll=e=>{let{state:t}=e,n=[];for(let i=0;i<t.doc.length;){let r=e.lineBlockAt(i),s=foldable(t,r.from,r.to);s&&n.push(foldEffect.of(s)),i=(s?e.lineBlockAt(s.to):r).to+1}return n.length&&e.dispatch({effects:maybeEnable(e.state,n)}),!!n.length},unfoldAll=e=>{let t=e.state.field(foldState,!1);if(!t||!t.size)return!1;let n=[];return t.between(0,e.state.doc.length,((e,t)=>{n.push(unfoldEffect.of({from:e,to:t}))})),e.dispatch({effects:n}),!0},foldKeymap=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:foldCode},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:unfoldCode},{key:"Ctrl-Alt-[",run:foldAll},{key:"Ctrl-Alt-]",run:unfoldAll}],defaultConfig={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},foldConfig=Facet.define({combine:e=>combineConfig(e,defaultConfig)});function codeFolding(e){let t=[foldState,baseTheme$1$2];return e&&t.push(foldConfig.of(e)),t}function widgetToDOM(e,t){let{state:n}=e,i=n.facet(foldConfig),r=t=>{let n=e.lineBlockAt(e.posAtDOM(t.target)),i=findFold(e.state,n.from,n.to);i&&e.dispatch({effects:unfoldEffect.of(i)}),t.preventDefault()};if(i.placeholderDOM)return i.placeholderDOM(e,r,t);let s=document.createElement("span");return s.textContent=i.placeholderText,s.setAttribute("aria-label",n.phrase("folded code")),s.title=n.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=r,s}const foldWidget=Decoration.replace({widget:new class extends WidgetType{toDOM(e){return widgetToDOM(e,null)}}});class PreparedFoldWidget extends WidgetType{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return widgetToDOM(e,this.value)}}const foldGutterDefaults={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class FoldMarker extends GutterMarker{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function foldGutter(e={}){let t=Object.assign(Object.assign({},foldGutterDefaults),e),n=new FoldMarker(t,!0),i=new FoldMarker(t,!1),r=ViewPlugin.fromClass(class{constructor(e){this.from=e.viewport.from,this.markers=this.buildMarkers(e)}update(e){(e.docChanged||e.viewportChanged||e.startState.facet(language)!=e.state.facet(language)||e.startState.field(foldState,!1)!=e.state.field(foldState,!1)||syntaxTree(e.startState)!=syntaxTree(e.state)||t.foldingChanged(e))&&(this.markers=this.buildMarkers(e.view))}buildMarkers(e){let t=new RangeSetBuilder;for(let r of e.viewportLineBlocks){let s=findFold(e.state,r.from,r.to)?i:foldable(e.state,r.from,r.to)?n:null;s&&t.add(r.from,r.from,s)}return t.finish()}}),{domEventHandlers:s}=t;return[r,gutter({class:"cm-foldGutter",markers(e){var t;return(null===(t=e.plugin(r))||void 0===t?void 0:t.markers)||RangeSet.empty},initialSpacer:()=>new FoldMarker(t,!1),domEventHandlers:Object.assign(Object.assign({},s),{click:(e,t,n)=>{if(s.click&&s.click(e,t,n))return!0;let i=findFold(e.state,t.from,t.to);if(i)return e.dispatch({effects:unfoldEffect.of(i)}),!0;let r=foldable(e.state,t.from,t.to);return!!r&&(e.dispatch({effects:foldEffect.of(r)}),!0)}})}),codeFolding()]}const baseTheme$1$2=EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class HighlightStyle{constructor(e,t){let n;function i(e){let t=StyleModule.newName();return(n||(n=Object.create(null)))["."+t]=e,t}this.specs=e;const r="string"==typeof t.all?t.all:t.all?i(t.all):void 0,s=t.scope;this.scope=s instanceof Language?e=>e.prop(languageDataProp)==s.data:s?e=>e==s:void 0,this.style=tagHighlighter(e.map((e=>({tag:e.tag,class:e.class||i(Object.assign({},e,{tag:null}))}))),{all:r}).style,this.module=n?new StyleModule(n):null,this.themeType=t.themeType}static define(e,t){return new HighlightStyle(e,t||{})}}const highlighterFacet=Facet.define(),fallbackHighlighter=Facet.define({combine:e=>e.length?[e[0]]:null});function getHighlighters(e){let t=e.facet(highlighterFacet);return t.length?t:e.facet(fallbackHighlighter)}function syntaxHighlighting(e,t){let n,i=[treeHighlighter];return e instanceof HighlightStyle&&(e.module&&i.push(EditorView.styleModule.of(e.module)),n=e.themeType),(null==t?void 0:t.fallback)?i.push(fallbackHighlighter.of(e)):n?i.push(highlighterFacet.computeN([EditorView.darkTheme],(t=>t.facet(EditorView.darkTheme)==("dark"==n)?[e]:[]))):i.push(highlighterFacet.of(e)),i}class TreeHighlighter{constructor(e){this.markCache=Object.create(null),this.tree=syntaxTree(e.state),this.decorations=this.buildDeco(e,getHighlighters(e.state))}update(e){let t=syntaxTree(e.state),n=getHighlighters(e.state),i=n!=getHighlighters(e.startState);t.length<e.view.viewport.to&&!i&&t.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,n))}buildDeco(e,t){if(!t||!this.tree.length)return Decoration.none;let n=new RangeSetBuilder;for(let{from:i,to:r}of e.visibleRanges)highlightTree(this.tree,t,((e,t,i)=>{n.add(e,t,this.markCache[i]||(this.markCache[i]=Decoration.mark({class:i})))}),i,r);return n.finish()}}const treeHighlighter=Prec.high(ViewPlugin.fromClass(TreeHighlighter,{decorations:e=>e.decorations})),defaultHighlightStyle=HighlightStyle.define([{tag:tags$1.meta,color:"#404740"},{tag:tags$1.link,textDecoration:"underline"},{tag:tags$1.heading,textDecoration:"underline",fontWeight:"bold"},{tag:tags$1.emphasis,fontStyle:"italic"},{tag:tags$1.strong,fontWeight:"bold"},{tag:tags$1.strikethrough,textDecoration:"line-through"},{tag:tags$1.keyword,color:"#708"},{tag:[tags$1.atom,tags$1.bool,tags$1.url,tags$1.contentSeparator,tags$1.labelName],color:"#219"},{tag:[tags$1.literal,tags$1.inserted],color:"#164"},{tag:[tags$1.string,tags$1.deleted],color:"#a11"},{tag:[tags$1.regexp,tags$1.escape,tags$1.special(tags$1.string)],color:"#e40"},{tag:tags$1.definition(tags$1.variableName),color:"#00f"},{tag:tags$1.local(tags$1.variableName),color:"#30a"},{tag:[tags$1.typeName,tags$1.namespace],color:"#085"},{tag:tags$1.className,color:"#167"},{tag:[tags$1.special(tags$1.variableName),tags$1.macroName],color:"#256"},{tag:tags$1.definition(tags$1.propertyName),color:"#00c"},{tag:tags$1.comment,color:"#940"},{tag:tags$1.invalid,color:"#f00"}]),baseTheme$3=EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),DefaultScanDist=1e4,DefaultBrackets="()[]{}",bracketMatchingConfig=Facet.define({combine:e=>combineConfig(e,{afterCursor:!0,brackets:DefaultBrackets,maxScanDistance:DefaultScanDist,renderMatch:defaultRenderMatch})}),matchingMark=Decoration.mark({class:"cm-matchingBracket"}),nonmatchingMark=Decoration.mark({class:"cm-nonmatchingBracket"});function defaultRenderMatch(e){let t=[],n=e.matched?matchingMark:nonmatchingMark;return t.push(n.range(e.start.from,e.start.to)),e.end&&t.push(n.range(e.end.from,e.end.to)),t}const bracketMatchingState=StateField.define({create:()=>Decoration.none,update(e,t){if(!t.docChanged&&!t.selection)return e;let n=[],i=t.state.facet(bracketMatchingConfig);for(let e of t.state.selection.ranges){if(!e.empty)continue;let r=matchBrackets(t.state,e.head,-1,i)||e.head>0&&matchBrackets(t.state,e.head-1,1,i)||i.afterCursor&&(matchBrackets(t.state,e.head,1,i)||e.head<t.state.doc.length&&matchBrackets(t.state,e.head+1,-1,i));r&&(n=n.concat(i.renderMatch(r,t.state)))}return Decoration.set(n,!0)},provide:e=>EditorView.decorations.from(e)}),bracketMatchingUnique=[bracketMatchingState,baseTheme$3];function bracketMatching(e={}){return[bracketMatchingConfig.of(e),bracketMatchingUnique]}const bracketMatchingHandle=new NodeProp;function matchingNodes(e,t,n){let i=e.prop(t<0?NodeProp.openedBy:NodeProp.closedBy);if(i)return i;if(1==e.name.length){let i=n.indexOf(e.name);if(i>-1&&i%2==(t<0?1:0))return[n[i+t]]}return null}function findHandle(e){let t=e.type.prop(bracketMatchingHandle);return t?t(e.node):e}function matchBrackets(e,t,n,i={}){let r=i.maxScanDistance||DefaultScanDist,s=i.brackets||DefaultBrackets,o=syntaxTree(e),a=o.resolveInner(t,n);for(let i=a;i;i=i.parent){let r=matchingNodes(i.type,n,s);if(r&&i.from<i.to){let o=findHandle(i);if(o&&(n>0?t>=o.from&&t<o.to:t>o.from&&t<=o.to))return matchMarkedBrackets(e,t,n,i,o,r,s)}}return matchPlainBrackets(e,t,n,o,a.type,r,s)}function matchMarkedBrackets(e,t,n,i,r,s,o){let a=i.parent,l={from:r.from,to:r.to},c=0,h=null==a?void 0:a.cursor();if(h&&(n<0?h.childBefore(i.from):h.childAfter(i.to)))do{if(n<0?h.to<=i.from:h.from>=i.to){if(0==c&&s.indexOf(h.type.name)>-1&&h.from<h.to){let e=findHandle(h);return{start:l,end:e?{from:e.from,to:e.to}:void 0,matched:!0}}if(matchingNodes(h.type,n,o))c++;else if(matchingNodes(h.type,-n,o)){if(0==c){let e=findHandle(h);return{start:l,end:e&&e.from<e.to?{from:e.from,to:e.to}:void 0,matched:!1}}c--}}}while(n<0?h.prevSibling():h.nextSibling());return{start:l,matched:!1}}function matchPlainBrackets(e,t,n,i,r,s,o){let a=n<0?e.sliceDoc(t-1,t):e.sliceDoc(t,t+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let c={from:n<0?t-1:t,to:n>0?t+1:t},h=e.doc.iterRange(t,n>0?e.doc.length:0),d=0;for(let e=0;!h.next().done&&e<=s;){let s=h.value;n<0&&(e+=s.length);let a=t+e*n;for(let e=n>0?0:s.length-1,t=n>0?s.length:-1;e!=t;e+=n){let t=o.indexOf(s[e]);if(!(t<0||i.resolveInner(a+e,1).type!=r))if(t%2==0==n>0)d++;else{if(1==d)return{start:c,end:{from:a+e,to:a+e+1},matched:t>>1==l>>1};d--}}n>0&&(e+=s.length)}return h.done?{start:c,matched:!1}:null}const noTokens=Object.create(null),typeArray=[NodeType.none],warned=[],byTag=Object.create(null),defaultTable=Object.create(null);for(let[e,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])defaultTable[e]=createTokenType(noTokens,t);function warnForPart(e,t){warned.indexOf(e)>-1||(warned.push(e),console.warn(t))}function createTokenType(e,t){let n=[];for(let i of t.split(" ")){let t=[];for(let n of i.split(".")){let i=e[n]||tags$1[n];i?"function"==typeof i?t.length?t=t.map(i):warnForPart(n,`Modifier ${n} used at start of tag`):t.length?warnForPart(n,`Tag ${n} used as modifier`):t=Array.isArray(i)?i:[i]:warnForPart(n,`Unknown highlighting tag ${n}`)}for(let e of t)n.push(e)}if(!n.length)return 0;let i=t.replace(/ /g,"_"),r=i+" "+n.map((e=>e.id)),s=byTag[r];if(s)return s.id;let o=byTag[r]=NodeType.define({id:typeArray.length,name:i,props:[styleTags({[i]:n})]});return typeArray.push(o),o.id}Direction.RTL,Direction.LTR;const toggleComment=e=>{let{state:t}=e,n=t.doc.lineAt(t.selection.main.from),i=getConfig(e.state,n.from);return i.line?toggleLineComment(e):!!i.block&&toggleBlockCommentByLine(e)};function command(e,t){return({state:n,dispatch:i})=>{if(n.readOnly)return!1;let r=e(t,n);return!!r&&(i(n.update(r)),!0)}}const toggleLineComment=command(changeLineComment,0),toggleBlockComment=command(changeBlockComment,0),toggleBlockCommentByLine=command(((e,t)=>changeBlockComment(e,t,selectedLineRanges(t))),0);function getConfig(e,t){let n=e.languageDataAt("commentTokens",t);return n.length?n[0]:{}}const SearchMargin=50;function findBlockComment(e,{open:t,close:n},i,r){let s,o,a=e.sliceDoc(i-SearchMargin,i),l=e.sliceDoc(r,r+SearchMargin),c=/\s*$/.exec(a)[0].length,h=/^\s*/.exec(l)[0].length,d=a.length-c;if(a.slice(d-t.length,d)==t&&l.slice(h,h+n.length)==n)return{open:{pos:i-c,margin:c&&1},close:{pos:r+h,margin:h&&1}};r-i<=2*SearchMargin?s=o=e.sliceDoc(i,r):(s=e.sliceDoc(i,i+SearchMargin),o=e.sliceDoc(r-SearchMargin,r));let u=/^\s*/.exec(s)[0].length,p=/\s*$/.exec(o)[0].length,f=o.length-p-n.length;return s.slice(u,u+t.length)==t&&o.slice(f,f+n.length)==n?{open:{pos:i+u+t.length,margin:/\s/.test(s.charAt(u+t.length))?1:0},close:{pos:r-p-n.length,margin:/\s/.test(o.charAt(f-1))?1:0}}:null}function selectedLineRanges(e){let t=[];for(let n of e.selection.ranges){let i=e.doc.lineAt(n.from),r=n.to<=i.to?i:e.doc.lineAt(n.to),s=t.length-1;s>=0&&t[s].to>i.from?t[s].to=r.to:t.push({from:i.from+/^\s*/.exec(i.text)[0].length,to:r.to})}return t}function changeBlockComment(e,t,n=t.selection.ranges){let i=n.map((e=>getConfig(t,e.from).block));if(!i.every((e=>e)))return null;let r=n.map(((e,n)=>findBlockComment(t,i[n],e.from,e.to)));if(2!=e&&!r.every((e=>e)))return{changes:t.changes(n.map(((e,t)=>r[t]?[]:[{from:e.from,insert:i[t].open+" "},{from:e.to,insert:" "+i[t].close}])))};if(1!=e&&r.some((e=>e))){let e=[];for(let t,n=0;n<r.length;n++)if(t=r[n]){let r=i[n],{open:s,close:o}=t;e.push({from:s.pos-r.open.length,to:s.pos+s.margin},{from:o.pos-o.margin,to:o.pos+r.close.length})}return{changes:e}}return null}function changeLineComment(e,t,n=t.selection.ranges){let i=[],r=-1;for(let{from:e,to:s}of n){let n=i.length,o=1e9,a=getConfig(t,e).line;if(a){for(let n=e;n<=s;){let l=t.doc.lineAt(n);if(l.from>r&&(e==s||s>l.from)){r=l.from;let e=/^\s*/.exec(l.text)[0].length,t=e==l.length,n=l.text.slice(e,e+a.length)==a?e:-1;e<l.text.length&&e<o&&(o=e),i.push({line:l,comment:n,token:a,indent:e,empty:t,single:!1})}n=l.to+1}if(o<1e9)for(let e=n;e<i.length;e++)i[e].indent<i[e].line.text.length&&(i[e].indent=o);i.length==n+1&&(i[n].single=!0)}}if(2!=e&&i.some((e=>e.comment<0&&(!e.empty||e.single)))){let e=[];for(let{line:t,token:n,indent:r,empty:s,single:o}of i)!o&&s||e.push({from:t.from+r,insert:n+" "});let n=t.changes(e);return{changes:n,selection:t.selection.map(n,1)}}if(1!=e&&i.some((e=>e.comment>=0))){let e=[];for(let{line:t,comment:n,token:r}of i)if(n>=0){let i=t.from+n,s=i+r.length;" "==t.text[s-t.from]&&s++,e.push({from:i,to:s})}return{changes:e}}return null}const fromHistory=Annotation.define(),isolateHistory=Annotation.define(),invertedEffects=Facet.define(),historyConfig=Facet.define({combine:e=>combineConfig(e,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(n,i)=>e(n,i)||t(n,i)})}),historyField_=StateField.define({create:()=>HistoryState.empty,update(e,t){let n=t.state.facet(historyConfig),i=t.annotation(fromHistory);if(i){let r=HistEvent.fromTransaction(t,i.selection),s=i.side,o=0==s?e.undone:e.done;return o=r?updateBranch(o,o.length,n.minDepth,r):addSelection(o,t.startState.selection),new HistoryState(0==s?i.rest:o,0==s?o:i.rest)}let r=t.annotation(isolateHistory);if("full"!=r&&"before"!=r||(e=e.isolate()),!1===t.annotation(Transaction.addToHistory))return t.changes.empty?e:e.addMapping(t.changes.desc);let s=HistEvent.fromTransaction(t),o=t.annotation(Transaction.time),a=t.annotation(Transaction.userEvent);return s?e=e.addChanges(s,o,a,n,t):t.selection&&(e=e.addSelection(t.startState.selection,o,a,n.newGroupDelay)),"full"!=r&&"after"!=r||(e=e.isolate()),e},toJSON:e=>({done:e.done.map((e=>e.toJSON())),undone:e.undone.map((e=>e.toJSON()))}),fromJSON:e=>new HistoryState(e.done.map(HistEvent.fromJSON),e.undone.map(HistEvent.fromJSON))});function history(e={}){return[historyField_,historyConfig.of(e),EditorView.domEventHandlers({beforeinput(e,t){let n="historyUndo"==e.inputType?undo:"historyRedo"==e.inputType?redo:null;return!!n&&(e.preventDefault(),n(t))}})]}function cmd(e,t){return function({state:n,dispatch:i}){if(!t&&n.readOnly)return!1;let r=n.field(historyField_,!1);if(!r)return!1;let s=r.pop(e,n,t);return!!s&&(i(s),!0)}}const undo=cmd(0,!1),redo=cmd(1,!1),undoSelection=cmd(0,!0),redoSelection=cmd(1,!0);class HistEvent{constructor(e,t,n,i,r){this.changes=e,this.effects=t,this.mapped=n,this.startSelection=i,this.selectionsAfter=r}setSelAfter(e){return new HistEvent(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,n;return{changes:null===(e=this.changes)||void 0===e?void 0:e.toJSON(),mapped:null===(t=this.mapped)||void 0===t?void 0:t.toJSON(),startSelection:null===(n=this.startSelection)||void 0===n?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map((e=>e.toJSON()))}}static fromJSON(e){return new HistEvent(e.changes&&ChangeSet.fromJSON(e.changes),[],e.mapped&&ChangeDesc.fromJSON(e.mapped),e.startSelection&&EditorSelection.fromJSON(e.startSelection),e.selectionsAfter.map(EditorSelection.fromJSON))}static fromTransaction(e,t){let n=none$2;for(let t of e.startState.facet(invertedEffects)){let i=t(e);i.length&&(n=n.concat(i))}return!n.length&&e.changes.empty?null:new HistEvent(e.changes.invert(e.startState.doc),n,void 0,t||e.startState.selection,none$2)}static selection(e){return new HistEvent(void 0,none$2,void 0,void 0,e)}}function updateBranch(e,t,n,i){let r=t+1>n+20?t-n-1:0,s=e.slice(r,t);return s.push(i),s}function isAdjacent(e,t){let n=[],i=!1;return e.iterChangedRanges(((e,t)=>n.push(e,t))),t.iterChangedRanges(((e,t,r,s)=>{for(let e=0;e<n.length;){let t=n[e++],o=n[e++];s>=t&&r<=o&&(i=!0)}})),i}function eqSelectionShape(e,t){return e.ranges.length==t.ranges.length&&0===e.ranges.filter(((e,n)=>e.empty!=t.ranges[n].empty)).length}function conc(e,t){return e.length?t.length?e.concat(t):e:t}const none$2=[],MaxSelectionsPerEvent=200;function addSelection(e,t){if(e.length){let n=e[e.length-1],i=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-MaxSelectionsPerEvent));return i.length&&i[i.length-1].eq(t)?e:(i.push(t),updateBranch(e,e.length-1,1e9,n.setSelAfter(i)))}return[HistEvent.selection([t])]}function popSelection(e){let t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function addMappingToBranch(e,t){if(!e.length)return e;let n=e.length,i=none$2;for(;n;){let r=mapEvent(e[n-1],t,i);if(r.changes&&!r.changes.empty||r.effects.length){let t=e.slice(0,n);return t[n-1]=r,t}t=r.mapped,n--,i=r.selectionsAfter}return i.length?[HistEvent.selection(i)]:none$2}function mapEvent(e,t,n){let i=conc(e.selectionsAfter.length?e.selectionsAfter.map((e=>e.map(t))):none$2,n);if(!e.changes)return HistEvent.selection(i);let r=e.changes.map(t),s=t.mapDesc(e.changes,!0),o=e.mapped?e.mapped.composeDesc(s):s;return new HistEvent(r,StateEffect.mapEffects(e.effects,t),o,e.startSelection.map(s),i)}const joinableUserEvent=/^(input\.type|delete)($|\.)/;class HistoryState{constructor(e,t,n=0,i=void 0){this.done=e,this.undone=t,this.prevTime=n,this.prevUserEvent=i}isolate(){return this.prevTime?new HistoryState(this.done,this.undone):this}addChanges(e,t,n,i,r){let s=this.done,o=s[s.length-1];return s=o&&o.changes&&!o.changes.empty&&e.changes&&(!n||joinableUserEvent.test(n))&&(!o.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(r,isAdjacent(o.changes,e.changes))||"input.type.compose"==n)?updateBranch(s,s.length-1,i.minDepth,new HistEvent(e.changes.compose(o.changes),conc(e.effects,o.effects),o.mapped,o.startSelection,none$2)):updateBranch(s,s.length,i.minDepth,e),new HistoryState(s,none$2,t,n)}addSelection(e,t,n,i){let r=this.done.length?this.done[this.done.length-1].selectionsAfter:none$2;return r.length>0&&t-this.prevTime<i&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&eqSelectionShape(r[r.length-1],e)?this:new HistoryState(addSelection(this.done,e),this.undone,t,n)}addMapping(e){return new HistoryState(addMappingToBranch(this.done,e),addMappingToBranch(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,n){let i=0==e?this.done:this.undone;if(0==i.length)return null;let r=i[i.length-1],s=r.selectionsAfter[0]||t.selection;if(n&&r.selectionsAfter.length)return t.update({selection:r.selectionsAfter[r.selectionsAfter.length-1],annotations:fromHistory.of({side:e,rest:popSelection(i),selection:s}),userEvent:0==e?"select.undo":"select.redo",scrollIntoView:!0});if(r.changes){let n=1==i.length?none$2:i.slice(0,i.length-1);return r.mapped&&(n=addMappingToBranch(n,r.mapped)),t.update({changes:r.changes,selection:r.startSelection,effects:r.effects,annotations:fromHistory.of({side:e,rest:n,selection:s}),filter:!1,userEvent:0==e?"undo":"redo",scrollIntoView:!0})}return null}}HistoryState.empty=new HistoryState(none$2,none$2);const historyKeymap=[{key:"Mod-z",run:undo,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:redo,preventDefault:!0},{linux:"Ctrl-Shift-z",run:redo,preventDefault:!0},{key:"Mod-u",run:undoSelection,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:redoSelection,preventDefault:!0}];function updateSel(e,t){return EditorSelection.create(e.ranges.map(t),e.mainIndex)}function setSel(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function moveSel({state:e,dispatch:t},n){let i=updateSel(e.selection,n);return!i.eq(e.selection,!0)&&(t(setSel(e,i)),!0)}function rangeEnd(e,t){return EditorSelection.cursor(t?e.to:e.from)}function cursorByChar(e,t){return moveSel(e,(n=>n.empty?e.moveByChar(n,t):rangeEnd(n,t)))}function ltrAtCursor(e){return e.textDirectionAt(e.state.selection.main.head)==Direction.LTR}const cursorCharLeft=e=>cursorByChar(e,!ltrAtCursor(e)),cursorCharRight=e=>cursorByChar(e,ltrAtCursor(e));function cursorByGroup(e,t){return moveSel(e,(n=>n.empty?e.moveByGroup(n,t):rangeEnd(n,t)))}const cursorGroupLeft=e=>cursorByGroup(e,!ltrAtCursor(e)),cursorGroupRight=e=>cursorByGroup(e,ltrAtCursor(e));function interestingNode(e,t,n){if(t.type.prop(n))return!0;let i=t.to-t.from;return i&&(i>2||/[^\s,.;:]/.test(e.sliceDoc(t.from,t.to)))||t.firstChild}function moveBySyntax(e,t,n){let i,r,s=syntaxTree(e).resolveInner(t.head),o=n?NodeProp.closedBy:NodeProp.openedBy;for(let i=t.head;;){let t=n?s.childAfter(i):s.childBefore(i);if(!t)break;interestingNode(e,t,o)?s=t:i=n?t.to:t.from}return r=s.type.prop(o)&&(i=n?matchBrackets(e,s.from,1):matchBrackets(e,s.to,-1))&&i.matched?n?i.end.to:i.end.from:n?s.to:s.from,EditorSelection.cursor(r,n?-1:1)}const cursorSyntaxLeft=e=>moveSel(e,(t=>moveBySyntax(e.state,t,!ltrAtCursor(e)))),cursorSyntaxRight=e=>moveSel(e,(t=>moveBySyntax(e.state,t,ltrAtCursor(e))));function cursorByLine(e,t){return moveSel(e,(n=>{if(!n.empty)return rangeEnd(n,t);let i=e.moveVertically(n,t);return i.head!=n.head?i:e.moveToLineBoundary(n,t)}))}const cursorLineUp=e=>cursorByLine(e,!1),cursorLineDown=e=>cursorByLine(e,!0);function pageInfo(e){let t,n=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,i=0,r=0;if(n){for(let t of e.state.facet(EditorView.scrollMargins)){let n=t(e);(null==n?void 0:n.top)&&(i=Math.max(null==n?void 0:n.top,i)),(null==n?void 0:n.bottom)&&(r=Math.max(null==n?void 0:n.bottom,r))}t=e.scrollDOM.clientHeight-i-r}else t=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:i,marginBottom:r,selfScroll:n,height:Math.max(e.defaultLineHeight,t-5)}}function cursorByPage(e,t){let n,i=pageInfo(e),{state:r}=e,s=updateSel(r.selection,(n=>n.empty?e.moveVertically(n,t,i.height):rangeEnd(n,t)));if(s.eq(r.selection))return!1;if(i.selfScroll){let t=e.coordsAtPos(r.selection.main.head),o=e.scrollDOM.getBoundingClientRect(),a=o.top+i.marginTop,l=o.bottom-i.marginBottom;t&&t.top>a&&t.bottom<l&&(n=EditorView.scrollIntoView(s.main.head,{y:"start",yMargin:t.top-a}))}return e.dispatch(setSel(r,s),{effects:n}),!0}const cursorPageUp=e=>cursorByPage(e,!1),cursorPageDown=e=>cursorByPage(e,!0);function moveByLineBoundary(e,t,n){let i=e.lineBlockAt(t.head),r=e.moveToLineBoundary(t,n);if(r.head==t.head&&r.head!=(n?i.to:i.from)&&(r=e.moveToLineBoundary(t,n,!1)),!n&&r.head==i.from&&i.length){let n=/^\s*/.exec(e.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;n&&t.head!=i.from+n&&(r=EditorSelection.cursor(i.from+n))}return r}const cursorLineBoundaryForward=e=>moveSel(e,(t=>moveByLineBoundary(e,t,!0))),cursorLineBoundaryBackward=e=>moveSel(e,(t=>moveByLineBoundary(e,t,!1))),cursorLineBoundaryLeft=e=>moveSel(e,(t=>moveByLineBoundary(e,t,!ltrAtCursor(e)))),cursorLineBoundaryRight=e=>moveSel(e,(t=>moveByLineBoundary(e,t,ltrAtCursor(e)))),cursorLineStart=e=>moveSel(e,(t=>EditorSelection.cursor(e.lineBlockAt(t.head).from,1))),cursorLineEnd=e=>moveSel(e,(t=>EditorSelection.cursor(e.lineBlockAt(t.head).to,-1)));function toMatchingBracket(e,t,n){let i=!1,r=updateSel(e.selection,(t=>{let r=matchBrackets(e,t.head,-1)||matchBrackets(e,t.head,1)||t.head>0&&matchBrackets(e,t.head-1,1)||t.head<e.doc.length&&matchBrackets(e,t.head+1,-1);if(!r||!r.end)return t;i=!0;let s=r.start.from==t.head?r.end.to:r.end.from;return n?EditorSelection.range(t.anchor,s):EditorSelection.cursor(s)}));return!!i&&(t(setSel(e,r)),!0)}const cursorMatchingBracket=({state:e,dispatch:t})=>toMatchingBracket(e,t,!1);function extendSel(e,t){let n=updateSel(e.state.selection,(e=>{let n=t(e);return EditorSelection.range(e.anchor,n.head,n.goalColumn,n.bidiLevel||void 0)}));return!n.eq(e.state.selection)&&(e.dispatch(setSel(e.state,n)),!0)}function selectByChar(e,t){return extendSel(e,(n=>e.moveByChar(n,t)))}const selectCharLeft=e=>selectByChar(e,!ltrAtCursor(e)),selectCharRight=e=>selectByChar(e,ltrAtCursor(e));function selectByGroup(e,t){return extendSel(e,(n=>e.moveByGroup(n,t)))}const selectGroupLeft=e=>selectByGroup(e,!ltrAtCursor(e)),selectGroupRight=e=>selectByGroup(e,ltrAtCursor(e)),selectSyntaxLeft=e=>extendSel(e,(t=>moveBySyntax(e.state,t,!ltrAtCursor(e)))),selectSyntaxRight=e=>extendSel(e,(t=>moveBySyntax(e.state,t,ltrAtCursor(e))));function selectByLine(e,t){return extendSel(e,(n=>e.moveVertically(n,t)))}const selectLineUp=e=>selectByLine(e,!1),selectLineDown=e=>selectByLine(e,!0);function selectByPage(e,t){return extendSel(e,(n=>e.moveVertically(n,t,pageInfo(e).height)))}const selectPageUp=e=>selectByPage(e,!1),selectPageDown=e=>selectByPage(e,!0),selectLineBoundaryForward=e=>extendSel(e,(t=>moveByLineBoundary(e,t,!0))),selectLineBoundaryBackward=e=>extendSel(e,(t=>moveByLineBoundary(e,t,!1))),selectLineBoundaryLeft=e=>extendSel(e,(t=>moveByLineBoundary(e,t,!ltrAtCursor(e)))),selectLineBoundaryRight=e=>extendSel(e,(t=>moveByLineBoundary(e,t,ltrAtCursor(e)))),selectLineStart=e=>extendSel(e,(t=>EditorSelection.cursor(e.lineBlockAt(t.head).from))),selectLineEnd=e=>extendSel(e,(t=>EditorSelection.cursor(e.lineBlockAt(t.head).to))),cursorDocStart=({state:e,dispatch:t})=>(t(setSel(e,{anchor:0})),!0),cursorDocEnd=({state:e,dispatch:t})=>(t(setSel(e,{anchor:e.doc.length})),!0),selectDocStart=({state:e,dispatch:t})=>(t(setSel(e,{anchor:e.selection.main.anchor,head:0})),!0),selectDocEnd=({state:e,dispatch:t})=>(t(setSel(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0),selectAll=({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0),selectLine=({state:e,dispatch:t})=>{let n=selectedLineBlocks(e).map((({from:t,to:n})=>EditorSelection.range(t,Math.min(n+1,e.doc.length))));return t(e.update({selection:EditorSelection.create(n),userEvent:"select"})),!0},selectParentSyntax=({state:e,dispatch:t})=>{let n=updateSel(e.selection,(t=>{var n;for(let i=syntaxTree(e).resolveStack(t.from,1);i;i=i.next){let{node:e}=i;if((e.from<t.from&&e.to>=t.to||e.to>t.to&&e.from<=t.from)&&(null===(n=e.parent)||void 0===n?void 0:n.parent))return EditorSelection.range(e.to,e.from)}return t}));return t(setSel(e,n)),!0},simplifySelection=({state:e,dispatch:t})=>{let n=e.selection,i=null;return n.ranges.length>1?i=EditorSelection.create([n.main]):n.main.empty||(i=EditorSelection.create([EditorSelection.cursor(n.main.head)])),!!i&&(t(setSel(e,i)),!0)};function deleteBy(e,t){if(e.state.readOnly)return!1;let n="delete.selection",{state:i}=e,r=i.changeByRange((i=>{let{from:r,to:s}=i;if(r==s){let o=t(i);o<r?(n="delete.backward",o=skipAtomic(e,o,!1)):o>r&&(n="delete.forward",o=skipAtomic(e,o,!0)),r=Math.min(r,o),s=Math.max(s,o)}else r=skipAtomic(e,r,!1),s=skipAtomic(e,s,!0);return r==s?{range:i}:{changes:{from:r,to:s},range:EditorSelection.cursor(r,r<i.head?-1:1)}}));return!r.changes.empty&&(e.dispatch(i.update(r,{scrollIntoView:!0,userEvent:n,effects:"delete.selection"==n?EditorView.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function skipAtomic(e,t,n){if(e instanceof EditorView)for(let i of e.state.facet(EditorView.atomicRanges).map((t=>t(e))))i.between(t,t,((e,i)=>{e<t&&i>t&&(t=n?i:e)}));return t}const deleteByChar=(e,t)=>deleteBy(e,(n=>{let i,r,s=n.from,{state:o}=e,a=o.doc.lineAt(s);if(!t&&s>a.from&&s<a.from+200&&!/[^ \t]/.test(i=a.text.slice(0,s-a.from))){if("\t"==i[i.length-1])return s-1;let e=countColumn(i,o.tabSize)%getIndentUnit(o)||getIndentUnit(o);for(let t=0;t<e&&" "==i[i.length-1-t];t++)s--;r=s}else r=findClusterBreak(a.text,s-a.from,t,t)+a.from,r==s&&a.number!=(t?o.doc.lines:1)?r+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(a.text.slice(r-a.from,s-a.from))&&(r=findClusterBreak(a.text,r-a.from,!1,!1)+a.from);return r})),deleteCharBackward=e=>deleteByChar(e,!1),deleteCharForward=e=>deleteByChar(e,!0),deleteByGroup=(e,t)=>deleteBy(e,(n=>{let i=n.head,{state:r}=e,s=r.doc.lineAt(i),o=r.charCategorizer(i);for(let e=null;;){if(i==(t?s.to:s.from)){i==n.head&&s.number!=(t?r.doc.lines:1)&&(i+=t?1:-1);break}let a=findClusterBreak(s.text,i-s.from,t)+s.from,l=s.text.slice(Math.min(i,a)-s.from,Math.max(i,a)-s.from),c=o(l);if(null!=e&&c!=e)break;" "==l&&i==n.head||(e=c),i=a}return i})),deleteGroupBackward=e=>deleteByGroup(e,!1),deleteGroupForward=e=>deleteByGroup(e,!0),deleteToLineEnd=e=>deleteBy(e,(t=>{let n=e.lineBlockAt(t.head).to;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})),deleteLineBoundaryBackward=e=>deleteBy(e,(t=>{let n=e.moveToLineBoundary(t,!1).head;return t.head>n?n:Math.max(0,t.head-1)})),deleteLineBoundaryForward=e=>deleteBy(e,(t=>{let n=e.moveToLineBoundary(t,!0).head;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)})),splitLine=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange((e=>({changes:{from:e.from,to:e.to,insert:Text.of(["",""])},range:EditorSelection.cursor(e.from)})));return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},transposeChars=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange((t=>{if(!t.empty||0==t.from||t.from==e.doc.length)return{range:t};let n=t.from,i=e.doc.lineAt(n),r=n==i.from?n-1:findClusterBreak(i.text,n-i.from,!1)+i.from,s=n==i.to?n+1:findClusterBreak(i.text,n-i.from,!0)+i.from;return{changes:{from:r,to:s,insert:e.doc.slice(n,s).append(e.doc.slice(r,n))},range:EditorSelection.cursor(s)}}));return!n.changes.empty&&(t(e.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function selectedLineBlocks(e){let t=[],n=-1;for(let i of e.selection.ranges){let r=e.doc.lineAt(i.from),s=e.doc.lineAt(i.to);if(i.empty||i.to!=s.from||(s=e.doc.lineAt(i.to-1)),n>=r.number){let e=t[t.length-1];e.to=s.to,e.ranges.push(i)}else t.push({from:r.from,to:s.to,ranges:[i]});n=s.number+1}return t}function moveLine(e,t,n){if(e.readOnly)return!1;let i=[],r=[];for(let t of selectedLineBlocks(e)){if(n?t.to==e.doc.length:0==t.from)continue;let s=e.doc.lineAt(n?t.to+1:t.from-1),o=s.length+1;if(n){i.push({from:t.to,to:s.to},{from:t.from,insert:s.text+e.lineBreak});for(let n of t.ranges)r.push(EditorSelection.range(Math.min(e.doc.length,n.anchor+o),Math.min(e.doc.length,n.head+o)))}else{i.push({from:s.from,to:t.from},{from:t.to,insert:e.lineBreak+s.text});for(let e of t.ranges)r.push(EditorSelection.range(e.anchor-o,e.head-o))}}return!!i.length&&(t(e.update({changes:i,scrollIntoView:!0,selection:EditorSelection.create(r,e.selection.mainIndex),userEvent:"move.line"})),!0)}const moveLineUp=({state:e,dispatch:t})=>moveLine(e,t,!1),moveLineDown=({state:e,dispatch:t})=>moveLine(e,t,!0);function copyLine(e,t,n){if(e.readOnly)return!1;let i=[];for(let t of selectedLineBlocks(e))n?i.push({from:t.from,insert:e.doc.slice(t.from,t.to)+e.lineBreak}):i.push({from:t.to,insert:e.lineBreak+e.doc.slice(t.from,t.to)});return t(e.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const copyLineUp=({state:e,dispatch:t})=>copyLine(e,t,!1),copyLineDown=({state:e,dispatch:t})=>copyLine(e,t,!0),deleteLine=e=>{if(e.state.readOnly)return!1;let{state:t}=e,n=t.changes(selectedLineBlocks(t).map((({from:e,to:n})=>(e>0?e--:n<t.doc.length&&n++,{from:e,to:n})))),i=updateSel(t.selection,(t=>e.moveVertically(t,!0))).map(n);return e.dispatch({changes:n,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function isBetweenBrackets(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n,i=syntaxTree(e).resolveInner(t),r=i.childBefore(t),s=i.childAfter(t);return r&&s&&r.to<=t&&s.from>=t&&(n=r.type.prop(NodeProp.closedBy))&&n.indexOf(s.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(s.from).from&&!/\S/.test(e.sliceDoc(r.to,s.from))?{from:r.to,to:s.from}:null}const insertNewlineAndIndent=newlineAndIndent(!1),insertBlankLine=newlineAndIndent(!0);function newlineAndIndent(e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let i=t.changeByRange((n=>{let{from:i,to:r}=n,s=t.doc.lineAt(i),o=!e&&i==r&&isBetweenBrackets(t,i);e&&(i=r=(r<=s.to?s:t.doc.lineAt(r)).to);let a=new IndentContext(t,{simulateBreak:i,simulateDoubleBreak:!!o}),l=getIndentation(a,i);for(null==l&&(l=countColumn(/^\s*/.exec(t.doc.lineAt(i).text)[0],t.tabSize));r<s.to&&/\s/.test(s.text[r-s.from]);)r++;o?({from:i,to:r}=o):i>s.from&&i<s.from+100&&!/\S/.test(s.text.slice(0,i))&&(i=s.from);let c=["",indentString(t,l)];return o&&c.push(indentString(t,a.lineIndent(s.from,-1))),{changes:{from:i,to:r,insert:Text.of(c)},range:EditorSelection.cursor(i+1+c[1].length)}}));return n(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function changeBySelectedLine(e,t){let n=-1;return e.changeByRange((i=>{let r=[];for(let s=i.from;s<=i.to;){let o=e.doc.lineAt(s);o.number>n&&(i.empty||i.to>o.from)&&(t(o,r,i),n=o.number),s=o.to+1}let s=e.changes(r);return{changes:r,range:EditorSelection.range(s.mapPos(i.anchor,1),s.mapPos(i.head,1))}}))}const indentSelection=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=Object.create(null),i=new IndentContext(e,{overrideIndentation:e=>{let t=n[e];return null==t?-1:t}}),r=changeBySelectedLine(e,((t,r,s)=>{let o=getIndentation(i,t.from);if(null==o)return;/\S/.test(t.text)||(o=0);let a=/^\s*/.exec(t.text)[0],l=indentString(e,o);(a!=l||s.from<t.from+a.length)&&(n[t.from]=o,r.push({from:t.from,to:t.from+a.length,insert:l}))}));return r.changes.empty||t(e.update(r,{userEvent:"indent"})),!0},indentMore=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(changeBySelectedLine(e,((t,n)=>{n.push({from:t.from,insert:e.facet(indentUnit)})})),{userEvent:"input.indent"})),!0),indentLess=({state:e,dispatch:t})=>!e.readOnly&&(t(e.update(changeBySelectedLine(e,((t,n)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let r=countColumn(i,e.tabSize),s=0,o=indentString(e,Math.max(0,r-getIndentUnit(e)));for(;s<i.length&&s<o.length&&i.charCodeAt(s)==o.charCodeAt(s);)s++;n.push({from:t.from+s,to:t.from+i.length,insert:o.slice(s)})})),{userEvent:"delete.dedent"})),!0),emacsStyleKeymap=[{key:"Ctrl-b",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Ctrl-f",run:cursorCharRight,shift:selectCharRight},{key:"Ctrl-p",run:cursorLineUp,shift:selectLineUp},{key:"Ctrl-n",run:cursorLineDown,shift:selectLineDown},{key:"Ctrl-a",run:cursorLineStart,shift:selectLineStart},{key:"Ctrl-e",run:cursorLineEnd,shift:selectLineEnd},{key:"Ctrl-d",run:deleteCharForward},{key:"Ctrl-h",run:deleteCharBackward},{key:"Ctrl-k",run:deleteToLineEnd},{key:"Ctrl-Alt-h",run:deleteGroupBackward},{key:"Ctrl-o",run:splitLine},{key:"Ctrl-t",run:transposeChars},{key:"Ctrl-v",run:cursorPageDown}],standardKeymap=[{key:"ArrowLeft",run:cursorCharLeft,shift:selectCharLeft,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:cursorGroupLeft,shift:selectGroupLeft,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:cursorLineBoundaryLeft,shift:selectLineBoundaryLeft,preventDefault:!0},{key:"ArrowRight",run:cursorCharRight,shift:selectCharRight,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:cursorGroupRight,shift:selectGroupRight,preventDefault:!0},{mac:"Cmd-ArrowRight",run:cursorLineBoundaryRight,shift:selectLineBoundaryRight,preventDefault:!0},{key:"ArrowUp",run:cursorLineUp,shift:selectLineUp,preventDefault:!0},{mac:"Cmd-ArrowUp",run:cursorDocStart,shift:selectDocStart},{mac:"Ctrl-ArrowUp",run:cursorPageUp,shift:selectPageUp},{key:"ArrowDown",run:cursorLineDown,shift:selectLineDown,preventDefault:!0},{mac:"Cmd-ArrowDown",run:cursorDocEnd,shift:selectDocEnd},{mac:"Ctrl-ArrowDown",run:cursorPageDown,shift:selectPageDown},{key:"PageUp",run:cursorPageUp,shift:selectPageUp},{key:"PageDown",run:cursorPageDown,shift:selectPageDown},{key:"Home",run:cursorLineBoundaryBackward,shift:selectLineBoundaryBackward,preventDefault:!0},{key:"Mod-Home",run:cursorDocStart,shift:selectDocStart},{key:"End",run:cursorLineBoundaryForward,shift:selectLineBoundaryForward,preventDefault:!0},{key:"Mod-End",run:cursorDocEnd,shift:selectDocEnd},{key:"Enter",run:insertNewlineAndIndent},{key:"Mod-a",run:selectAll},{key:"Backspace",run:deleteCharBackward,shift:deleteCharBackward},{key:"Delete",run:deleteCharForward},{key:"Mod-Backspace",mac:"Alt-Backspace",run:deleteGroupBackward},{key:"Mod-Delete",mac:"Alt-Delete",run:deleteGroupForward},{mac:"Mod-Backspace",run:deleteLineBoundaryBackward},{mac:"Mod-Delete",run:deleteLineBoundaryForward}].concat(emacsStyleKeymap.map((e=>({mac:e.key,run:e.run,shift:e.shift})))),defaultKeymap=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:cursorSyntaxLeft,shift:selectSyntaxLeft},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:cursorSyntaxRight,shift:selectSyntaxRight},{key:"Alt-ArrowUp",run:moveLineUp},{key:"Shift-Alt-ArrowUp",run:copyLineUp},{key:"Alt-ArrowDown",run:moveLineDown},{key:"Shift-Alt-ArrowDown",run:copyLineDown},{key:"Escape",run:simplifySelection},{key:"Mod-Enter",run:insertBlankLine},{key:"Alt-l",mac:"Ctrl-l",run:selectLine},{key:"Mod-i",run:selectParentSyntax,preventDefault:!0},{key:"Mod-[",run:indentLess},{key:"Mod-]",run:indentMore},{key:"Mod-Alt-\\",run:indentSelection},{key:"Shift-Mod-k",run:deleteLine},{key:"Shift-Mod-\\",run:cursorMatchingBracket},{key:"Mod-/",run:toggleComment},{key:"Alt-A",run:toggleBlockComment}].concat(standardKeymap),indentWithTab={key:"Tab",run:indentMore,shift:indentLess};function crelt(){var e=arguments[0];"string"==typeof e&&(e=document.createElement(e));var t=1,n=arguments[1];if(n&&"object"==typeof n&&null==n.nodeType&&!Array.isArray(n)){for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var r=n[i];"string"==typeof r?e.setAttribute(i,r):null!=r&&(e[i]=r)}t++}for(;t<arguments.length;t++)add(e,arguments[t]);return e}function add(e,t){if("string"==typeof t)e.appendChild(document.createTextNode(t));else if(null==t);else if(null!=t.nodeType)e.appendChild(t);else{if(!Array.isArray(t))throw new RangeError("Unsupported child node: "+t);for(var n=0;n<t.length;n++)add(e,t[n])}}const basicNormalize="function"==typeof String.prototype.normalize?e=>e.normalize("NFKD"):e=>e;class SearchCursor{constructor(e,t,n=0,i=e.length,r,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,i),this.bufferStart=n,this.normalize=r?e=>r(basicNormalize(e)):basicNormalize,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=fromCodePoint(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=codePointSize(e);let i=this.normalize(t);for(let e=0,r=n;;e++){let s=i.charCodeAt(e),o=this.match(s,r);if(e==i.length-1){if(o)return this.value=o,this;break}r==n&&e<t.length&&t.charCodeAt(e)==s&&r++}}}match(e,t){let n=null;for(let i=0;i<this.matches.length;i+=2){let r=this.matches[i],s=!1;this.query.charCodeAt(r)==e&&(r==this.query.length-1?n={from:this.matches[i+1],to:t+1}:(this.matches[i]++,s=!0)),s||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(1==this.query.length?n={from:t,to:t+1}:this.matches.push(1,t)),n&&this.test&&!this.test(n.from,n.to,this.buffer,this.bufferStart)&&(n=null),n}}"undefined"!=typeof Symbol&&(SearchCursor.prototype[Symbol.iterator]=function(){return this});const empty={from:-1,to:-1,match:/.*/.exec("")},baseFlags="gm"+(null==/x/.unicode?"":"u");class RegExpCursor{constructor(e,t,n,i=0,r=e.length){if(this.text=e,this.to=r,this.curLine="",this.done=!1,this.value=empty,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new MultilineRegExpCursor(e,t,n,i,r);this.re=new RegExp(t,baseFlags+((null==n?void 0:n.ignoreCase)?"i":"")),this.test=null==n?void 0:n.test,this.iter=e.iter();let s=e.lineAt(i);this.curLineStart=s.from,this.matchPos=toCharEnd(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let n=this.curLineStart+t.index,i=n+t[0].length;if(this.matchPos=toCharEnd(this.text,i+(n==i?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<i||n>this.value.to)&&(!this.test||this.test(n,i,t)))return this.value={from:n,to:i,match:t},this;e=this.matchPos-this.curLineStart}else{if(!(this.curLineStart+this.curLine.length<this.to))return this.done=!0,this;this.nextLine(),e=0}}}}const flattened=new WeakMap;class FlattenedDoc{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,n){let i=flattened.get(e);if(!i||i.from>=n||i.to<=t){let i=new FlattenedDoc(t,e.sliceString(t,n));return flattened.set(e,i),i}if(i.from==t&&i.to==n)return i;let{text:r,from:s}=i;return s>t&&(r=e.sliceString(t,s)+r,s=t),i.to<n&&(r+=e.sliceString(i.to,n)),flattened.set(e,new FlattenedDoc(s,r)),new FlattenedDoc(t,r.slice(t-s,n-s))}}class MultilineRegExpCursor{constructor(e,t,n,i,r){this.text=e,this.to=r,this.done=!1,this.value=empty,this.matchPos=toCharEnd(e,i),this.re=new RegExp(t,baseFlags+((null==n?void 0:n.ignoreCase)?"i":"")),this.test=null==n?void 0:n.test,this.flat=FlattenedDoc.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let e=this.flat.from+t.index,n=e+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(e,n,t)))return this.value={from:e,to:n,match:t},this.matchPos=toCharEnd(this.text,n+(e==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=FlattenedDoc.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+2*this.flat.text.length))}}}function validRegExp(e){try{return new RegExp(e,baseFlags),!0}catch(e){return!1}}function toCharEnd(e,t){if(t>=e.length)return t;let n,i=e.lineAt(t);for(;t<i.to&&(n=i.text.charCodeAt(t-i.from))>=56320&&n<57344;)t++;return t}function createLineDialog(e){let t=crelt("input",{class:"cm-textfield",name:"line",value:String(e.state.doc.lineAt(e.state.selection.main.head).number)});function n(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!n)return;let{state:i}=e,r=i.doc.lineAt(i.selection.main.head),[,s,o,a,l]=n,c=a?+a.slice(1):0,h=o?+o:r.number;if(o&&l){let e=h/100;s&&(e=e*("-"==s?-1:1)+r.number/i.doc.lines),h=Math.round(i.doc.lines*e)}else o&&s&&(h=h*("-"==s?-1:1)+r.number);let d=i.doc.line(Math.max(1,Math.min(i.doc.lines,h))),u=EditorSelection.cursor(d.from+Math.max(0,Math.min(c,d.length)));e.dispatch({effects:[dialogEffect.of(!1),EditorView.scrollIntoView(u.from,{y:"center"})],selection:u}),e.focus()}return{dom:crelt("form",{class:"cm-gotoLine",onkeydown:t=>{27==t.keyCode?(t.preventDefault(),e.dispatch({effects:dialogEffect.of(!1)}),e.focus()):13==t.keyCode&&(t.preventDefault(),n())},onsubmit:e=>{e.preventDefault(),n()}},crelt("label",e.state.phrase("Go to line"),": ",t)," ",crelt("button",{class:"cm-button",type:"submit"},e.state.phrase("go")))}}"undefined"!=typeof Symbol&&(RegExpCursor.prototype[Symbol.iterator]=MultilineRegExpCursor.prototype[Symbol.iterator]=function(){return this});const dialogEffect=StateEffect.define(),dialogField=StateField.define({create:()=>!0,update(e,t){for(let n of t.effects)n.is(dialogEffect)&&(e=n.value);return e},provide:e=>showPanel.from(e,(e=>e?createLineDialog:null))}),gotoLine=e=>{let t=getPanel(e,createLineDialog);if(!t){let n=[dialogEffect.of(!0)];null==e.state.field(dialogField,!1)&&n.push(StateEffect.appendConfig.of([dialogField,baseTheme$1$1])),e.dispatch({effects:n}),t=getPanel(e,createLineDialog)}return t&&t.dom.querySelector("input").select(),!0},baseTheme$1$1=EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),defaultHighlightOptions={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},highlightConfig=Facet.define({combine:e=>combineConfig(e,defaultHighlightOptions,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})});function highlightSelectionMatches(e){let t=[defaultTheme,matchHighlighter];return e&&t.push(highlightConfig.of(e)),t}const matchDeco=Decoration.mark({class:"cm-selectionMatch"}),mainMatchDeco=Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function insideWordBoundaries(e,t,n,i){return!(0!=n&&e(t.sliceDoc(n-1,n))==CharCategory.Word||i!=t.doc.length&&e(t.sliceDoc(i,i+1))==CharCategory.Word)}function insideWord(e,t,n,i){return e(t.sliceDoc(n,n+1))==CharCategory.Word&&e(t.sliceDoc(i-1,i))==CharCategory.Word}const matchHighlighter=ViewPlugin.fromClass(class{constructor(e){this.decorations=this.getDeco(e)}update(e){(e.selectionSet||e.docChanged||e.viewportChanged)&&(this.decorations=this.getDeco(e.view))}getDeco(e){let t=e.state.facet(highlightConfig),{state:n}=e,i=n.selection;if(i.ranges.length>1)return Decoration.none;let r,s=i.main,o=null;if(s.empty){if(!t.highlightWordAroundCursor)return Decoration.none;let e=n.wordAt(s.head);if(!e)return Decoration.none;o=n.charCategorizer(s.head),r=n.sliceDoc(e.from,e.to)}else{let e=s.to-s.from;if(e<t.minSelectionLength||e>200)return Decoration.none;if(t.wholeWords){if(r=n.sliceDoc(s.from,s.to),o=n.charCategorizer(s.head),!insideWordBoundaries(o,n,s.from,s.to)||!insideWord(o,n,s.from,s.to))return Decoration.none}else if(r=n.sliceDoc(s.from,s.to).trim(),!r)return Decoration.none}let a=[];for(let i of e.visibleRanges){let e=new SearchCursor(n.doc,r,i.from,i.to);for(;!e.next().done;){let{from:i,to:r}=e.value;if((!o||insideWordBoundaries(o,n,i,r))&&(s.empty&&i<=s.from&&r>=s.to?a.push(mainMatchDeco.range(i,r)):(i>=s.to||r<=s.from)&&a.push(matchDeco.range(i,r)),a.length>t.maxMatches))return Decoration.none}}return Decoration.set(a)}},{decorations:e=>e.decorations}),defaultTheme=EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),selectWord=({state:e,dispatch:t})=>{let{selection:n}=e,i=EditorSelection.create(n.ranges.map((t=>e.wordAt(t.head)||EditorSelection.cursor(t.head))),n.mainIndex);return!i.eq(n)&&(t(e.update({selection:i})),!0)};function findNextOccurrence(e,t){let{main:n,ranges:i}=e.selection,r=e.wordAt(n.head),s=r&&r.from==n.from&&r.to==n.to;for(let n=!1,r=new SearchCursor(e.doc,t,i[i.length-1].to);;){if(r.next(),!r.done){if(n&&i.some((e=>e.from==r.value.from)))continue;if(s){let t=e.wordAt(r.value.from);if(!t||t.from!=r.value.from||t.to!=r.value.to)continue}return r.value}if(n)return null;r=new SearchCursor(e.doc,t,0,Math.max(0,i[i.length-1].from-1)),n=!0}}const selectNextOccurrence=({state:e,dispatch:t})=>{let{ranges:n}=e.selection;if(n.some((e=>e.from===e.to)))return selectWord({state:e,dispatch:t});let i=e.sliceDoc(n[0].from,n[0].to);if(e.selection.ranges.some((t=>e.sliceDoc(t.from,t.to)!=i)))return!1;let r=findNextOccurrence(e,i);return!!r&&(t(e.update({selection:e.selection.addRange(EditorSelection.range(r.from,r.to),!1),effects:EditorView.scrollIntoView(r.to)})),!0)},searchConfigFacet=Facet.define({combine:e=>combineConfig(e,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new SearchPanel(e),scrollToMatch:e=>EditorView.scrollIntoView(e)})});class SearchQuery{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||validRegExp(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,((e,t)=>"n"==t?"\n":"r"==t?"\r":"t"==t?"\t":"\\"))}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new RegExpQuery(this):new StringQuery(this)}getCursor(e,t=0,n){let i=e.doc?e:EditorState.create({doc:e});return null==n&&(n=i.doc.length),this.regexp?regexpCursor(this,i,t,n):stringCursor(this,i,t,n)}}class QueryType{constructor(e){this.spec=e}}function stringCursor(e,t,n,i){return new SearchCursor(t.doc,e.unquoted,n,i,e.caseSensitive?void 0:e=>e.toLowerCase(),e.wholeWord?stringWordTest(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function stringWordTest(e,t){return(n,i,r,s)=>((s>n||s+r.length<i)&&(s=Math.max(0,n-2),r=e.sliceString(s,Math.min(e.length,i+2))),!(t(charBefore(r,n-s))==CharCategory.Word&&t(charAfter(r,n-s))==CharCategory.Word||t(charAfter(r,i-s))==CharCategory.Word&&t(charBefore(r,i-s))==CharCategory.Word))}class StringQuery extends QueryType{constructor(e){super(e)}nextMatch(e,t,n){let i=stringCursor(this.spec,e,n,e.doc.length).nextOverlapping();return i.done&&(i=stringCursor(this.spec,e,0,t).nextOverlapping()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=n;;){let n=Math.max(t,i-1e4-this.spec.unquoted.length),r=stringCursor(this.spec,e,n,i),s=null;for(;!r.nextOverlapping().done;)s=r.value;if(s)return s;if(n==t)return null;i-=1e4}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let n=stringCursor(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let r=stringCursor(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!r.next().done;)i(r.value.from,r.value.to)}}function regexpCursor(e,t,n,i){return new RegExpCursor(t.doc,e.search,{ignoreCase:!e.caseSensitive,test:e.wholeWord?regexpWordTest(t.charCategorizer(t.selection.main.head)):void 0},n,i)}function charBefore(e,t){return e.slice(findClusterBreak(e,t,!1),t)}function charAfter(e,t){return e.slice(t,findClusterBreak(e,t))}function regexpWordTest(e){return(t,n,i)=>!i[0].length||(e(charBefore(i.input,i.index))!=CharCategory.Word||e(charAfter(i.input,i.index))!=CharCategory.Word)&&(e(charAfter(i.input,i.index+i[0].length))!=CharCategory.Word||e(charBefore(i.input,i.index+i[0].length))!=CharCategory.Word)}class RegExpQuery extends QueryType{nextMatch(e,t,n){let i=regexpCursor(this.spec,e,n,e.doc.length).next();return i.done&&(i=regexpCursor(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,n){for(let i=1;;i++){let r=Math.max(t,n-1e4*i),s=regexpCursor(this.spec,e,r,n),o=null;for(;!s.next().done;)o=s.value;if(o&&(r==t||o.from>r+10))return o;if(r==t)return null}}prevMatch(e,t,n){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,((t,n)=>"$"==n?"$":"&"==n?e.match[0]:"0"!=n&&+n<e.match.length?e.match[n]:t))}matchAll(e,t){let n=regexpCursor(this.spec,e,0,e.doc.length),i=[];for(;!n.next().done;){if(i.length>=t)return null;i.push(n.value)}return i}highlight(e,t,n,i){let r=regexpCursor(this.spec,e,Math.max(0,t-250),Math.min(n+250,e.doc.length));for(;!r.next().done;)i(r.value.from,r.value.to)}}const setSearchQuery=StateEffect.define(),togglePanel$1=StateEffect.define(),searchState=StateField.define({create:e=>new SearchState(defaultQuery(e).create(),null),update(e,t){for(let n of t.effects)n.is(setSearchQuery)?e=new SearchState(n.value.create(),e.panel):n.is(togglePanel$1)&&(e=new SearchState(e.query,n.value?createSearchPanel:null));return e},provide:e=>showPanel.from(e,(e=>e.panel))});class SearchState{constructor(e,t){this.query=e,this.panel=t}}const matchMark=Decoration.mark({class:"cm-searchMatch"}),selectedMatchMark=Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),searchHighlighter=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.decorations=this.highlight(e.state.field(searchState))}update(e){let t=e.state.field(searchState);(t!=e.startState.field(searchState)||e.docChanged||e.selectionSet||e.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:e,panel:t}){if(!t||!e.spec.valid)return Decoration.none;let{view:n}=this,i=new RangeSetBuilder;for(let t=0,r=n.visibleRanges,s=r.length;t<s;t++){let{from:o,to:a}=r[t];for(;t<s-1&&a>r[t+1].from-500;)a=r[++t].to;e.highlight(n.state,o,a,((e,t)=>{let r=n.state.selection.ranges.some((n=>n.from==e&&n.to==t));i.add(e,t,r?selectedMatchMark:matchMark)}))}return i.finish()}},{decorations:e=>e.decorations});function searchCommand(e){return t=>{let n=t.state.field(searchState,!1);return n&&n.query.spec.valid?e(t,n):openSearchPanel(t)}}const findNext=searchCommand(((e,{query:t})=>{let{to:n}=e.state.selection.main,i=t.nextMatch(e.state,n,n);if(!i)return!1;let r=EditorSelection.single(i.from,i.to),s=e.state.facet(searchConfigFacet);return e.dispatch({selection:r,effects:[announceMatch(e,i),s.scrollToMatch(r.main,e)],userEvent:"select.search"}),selectSearchInput(e),!0})),findPrevious=searchCommand(((e,{query:t})=>{let{state:n}=e,{from:i}=n.selection.main,r=t.prevMatch(n,i,i);if(!r)return!1;let s=EditorSelection.single(r.from,r.to),o=e.state.facet(searchConfigFacet);return e.dispatch({selection:s,effects:[announceMatch(e,r),o.scrollToMatch(s.main,e)],userEvent:"select.search"}),selectSearchInput(e),!0})),selectMatches=searchCommand(((e,{query:t})=>{let n=t.matchAll(e.state,1e3);return!(!n||!n.length)&&(e.dispatch({selection:EditorSelection.create(n.map((e=>EditorSelection.range(e.from,e.to)))),userEvent:"select.search.matches"}),!0)})),selectSelectionMatches=({state:e,dispatch:t})=>{let n=e.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:i,to:r}=n.main,s=[],o=0;for(let t=new SearchCursor(e.doc,e.sliceDoc(i,r));!t.next().done;){if(s.length>1e3)return!1;t.value.from==i&&(o=s.length),s.push(EditorSelection.range(t.value.from,t.value.to))}return t(e.update({selection:EditorSelection.create(s,o),userEvent:"select.search.matches"})),!0},replaceNext=searchCommand(((e,{query:t})=>{let{state:n}=e,{from:i,to:r}=n.selection.main;if(n.readOnly)return!1;let s=t.nextMatch(n,i,i);if(!s)return!1;let o,a,l=[],c=[];if(s.from==i&&s.to==r&&(a=n.toText(t.getReplacement(s)),l.push({from:s.from,to:s.to,insert:a}),s=t.nextMatch(n,s.from,s.to),c.push(EditorView.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(i).number)+"."))),s){let t=0==l.length||l[0].from>=s.to?0:s.to-s.from-a.length;o=EditorSelection.single(s.from-t,s.to-t),c.push(announceMatch(e,s)),c.push(n.facet(searchConfigFacet).scrollToMatch(o.main,e))}return e.dispatch({changes:l,selection:o,effects:c,userEvent:"input.replace"}),!0})),replaceAll=searchCommand(((e,{query:t})=>{if(e.state.readOnly)return!1;let n=t.matchAll(e.state,1e9).map((e=>{let{from:n,to:i}=e;return{from:n,to:i,insert:t.getReplacement(e)}}));if(!n.length)return!1;let i=e.state.phrase("replaced $ matches",n.length)+".";return e.dispatch({changes:n,effects:EditorView.announce.of(i),userEvent:"input.replace.all"}),!0}));function createSearchPanel(e){return e.state.facet(searchConfigFacet).createPanel(e)}function defaultQuery(e,t){var n,i,r,s,o;let a=e.selection.main,l=a.empty||a.to>a.from+100?"":e.sliceDoc(a.from,a.to);if(t&&!l)return t;let c=e.facet(searchConfigFacet);return new SearchQuery({search:(null!==(n=null==t?void 0:t.literal)&&void 0!==n?n:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:null!==(i=null==t?void 0:t.caseSensitive)&&void 0!==i?i:c.caseSensitive,literal:null!==(r=null==t?void 0:t.literal)&&void 0!==r?r:c.literal,regexp:null!==(s=null==t?void 0:t.regexp)&&void 0!==s?s:c.regexp,wholeWord:null!==(o=null==t?void 0:t.wholeWord)&&void 0!==o?o:c.wholeWord})}function getSearchInput(e){let t=getPanel(e,createSearchPanel);return t&&t.dom.querySelector("[main-field]")}function selectSearchInput(e){let t=getSearchInput(e);t&&t==e.root.activeElement&&t.select()}const openSearchPanel=e=>{let t=e.state.field(searchState,!1);if(t&&t.panel){let n=getSearchInput(e);if(n&&n!=e.root.activeElement){let i=defaultQuery(e.state,t.query.spec);i.valid&&e.dispatch({effects:setSearchQuery.of(i)}),n.focus(),n.select()}}else e.dispatch({effects:[togglePanel$1.of(!0),t?setSearchQuery.of(defaultQuery(e.state,t.query.spec)):StateEffect.appendConfig.of(searchExtensions)]});return!0},closeSearchPanel=e=>{let t=e.state.field(searchState,!1);if(!t||!t.panel)return!1;let n=getPanel(e,createSearchPanel);return n&&n.dom.contains(e.root.activeElement)&&e.focus(),e.dispatch({effects:togglePanel$1.of(!1)}),!0},searchKeymap=[{key:"Mod-f",run:openSearchPanel,scope:"editor search-panel"},{key:"F3",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:findNext,shift:findPrevious,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:closeSearchPanel,scope:"editor search-panel"},{key:"Mod-Shift-l",run:selectSelectionMatches},{key:"Mod-Alt-g",run:gotoLine},{key:"Mod-d",run:selectNextOccurrence,preventDefault:!0}];class SearchPanel{constructor(e){this.view=e;let t=this.query=e.state.field(searchState).query.spec;function n(e,t,n){return crelt("button",{class:"cm-button",name:e,onclick:t,type:"button"},n)}this.commit=this.commit.bind(this),this.searchField=crelt("input",{value:t.search,placeholder:phrase(e,"Find"),"aria-label":phrase(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=crelt("input",{value:t.replace,placeholder:phrase(e,"Replace"),"aria-label":phrase(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=crelt("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=crelt("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=crelt("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit}),this.dom=crelt("div",{onkeydown:e=>this.keydown(e),class:"cm-search"},[this.searchField,n("next",(()=>findNext(e)),[phrase(e,"next")]),n("prev",(()=>findPrevious(e)),[phrase(e,"previous")]),n("select",(()=>selectMatches(e)),[phrase(e,"all")]),crelt("label",null,[this.caseField,phrase(e,"match case")]),crelt("label",null,[this.reField,phrase(e,"regexp")]),crelt("label",null,[this.wordField,phrase(e,"by word")]),...e.state.readOnly?[]:[crelt("br"),this.replaceField,n("replace",(()=>replaceNext(e)),[phrase(e,"replace")]),n("replaceAll",(()=>replaceAll(e)),[phrase(e,"replace all")])],crelt("button",{name:"close",onclick:()=>closeSearchPanel(e),"aria-label":phrase(e,"close"),type:"button"},[""])])}commit(){let e=new SearchQuery({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:setSearchQuery.of(e)}))}keydown(e){runScopeHandlers(this.view,e,"search-panel")?e.preventDefault():13==e.keyCode&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?findPrevious:findNext)(this.view)):13==e.keyCode&&e.target==this.replaceField&&(e.preventDefault(),replaceNext(this.view))}update(e){for(let t of e.transactions)for(let e of t.effects)e.is(setSearchQuery)&&!e.value.eq(this.query)&&this.setQuery(e.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(searchConfigFacet).top}}function phrase(e,t){return e.state.phrase(t)}const AnnounceMargin=30,Break=/[\s\.,:;?!]/;function announceMatch(e,{from:t,to:n}){let i=e.state.doc.lineAt(t),r=e.state.doc.lineAt(n).to,s=Math.max(i.from,t-AnnounceMargin),o=Math.min(r,n+AnnounceMargin),a=e.state.sliceDoc(s,o);if(s!=i.from)for(let e=0;e<AnnounceMargin;e++)if(!Break.test(a[e+1])&&Break.test(a[e])){a=a.slice(e);break}if(o!=r)for(let e=a.length-1;e>a.length-AnnounceMargin;e--)if(!Break.test(a[e-1])&&Break.test(a[e])){a=a.slice(0,e);break}return EditorView.announce.of(`${e.state.phrase("current match")}. ${a} ${e.state.phrase("on line")} ${i.number}.`)}const baseTheme$2=EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),searchExtensions=[searchState,Prec.low(searchHighlighter),baseTheme$2];class CompletionContext{constructor(e,t,n){this.state=e,this.pos=t,this.explicit=n,this.abortListeners=[]}tokenBefore(e){let t=syntaxTree(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),n=Math.max(t.from,this.pos-250),i=t.text.slice(n-t.from,this.pos-t.from),r=i.search(ensureAnchor(e,!1));return r<0?null:{from:n+r,to:this.pos,text:i.slice(r)}}get aborted(){return null==this.abortListeners}addEventListener(e,t){"abort"==e&&this.abortListeners&&this.abortListeners.push(t)}}function toSet(e){let t=Object.keys(e).join(""),n=/\w/.test(t);return n&&(t=t.replace(/\w/g,"")),`[${n?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function prefixMatch(e){let t=Object.create(null),n=Object.create(null);for(let{label:i}of e){t[i[0]]=!0;for(let e=1;e<i.length;e++)n[i[e]]=!0}let i=toSet(t)+toSet(n)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function completeFromList(e){let t=e.map((e=>"string"==typeof e?{label:e}:e)),[n,i]=t.every((e=>/^\w+$/.test(e.label)))?[/\w*$/,/\w+$/]:prefixMatch(t);return e=>{let r=e.matchBefore(i);return r||e.explicit?{from:r?r.from:e.pos,options:t,validFor:n}:null}}function ifNotIn(e,t){return n=>{for(let t=syntaxTree(n.state).resolveInner(n.pos,-1);t;t=t.parent){if(e.indexOf(t.name)>-1)return null;if(t.type.isTop)break}return t(n)}}class Option{constructor(e,t,n,i){this.completion=e,this.source=t,this.match=n,this.score=i}}function cur(e){return e.selection.main.from}function ensureAnchor(e,t){var n;let{source:i}=e,r=t&&"^"!=i[0],s="$"!=i[i.length-1];return r||s?new RegExp(`${r?"^":""}(?:${i})${s?"$":""}`,null!==(n=e.flags)&&void 0!==n?n:e.ignoreCase?"i":""):e}const pickedCompletion=Annotation.define();function insertCompletionText(e,t,n,i){let{main:r}=e.selection,s=n-r.from,o=i-r.from;return Object.assign(Object.assign({},e.changeByRange((a=>a!=r&&n!=i&&e.sliceDoc(a.from+s,a.from+o)!=e.sliceDoc(n,i)?{range:a}:{changes:{from:a.from+s,to:i==r.from?a.to:a.from+o,insert:t},range:EditorSelection.cursor(a.from+s+t.length)}))),{scrollIntoView:!0,userEvent:"input.complete"})}const SourceCache=new WeakMap;function asSource(e){if(!Array.isArray(e))return e;let t=SourceCache.get(e);return t||SourceCache.set(e,t=completeFromList(e)),t}const startCompletionEffect=StateEffect.define(),closeCompletionEffect=StateEffect.define();class FuzzyMatcher{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let n=codePointAt(e,t),i=codePointSize(n);this.chars.push(n);let r=e.slice(t,t+i),s=r.toUpperCase();this.folded.push(codePointAt(s==r?r.toLowerCase():s,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,!0}match(e){if(0==this.pattern.length)return this.ret(-100,[]);if(e.length<this.pattern.length)return!1;let{chars:t,folded:n,any:i,precise:r,byWord:s}=this;if(1==t.length){let i=codePointAt(e,0),r=codePointSize(i),s=r==e.length?0:-100;if(i==t[0]);else{if(i!=n[0])return!1;s+=-200}return this.ret(s,[0,r])}let o=e.indexOf(this.pattern);if(0==o)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,l=0;if(o<0){for(let r=0,s=Math.min(e.length,200);r<s&&l<a;){let s=codePointAt(e,r);s!=t[l]&&s!=n[l]||(i[l++]=r),r+=codePointSize(s)}if(l<a)return!1}let c=0,h=0,d=!1,u=0,p=-1,f=-1,m=/[a-z]/.test(e),g=!0;for(let i=0,l=Math.min(e.length,200),O=0;i<l&&h<a;){let l=codePointAt(e,i);o<0&&(c<a&&l==t[c]&&(r[c++]=i),u<a&&(l==t[u]||l==n[u]?(0==u&&(p=i),f=i+1,u++):u=0));let y,v=l<255?l>=48&&l<=57||l>=97&&l<=122?2:l>=65&&l<=90?1:0:(y=fromCodePoint(l))!=y.toLowerCase()?1:y!=y.toUpperCase()?2:0;(!i||1==v&&m||0==O&&0!=v)&&(t[h]==l||n[h]==l&&(d=!0)?s[h++]=i:s.length&&(g=!1)),O=v,i+=codePointSize(l)}return h==a&&0==s[0]&&g?this.result((d?-200:0)-100,s,e):u==a&&0==p?this.ret(-200-e.length+(f==e.length?0:-100),[0,f]):o>-1?this.ret(-700-e.length,[o,o+this.pattern.length]):u==a?this.ret(-900-e.length,[p,f]):h==a?this.result((d?-200:0)-100-700+(g?0:-1100),s,e):2!=t.length&&this.result((i[0]?-700:0)-200-1100,i,e)}result(e,t,n){let i=[],r=0;for(let e of t){let t=e+(this.astral?codePointSize(codePointAt(n,e)):1);r&&i[r-1]==e?i[r-1]=t:(i[r++]=e,i[r++]=t)}return this.ret(e-n.length,i)}}const completionConfig=Facet.define({combine:e=>combineConfig(e,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:defaultPositionInfo,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>n=>joinClass(e(n),t(n)),optionClass:(e,t)=>n=>joinClass(e(n),t(n)),addToOptions:(e,t)=>e.concat(t)})});function joinClass(e,t){return e?t?e+" "+t:e:t}function defaultPositionInfo(e,t,n,i,r,s){let o,a,l=e.textDirection==Direction.RTL,c=l,h=!1,d="top",u=t.left-r.left,p=r.right-t.right,f=i.right-i.left,m=i.bottom-i.top;if(c&&u<Math.min(f,p)?c=!1:!c&&p<Math.min(f,u)&&(c=!0),f<=(c?u:p))o=Math.max(r.top,Math.min(n.top,r.bottom-m))-t.top,a=Math.min(400,c?u:p);else{h=!0,a=Math.min(400,(l?t.right:r.right-t.left)-30);let e=r.bottom-t.bottom;e>=m||e>t.top?o=n.bottom-t.top:(d="bottom",o=t.bottom-n.top)}return{style:`${d}: ${o/((t.bottom-t.top)/s.offsetHeight)}px; max-width: ${a/((t.right-t.left)/s.offsetWidth)}px`,class:"cm-completionInfo-"+(h?l?"left-narrow":"right-narrow":c?"left":"right")}}function optionContent(e){let t=e.addToOptions.slice();return e.icons&&t.push({render(e){let t=document.createElement("div");return t.classList.add("cm-completionIcon"),e.type&&t.classList.add(...e.type.split(/\s+/g).map((e=>"cm-completionIcon-"+e))),t.setAttribute("aria-hidden","true"),t},position:20}),t.push({render(e,t,n,i){let r=document.createElement("span");r.className="cm-completionLabel";let s=e.displayLabel||e.label,o=0;for(let e=0;e<i.length;){let t=i[e++],n=i[e++];t>o&&r.appendChild(document.createTextNode(s.slice(o,t)));let a=r.appendChild(document.createElement("span"));a.appendChild(document.createTextNode(s.slice(t,n))),a.className="cm-completionMatchedText",o=n}return o<s.length&&r.appendChild(document.createTextNode(s.slice(o))),r},position:50},{render(e){if(!e.detail)return null;let t=document.createElement("span");return t.className="cm-completionDetail",t.textContent=e.detail,t},position:80}),t.sort(((e,t)=>e.position-t.position)).map((e=>e.render))}function rangeAroundSelected(e,t,n){if(e<=n)return{from:0,to:e};if(t<0&&(t=0),t<=e>>1){let e=Math.floor(t/n);return{from:e*n,to:(e+1)*n}}let i=Math.floor((e-t)/n);return{from:e-(i+1)*n,to:e-i*n}}class CompletionTooltip{constructor(e,t,n){this.view=e,this.stateField=t,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:e=>this.placeInfo(e),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:r,selected:s}=i.open,o=e.state.facet(completionConfig);this.optionContent=optionContent(o),this.optionClass=o.optionClass,this.tooltipClass=o.tooltipClass,this.range=rangeAroundSelected(r.length,s,o.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",(n=>{let{options:i}=e.state.field(t).open;for(let t,r=n.target;r&&r!=this.dom;r=r.parentNode)if("LI"==r.nodeName&&(t=/-(\d+)$/.exec(r.id))&&+t[1]<i.length)return this.applyCompletion(e,i[+t[1]]),void n.preventDefault()})),this.dom.addEventListener("focusout",(t=>{let n=e.state.field(this.stateField,!1);n&&n.tooltip&&e.state.facet(completionConfig).closeOnBlur&&t.relatedTarget!=e.contentDOM&&e.dispatch({effects:closeCompletionEffect.of(null)})})),this.showOptions(r,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",(()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)}))}update(e){var t;let n=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=i){let{options:r,selected:s,disabled:o}=n.open;i.open&&i.open.options==r||(this.range=rangeAroundSelected(r.length,s,e.state.facet(completionConfig).maxRenderedOptions),this.showOptions(r,n.id)),this.updateSel(),o!=(null===(t=i.open)||void 0===t?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!o)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let e of this.currentClass.split(" "))e&&this.dom.classList.remove(e);for(let e of t.split(" "))e&&this.dom.classList.add(e);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=rangeAroundSelected(t.options.length,t.selected,this.view.state.facet(completionConfig).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:n}=t.options[t.selected],{info:i}=n;if(!i)return;let r="string"==typeof i?document.createTextNode(i):i(n);if(!r)return;"then"in r?r.then((t=>{t&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(t,n)})).catch((e=>logException(this.view.state,e,"completion info"))):this.addInfoPane(r,n)}}addInfoPane(e,t){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",null!=e.nodeType)n.appendChild(e),this.infoDestroy=null;else{let{dom:t,destroy:i}=e;n.appendChild(t),this.infoDestroy=i||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let n=this.list.firstChild,i=this.range.from;n;n=n.nextSibling,i++)"LI"==n.nodeName&&n.id?i==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),t=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected"):i--;return t&&scrollIntoView(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),r=this.space;if(!r){let e=this.dom.ownerDocument.defaultView||window;r={left:0,top:0,right:e.innerWidth,bottom:e.innerHeight}}return i.top>Math.min(r.bottom,t.bottom)-10||i.bottom<Math.max(r.top,t.top)+10?null:this.view.state.facet(completionConfig).positionInfo(this.view,t,i,n,r,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,n){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions"));let r=null;for(let s=n.from;s<n.to;s++){let{completion:o,match:a}=e[s],{section:l}=o;if(l){let e="string"==typeof l?l:l.name;if(e!=r&&(s>n.from||0==n.from))if(r=e,"string"!=typeof l&&l.header)i.appendChild(l.header(l));else{i.appendChild(document.createElement("completion-section")).textContent=e}}const c=i.appendChild(document.createElement("li"));c.id=t+"-"+s,c.setAttribute("role","option");let h=this.optionClass(o);h&&(c.className=h);for(let e of this.optionContent){let t=e(o,this.view.state,this.view,a);t&&c.appendChild(t)}}return n.from&&i.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function completionTooltip(e,t){return n=>new CompletionTooltip(n,e,t)}function scrollIntoView(e,t){let n=e.getBoundingClientRect(),i=t.getBoundingClientRect(),r=n.height/e.offsetHeight;i.top<n.top?e.scrollTop-=(n.top-i.top)/r:i.bottom>n.bottom&&(e.scrollTop+=(i.bottom-n.bottom)/r)}function score(e){return 100*(e.boost||0)+(e.apply?10:0)+(e.info?5:0)+(e.type?1:0)}function sortOptions(e,t){let n=[],i=null,r=e=>{n.push(e);let{section:t}=e.completion;if(t){i||(i=[]);let e="string"==typeof t?t:t.name;i.some((t=>t.name==e))||i.push("string"==typeof t?{name:e}:t)}};for(let i of e)if(i.hasResult()){let e=i.result.getMatch;if(!1===i.result.filter)for(let t of i.result.options)r(new Option(t,i.source,e?e(t):[],1e9-n.length));else{let n=new FuzzyMatcher(t.sliceDoc(i.from,i.to));for(let t of i.result.options)if(n.match(t.label)){let s=t.displayLabel?e?e(t,n.matched):[]:n.matched;r(new Option(t,i.source,s,n.score+(t.boost||0)))}}}if(i){let e=Object.create(null),t=0,r=(e,t)=>{var n,i;return(null!==(n=e.rank)&&void 0!==n?n:1e9)-(null!==(i=t.rank)&&void 0!==i?i:1e9)||(e.name<t.name?-1:1)};for(let n of i.sort(r))t-=1e5,e[n.name]=t;for(let t of n){let{section:n}=t.completion;n&&(t.score+=e["string"==typeof n?n:n.name])}}let s=[],o=null,a=t.facet(completionConfig).compareCompletions;for(let e of n.sort(((e,t)=>t.score-e.score||a(e.completion,t.completion)))){let t=e.completion;!o||o.label!=t.label||o.detail!=t.detail||null!=o.type&&null!=t.type&&o.type!=t.type||o.apply!=t.apply||o.boost!=t.boost?s.push(e):score(e.completion)>score(o)&&(s[s.length-1]=e),o=e.completion}return s}class CompletionDialog{constructor(e,t,n,i,r,s){this.options=e,this.attrs=t,this.tooltip=n,this.timestamp=i,this.selected=r,this.disabled=s}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new CompletionDialog(this.options,makeAttrs(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,n,i,r){let s=sortOptions(e,t);if(!s.length)return i&&e.some((e=>1==e.state))?new CompletionDialog(i.options,i.attrs,i.tooltip,i.timestamp,i.selected,!0):null;let o=t.facet(completionConfig).selectOnOpen?0:-1;if(i&&i.selected!=o&&-1!=i.selected){let e=i.options[i.selected].completion;for(let t=0;t<s.length;t++)if(s[t].completion==e){o=t;break}}return new CompletionDialog(s,makeAttrs(n,o),{pos:e.reduce(((e,t)=>t.hasResult()?Math.min(e,t.from):e),1e8),create:createTooltip,above:r.aboveCursor},i?i.timestamp:Date.now(),o,!1)}map(e){return new CompletionDialog(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class CompletionState{constructor(e,t,n){this.active=e,this.id=t,this.open=n}static start(){return new CompletionState(none$1,"cm-ac-"+Math.floor(2e6*Math.random()).toString(36),null)}update(e){let{state:t}=e,n=t.facet(completionConfig),i=(n.override||t.languageDataAt("autocomplete",cur(t)).map(asSource)).map((t=>(this.active.find((e=>e.source==t))||new ActiveSource(t,this.active.some((e=>0!=e.state))?1:0)).update(e,n)));i.length==this.active.length&&i.every(((e,t)=>e==this.active[t]))&&(i=this.active);let r=this.open;r&&e.docChanged&&(r=r.map(e.changes)),e.selection||i.some((t=>t.hasResult()&&e.changes.touchesRange(t.from,t.to)))||!sameResults(i,this.active)?r=CompletionDialog.build(i,t,this.id,r,n):r&&r.disabled&&!i.some((e=>1==e.state))&&(r=null),!r&&i.every((e=>1!=e.state))&&i.some((e=>e.hasResult()))&&(i=i.map((e=>e.hasResult()?new ActiveSource(e.source,0):e)));for(let t of e.effects)t.is(setSelectedEffect)&&(r=r&&r.setSelected(t.value,this.id));return i==this.active&&r==this.open?this:new CompletionState(i,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:baseAttrs}}function sameResults(e,t){if(e==t)return!0;for(let n=0,i=0;;){for(;n<e.length&&!e[n].hasResult;)n++;for(;i<t.length&&!t[i].hasResult;)i++;let r=n==e.length,s=i==t.length;if(r||s)return r==s;if(e[n++].result!=t[i++].result)return!1}}const baseAttrs={"aria-autocomplete":"list"};function makeAttrs(e,t){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":e};return t>-1&&(n["aria-activedescendant"]=e+"-"+t),n}const none$1=[];function getUserEvent(e){return e.isUserEvent("input.type")?"input":e.isUserEvent("delete.backward")?"delete":null}class ActiveSource{constructor(e,t,n=-1){this.source=e,this.state=t,this.explicitPos=n}hasResult(){return!1}update(e,t){let n=getUserEvent(e),i=this;n?i=i.handleUserEvent(e,n,t):e.docChanged?i=i.handleChange(e):e.selection&&0!=i.state&&(i=new ActiveSource(i.source,0));for(let t of e.effects)if(t.is(startCompletionEffect))i=new ActiveSource(i.source,1,t.value?cur(e.state):-1);else if(t.is(closeCompletionEffect))i=new ActiveSource(i.source,0);else if(t.is(setActiveEffect))for(let e of t.value)e.source==i.source&&(i=e);return i}handleUserEvent(e,t,n){return"delete"!=t&&n.activateOnTyping?new ActiveSource(this.source,1):this.map(e.changes)}handleChange(e){return e.changes.touchesRange(cur(e.startState))?new ActiveSource(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new ActiveSource(this.source,this.state,e.mapPos(this.explicitPos))}}class ActiveResult extends ActiveSource{constructor(e,t,n,i,r){super(e,2,t),this.result=n,this.from=i,this.to=r}hasResult(){return!0}handleUserEvent(e,t,n){var i;let r=e.changes.mapPos(this.from),s=e.changes.mapPos(this.to,1),o=cur(e.state);if((this.explicitPos<0?o<=r:o<this.from)||o>s||"delete"==t&&cur(e.startState)==this.from)return new ActiveSource(this.source,"input"==t&&n.activateOnTyping?1:0);let a,l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return checkValid(this.result.validFor,e.state,r,s)?new ActiveResult(this.source,l,this.result,r,s):this.result.update&&(a=this.result.update(this.result,r,s,new CompletionContext(e.state,o,l>=0)))?new ActiveResult(this.source,l,a,a.from,null!==(i=a.to)&&void 0!==i?i:cur(e.state)):new ActiveSource(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new ActiveSource(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new ActiveResult(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function checkValid(e,t,n,i){if(!e)return!1;let r=t.sliceDoc(n,i);return"function"==typeof e?e(r,n,i,t):ensureAnchor(e,!0).test(r)}const setActiveEffect=StateEffect.define({map:(e,t)=>e.map((e=>e.map(t)))}),setSelectedEffect=StateEffect.define(),completionState=StateField.define({create:()=>CompletionState.start(),update:(e,t)=>e.update(t),provide:e=>[showTooltip.from(e,(e=>e.tooltip)),EditorView.contentAttributes.from(e,(e=>e.attrs))]});function applyCompletion(e,t){const n=t.completion.apply||t.completion.label;let i=e.state.field(completionState).active.find((e=>e.source==t.source));return i instanceof ActiveResult&&("string"==typeof n?e.dispatch(Object.assign(Object.assign({},insertCompletionText(e.state,n,i.from,i.to)),{annotations:pickedCompletion.of(t.completion)})):n(e,t.completion,i.from,i.to),!0)}const createTooltip=completionTooltip(completionState,applyCompletion);function moveCompletionSelection(e,t="option"){return n=>{let i=n.state.field(completionState,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<n.state.facet(completionConfig).interactionDelay)return!1;let r,s=1;"page"==t&&(r=getTooltip(n,i.open.tooltip))&&(s=Math.max(2,Math.floor(r.dom.offsetHeight/r.dom.querySelector("li").offsetHeight)-1));let{length:o}=i.open.options,a=i.open.selected>-1?i.open.selected+s*(e?1:-1):e?0:o-1;return a<0?a="page"==t?0:o-1:a>=o&&(a="page"==t?o-1:0),n.dispatch({effects:setSelectedEffect.of(a)}),!0}}const acceptCompletion=e=>{let t=e.state.field(completionState,!1);return!(e.state.readOnly||!t||!t.open||t.open.selected<0||t.open.disabled||Date.now()-t.open.timestamp<e.state.facet(completionConfig).interactionDelay)&&applyCompletion(e,t.open.options[t.open.selected])},startCompletion=e=>!!e.state.field(completionState,!1)&&(e.dispatch({effects:startCompletionEffect.of(!0)}),!0),closeCompletion=e=>{let t=e.state.field(completionState,!1);return!(!t||!t.active.some((e=>0!=e.state)))&&(e.dispatch({effects:closeCompletionEffect.of(null)}),!0)};class RunningQuery{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const MaxUpdateCount=50,MinAbortTime=1e3,completionPlugin=ViewPlugin.fromClass(class{constructor(e){this.view=e,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let t of e.state.field(completionState).active)1==t.state&&this.startQuery(t)}update(e){let t=e.state.field(completionState);if(!e.selectionSet&&!e.docChanged&&e.startState.field(completionState)==t)return;let n=e.transactions.some((e=>(e.selection||e.docChanged)&&!getUserEvent(e)));for(let t=0;t<this.running.length;t++){let i=this.running[t];if(n||i.updates.length+e.transactions.length>MaxUpdateCount&&Date.now()-i.time>MinAbortTime){for(let e of i.context.abortListeners)try{e()}catch(e){logException(this.view.state,e)}i.context.abortListeners=null,this.running.splice(t--,1)}else i.updates.push(...e.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=t.active.some((e=>1==e.state&&!this.running.some((t=>t.active.source==e.source))))?setTimeout((()=>this.startUpdate()),50):-1,0!=this.composing)for(let t of e.transactions)"input"==getUserEvent(t)?this.composing=2:2==this.composing&&t.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:e}=this.view,t=e.field(completionState);for(let e of t.active)1!=e.state||this.running.some((t=>t.active.source==e.source))||this.startQuery(e)}startQuery(e){let{state:t}=this.view,n=cur(t),i=new CompletionContext(t,n,e.explicitPos==n),r=new RunningQuery(e,i);this.running.push(r),Promise.resolve(e.source(i)).then((e=>{r.context.aborted||(r.done=e||null,this.scheduleAccept())}),(e=>{this.view.dispatch({effects:closeCompletionEffect.of(null)}),logException(this.view.state,e)}))}scheduleAccept(){this.running.every((e=>void 0!==e.done))?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout((()=>this.accept()),this.view.state.facet(completionConfig).updateSyncTime))}accept(){var e;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],n=this.view.state.facet(completionConfig);for(let i=0;i<this.running.length;i++){let r=this.running[i];if(void 0===r.done)continue;if(this.running.splice(i--,1),r.done){let i=new ActiveResult(r.active.source,r.active.explicitPos,r.done,r.done.from,null!==(e=r.done.to)&&void 0!==e?e:cur(r.updates.length?r.updates[0].startState:this.view.state));for(let e of r.updates)i=i.update(e,n);if(i.hasResult()){t.push(i);continue}}let s=this.view.state.field(completionState).active.find((e=>e.source==r.active.source));if(s&&1==s.state)if(null==r.done){let e=new ActiveSource(r.active.source,0);for(let t of r.updates)e=e.update(t,n);1!=e.state&&t.push(e)}else this.startQuery(s)}t.length&&this.view.dispatch({effects:setActiveEffect.of(t)})}},{eventHandlers:{blur(e){let t=this.view.state.field(completionState,!1);if(t&&t.tooltip&&this.view.state.facet(completionConfig).closeOnBlur){let n=t.open&&getTooltip(this.view,t.open.tooltip);n&&n.dom.contains(e.relatedTarget)||this.view.dispatch({effects:closeCompletionEffect.of(null)})}},compositionstart(){this.composing=1},compositionend(){3==this.composing&&setTimeout((()=>this.view.dispatch({effects:startCompletionEffect.of(!1)})),20),this.composing=0}}}),baseTheme$1=EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class FieldPos{constructor(e,t,n,i){this.field=e,this.line=t,this.from=n,this.to=i}}class FieldRange{constructor(e,t,n){this.field=e,this.from=t,this.to=n}map(e){let t=e.mapPos(this.from,-1,MapMode.TrackDel),n=e.mapPos(this.to,1,MapMode.TrackDel);return null==t||null==n?null:new FieldRange(this.field,t,n)}}class Snippet{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let n=[],i=[t],r=e.doc.lineAt(t),s=/^\s*/.exec(r.text)[0];for(let r of this.lines){if(n.length){let n=s,o=/^\t*/.exec(r)[0].length;for(let t=0;t<o;t++)n+=e.facet(indentUnit);i.push(t+n.length-o),r=n+r.slice(o)}n.push(r),t+=r.length+1}let o=this.fieldPositions.map((e=>new FieldRange(e.field,i[e.line]+e.from,i[e.line]+e.to)));return{text:n,ranges:o}}static parse(e){let t,n=[],i=[],r=[];for(let s of e.split(/\r\n?|\n/)){for(;t=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(s);){let e=t[1]?+t[1]:null,o=t[2]||t[3]||"",a=-1;for(let t=0;t<n.length;t++)(null!=e?n[t].seq==e:o&&n[t].name==o)&&(a=t);if(a<0){let t=0;for(;t<n.length&&(null==e||null!=n[t].seq&&n[t].seq<e);)t++;n.splice(t,0,{seq:e,name:o}),a=t;for(let e of r)e.field>=a&&e.field++}r.push(new FieldPos(a,i.length,t.index,t.index+o.length)),s=s.slice(0,t.index)+o+s.slice(t.index+t[0].length)}for(let e;e=/\\([{}])/.exec(s);){s=s.slice(0,e.index)+e[1]+s.slice(e.index+e[0].length);for(let t of r)t.line==i.length&&t.from>e.index&&(t.from--,t.to--)}i.push(s)}return new Snippet(i,r)}}let fieldMarker=Decoration.widget({widget:new class extends WidgetType{toDOM(){let e=document.createElement("span");return e.className="cm-snippetFieldPosition",e}ignoreEvent(){return!1}}}),fieldRange=Decoration.mark({class:"cm-snippetField"});class ActiveSnippet{constructor(e,t){this.ranges=e,this.active=t,this.deco=Decoration.set(e.map((e=>(e.from==e.to?fieldMarker:fieldRange).range(e.from,e.to))))}map(e){let t=[];for(let n of this.ranges){let i=n.map(e);if(!i)return null;t.push(i)}return new ActiveSnippet(t,this.active)}selectionInsideField(e){return e.ranges.every((e=>this.ranges.some((t=>t.field==this.active&&t.from<=e.from&&t.to>=e.to))))}}const setActive=StateEffect.define({map:(e,t)=>e&&e.map(t)}),moveToField=StateEffect.define(),snippetState=StateField.define({create:()=>null,update(e,t){for(let n of t.effects){if(n.is(setActive))return n.value;if(n.is(moveToField)&&e)return new ActiveSnippet(e.ranges,n.value)}return e&&t.docChanged&&(e=e.map(t.changes)),e&&t.selection&&!e.selectionInsideField(t.selection)&&(e=null),e},provide:e=>EditorView.decorations.from(e,(e=>e?e.deco:Decoration.none))});function fieldSelection(e,t){return EditorSelection.create(e.filter((e=>e.field==t)).map((e=>EditorSelection.range(e.from,e.to))))}function snippet(e){let t=Snippet.parse(e);return(e,n,i,r)=>{let{text:s,ranges:o}=t.instantiate(e.state,i),a={changes:{from:i,to:r,insert:Text.of(s)},scrollIntoView:!0,annotations:n?pickedCompletion.of(n):void 0};if(o.length&&(a.selection=fieldSelection(o,0)),o.length>1){let t=new ActiveSnippet(o,0),n=a.effects=[setActive.of(t)];void 0===e.state.field(snippetState,!1)&&n.push(StateEffect.appendConfig.of([snippetState,addSnippetKeymap,snippetPointerHandler,baseTheme$1]))}e.dispatch(e.state.update(a))}}function moveField(e){return({state:t,dispatch:n})=>{let i=t.field(snippetState,!1);if(!i||e<0&&0==i.active)return!1;let r=i.active+e,s=e>0&&!i.ranges.some((t=>t.field==r+e));return n(t.update({selection:fieldSelection(i.ranges,r),effects:setActive.of(s?null:new ActiveSnippet(i.ranges,r)),scrollIntoView:!0})),!0}}const clearSnippet=({state:e,dispatch:t})=>!!e.field(snippetState,!1)&&(t(e.update({effects:setActive.of(null)})),!0),nextSnippetField=moveField(1),prevSnippetField=moveField(-1),defaultSnippetKeymap=[{key:"Tab",run:nextSnippetField,shift:prevSnippetField},{key:"Escape",run:clearSnippet}],snippetKeymap=Facet.define({combine:e=>e.length?e[0]:defaultSnippetKeymap}),addSnippetKeymap=Prec.highest(keymap.compute([snippetKeymap],(e=>e.facet(snippetKeymap))));function snippetCompletion(e,t){return Object.assign(Object.assign({},t),{apply:snippet(e)})}const snippetPointerHandler=EditorView.domEventHandlers({mousedown(e,t){let n,i=t.state.field(snippetState,!1);if(!i||null==(n=t.posAtCoords({x:e.clientX,y:e.clientY})))return!1;let r=i.ranges.find((e=>e.from<=n&&e.to>=n));return!(!r||r.field==i.active)&&(t.dispatch({selection:fieldSelection(i.ranges,r.field),effects:setActive.of(i.ranges.some((e=>e.field>r.field))?new ActiveSnippet(i.ranges,r.field):null),scrollIntoView:!0}),!0)}}),defaults={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},closeBracketEffect=StateEffect.define({map(e,t){let n=t.mapPos(e,-1,MapMode.TrackAfter);return null==n?void 0:n}}),closedBracket=new class extends RangeValue{};closedBracket.startSide=1,closedBracket.endSide=-1;const bracketState=StateField.define({create:()=>RangeSet.empty,update(e,t){if(e=e.map(t.changes),t.selection){let n=t.state.doc.lineAt(t.selection.main.head);e=e.update({filter:e=>e>=n.from&&e<=n.to})}for(let n of t.effects)n.is(closeBracketEffect)&&(e=e.update({add:[closedBracket.range(n.value,n.value+1)]}));return e}});function closeBrackets(){return[inputHandler,bracketState]}const definedClosing="()[]{}<>";function closing(e){for(let t=0;t<definedClosing.length;t+=2)if(definedClosing.charCodeAt(t)==e)return definedClosing.charAt(t+1);return fromCodePoint(e<128?e:e+1)}function config(e,t){return e.languageDataAt("closeBrackets",t)[0]||defaults}const android$1="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),inputHandler=EditorView.inputHandler.of(((e,t,n,i)=>{if((android$1?e.composing:e.compositionStarted)||e.state.readOnly)return!1;let r=e.state.selection.main;if(i.length>2||2==i.length&&1==codePointSize(codePointAt(i,0))||t!=r.from||n!=r.to)return!1;let s=insertBracket(e.state,i);return!!s&&(e.dispatch(s),!0)})),deleteBracketPair=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=config(e,e.selection.main.head).brackets||defaults.brackets,i=null,r=e.changeByRange((t=>{if(t.empty){let i=prevChar(e.doc,t.head);for(let r of n)if(r==i&&nextChar(e.doc,t.head)==closing(codePointAt(r,0)))return{changes:{from:t.head-r.length,to:t.head+r.length},range:EditorSelection.cursor(t.head-r.length)}}return{range:i=t}}));return i||t(e.update(r,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},closeBracketsKeymap=[{key:"Backspace",run:deleteBracketPair}];function insertBracket(e,t){let n=config(e,e.selection.main.head),i=n.brackets||defaults.brackets;for(let r of i){let s=closing(codePointAt(r,0));if(t==r)return s==r?handleSame(e,r,i.indexOf(r+r+r)>-1,n):handleOpen(e,r,s,n.before||defaults.before);if(t==s&&closedBracketAt(e,e.selection.main.from))return handleClose(e,r,s)}return null}function closedBracketAt(e,t){let n=!1;return e.field(bracketState).between(0,e.doc.length,(e=>{e==t&&(n=!0)})),n}function nextChar(e,t){let n=e.sliceString(t,t+2);return n.slice(0,codePointSize(codePointAt(n,0)))}function prevChar(e,t){let n=e.sliceString(t-2,t);return codePointSize(codePointAt(n,0))==n.length?n:n.slice(1)}function handleOpen(e,t,n,i){let r=null,s=e.changeByRange((s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:n,from:s.to}],effects:closeBracketEffect.of(s.to+t.length),range:EditorSelection.range(s.anchor+t.length,s.head+t.length)};let o=nextChar(e.doc,s.head);return!o||/\s/.test(o)||i.indexOf(o)>-1?{changes:{insert:t+n,from:s.head},effects:closeBracketEffect.of(s.head+t.length),range:EditorSelection.cursor(s.head+t.length)}:{range:r=s}}));return r?null:e.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function handleClose(e,t,n){let i=null,r=e.changeByRange((t=>t.empty&&nextChar(e.doc,t.head)==n?{changes:{from:t.head,to:t.head+n.length,insert:n},range:EditorSelection.cursor(t.head+n.length)}:i={range:t}));return i?null:e.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function handleSame(e,t,n,i){let r=i.stringPrefixes||defaults.stringPrefixes,s=null,o=e.changeByRange((i=>{if(!i.empty)return{changes:[{insert:t,from:i.from},{insert:t,from:i.to}],effects:closeBracketEffect.of(i.to+t.length),range:EditorSelection.range(i.anchor+t.length,i.head+t.length)};let o,a=i.head,l=nextChar(e.doc,a);if(l==t){if(nodeStart(e,a))return{changes:{insert:t+t,from:a},effects:closeBracketEffect.of(a+t.length),range:EditorSelection.cursor(a+t.length)};if(closedBracketAt(e,a)){let i=n&&e.sliceDoc(a,a+3*t.length)==t+t+t?t+t+t:t;return{changes:{from:a,to:a+i.length,insert:i},range:EditorSelection.cursor(a+i.length)}}}else{if(n&&e.sliceDoc(a-2*t.length,a)==t+t&&(o=canStartStringAt(e,a-2*t.length,r))>-1&&nodeStart(e,o))return{changes:{insert:t+t+t+t,from:a},effects:closeBracketEffect.of(a+t.length),range:EditorSelection.cursor(a+t.length)};if(e.charCategorizer(a)(l)!=CharCategory.Word&&canStartStringAt(e,a,r)>-1&&!probablyInString(e,a,t,r))return{changes:{insert:t+t,from:a},effects:closeBracketEffect.of(a+t.length),range:EditorSelection.cursor(a+t.length)}}return{range:s=i}}));return s?null:e.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function nodeStart(e,t){let n=syntaxTree(e).resolveInner(t+1);return n.parent&&n.from==t}function probablyInString(e,t,n,i){let r=syntaxTree(e).resolveInner(t,-1),s=i.reduce(((e,t)=>Math.max(e,t.length)),0);for(let o=0;o<5;o++){let o=e.sliceDoc(r.from,Math.min(r.to,r.from+n.length+s)),a=o.indexOf(n);if(!a||a>-1&&i.indexOf(o.slice(0,a))>-1){let t=r.firstChild;for(;t&&t.from==r.from&&t.to-t.from>n.length+a;){if(e.sliceDoc(t.to-n.length,t.to)==n)return!1;t=t.firstChild}return!0}let l=r.to==t&&r.parent;if(!l)break;r=l}return!1}function canStartStringAt(e,t,n){let i=e.charCategorizer(t);if(i(e.sliceDoc(t-1,t))!=CharCategory.Word)return t;for(let r of n){let n=t-r.length;if(e.sliceDoc(n,t)==r&&i(e.sliceDoc(n-1,n))!=CharCategory.Word)return n}return-1}function autocompletion(e={}){return[completionState,completionConfig.of(e),completionPlugin,completionKeymapExt,baseTheme$1]}const completionKeymap=[{key:"Ctrl-Space",run:startCompletion},{key:"Escape",run:closeCompletion},{key:"ArrowDown",run:moveCompletionSelection(!0)},{key:"ArrowUp",run:moveCompletionSelection(!1)},{key:"PageDown",run:moveCompletionSelection(!0,"page")},{key:"PageUp",run:moveCompletionSelection(!1,"page")},{key:"Enter",run:acceptCompletion}],completionKeymapExt=Prec.highest(keymap.computeN([completionConfig],(e=>e.facet(completionConfig).defaultKeymap?[completionKeymap]:[])));class SelectedDiagnostic{constructor(e,t,n){this.from=e,this.to=t,this.diagnostic=n}}class LintState{constructor(e,t,n){this.diagnostics=e,this.panel=t,this.selected=n}static init(e,t,n){let i=e,r=n.facet(lintConfig).markerFilter;r&&(i=r(i));let s=Decoration.set(i.map((e=>e.from==e.to||e.from==e.to-1&&n.doc.lineAt(e.from).to==e.from?Decoration.widget({widget:new DiagnosticWidget(e),diagnostic:e}).range(e.from):Decoration.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity+(e.markClass?" "+e.markClass:"")},diagnostic:e}).range(e.from,e.to))),!0);return new LintState(s,t,findDiagnostic(s))}}function findDiagnostic(e,t=null,n=0){let i=null;return e.between(n,1e9,((e,n,{spec:r})=>{if(!t||r.diagnostic==t)return i=new SelectedDiagnostic(e,n,r.diagnostic),!1})),i}function hideTooltip(e,t){let n=e.startState.doc.lineAt(t.pos);return!(!e.effects.some((e=>e.is(setDiagnosticsEffect)))&&!e.changes.touchesRange(n.from,n.to))}function maybeEnableLint(e,t){return e.field(lintState,!1)?t:t.concat(StateEffect.appendConfig.of(lintExtensions))}const setDiagnosticsEffect=StateEffect.define(),togglePanel=StateEffect.define(),movePanelSelection=StateEffect.define(),lintState=StateField.define({create:()=>new LintState(Decoration.none,null,null),update(e,t){if(t.docChanged){let n=e.diagnostics.map(t.changes),i=null;if(e.selected){let r=t.changes.mapPos(e.selected.from,1);i=findDiagnostic(n,e.selected.diagnostic,r)||findDiagnostic(n,null,r)}e=new LintState(n,e.panel,i)}for(let n of t.effects)n.is(setDiagnosticsEffect)?e=LintState.init(n.value,e.panel,t.state):n.is(togglePanel)?e=new LintState(e.diagnostics,n.value?LintPanel.open:null,e.selected):n.is(movePanelSelection)&&(e=new LintState(e.diagnostics,e.panel,n.value));return e},provide:e=>[showPanel.from(e,(e=>e.panel)),EditorView.decorations.from(e,(e=>e.diagnostics))]}),activeMark=Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function lintTooltip(e,t,n){let{diagnostics:i}=e.state.field(lintState),r=[],s=2e8,o=0;i.between(t-(n<0?1:0),t+(n>0?1:0),((e,i,{spec:a})=>{t>=e&&t<=i&&(e==i||(t>e||n>0)&&(t<i||n<0))&&(r.push(a.diagnostic),s=Math.min(e,s),o=Math.max(i,o))}));let a=e.state.facet(lintConfig).tooltipFilter;return a&&(r=a(r)),r.length?{pos:s,end:o,above:e.state.doc.lineAt(s).to<o,create:()=>({dom:diagnosticsTooltip(e,r)})}:null}function diagnosticsTooltip(e,t){return crelt("ul",{class:"cm-tooltip-lint"},t.map((t=>renderDiagnostic(e,t,!1))))}const openLintPanel=e=>{let t=e.state.field(lintState,!1);t&&t.panel||e.dispatch({effects:maybeEnableLint(e.state,[togglePanel.of(!0)])});let n=getPanel(e,LintPanel.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},closeLintPanel=e=>{let t=e.state.field(lintState,!1);return!(!t||!t.panel)&&(e.dispatch({effects:togglePanel.of(!1)}),!0)},nextDiagnostic=e=>{let t=e.state.field(lintState,!1);if(!t)return!1;let n=e.state.selection.main,i=t.diagnostics.iter(n.to+1);return!(!i.value&&(i=t.diagnostics.iter(0),!i.value||i.from==n.from&&i.to==n.to))&&(e.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)},lintKeymap=[{key:"Mod-Shift-m",run:openLintPanel,preventDefault:!0},{key:"F8",run:nextDiagnostic}],lintConfig=Facet.define({combine:e=>Object.assign({sources:e.map((e=>e.source))},combineConfig(e.map((e=>e.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,t)=>e?t?n=>e(n)||t(n):e:t}))});function assignKeys(e){let t=[];if(e)e:for(let{name:n}of e){for(let e=0;e<n.length;e++){let i=n[e];if(/[a-zA-Z]/.test(i)&&!t.some((e=>e.toLowerCase()==i.toLowerCase()))){t.push(i);continue e}}t.push("")}return t}function renderDiagnostic(e,t,n){var i;let r=n?assignKeys(t.actions):[];return crelt("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},crelt("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),null===(i=t.actions)||void 0===i?void 0:i.map(((n,i)=>{let s=!1,o=i=>{if(i.preventDefault(),s)return;s=!0;let r=findDiagnostic(e.state.field(lintState).diagnostics,t);r&&n.apply(e,r.from,r.to)},{name:a}=n,l=r[i]?a.indexOf(r[i]):-1,c=l<0?a:[a.slice(0,l),crelt("u",a.slice(l,l+1)),a.slice(l+1)];return crelt("button",{type:"button",class:"cm-diagnosticAction",onclick:o,onmousedown:o,"aria-label":` Action: ${a}${l<0?"":` (access key "${r[i]})"`}.`},c)})),t.source&&crelt("div",{class:"cm-diagnosticSource"},t.source))}class DiagnosticWidget extends WidgetType{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return crelt("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class PanelItem{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(4294967295*Math.random()).toString(16),this.dom=renderDiagnostic(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class LintPanel{constructor(e){this.view=e,this.items=[];this.list=crelt("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t=>{if(27==t.keyCode)closeLintPanel(this.view),this.view.focus();else if(38==t.keyCode||33==t.keyCode)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(40==t.keyCode||34==t.keyCode)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(36==t.keyCode)this.moveSelection(0);else if(35==t.keyCode)this.moveSelection(this.items.length-1);else if(13==t.keyCode)this.view.focus();else{if(!(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0))return;{let{diagnostic:n}=this.items[this.selectedIndex],i=assignKeys(n.actions);for(let r=0;r<i.length;r++)if(i[r].toUpperCase().charCodeAt(0)==t.keyCode){let t=findDiagnostic(this.view.state.field(lintState).diagnostics,n);t&&n.actions[r].apply(e,t.from,t.to)}}}t.preventDefault()},onclick:e=>{for(let t=0;t<this.items.length;t++)this.items[t].dom.contains(e.target)&&this.moveSelection(t)}}),this.dom=crelt("div",{class:"cm-panel-lint"},this.list,crelt("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>closeLintPanel(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(lintState).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(lintState),n=0,i=!1,r=null;for(e.between(0,this.view.state.doc.length,((e,s,{spec:o})=>{let a,l=-1;for(let e=n;e<this.items.length;e++)if(this.items[e].diagnostic==o.diagnostic){l=e;break}l<0?(a=new PanelItem(this.view,o.diagnostic),this.items.splice(n,0,a),i=!0):(a=this.items[l],l>n&&(this.items.splice(n,l-n),i=!0)),t&&a.diagnostic==t.diagnostic?a.dom.hasAttribute("aria-selected")||(a.dom.setAttribute("aria-selected","true"),r=a):a.dom.hasAttribute("aria-selected")&&a.dom.removeAttribute("aria-selected"),n++}));n<this.items.length&&!(1==this.items.length&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();0==this.items.length&&(this.items.push(new PanelItem(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),r?(this.list.setAttribute("aria-activedescendant",r.id),this.view.requestMeasure({key:this,read:()=>({sel:r.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{let n=t.height/this.list.offsetHeight;e.top<t.top?this.list.scrollTop-=(t.top-e.top)/n:e.bottom>t.bottom&&(this.list.scrollTop+=(e.bottom-t.bottom)/n)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling,t.remove()}for(let n of this.items)if(n.dom.parentNode==this.list){for(;e!=n.dom;)t();e=n.dom.nextSibling}else this.list.insertBefore(n.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=findDiagnostic(this.view.state.field(lintState).diagnostics,this.items[e].diagnostic);t&&this.view.dispatch({selection:{anchor:t.from,head:t.to},scrollIntoView:!0,effects:movePanelSelection.of(t)})}static open(e){return new LintPanel(e)}}function svg(e,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function underline(e){return svg(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const baseTheme=EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:underline("#d11")},".cm-lintRange-warning":{backgroundImage:underline("orange")},".cm-lintRange-info":{backgroundImage:underline("#999")},".cm-lintRange-hint":{backgroundImage:underline("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),lintExtensions=[lintState,EditorView.decorations.compute([lintState],(e=>{let{selected:t,panel:n}=e.field(lintState);return t&&n&&t.from!=t.to?Decoration.set([activeMark.range(t.from,t.to)]):Decoration.none})),hoverTooltip(lintTooltip,{hideOn:hideTooltip}),baseTheme];var basicSetup=function(e){void 0===e&&(e={});var{crosshairCursor:t=!1}=e,n=[];!1!==e.closeBracketsKeymap&&(n=n.concat(closeBracketsKeymap)),!1!==e.defaultKeymap&&(n=n.concat(defaultKeymap)),!1!==e.searchKeymap&&(n=n.concat(searchKeymap)),!1!==e.historyKeymap&&(n=n.concat(historyKeymap)),!1!==e.foldKeymap&&(n=n.concat(foldKeymap)),!1!==e.completionKeymap&&(n=n.concat(completionKeymap)),!1!==e.lintKeymap&&(n=n.concat(lintKeymap));var i=[];return!1!==e.lineNumbers&&i.push(lineNumbers()),!1!==e.highlightActiveLineGutter&&i.push(highlightActiveLineGutter()),!1!==e.highlightSpecialChars&&i.push(highlightSpecialChars()),!1!==e.history&&i.push(history()),!1!==e.foldGutter&&i.push(foldGutter()),!1!==e.drawSelection&&i.push(drawSelection()),!1!==e.dropCursor&&i.push(dropCursor()),!1!==e.allowMultipleSelections&&i.push(EditorState.allowMultipleSelections.of(!0)),!1!==e.indentOnInput&&i.push(indentOnInput()),!1!==e.syntaxHighlighting&&i.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),!1!==e.bracketMatching&&i.push(bracketMatching()),!1!==e.closeBrackets&&i.push(closeBrackets()),!1!==e.autocompletion&&i.push(autocompletion()),!1!==e.rectangularSelection&&i.push(rectangularSelection()),!1!==t&&i.push(crosshairCursor()),!1!==e.highlightActiveLine&&i.push(highlightActiveLine()),!1!==e.highlightSelectionMatches&&i.push(highlightSelectionMatches()),e.tabSize&&"number"==typeof e.tabSize&&i.push(indentUnit.of(" ".repeat(e.tabSize))),i.concat([keymap.of(n.flat())]).filter(Boolean)};const chalky="#e5c07b",coral="#e06c75",cyan="#56b6c2",invalid="#ffffff",ivory="#abb2bf",stone="#7d8799",malibu="#61afef",sage="#98c379",whiskey="#d19a66",violet="#c678dd",darkBackground="#21252b",highlightBackground="#2c313a",background="#282c34",tooltipBackground="#353a42",selection="#3E4451",cursor="#528bff",oneDarkTheme=EditorView.theme({"&":{color:ivory,backgroundColor:background},".cm-content":{caretColor:cursor},".cm-cursor, .cm-dropCursor":{borderLeftColor:cursor},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:selection},".cm-panels":{backgroundColor:darkBackground,color:ivory},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:background,color:stone,border:"none"},".cm-activeLineGutter":{backgroundColor:highlightBackground},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:tooltipBackground},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:tooltipBackground,borderBottomColor:tooltipBackground},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:highlightBackground,color:ivory}}},{dark:!0}),oneDarkHighlightStyle=HighlightStyle.define([{tag:tags$1.keyword,color:violet},{tag:[tags$1.name,tags$1.deleted,tags$1.character,tags$1.propertyName,tags$1.macroName],color:coral},{tag:[tags$1.function(tags$1.variableName),tags$1.labelName],color:malibu},{tag:[tags$1.color,tags$1.constant(tags$1.name),tags$1.standard(tags$1.name)],color:whiskey},{tag:[tags$1.definition(tags$1.name),tags$1.separator],color:ivory},{tag:[tags$1.typeName,tags$1.className,tags$1.number,tags$1.changed,tags$1.annotation,tags$1.modifier,tags$1.self,tags$1.namespace],color:chalky},{tag:[tags$1.operator,tags$1.operatorKeyword,tags$1.url,tags$1.escape,tags$1.regexp,tags$1.link,tags$1.special(tags$1.string)],color:cyan},{tag:[tags$1.meta,tags$1.comment],color:stone},{tag:tags$1.strong,fontWeight:"bold"},{tag:tags$1.emphasis,fontStyle:"italic"},{tag:tags$1.strikethrough,textDecoration:"line-through"},{tag:tags$1.link,color:stone,textDecoration:"underline"},{tag:tags$1.heading,fontWeight:"bold",color:coral},{tag:[tags$1.atom,tags$1.bool,tags$1.special(tags$1.variableName)],color:whiskey},{tag:[tags$1.processingInstruction,tags$1.string,tags$1.inserted],color:sage},{tag:tags$1.invalid,color:invalid}]),oneDark=[oneDarkTheme,syntaxHighlighting(oneDarkHighlightStyle)];var defaultLightThemeOption=EditorView.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),getDefaultExtensions=function(e){void 0===e&&(e={});var{indentWithTab:t=!0,editable:n=!0,readOnly:i=!1,theme:r="light",placeholder:s="",basicSetup:o=!0}=e,a=[];switch(t&&a.unshift(keymap.of([indentWithTab])),o&&("boolean"==typeof o?a.unshift(basicSetup()):a.unshift(basicSetup(o))),s&&a.unshift(placeholder(s)),r){case"light":a.push(defaultLightThemeOption);break;case"dark":a.push(oneDark);break;case"none":break;default:a.push(r)}return!1===n&&a.push(EditorView.editable.of(!1)),i&&a.push(EditorState.readOnly.of(!0)),[...a]},getStatistics=e=>({line:e.state.doc.lineAt(e.state.selection.main.from),lineCount:e.state.doc.lines,lineBreak:e.state.lineBreak,length:e.state.doc.length,readOnly:e.state.readOnly,tabSize:e.state.tabSize,selection:e.state.selection,selectionAsSingle:e.state.selection.asSingle().main,ranges:e.state.selection.ranges,selectionCode:e.state.sliceDoc(e.state.selection.main.from,e.state.selection.main.to),selections:e.state.selection.ranges.map((t=>e.state.sliceDoc(t.from,t.to))),selectedText:e.state.selection.ranges.some((e=>!e.empty))}),External=Annotation.define(),emptyExtensions=[];function useCodeMirror(e){var{value:t,selection:n,onChange:i,onStatistics:r,onCreateEditor:s,onUpdate:o,extensions:a=emptyExtensions,autoFocus:l,theme:c="light",height:h=null,minHeight:d=null,maxHeight:u=null,width:p=null,minWidth:f=null,maxWidth:m=null,placeholder:g="",editable:O=!0,readOnly:y=!1,indentWithTab:v=!0,basicSetup:b=!0,root:w,initialState:S}=e,[x,C]=React.useState(),[_,E]=React.useState(),[P,k]=React.useState(),T=EditorView.theme({"&":{height:h,minHeight:d,maxHeight:u,width:p,minWidth:f,maxWidth:m},"& .cm-scroller":{height:"100% !important"}}),A=[EditorView.updateListener.of((e=>{if(e.docChanged&&"function"==typeof i&&!e.transactions.some((e=>e.annotation(External)))){var t=e.state.doc.toString();i(t,e)}r&&r(getStatistics(e))})),T,...getDefaultExtensions({theme:c,editable:O,readOnly:y,placeholder:g,indentWithTab:v,basicSetup:b})];return o&&"function"==typeof o&&A.push(EditorView.updateListener.of(o)),A=A.concat(a),React.useEffect((()=>{if(x&&!P){var e={doc:t,selection:n,extensions:A},i=S?EditorState.fromJSON(S.json,e,S.fields):EditorState.create(e);if(k(i),!_){var r=new EditorView({state:i,parent:x,root:w});E(r),s&&s(r,i)}}return()=>{_&&(k(void 0),E(void 0))}}),[x,P]),React.useEffect((()=>C(e.container)),[e.container]),React.useEffect((()=>()=>{_&&(_.destroy(),E(void 0))}),[_]),React.useEffect((()=>{l&&_&&_.focus()}),[l,_]),React.useEffect((()=>{_&&_.dispatch({effects:StateEffect.reconfigure.of(A)})}),[c,a,h,d,u,p,f,m,g,O,y,v,b,i,o]),React.useEffect((()=>{if(void 0!==t){var e=_?_.state.doc.toString():"";_&&t!==e&&_.dispatch({changes:{from:0,to:e.length,insert:t||""},annotations:[External.of(!0)]})}}),[t,_]),{state:P,setState:k,view:_,setView:E,container:x,setContainer:C}}var _excluded$1=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],ReactCodeMirror=React.forwardRef(((e,t)=>{var{className:n,value:i="",selection:r,extensions:s=[],onChange:o,onStatistics:a,onCreateEditor:l,onUpdate:c,autoFocus:h,theme:d="light",height:u,minHeight:p,maxHeight:f,width:m,minWidth:g,maxWidth:O,basicSetup:y,placeholder:v,indentWithTab:b,editable:w,readOnly:S,root:x,initialState:C}=e,_=_objectWithoutPropertiesLoose$1(e,_excluded$1),E=React.useRef(null),{state:P,view:k,container:T}=useCodeMirror({container:E.current,root:x,value:i,autoFocus:h,theme:d,height:u,minHeight:p,maxHeight:f,width:m,minWidth:g,maxWidth:O,basicSetup:y,placeholder:v,indentWithTab:b,editable:w,readOnly:S,selection:r,onChange:o,onStatistics:a,onCreateEditor:l,onUpdate:c,extensions:s,initialState:C});if(React.useImperativeHandle(t,(()=>({editor:E.current,state:P,view:k})),[E,T,P,k]),"string"!=typeof i)throw new Error("value must be typeof string but got "+typeof i);var A="string"==typeof d?"cm-theme-"+d:"cm-theme";return jsxRuntime.jsx("div",_extends$1({ref:E,className:A+(n?" "+n:"")},_))})),Type;ReactCodeMirror.displayName="CodeMirror";class CompositeBlock{static create(e,t,n,i,r){return new CompositeBlock(e,t,n,i+(i<<8)+e+(t<<4)|0,r,[],[])}constructor(e,t,n,i,r,s,o){this.type=e,this.value=t,this.from=n,this.hash=i,this.end=r,this.children=s,this.positions=o,this.hashProp=[[NodeProp.contextHash,i]]}addChild(e,t){e.prop(NodeProp.contextHash)!=this.hash&&(e=new Tree(e.type,e.children,e.positions,e.length,this.hashProp)),this.children.push(e),this.positions.push(t)}toTree(e,t=this.end){let n=this.children.length-1;return n>=0&&(t=Math.max(t,this.positions[n]+this.children[n].length+this.from)),new Tree(e.types[this.type],this.children,this.positions,t-this.from).balance({makeTree:(e,t,n)=>new Tree(NodeType.none,e,t,n,this.hashProp)})}}!function(e){e[e.Document=1]="Document",e[e.CodeBlock=2]="CodeBlock",e[e.FencedCode=3]="FencedCode",e[e.Blockquote=4]="Blockquote",e[e.HorizontalRule=5]="HorizontalRule",e[e.BulletList=6]="BulletList",e[e.OrderedList=7]="OrderedList",e[e.ListItem=8]="ListItem",e[e.ATXHeading1=9]="ATXHeading1",e[e.ATXHeading2=10]="ATXHeading2",e[e.ATXHeading3=11]="ATXHeading3",e[e.ATXHeading4=12]="ATXHeading4",e[e.ATXHeading5=13]="ATXHeading5",e[e.ATXHeading6=14]="ATXHeading6",e[e.SetextHeading1=15]="SetextHeading1",e[e.SetextHeading2=16]="SetextHeading2",e[e.HTMLBlock=17]="HTMLBlock",e[e.LinkReference=18]="LinkReference",e[e.Paragraph=19]="Paragraph",e[e.CommentBlock=20]="CommentBlock",e[e.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",e[e.Escape=22]="Escape",e[e.Entity=23]="Entity",e[e.HardBreak=24]="HardBreak",e[e.Emphasis=25]="Emphasis",e[e.StrongEmphasis=26]="StrongEmphasis",e[e.Link=27]="Link",e[e.Image=28]="Image",e[e.InlineCode=29]="InlineCode",e[e.HTMLTag=30]="HTMLTag",e[e.Comment=31]="Comment",e[e.ProcessingInstruction=32]="ProcessingInstruction",e[e.Autolink=33]="Autolink",e[e.HeaderMark=34]="HeaderMark",e[e.QuoteMark=35]="QuoteMark",e[e.ListMark=36]="ListMark",e[e.LinkMark=37]="LinkMark",e[e.EmphasisMark=38]="EmphasisMark",e[e.CodeMark=39]="CodeMark",e[e.CodeText=40]="CodeText",e[e.CodeInfo=41]="CodeInfo",e[e.LinkTitle=42]="LinkTitle",e[e.LinkLabel=43]="LinkLabel",e[e.URL=44]="URL"}(Type||(Type={}));class LeafBlock{constructor(e,t){this.start=e,this.content=t,this.marks=[],this.parsers=[]}}class Line{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let e=this.skipSpace(this.basePos);this.indent=this.countIndent(e,this.pos,this.indent),this.pos=e,this.next=e==this.text.length?-1:this.text.charCodeAt(e)}skipSpace(e){return skipSpace(this.text,e)}reset(e){for(this.text=e,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(e){this.basePos=e,this.baseIndent=this.countIndent(e,this.pos,this.indent)}moveBaseColumn(e){this.baseIndent=e,this.basePos=this.findColumn(e)}addMarker(e){this.markers.push(e)}countIndent(e,t=0,n=0){for(let i=t;i<e;i++)n+=9==this.text.charCodeAt(i)?4-n%4:1;return n}findColumn(e){let t=0;for(let n=0;t<this.text.length&&n<e;t++)n+=9==this.text.charCodeAt(t)?4-n%4:1;return t}scrub(){if(!this.baseIndent)return this.text;let e="";for(let t=0;t<this.basePos;t++)e+=" ";return e+this.text.slice(this.basePos)}}function skipForList(e,t,n){if(n.pos==n.text.length||e!=t.block&&n.indent>=t.stack[n.depth+1].value+n.baseIndent)return!0;if(n.indent>=n.baseIndent+4)return!1;let i=(e.type==Type.OrderedList?isOrderedList:isBulletList)(n,t,!1);return i>0&&(e.type!=Type.BulletList||isHorizontalRule(n,t,!1)<0)&&n.text.charCodeAt(n.pos+i-1)==e.value}const DefaultSkipMarkup={[Type.Blockquote]:(e,t,n)=>62==n.next&&(n.markers.push(elt(Type.QuoteMark,t.lineStart+n.pos,t.lineStart+n.pos+1)),n.moveBase(n.pos+(space$2(n.text.charCodeAt(n.pos+1))?2:1)),e.end=t.lineStart+n.text.length,!0),[Type.ListItem]:(e,t,n)=>!(n.indent<n.baseIndent+e.value&&n.next>-1)&&(n.moveBaseColumn(n.baseIndent+e.value),!0),[Type.OrderedList]:skipForList,[Type.BulletList]:skipForList,[Type.Document]:()=>!0};function space$2(e){return 32==e||9==e||10==e||13==e}function skipSpace(e,t=0){for(;t<e.length&&space$2(e.charCodeAt(t));)t++;return t}function skipSpaceBack(e,t,n){for(;t>n&&space$2(e.charCodeAt(t-1));)t--;return t}function isFencedCode(e){if(96!=e.next&&126!=e.next)return-1;let t=e.pos+1;for(;t<e.text.length&&e.text.charCodeAt(t)==e.next;)t++;if(t<e.pos+3)return-1;if(96==e.next)for(let n=t;n<e.text.length;n++)if(96==e.text.charCodeAt(n))return-1;return t}function isBlockquote(e){return 62!=e.next?-1:32==e.text.charCodeAt(e.pos+1)?2:1}function isHorizontalRule(e,t,n){if(42!=e.next&&45!=e.next&&95!=e.next)return-1;let i=1;for(let t=e.pos+1;t<e.text.length;t++){let n=e.text.charCodeAt(t);if(n==e.next)i++;else if(!space$2(n))return-1}return n&&45==e.next&&isSetextUnderline(e)>-1&&e.depth==t.stack.length||i<3?-1:1}function inList(e,t){for(let n=e.stack.length-1;n>=0;n--)if(e.stack[n].type==t)return!0;return!1}function isBulletList(e,t,n){return 45!=e.next&&43!=e.next&&42!=e.next||e.pos!=e.text.length-1&&!space$2(e.text.charCodeAt(e.pos+1))||!(!n||inList(t,Type.BulletList)||e.skipSpace(e.pos+2)<e.text.length)?-1:1}function isOrderedList(e,t,n){let i=e.pos,r=e.next;for(;r>=48&&r<=57;){if(i++,i==e.text.length)return-1;r=e.text.charCodeAt(i)}return i==e.pos||i>e.pos+9||46!=r&&41!=r||i<e.text.length-1&&!space$2(e.text.charCodeAt(i+1))||n&&!inList(t,Type.OrderedList)&&(e.skipSpace(i+1)==e.text.length||i>e.pos+1||49!=e.next)?-1:i+1-e.pos}function isAtxHeading(e){if(35!=e.next)return-1;let t=e.pos+1;for(;t<e.text.length&&35==e.text.charCodeAt(t);)t++;if(t<e.text.length&&32!=e.text.charCodeAt(t))return-1;let n=t-e.pos;return n>6?-1:n}function isSetextUnderline(e){if(45!=e.next&&61!=e.next||e.indent>=e.baseIndent+4)return-1;let t=e.pos+1;for(;t<e.text.length&&e.text.charCodeAt(t)==e.next;)t++;let n=t;for(;t<e.text.length&&space$2(e.text.charCodeAt(t));)t++;return t==e.text.length?n:-1}const EmptyLine=/^[ \t]*$/,CommentEnd=/-->/,ProcessingEnd=/\?>/,HTMLBlockStyle=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,CommentEnd],[/^\s*<\?/,ProcessingEnd],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,EmptyLine],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,EmptyLine]];function isHTMLBlock(e,t,n){if(60!=e.next)return-1;let i=e.text.slice(e.pos);for(let e=0,t=HTMLBlockStyle.length-(n?1:0);e<t;e++)if(HTMLBlockStyle[e][0].test(i))return e;return-1}function getListIndent(e,t){let n=e.countIndent(t,e.pos,e.indent),i=e.countIndent(e.skipSpace(t),t,n);return i>=n+5?n+1:i}function addCodeText(e,t,n){let i=e.length-1;i>=0&&e[i].to==t&&e[i].type==Type.CodeText?e[i].to=n:e.push(elt(Type.CodeText,t,n))}const DefaultBlockParsers={LinkReference:void 0,IndentedCode(e,t){let n=t.baseIndent+4;if(t.indent<n)return!1;let i=t.findColumn(n),r=e.lineStart+i,s=e.lineStart+t.text.length,o=[],a=[];for(addCodeText(o,r,s);e.nextLine()&&t.depth>=e.stack.length;)if(t.pos==t.text.length){addCodeText(a,e.lineStart-1,e.lineStart);for(let e of t.markers)a.push(e)}else{if(t.indent<n)break;{if(a.length){for(let e of a)e.type==Type.CodeText?addCodeText(o,e.from,e.to):o.push(e);a=[]}addCodeText(o,e.lineStart-1,e.lineStart);for(let e of t.markers)o.push(e);s=e.lineStart+t.text.length;let n=e.lineStart+t.findColumn(t.baseIndent+4);n<s&&addCodeText(o,n,s)}}return a.length&&(a=a.filter((e=>e.type!=Type.CodeText)),a.length&&(t.markers=a.concat(t.markers))),e.addNode(e.buffer.writeElements(o,-r).finish(Type.CodeBlock,s-r),r),!0},FencedCode(e,t){let n=isFencedCode(t);if(n<0)return!1;let i=e.lineStart+t.pos,r=t.next,s=n-t.pos,o=t.skipSpace(n),a=skipSpaceBack(t.text,t.text.length,o),l=[elt(Type.CodeMark,i,i+s)];o<a&&l.push(elt(Type.CodeInfo,e.lineStart+o,e.lineStart+a));for(let n=!0;e.nextLine()&&t.depth>=e.stack.length;n=!1){let i=t.pos;if(t.indent-t.baseIndent<4)for(;i<t.text.length&&t.text.charCodeAt(i)==r;)i++;if(i-t.pos>=s&&t.skipSpace(i)==t.text.length){for(let e of t.markers)l.push(e);l.push(elt(Type.CodeMark,e.lineStart+t.pos,e.lineStart+i)),e.nextLine();break}{n||addCodeText(l,e.lineStart-1,e.lineStart);for(let e of t.markers)l.push(e);let i=e.lineStart+t.basePos,r=e.lineStart+t.text.length;i<r&&addCodeText(l,i,r)}}return e.addNode(e.buffer.writeElements(l,-i).finish(Type.FencedCode,e.prevLineEnd()-i),i),!0},Blockquote(e,t){let n=isBlockquote(t);return!(n<0)&&(e.startContext(Type.Blockquote,t.pos),e.addNode(Type.QuoteMark,e.lineStart+t.pos,e.lineStart+t.pos+1),t.moveBase(t.pos+n),null)},HorizontalRule(e,t){if(isHorizontalRule(t,e,!1)<0)return!1;let n=e.lineStart+t.pos;return e.nextLine(),e.addNode(Type.HorizontalRule,n),!0},BulletList(e,t){let n=isBulletList(t,e,!1);if(n<0)return!1;e.block.type!=Type.BulletList&&e.startContext(Type.BulletList,t.basePos,t.next);let i=getListIndent(t,t.pos+1);return e.startContext(Type.ListItem,t.basePos,i-t.baseIndent),e.addNode(Type.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n),t.moveBaseColumn(i),null},OrderedList(e,t){let n=isOrderedList(t,e,!1);if(n<0)return!1;e.block.type!=Type.OrderedList&&e.startContext(Type.OrderedList,t.basePos,t.text.charCodeAt(t.pos+n-1));let i=getListIndent(t,t.pos+n);return e.startContext(Type.ListItem,t.basePos,i-t.baseIndent),e.addNode(Type.ListMark,e.lineStart+t.pos,e.lineStart+t.pos+n),t.moveBaseColumn(i),null},ATXHeading(e,t){let n=isAtxHeading(t);if(n<0)return!1;let i=t.pos,r=e.lineStart+i,s=skipSpaceBack(t.text,t.text.length,i),o=s;for(;o>i&&t.text.charCodeAt(o-1)==t.next;)o--;o!=s&&o!=i&&space$2(t.text.charCodeAt(o-1))||(o=t.text.length);let a=e.buffer.write(Type.HeaderMark,0,n).writeElements(e.parser.parseInline(t.text.slice(i+n+1,o),r+n+1),-r);o<t.text.length&&a.write(Type.HeaderMark,o-i,s-i);let l=a.finish(Type.ATXHeading1-1+n,t.text.length-i);return e.nextLine(),e.addNode(l,r),!0},HTMLBlock(e,t){let n=isHTMLBlock(t,e,!1);if(n<0)return!1;let i=e.lineStart+t.pos,r=HTMLBlockStyle[n][1],s=[],o=r!=EmptyLine;for(;!r.test(t.text)&&e.nextLine();){if(t.depth<e.stack.length){o=!1;break}for(let e of t.markers)s.push(e)}o&&e.nextLine();let a=r==CommentEnd?Type.CommentBlock:r==ProcessingEnd?Type.ProcessingInstructionBlock:Type.HTMLBlock,l=e.prevLineEnd();return e.addNode(e.buffer.writeElements(s,-i).finish(a,l-i),i),!0},SetextHeading:void 0};class LinkReferenceParser{constructor(e){this.stage=0,this.elts=[],this.pos=0,this.start=e.start,this.advance(e.content)}nextLine(e,t,n){if(-1==this.stage)return!1;let i=n.content+"\n"+t.scrub(),r=this.advance(i);return r>-1&&r<i.length&&this.complete(e,n,r)}finish(e,t){return(2==this.stage||3==this.stage)&&skipSpace(t.content,this.pos)==t.content.length&&this.complete(e,t,t.content.length)}complete(e,t,n){return e.addLeafElement(t,elt(Type.LinkReference,this.start,this.start+n,this.elts)),!0}nextStage(e){return e?(this.pos=e.to-this.start,this.elts.push(e),this.stage++,!0):(!1===e&&(this.stage=-1),!1)}advance(e){for(;;){if(-1==this.stage)return-1;if(0==this.stage){if(!this.nextStage(parseLinkLabel(e,this.pos,this.start,!0)))return-1;if(58!=e.charCodeAt(this.pos))return this.stage=-1;this.elts.push(elt(Type.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else{if(1!=this.stage){if(2==this.stage){let t=skipSpace(e,this.pos),n=0;if(t>this.pos){let i=parseLinkTitle(e,t,this.start);if(i){let t=lineEnd(e,i.to-this.start);t>0&&(this.nextStage(i),n=t)}}return n||(n=lineEnd(e,this.pos)),n>0&&n<e.length?n:-1}return lineEnd(e,this.pos)}if(!this.nextStage(parseURL(e,skipSpace(e,this.pos),this.start)))return-1}}}}function lineEnd(e,t){for(;t<e.length;t++){let n=e.charCodeAt(t);if(10==n)break;if(!space$2(n))return-1}return t}class SetextHeadingParser{nextLine(e,t,n){let i=t.depth<e.stack.length?-1:isSetextUnderline(t),r=t.next;if(i<0)return!1;let s=elt(Type.HeaderMark,e.lineStart+t.pos,e.lineStart+i);return e.nextLine(),e.addLeafElement(n,elt(61==r?Type.SetextHeading1:Type.SetextHeading2,n.start,e.prevLineEnd(),[...e.parser.parseInline(n.content,n.start),s])),!0}finish(){return!1}}const DefaultLeafBlocks={LinkReference:(e,t)=>91==t.content.charCodeAt(0)?new LinkReferenceParser(t):null,SetextHeading:()=>new SetextHeadingParser},DefaultEndLeaf=[(e,t)=>isAtxHeading(t)>=0,(e,t)=>isFencedCode(t)>=0,(e,t)=>isBlockquote(t)>=0,(e,t)=>isBulletList(t,e,!0)>=0,(e,t)=>isOrderedList(t,e,!0)>=0,(e,t)=>isHorizontalRule(t,e,!0)>=0,(e,t)=>isHTMLBlock(t,e,!0)>=0],scanLineResult={text:"",end:0};class BlockContext{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.line=new Line,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=i[i.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=i[0].from,this.block=CompositeBlock.create(Type.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=n.length?new FragmentCursor$1(n,t):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:e}=this;for(;;){for(let t=0;;){let n=e.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;t<e.markers.length&&(!n||e.markers[t].from<n.end);){let n=e.markers[t++];this.addNode(n.type,n.from,n.to)}if(!n)break;this.finishContext()}if(e.pos<e.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(e.basePos))return null;e:for(;;){for(let t of this.parser.blockParsers)if(t){let n=t(this,e);if(0!=n){if(1==n)return null;e.forward();continue e}}break}let t=new LeafBlock(this.lineStart+e.pos,e.text.slice(e.pos));for(let e of this.parser.leafBlockParsers)if(e){let n=e(this,t);n&&t.parsers.push(n)}e:for(;this.nextLine()&&e.pos!=e.text.length;){if(e.indent<e.baseIndent+4)for(let n of this.parser.endLeafBlock)if(n(this,e,t))break e;for(let n of t.parsers)if(n.nextLine(this,e,t))return null;t.content+="\n"+e.scrub();for(let n of e.markers)t.marks.push(n)}return this.finishLeaf(t),null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}reuseFragment(e){if(!this.fragments.moveTo(this.absoluteLineStart+e,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let t=this.fragments.takeNodes(this);return!!t&&(this.absoluteLineStart+=t,this.lineStart=toRelative(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++,this.readLine()):(this.atEnd=!0,this.readLine()),!0)}get depth(){return this.stack.length}parentType(e=this.depth-1){return this.parser.nodeSet.types[this.stack[e].type]}nextLine(){return this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(e){let t=scanLineResult;if(t.end=e,e>=this.to)t.text="";else if(t.text=this.lineChunkAt(e),t.end+=t.text.length,this.ranges.length>1){let e=this.absoluteLineStart,n=this.rangeI;for(;this.ranges[n].to<t.end;){n++;let i=this.ranges[n].from,r=this.lineChunkAt(i);t.end=i+r.length,t.text=t.text.slice(0,this.ranges[n-1].to-e)+r,e=t.end-t.text.length}}return t}readLine(){let{line:e}=this,{text:t,end:n}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=n,e.reset(t);e.depth<this.stack.length;e.depth++){let t=this.stack[e.depth],n=this.parser.skipContextMarkup[t.type];if(!n)throw new Error("Unhandled block context "+Type[t.type]);if(!n(t,this,e))break;e.forward()}}lineChunkAt(e){let t,n=this.input.chunk(e);if(this.input.lineChunks)t="\n"==n?"":n;else{let e=n.indexOf("\n");t=e<0?n:n.slice(0,e)}return e+t.length>this.to?t.slice(0,this.to-e):t}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(e,t,n=0){this.block=CompositeBlock.create(e,n,this.lineStart+t,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(e,t,n=0){this.startContext(this.parser.getNodeType(e),t,n)}addNode(e,t,n){"number"==typeof e&&(e=new Tree(this.parser.nodeSet.types[e],none,none,(null!=n?n:this.prevLineEnd())-t)),this.block.addChild(e,t-this.block.from)}addElement(e){this.block.addChild(e.toTree(this.parser.nodeSet),e.from-this.block.from)}addLeafElement(e,t){this.addNode(this.buffer.writeElements(injectMarks(t.children,e.marks),-t.from).finish(t.type,t.to-t.from),t.from)}finishContext(){let e=this.stack.pop(),t=this.stack[this.stack.length-1];t.addChild(e.toTree(this.parser.nodeSet),e.from-t.from),this.block=t}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(e){return this.ranges.length>1?injectGaps(this.ranges,0,e.topNode,this.ranges[0].from,this.reusePlaceholders):e}finishLeaf(e){for(let t of e.parsers)if(t.finish(this,e))return;let t=injectMarks(this.parser.parseInline(e.content,e.start),e.marks);this.addNode(this.buffer.writeElements(t,-e.start).finish(Type.Paragraph,e.content.length),e.start)}elt(e,t,n,i){return"string"==typeof e?elt(this.parser.getNodeType(e),t,n,i):new TreeElement(e,t)}get buffer(){return new Buffer$1(this.parser.nodeSet)}}function injectGaps(e,t,n,i,r){let s=e[t].to,o=[],a=[],l=n.from+i;function c(n,r){for(;r?n>=s:n>s;){let r=e[t+1].from-s;i+=r,n+=r,t++,s=e[t].to}}for(let h=n.firstChild;h;h=h.nextSibling){c(h.from+i,!0);let n,d=h.from+i,u=r.get(h.tree);u?n=u:h.to+i>s?(n=injectGaps(e,t,h,i,r),c(h.to+i,!1)):n=h.toTree(),o.push(n),a.push(d-l)}return c(n.to+i,!1),new Tree(n.type,o,a,n.to+i-l,n.tree?n.tree.propValues:void 0)}class MarkdownParser extends Parser{constructor(e,t,n,i,r,s,o,a,l){super(),this.nodeSet=e,this.blockParsers=t,this.leafBlockParsers=n,this.blockNames=i,this.endLeafBlock=r,this.skipContextMarkup=s,this.inlineParsers=o,this.inlineNames=a,this.wrappers=l,this.nodeTypes=Object.create(null);for(let t of e.types)this.nodeTypes[t.name]=t.id}createParse(e,t,n){let i=new BlockContext(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}configure(e){let t=resolveConfig(e);if(!t)return this;let{nodeSet:n,skipContextMarkup:i}=this,r=this.blockParsers.slice(),s=this.leafBlockParsers.slice(),o=this.blockNames.slice(),a=this.inlineParsers.slice(),l=this.inlineNames.slice(),c=this.endLeafBlock.slice(),h=this.wrappers;if(nonEmpty(t.defineNodes)){i=Object.assign({},i);let e,r=n.types.slice();for(let n of t.defineNodes){let{name:t,block:s,composite:o,style:a}="string"==typeof n?{name:n}:n;if(r.some((e=>e.name==t)))continue;o&&(i[r.length]=(e,t,n)=>o(t,n,e.value));let l=r.length,c=o?["Block","BlockContext"]:s?l>=Type.ATXHeading1&&l<=Type.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;r.push(NodeType.define({id:l,name:t,props:c&&[[NodeProp.group,c]]})),a&&(e||(e={}),Array.isArray(a)||a instanceof Tag?e[t]=a:Object.assign(e,a))}n=new NodeSet(r),e&&(n=n.extend(styleTags(e)))}if(nonEmpty(t.props)&&(n=n.extend(...t.props)),nonEmpty(t.remove))for(let e of t.remove){let t=this.blockNames.indexOf(e),n=this.inlineNames.indexOf(e);t>-1&&(r[t]=s[t]=void 0),n>-1&&(a[n]=void 0)}if(nonEmpty(t.parseBlock))for(let e of t.parseBlock){let t=o.indexOf(e.name);if(t>-1)r[t]=e.parse,s[t]=e.leaf;else{let t=e.before?findName(o,e.before):e.after?findName(o,e.after)+1:o.length-1;r.splice(t,0,e.parse),s.splice(t,0,e.leaf),o.splice(t,0,e.name)}e.endLeaf&&c.push(e.endLeaf)}if(nonEmpty(t.parseInline))for(let e of t.parseInline){let t=l.indexOf(e.name);if(t>-1)a[t]=e.parse;else{let t=e.before?findName(l,e.before):e.after?findName(l,e.after)+1:l.length-1;a.splice(t,0,e.parse),l.splice(t,0,e.name)}}return t.wrap&&(h=h.concat(t.wrap)),new MarkdownParser(n,r,s,o,c,i,a,l,h)}getNodeType(e){let t=this.nodeTypes[e];if(null==t)throw new RangeError(`Unknown node type '${e}'`);return t}parseInline(e,t){let n=new InlineContext(this,e,t);e:for(let e=t;e<n.end;){let t=n.char(e);for(let i of this.inlineParsers)if(i){let r=i(n,t,e);if(r>=0){e=r;continue e}}e++}return n.resolveMarkers(0)}}function nonEmpty(e){return null!=e&&e.length>0}function resolveConfig(e){if(!Array.isArray(e))return e;if(0==e.length)return null;let t=resolveConfig(e[0]);if(1==e.length)return t;let n=resolveConfig(e.slice(1));if(!n||!t)return t||n;let i=(e,t)=>(e||none).concat(t||none),r=t.wrap,s=n.wrap;return{props:i(t.props,n.props),defineNodes:i(t.defineNodes,n.defineNodes),parseBlock:i(t.parseBlock,n.parseBlock),parseInline:i(t.parseInline,n.parseInline),remove:i(t.remove,n.remove),wrap:r?s?(e,t,n,i)=>r(s(e,t,n,i),t,n,i):r:s}}function findName(e,t){let n=e.indexOf(t);if(n<0)throw new RangeError(`Position specified relative to unknown parser ${t}`);return n}let nodeTypes=[NodeType.none];for(let e=1,t;t=Type[e];e++)nodeTypes[e]=NodeType.define({id:e,name:t,props:e>=Type.Escape?[]:[[NodeProp.group,e in DefaultSkipMarkup?["Block","BlockContext"]:["Block","LeafBlock"]]],top:"Document"==t});const none=[];let Buffer$1=class{constructor(e){this.nodeSet=e,this.content=[],this.nodes=[]}write(e,t,n,i=0){return this.content.push(e,t,n,4+4*i),this}writeElements(e,t=0){for(let n of e)n.writeTo(this,t);return this}finish(e,t){return Tree.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:e,length:t})}},Element$2=class{constructor(e,t,n,i=none){this.type=e,this.from=t,this.to=n,this.children=i}writeTo(e,t){let n=e.content.length;e.writeElements(this.children,t),e.content.push(this.type,this.from+t,this.to+t,e.content.length+4-n)}toTree(e){return new Buffer$1(e).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}};class TreeElement{constructor(e,t){this.tree=e,this.from=t}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return none}writeTo(e,t){e.nodes.push(this.tree),e.content.push(e.nodes.length-1,this.from+t,this.to+t,-1)}toTree(){return this.tree}}function elt(e,t,n,i){return new Element$2(e,t,n,i)}const EmphasisUnderscore={resolve:"Emphasis",mark:"EmphasisMark"},EmphasisAsterisk={resolve:"Emphasis",mark:"EmphasisMark"},LinkStart={},ImageStart={};class InlineDelimiter{constructor(e,t,n,i){this.type=e,this.from=t,this.to=n,this.side=i}}const Escapable="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~";let Punctuation=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{Punctuation=new RegExp("[\\p{Pc}|\\p{Pd}|\\p{Pe}|\\p{Pf}|\\p{Pi}|\\p{Po}|\\p{Ps}]","u")}catch(e){}const DefaultInline={Escape(e,t,n){if(92!=t||n==e.end-1)return-1;let i=e.char(n+1);for(let t=0;t<Escapable.length;t++)if(Escapable.charCodeAt(t)==i)return e.append(elt(Type.Escape,n,n+2));return-1},Entity(e,t,n){if(38!=t)return-1;let i=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(e.slice(n+1,n+31));return i?e.append(elt(Type.Entity,n,n+1+i[0].length)):-1},InlineCode(e,t,n){if(96!=t||n&&96==e.char(n-1))return-1;let i=n+1;for(;i<e.end&&96==e.char(i);)i++;let r=i-n,s=0;for(;i<e.end;i++)if(96==e.char(i)){if(s++,s==r&&96!=e.char(i+1))return e.append(elt(Type.InlineCode,n,i+1,[elt(Type.CodeMark,n,n+r),elt(Type.CodeMark,i+1-r,i+1)]))}else s=0;return-1},HTMLTag(e,t,n){if(60!=t||n==e.end-1)return-1;let i=e.slice(n+1,e.end),r=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(i);if(r)return e.append(elt(Type.Autolink,n,n+1+r[0].length,[elt(Type.LinkMark,n,n+1),elt(Type.URL,n+1,n+r[0].length),elt(Type.LinkMark,n+r[0].length,n+1+r[0].length)]));let s=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(i);if(s)return e.append(elt(Type.Comment,n,n+1+s[0].length));let o=/^\?[^]*?\?>/.exec(i);if(o)return e.append(elt(Type.ProcessingInstruction,n,n+1+o[0].length));let a=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(i);return a?e.append(elt(Type.HTMLTag,n,n+1+a[0].length)):-1},Emphasis(e,t,n){if(95!=t&&42!=t)return-1;let i=n+1;for(;e.char(i)==t;)i++;let r=e.slice(n-1,n),s=e.slice(i,i+1),o=Punctuation.test(r),a=Punctuation.test(s),l=/\s|^$/.test(r),c=/\s|^$/.test(s),h=!c&&(!a||l||o),d=!l&&(!o||c||a),u=h&&(42==t||!d||o),p=d&&(42==t||!h||a);return e.append(new InlineDelimiter(95==t?EmphasisUnderscore:EmphasisAsterisk,n,i,(u?1:0)|(p?2:0)))},HardBreak(e,t,n){if(92==t&&10==e.char(n+1))return e.append(elt(Type.HardBreak,n,n+2));if(32==t){let t=n+1;for(;32==e.char(t);)t++;if(10==e.char(t)&&t>=n+2)return e.append(elt(Type.HardBreak,n,t+1))}return-1},Link:(e,t,n)=>91==t?e.append(new InlineDelimiter(LinkStart,n,n+1,1)):-1,Image:(e,t,n)=>33==t&&91==e.char(n+1)?e.append(new InlineDelimiter(ImageStart,n,n+2,1)):-1,LinkEnd(e,t,n){if(93!=t)return-1;for(let t=e.parts.length-1;t>=0;t--){let i=e.parts[t];if(i instanceof InlineDelimiter&&(i.type==LinkStart||i.type==ImageStart)){if(!i.side||e.skipSpace(i.to)==n&&!/[(\[]/.test(e.slice(n+1,n+2)))return e.parts[t]=null,-1;let r=e.takeContent(t),s=e.parts[t]=finishLink(e,r,i.type==LinkStart?Type.Link:Type.Image,i.from,n+1);if(i.type==LinkStart)for(let n=0;n<t;n++){let t=e.parts[n];t instanceof InlineDelimiter&&t.type==LinkStart&&(t.side=0)}return s.to}}return-1}};function finishLink(e,t,n,i,r){let{text:s}=e,o=e.char(r),a=r;if(t.unshift(elt(Type.LinkMark,i,i+(n==Type.Image?2:1))),t.push(elt(Type.LinkMark,r-1,r)),40==o){let n,i=e.skipSpace(r+1),o=parseURL(s,i-e.offset,e.offset);o&&(i=e.skipSpace(o.to),i!=o.to&&(n=parseLinkTitle(s,i-e.offset,e.offset),n&&(i=e.skipSpace(n.to)))),41==e.char(i)&&(t.push(elt(Type.LinkMark,r,r+1)),a=i+1,o&&t.push(o),n&&t.push(n),t.push(elt(Type.LinkMark,i,a)))}else if(91==o){let n=parseLinkLabel(s,r-e.offset,e.offset,!1);n&&(t.push(n),a=n.to)}return elt(n,i,a,t)}function parseURL(e,t,n){if(60==e.charCodeAt(t)){for(let i=t+1;i<e.length;i++){let r=e.charCodeAt(i);if(62==r)return elt(Type.URL,t+n,i+1+n);if(60==r||10==r)return!1}return null}{let i=0,r=t;for(let t=!1;r<e.length;r++){let n=e.charCodeAt(r);if(space$2(n))break;if(t)t=!1;else if(40==n)i++;else if(41==n){if(!i)break;i--}else 92==n&&(t=!0)}return r>t?elt(Type.URL,t+n,r+n):r==e.length&&null}}function parseLinkTitle(e,t,n){let i=e.charCodeAt(t);if(39!=i&&34!=i&&40!=i)return!1;let r=40==i?41:i;for(let i=t+1,s=!1;i<e.length;i++){let o=e.charCodeAt(i);if(s)s=!1;else{if(o==r)return elt(Type.LinkTitle,t+n,i+1+n);92==o&&(s=!0)}}return null}function parseLinkLabel(e,t,n,i){for(let r=!1,s=t+1,o=Math.min(e.length,s+999);s<o;s++){let o=e.charCodeAt(s);if(r)r=!1;else{if(93==o)return!i&&elt(Type.LinkLabel,t+n,s+1+n);if(i&&!space$2(o)&&(i=!1),91==o)return!1;92==o&&(r=!0)}}return null}class InlineContext{constructor(e,t,n){this.parser=e,this.text=t,this.offset=n,this.parts=[]}char(e){return e>=this.end?-1:this.text.charCodeAt(e-this.offset)}get end(){return this.offset+this.text.length}slice(e,t){return this.text.slice(e-this.offset,t-this.offset)}append(e){return this.parts.push(e),e.to}addDelimiter(e,t,n,i,r){return this.append(new InlineDelimiter(e,t,n,(i?1:0)|(r?2:0)))}addElement(e){return this.append(e)}resolveMarkers(e){for(let t=e;t<this.parts.length;t++){let n=this.parts[t];if(!(n instanceof InlineDelimiter&&n.type.resolve&&2&n.side))continue;let i,r=n.type==EmphasisUnderscore||n.type==EmphasisAsterisk,s=n.to-n.from,o=t-1;for(;o>=e;o--){let e=this.parts[o];if(e instanceof InlineDelimiter&&1&e.side&&e.type==n.type&&!(r&&(1&n.side||2&e.side)&&(e.to-e.from+s)%3==0&&((e.to-e.from)%3||s%3))){i=e;break}}if(!i)continue;let a=n.type.resolve,l=[],c=i.from,h=n.to;if(r){let e=Math.min(2,i.to-i.from,s);c=i.to-e,h=n.from+e,a=1==e?"Emphasis":"StrongEmphasis"}i.type.mark&&l.push(this.elt(i.type.mark,c,i.to));for(let e=o+1;e<t;e++)this.parts[e]instanceof Element$2&&l.push(this.parts[e]),this.parts[e]=null;n.type.mark&&l.push(this.elt(n.type.mark,n.from,h));let d=this.elt(a,c,h,l);this.parts[o]=r&&i.from!=c?new InlineDelimiter(i.type,i.from,c,i.side):null,(this.parts[t]=r&&n.to!=h?new InlineDelimiter(n.type,h,n.to,n.side):null)?this.parts.splice(t,0,d):this.parts[t]=d}let t=[];for(let n=e;n<this.parts.length;n++){let e=this.parts[n];e instanceof Element$2&&t.push(e)}return t}findOpeningDelimiter(e){for(let t=this.parts.length-1;t>=0;t--){let n=this.parts[t];if(n instanceof InlineDelimiter&&n.type==e)return t}return null}takeContent(e){let t=this.resolveMarkers(e);return this.parts.length=e,t}skipSpace(e){return skipSpace(this.text,e-this.offset)+this.offset}elt(e,t,n,i){return"string"==typeof e?elt(this.parser.getNodeType(e),t,n,i):new TreeElement(e,t)}}function injectMarks(e,t){if(!t.length)return e;if(!e.length)return t;let n=e.slice(),i=0;for(let e of t){for(;i<n.length&&n[i].to<e.to;)i++;if(i<n.length&&n[i].from<e.from){let t=n[i];t instanceof Element$2&&(n[i]=new Element$2(t.type,t.from,t.to,injectMarks(t.children,[e])))}else n.splice(i++,0,e)}return n}const NotLast=[Type.CodeBlock,Type.ListItem,Type.OrderedList,Type.BulletList];let FragmentCursor$1=class{constructor(e,t){this.fragments=e,this.input=t,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,e.length&&(this.fragment=e[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(e,t){for(;this.fragment&&this.fragment.to<=e;)this.nextFragment();if(!this.fragment||this.fragment.from>(e?e-1:0))return!1;if(this.fragmentEnd<0){let e=this.fragment.to;for(;e>0&&"\n"!=this.input.read(e-1,e);)e--;this.fragmentEnd=e?e-1:0}let n=this.cursor;n||(n=this.cursor=this.fragment.tree.cursor(),n.firstChild());let i=e+this.fragment.offset;for(;n.to<=i;)if(!n.parent())return!1;for(;;){if(n.from>=i)return this.fragment.from<=t;if(!n.childAfter(i))return!1}}matches(e){let t=this.cursor.tree;return t&&t.prop(NodeProp.contextHash)==e}takeNodes(e){let t=this.cursor,n=this.fragment.offset,i=this.fragmentEnd-(this.fragment.openEnd?1:0),r=e.absoluteLineStart,s=r,o=e.block.children.length,a=s,l=o;for(;;){if(t.to-n>i){if(t.type.isAnonymous&&t.firstChild())continue;break}let r=toRelative(t.from-n,e.ranges);if(t.to-n<=e.ranges[e.rangeI].to)e.addNode(t.tree,r);else{let n=new Tree(e.parser.nodeSet.types[Type.Paragraph],[],[],0,e.block.hashProp);e.reusePlaceholders.set(n,t.tree),e.addNode(n,r)}if(t.type.is("Block")&&(NotLast.indexOf(t.type.id)<0?(s=t.to-n,o=e.block.children.length):(s=a,o=l,a=t.to-n,l=e.block.children.length)),!t.nextSibling())break}for(;e.block.children.length>o;)e.block.children.pop(),e.block.positions.pop();return s-r}};function toRelative(e,t){let n=e;for(let i=1;i<t.length;i++){let r=t[i-1].to,s=t[i].from;r<e&&(n-=s-r)}return n}const markdownHighlighting=styleTags({"Blockquote/...":tags$1.quote,HorizontalRule:tags$1.contentSeparator,"ATXHeading1/... SetextHeading1/...":tags$1.heading1,"ATXHeading2/... SetextHeading2/...":tags$1.heading2,"ATXHeading3/...":tags$1.heading3,"ATXHeading4/...":tags$1.heading4,"ATXHeading5/...":tags$1.heading5,"ATXHeading6/...":tags$1.heading6,"Comment CommentBlock":tags$1.comment,Escape:tags$1.escape,Entity:tags$1.character,"Emphasis/...":tags$1.emphasis,"StrongEmphasis/...":tags$1.strong,"Link/... Image/...":tags$1.link,"OrderedList/... BulletList/...":tags$1.list,"BlockQuote/...":tags$1.quote,"InlineCode CodeText":tags$1.monospace,"URL Autolink":tags$1.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":tags$1.processingInstruction,"CodeInfo LinkLabel":tags$1.labelName,LinkTitle:tags$1.string,Paragraph:tags$1.content}),parser$3=new MarkdownParser(new NodeSet(nodeTypes).extend(markdownHighlighting),Object.keys(DefaultBlockParsers).map((e=>DefaultBlockParsers[e])),Object.keys(DefaultBlockParsers).map((e=>DefaultLeafBlocks[e])),Object.keys(DefaultBlockParsers),DefaultEndLeaf,DefaultSkipMarkup,Object.keys(DefaultInline).map((e=>DefaultInline[e])),Object.keys(DefaultInline),[]);function leftOverSpace(e,t,n){let i=[];for(let r=e.firstChild,s=t;;r=r.nextSibling){let e=r?r.from:n;if(e>s&&i.push({from:s,to:e}),!r)break;s=r.to}return i}function parseCode(e){let{codeParser:t,htmlParser:n}=e,i=parseMixed(((e,i)=>{let r=e.type.id;if(!t||r!=Type.CodeBlock&&r!=Type.FencedCode){if(n&&(r==Type.HTMLBlock||r==Type.HTMLTag))return{parser:n,overlay:leftOverSpace(e.node,e.from,e.to)}}else{let n="";if(r==Type.FencedCode){let t=e.node.getChild(Type.CodeInfo);t&&(n=i.read(t.from,t.to))}let s=t(n);if(s)return{parser:s,overlay:e=>e.type.id==Type.CodeText}}return null}));return{wrap:i}}const StrikethroughDelim={resolve:"Strikethrough",mark:"StrikethroughMark"},Strikethrough={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":tags$1.strikethrough}},{name:"StrikethroughMark",style:tags$1.processingInstruction}],parseInline:[{name:"Strikethrough",parse(e,t,n){if(126!=t||126!=e.char(n+1)||126==e.char(n+2))return-1;let i=e.slice(n-1,n),r=e.slice(n+2,n+3),s=/\s|^$/.test(i),o=/\s|^$/.test(r),a=Punctuation.test(i),l=Punctuation.test(r);return e.addDelimiter(StrikethroughDelim,n,n+2,!o&&(!l||s||a),!s&&(!a||o||l))},after:"Emphasis"}]};function parseRow(e,t,n=0,i,r=0){let s=0,o=!0,a=-1,l=-1,c=!1,h=()=>{i.push(e.elt("TableCell",r+a,r+l,e.parser.parseInline(t.slice(a,l),r+a)))};for(let d=n;d<t.length;d++){let n=t.charCodeAt(d);124!=n||c?(c||32!=n&&9!=n)&&(a<0&&(a=d),l=d+1):((!o||a>-1)&&s++,o=!1,i&&(a>-1&&h(),i.push(e.elt("TableDelimiter",d+r,d+r+1))),a=l=-1),c=!c&&92==n}return a>-1&&(s++,i&&h()),s}function hasPipe(e,t){for(let n=t;n<e.length;n++){let t=e.charCodeAt(n);if(124==t)return!0;92==t&&n++}return!1}const delimiterLine=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class TableParser{constructor(){this.rows=null}nextLine(e,t,n){if(null==this.rows){let i;if(this.rows=!1,(45==t.next||58==t.next||124==t.next)&&delimiterLine.test(i=t.text.slice(t.pos))){let r=[];parseRow(e,n.content,0,r,n.start)==parseRow(e,i,t.pos)&&(this.rows=[e.elt("TableHeader",n.start,n.start+n.content.length,r),e.elt("TableDelimiter",e.lineStart+t.pos,e.lineStart+t.text.length)])}}else if(this.rows){let n=[];parseRow(e,t.text,t.pos,n,e.lineStart),this.rows.push(e.elt("TableRow",e.lineStart+t.pos,e.lineStart+t.text.length,n))}return!1}finish(e,t){return!!this.rows&&(e.addLeafElement(t,e.elt("Table",t.start,t.start+t.content.length,this.rows)),!0)}}const Table={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":tags$1.heading}},"TableRow",{name:"TableCell",style:tags$1.content},{name:"TableDelimiter",style:tags$1.processingInstruction}],parseBlock:[{name:"Table",leaf:(e,t)=>hasPipe(t.content,0)?new TableParser:null,endLeaf(e,t,n){if(n.parsers.some((e=>e instanceof TableParser))||!hasPipe(t.text,t.basePos))return!1;let i=e.scanLine(e.absoluteLineEnd+1).text;return delimiterLine.test(i)&&parseRow(e,t.text,t.basePos)==parseRow(e,i,t.basePos)},before:"SetextHeading"}]};class TaskParser{nextLine(){return!1}finish(e,t){return e.addLeafElement(t,e.elt("Task",t.start,t.start+t.content.length,[e.elt("TaskMarker",t.start,t.start+3),...e.parser.parseInline(t.content.slice(3),t.start+3)])),!0}}const TaskList={defineNodes:[{name:"Task",block:!0,style:tags$1.list},{name:"TaskMarker",style:tags$1.atom}],parseBlock:[{name:"TaskList",leaf:(e,t)=>/^\[[ xX]\][ \t]/.test(t.content)&&"ListItem"==e.parentType().name?new TaskParser:null,after:"SetextHeading"}]},autolinkRE=/(www\.)|(https?:\/\/)|([\w.+-]+@)|(mailto:|xmpp:)/gy,urlRE=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,lastTwoDomainWords=/[\w-]+\.[\w-]+($|\/)/,emailRE=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,xmppResourceRE=/\/[a-zA-Z\d@.]+/gy;function count(e,t,n,i){let r=0;for(let s=t;s<n;s++)e[s]==i&&r++;return r}function autolinkURLEnd(e,t){urlRE.lastIndex=t;let n=urlRE.exec(e);if(!n||lastTwoDomainWords.exec(n[0])[0].indexOf("_")>-1)return-1;let i=t+n[0].length;for(;;){let n,r=e[i-1];if(/[?!.,:*_~]/.test(r)||")"==r&&count(e,t,i,")")>count(e,t,i,"("))i--;else{if(";"!=r||!(n=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(e.slice(t,i))))break;i=t+n.index}}return i}function autolinkEmailEnd(e,t){emailRE.lastIndex=t;let n=emailRE.exec(e);if(!n)return-1;let i=n[0][n[0].length-1];return"_"==i||"-"==i?-1:t+n[0].length-("."==i?1:0)}const Autolink={parseInline:[{name:"Autolink",parse(e,t,n){let i=n-e.offset;autolinkRE.lastIndex=i;let r=autolinkRE.exec(e.text),s=-1;return r?(r[1]||r[2]?s=autolinkURLEnd(e.text,i+r[0].length):r[3]?s=autolinkEmailEnd(e.text,i):(s=autolinkEmailEnd(e.text,i+r[0].length),s>-1&&"xmpp:"==r[0]&&(xmppResourceRE.lastIndex=s,r=xmppResourceRE.exec(e.text),r&&(s=r.index+r[0].length))),s<0?-1:(e.addElement(e.elt("URL",n,s+e.offset)),s+e.offset)):-1}}]},GFM=[Table,TaskList,Strikethrough,Autolink];function parseSubSuper(e,t,n){return(i,r,s)=>{if(r!=e||i.char(s+1)==e)return-1;let o=[i.elt(n,s,s+1)];for(let r=s+1;r<i.end;r++){let a=i.char(r);if(a==e)return i.addElement(i.elt(t,s,r+1,o.concat(i.elt(n,r,r+1))));if(92==a&&o.push(i.elt("Escape",r,2+r++)),space$2(a))break}return-1}}const Superscript={defineNodes:[{name:"Superscript",style:tags$1.special(tags$1.content)},{name:"SuperscriptMark",style:tags$1.processingInstruction}],parseInline:[{name:"Superscript",parse:parseSubSuper(94,"Superscript","SuperscriptMark")}]},Subscript={defineNodes:[{name:"Subscript",style:tags$1.special(tags$1.content)},{name:"SubscriptMark",style:tags$1.processingInstruction}],parseInline:[{name:"Subscript",parse:parseSubSuper(126,"Subscript","SubscriptMark")}]},Emoji={defineNodes:[{name:"Emoji",style:tags$1.character}],parseInline:[{name:"Emoji",parse(e,t,n){let i;return 58==t&&(i=/^[a-zA-Z_0-9]+:/.exec(e.slice(n+1,e.end)))?e.addElement(e.elt("Emoji",n,n+1+i[0].length)):-1}}]};class Stack{constructor(e,t,n,i,r,s,o,a,l,c=0,h){this.p=e,this.stack=t,this.state=n,this.reducePos=i,this.pos=r,this.score=s,this.buffer=o,this.bufferBase=a,this.curContext=l,this.lookAhead=c,this.parent=h}toString(){return`[${this.stack.filter(((e,t)=>t%3==0)).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,n=0){let i=e.parser.context;return new Stack(e,[],t,n,n,0,[],0,i?new StackContext(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let n=e>>19,i=65535&e,{parser:r}=this.p,s=r.dynamicPrecedence(i);if(s&&(this.score+=s),0==n)return this.pushState(r.getGoto(this.state,i,!0),this.reducePos),i<r.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,4,!0),void this.reduceContext(i,this.reducePos);let o=this.stack.length-3*(n-1)-(262144&e?6:0),a=o?this.stack[o-2]:this.p.ranges[0].from,l=this.reducePos-a;l>=2e3&&!(null===(t=this.p.parser.nodeSet.types[i])||void 0===t?void 0:t.isAnonymous)&&(a==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=l):this.p.lastBigReductionSize<l&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=a,this.p.lastBigReductionSize=l));let c=o?this.stack[o-1]:0,h=this.bufferBase+this.buffer.length-c;if(i<r.minRepeatTerm||131072&e){let e=r.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,a,e,h+4,!0)}if(262144&e)this.state=this.stack[o];else{let e=this.stack[o-3];this.state=r.getGoto(e,i,!0)}for(;this.stack.length>o;)this.stack.pop();this.reduceContext(i,a)}storeNode(e,t,n,i=4,r=!1){if(0==e&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let e=this,i=this.buffer.length;if(0==i&&e.parent&&(i=e.bufferBase-e.parent.bufferBase,e=e.parent),i>0&&0==e.buffer[i-4]&&e.buffer[i-1]>-1){if(t==n)return;if(e.buffer[i-2]>=t)return void(e.buffer[i-2]=n)}}if(r&&this.pos!=n){let r=this.buffer.length;if(r>0&&0!=this.buffer[r-4])for(;r>0&&this.buffer[r-2]>n;)this.buffer[r]=this.buffer[r-4],this.buffer[r+1]=this.buffer[r-3],this.buffer[r+2]=this.buffer[r-2],this.buffer[r+3]=this.buffer[r-1],r-=4,i>4&&(i-=4);this.buffer[r]=e,this.buffer[r+1]=t,this.buffer[r+2]=n,this.buffer[r+3]=i}else this.buffer.push(e,t,n,i)}shift(e,t,n,i){if(131072&e)this.pushState(65535&e,this.pos);else if(0==(262144&e)){let r=e,{parser:s}=this.p;(i>this.pos||t<=s.maxNode)&&(this.pos=i,s.stateFlag(r,1)||(this.reducePos=i)),this.pushState(r,n),this.shiftContext(t,n),t<=s.maxNode&&this.buffer.push(t,n,i,4)}else this.pos=i,this.shiftContext(t,n),t<=this.p.parser.maxNode&&this.buffer.push(t,n,i,4)}apply(e,t,n,i){65536&e?this.reduce(e):this.shift(e,t,n,i)}useNode(e,t){let n=this.p.reused.length-1;(n<0||this.p.reused[n]!=e)&&(this.p.reused.push(e),n++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(n,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let n=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new Stack(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,n,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let n=e<=this.p.parser.maxNode;n&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,n?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new SimulatedStack(this);;){let n=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(0==n)return!1;if(0==(65536&n))return!0;t.reduce(n)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let n=[];for(let i,r=0;r<t.length;r+=2)(i=t[r+1])!=this.state&&this.p.parser.hasAction(i,e)&&n.push(t[r],i);if(this.stack.length<120)for(let e=0;n.length<8&&e<t.length;e+=2){let i=t[e+1];n.some(((e,t)=>1&t&&e==i))||n.push(t[e],i)}t=n}let n=[];for(let e=0;e<t.length&&n.length<4;e+=2){let i=t[e+1];if(i==this.state)continue;let r=this.split();r.pushState(i,this.pos),r.storeNode(0,r.pos,r.pos,4,!0),r.shiftContext(t[e],this.pos),r.reducePos=this.pos,r.score-=200,n.push(r)}return n}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(0==(65536&t))return!1;if(!e.validAction(this.state,t)){let n=t>>19,i=65535&t,r=this.stack.length-3*n;if(r<0||e.getGoto(this.stack[r],i,!1)<0){let e=this.findForcedReduction();if(null==e)return!1;t=e}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],n=(i,r)=>{if(!t.includes(i))return t.push(i),e.allActions(i,(t=>{if(393216&t);else if(65536&t){let n=(t>>19)-r;if(n>1){let i=65535&t,r=this.stack.length-3*n;if(r>=0&&e.getGoto(this.stack[r],i,!1)>=0)return n<<19|65536|i}}else{let e=n(t,r+1);if(null!=e)return e}}))};return n(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(3!=this.stack.length)return!1;let{parser:e}=this.p;return 65535==e.data[e.stateSlot(this.state,1)]&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||-3!=this.buffer[e])&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||-4!=this.buffer[e])&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new StackContext(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class StackContext{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class SimulatedStack{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=65535&e,n=e>>19;0==n?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=3*(n-1);let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}}class StackBufferCursor{constructor(e,t,n){this.stack=e,this.pos=t,this.index=n,this.buffer=e.buffer,0==this.index&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new StackBufferCursor(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;null!=e&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()}fork(){return new StackBufferCursor(this.stack,this.pos,this.index)}}function decodeArray(e,t=Uint16Array){if("string"!=typeof e)return e;let n=null;for(let i=0,r=0;i<e.length;){let s=0;for(;;){let t=e.charCodeAt(i++),n=!1;if(126==t){s=65535;break}t>=92&&t--,t>=34&&t--;let r=t-32;if(r>=46&&(r-=46,n=!0),s+=r,n)break;s*=46}n?n[r++]=s:n=new t(s)}return n}class CachedToken{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const nullToken=new CachedToken;class InputStream{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=nullToken,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let n=this.range,i=this.rangeIndex,r=this.pos+e;for(;r<n.from;){if(!i)return null;let e=this.ranges[--i];r-=n.from-e.to,n=e}for(;t<0?r>n.to:r>=n.to;){if(i==this.ranges.length-1)return null;let e=this.ranges[++i];r+=e.from-n.to,n=e}return r}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t,n,i=this.chunkOff+e;if(i>=0&&i<this.chunk.length)t=this.pos+e,n=this.chunk.charCodeAt(i);else{let i=this.resolveOffset(e,1);if(null==i)return-1;if(t=i,t>=this.chunk2Pos&&t<this.chunk2Pos+this.chunk2.length)n=this.chunk2.charCodeAt(t-this.chunk2Pos);else{let e=this.rangeIndex,i=this.range;for(;i.to<=t;)i=this.ranges[++e];this.chunk2=this.input.chunk(this.chunk2Pos=t),t+this.chunk2.length>i.to&&(this.chunk2=this.chunk2.slice(0,i.to-t)),n=this.chunk2.charCodeAt(0)}}return t>=this.token.lookAhead&&(this.token.lookAhead=t+1),n}acceptToken(e,t=0){let n=t?this.resolveOffset(t,-1):this.pos;if(null==n||n<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=n}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=nullToken,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let n="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(n+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return n}}class TokenGroup{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:n}=t.p;readToken(this.data,e,t,this.id,n.data,n.tokenPrecTable)}}TokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class LocalTokenGroup{constructor(e,t,n){this.precTable=t,this.elseToken=n,this.data="string"==typeof e?decodeArray(e):e}token(e,t){let n=e.pos,i=0;for(;;){let n=e.next<0,r=e.resolveOffset(1,1);if(readToken(this.data,e,t,0,this.data,this.precTable),e.token.value>-1)break;if(null==this.elseToken)return;if(n||i++,null==r)break;e.reset(r,e.token)}i&&(e.reset(n,e.token),e.acceptToken(this.elseToken,i))}}LocalTokenGroup.prototype.contextual=TokenGroup.prototype.fallback=TokenGroup.prototype.extend=!1;class ExternalTokenizer{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function readToken(e,t,n,i,r,s){let o=0,a=1<<i,{dialect:l}=n.p.parser;e:for(;0!=(a&e[o]);){let n=e[o+1];for(let i=o+3;i<n;i+=2)if((e[i+1]&a)>0){let n=e[i];if(l.allows(n)&&(-1==t.token.value||t.token.value==n||overrides(n,t.token.value,r,s))){t.acceptToken(n);break}}let i=t.next,c=0,h=e[o+2];if(!(t.next<0&&h>c&&65535==e[n+3*h-3])){for(;c<h;){let r=c+h>>1,s=n+r+(r<<1),a=e[s],l=e[s+1]||65536;if(i<a)h=r;else{if(!(i>=l)){o=e[s+2],t.advance();continue e}c=r+1}}break}o=e[n+3*h-1]}}function findOffset(e,t,n){for(let i,r=t;65535!=(i=e[r]);r++)if(i==n)return r-t;return-1}function overrides(e,t,n,i){let r=findOffset(n,i,t);return r<0||findOffset(n,i,e)<r}const verbose="undefined"!=typeof process&&process.env&&/\bparse\b/.test(process.env.LOG);let stackIDs=null;function cutAt(e,t,n){let i=e.cursor(IterMode.IncludeAnonymous);for(i.moveTo(t);;)if(!(n<0?i.childBefore(t):i.childAfter(t)))for(;;){if((n<0?i.to<t:i.from>t)&&!i.type.isError)return n<0?Math.max(0,Math.min(i.to-1,t-25)):Math.min(e.length,Math.max(i.from+1,t+25));if(n<0?i.prevSibling():i.nextSibling())break;if(!i.parent())return n<0?0:e.length}}class FragmentCursor{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?cutAt(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?cutAt(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let n=this.trees[t],i=this.index[t];if(i==n.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let r=n.children[i],s=this.start[t]+n.positions[i];if(s>e)return this.nextStart=s,null;if(r instanceof Tree){if(s==e){if(s<this.safeFrom)return null;let e=s+r.length;if(e<=this.safeTo){let t=r.prop(NodeProp.lookAhead);if(!t||e+t<this.fragment.to)return r}}this.index[t]++,s+r.length>=Math.max(this.safeFrom,e)&&(this.trees.push(r),this.start.push(s),this.index.push(0))}else this.index[t]++,this.nextStart=s+r.length}}}class TokenCache{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map((e=>new CachedToken))}getActions(e){let t=0,n=null,{parser:i}=e.p,{tokenizers:r}=i,s=i.stateSlot(e.state,3),o=e.curContext?e.curContext.hash:0,a=0;for(let i=0;i<r.length;i++){if(0==(1<<i&s))continue;let l=r[i],c=this.tokens[i];if((!n||l.fallback)&&((l.contextual||c.start!=e.pos||c.mask!=s||c.context!=o)&&(this.updateCachedToken(c,l,e),c.mask=s,c.context=o),c.lookAhead>c.end+25&&(a=Math.max(c.lookAhead,a)),0!=c.value)){let i=t;if(c.extended>-1&&(t=this.addActions(e,c.extended,c.end,t)),t=this.addActions(e,c.value,c.end,t),!l.extend&&(n=c,t>i))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),n||e.pos!=this.stream.end||(n=new CachedToken,n.value=e.p.parser.eofTerm,n.start=n.end=e.pos,t=this.addActions(e,n.value,n.end,t)),this.mainToken=n,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new CachedToken,{pos:n,p:i}=e;return t.start=n,t.end=Math.min(n+1,i.stream.end),t.value=n==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,n){let i=this.stream.clipPos(n.pos);if(t.token(this.stream.reset(i,e),n),e.value>-1){let{parser:t}=n.p;for(let i=0;i<t.specialized.length;i++)if(t.specialized[i]==e.value){let r=t.specializers[i](this.stream.read(e.start,e.end),n);if(r>=0&&n.p.parser.dialect.allows(r>>1)){0==(1&r)?e.value=r>>1:e.extended=r>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,n,i){for(let t=0;t<i;t+=3)if(this.actions[t]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=n,i}addActions(e,t,n,i){let{state:r}=e,{parser:s}=e.p,{data:o}=s;for(let e=0;e<2;e++)for(let a=s.stateSlot(r,e?2:1);;a+=3){if(65535==o[a]){if(1!=o[a+1]){0==i&&2==o[a+1]&&(i=this.putAction(pair(o,a+2),t,n,i));break}a=pair(o,a+2)}o[a]==t&&(i=this.putAction(pair(o,a+1),t,n,i))}return i}}class Parse{constructor(e,t,n,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new InputStream(t,i),this.tokens=new TokenCache(e,this.stream),this.topTerm=e.top[1];let{from:r}=i[0];this.stacks=[Stack.start(this,e.top[0],r)],this.fragments=n.length&&this.stream.end-r>4*e.bufferLength?new FragmentCursor(n,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e,t,n=this.stacks,i=this.minStackPos,r=this.stacks=[];if(this.bigReductionCount>300&&1==n.length){let[e]=n;for(;e.forceReduce()&&e.stack.length&&e.stack[e.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let s=0;s<n.length;s++){let o=n[s];for(;;){if(this.tokens.mainToken=null,o.pos>i)r.push(o);else{if(this.advanceStack(o,r,n))continue;{e||(e=[],t=[]),e.push(o);let n=this.tokens.getMainToken(o);t.push(n.value,n.end)}}break}}if(!r.length){let t=e&&findFinished(e);if(t)return verbose&&console.log("Finish with "+this.stackID(t)),this.stackToTree(t);if(this.parser.strict)throw verbose&&e&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+i);this.recovering||(this.recovering=5)}if(this.recovering&&e){let n=null!=this.stoppedAt&&e[0].pos>this.stoppedAt?e[0]:this.runRecovery(e,t,r);if(n)return verbose&&console.log("Force-finish "+this.stackID(n)),this.stackToTree(n.forceAll())}if(this.recovering){let e=1==this.recovering?1:3*this.recovering;if(r.length>e)for(r.sort(((e,t)=>t.score-e.score));r.length>e;)r.pop();r.some((e=>e.reducePos>i))&&this.recovering--}else if(r.length>1){e:for(let e=0;e<r.length-1;e++){let t=r[e];for(let n=e+1;n<r.length;n++){let i=r[n];if(t.sameState(i)||t.buffer.length>500&&i.buffer.length>500){if(!((t.score-i.score||t.buffer.length-i.buffer.length)>0)){r.splice(e--,1);continue e}r.splice(n--,1)}}}r.length>12&&r.splice(12,r.length-12)}this.minStackPos=r[0].pos;for(let e=1;e<r.length;e++)r[e].pos<this.minStackPos&&(this.minStackPos=r[e].pos);return null}stopAt(e){if(null!=this.stoppedAt&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,n){let i=e.pos,{parser:r}=this,s=verbose?this.stackID(e)+" -> ":"";if(null!=this.stoppedAt&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let t=e.curContext&&e.curContext.tracker.strict,n=t?e.curContext.hash:0;for(let o=this.fragments.nodeAt(i);o;){let i=this.parser.nodeSet.types[o.type.id]==o.type?r.getGoto(e.state,o.type.id):-1;if(i>-1&&o.length&&(!t||(o.prop(NodeProp.contextHash)||0)==n))return e.useNode(o,i),verbose&&console.log(s+this.stackID(e)+` (via reuse of ${r.getName(o.type.id)})`),!0;if(!(o instanceof Tree)||0==o.children.length||o.positions[0]>0)break;let a=o.children[0];if(!(a instanceof Tree&&0==o.positions[0]))break;o=a}}let o=r.stateSlot(e.state,4);if(o>0)return e.reduce(o),verbose&&console.log(s+this.stackID(e)+` (via always-reduce ${r.getName(65535&o)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let o=0;o<a.length;){let l=a[o++],c=a[o++],h=a[o++],d=o==a.length||!n,u=d?e:e.split(),p=this.tokens.mainToken;if(u.apply(l,c,p?p.start:u.pos,h),verbose&&console.log(s+this.stackID(u)+` (via ${0==(65536&l)?"shift":`reduce of ${r.getName(65535&l)}`} for ${r.getName(c)} @ ${i}${u==e?"":", split"})`),d)return!0;u.pos>i?t.push(u):n.push(u)}return!1}advanceFully(e,t){let n=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>n)return pushStackDedup(e,t),!0}}runRecovery(e,t,n){let i=null,r=!1;for(let s=0;s<e.length;s++){let o=e[s],a=t[s<<1],l=t[1+(s<<1)],c=verbose?this.stackID(o)+" -> ":"";if(o.deadEnd){if(r)continue;if(r=!0,o.restart(),verbose&&console.log(c+this.stackID(o)+" (restarted)"),this.advanceFully(o,n))continue}let h=o.split(),d=c;for(let e=0;h.forceReduce()&&e<10;e++){if(verbose&&console.log(d+this.stackID(h)+" (via force-reduce)"),this.advanceFully(h,n))break;verbose&&(d=this.stackID(h)+" -> ")}for(let e of o.recoverByInsert(a))verbose&&console.log(c+this.stackID(e)+" (via recover-insert)"),this.advanceFully(e,n);this.stream.end>o.pos?(l==o.pos&&(l++,a=0),o.recoverByDelete(a,l),verbose&&console.log(c+this.stackID(o)+` (via recover-delete ${this.parser.getName(a)})`),pushStackDedup(o,n)):(!i||i.score<o.score)&&(i=o)}return i}stackToTree(e){return e.close(),Tree.build({buffer:StackBufferCursor.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(stackIDs||(stackIDs=new WeakMap)).get(e);return t||stackIDs.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function pushStackDedup(e,t){for(let n=0;n<t.length;n++){let i=t[n];if(i.pos==e.pos&&i.sameState(e))return void(t[n].score<e.score&&(t[n]=e))}t.push(e)}class Dialect{constructor(e,t,n){this.source=e,this.flags=t,this.disabled=n}allows(e){return!this.disabled||0==this.disabled[e]}}const id=e=>e;class ContextTracker{constructor(e){this.start=e.start,this.shift=e.shift||id,this.reduce=e.reduce||id,this.reuse=e.reuse||id,this.hash=e.hash||(()=>0),this.strict=!1!==e.strict}}class LRParser extends Parser{constructor(e){if(super(),this.wrappers=[],14!=e.version)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let n=0;n<e.repeatNodeCount;n++)t.push("");let n=Object.keys(e.topRules).map((t=>e.topRules[t][1])),i=[];for(let e=0;e<t.length;e++)i.push([]);function r(e,t,n){i[e].push([t,t.deserialize(String(n))])}if(e.nodeProps)for(let t of e.nodeProps){let e=t[0];"string"==typeof e&&(e=NodeProp[e]);for(let n=1;n<t.length;){let i=t[n++];if(i>=0)r(i,e,t[n++]);else{let s=t[n+-i];for(let o=-i;o>0;o--)r(t[n++],e,s);n++}}}this.nodeSet=new NodeSet(t.map(((t,r)=>NodeType.define({name:r>=this.minRepeatTerm?void 0:t,id:r,props:i[r],top:n.indexOf(r)>-1,error:0==r,skipped:e.skippedNodes&&e.skippedNodes.indexOf(r)>-1})))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=DefaultBufferLength;let s=decodeArray(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let e=0;e<this.specializerSpecs.length;e++)this.specialized[e]=this.specializerSpecs[e].term;this.specializers=this.specializerSpecs.map(getSpecializer),this.states=decodeArray(e.states,Uint32Array),this.data=decodeArray(e.stateData),this.goto=decodeArray(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map((e=>"number"==typeof e?new TokenGroup(s,e):e)),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,n){let i=new Parse(this,e,t,n);for(let r of this.wrappers)i=r(i,e,t,n);return i}getGoto(e,t,n=!1){let i=this.goto;if(t>=i[0])return-1;for(let r=i[t+1];;){let t=i[r++],s=1&t,o=i[r++];if(s&&n)return o;for(let n=r+(t>>1);r<n;r++)if(i[r]==e)return o;if(s)return-1}}hasAction(e,t){let n=this.data;for(let i=0;i<2;i++)for(let r,s=this.stateSlot(e,i?2:1);;s+=3){if(65535==(r=n[s])){if(1!=n[s+1]){if(2==n[s+1])return pair(n,s+2);break}r=n[s=pair(n,s+2)]}if(r==t||0==r)return pair(n,s+1)}return 0}stateSlot(e,t){return this.states[6*e+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,(e=>e==t||null))}allActions(e,t){let n=this.stateSlot(e,4),i=n?t(n):void 0;for(let n=this.stateSlot(e,1);null==i;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=pair(this.data,n+2)}i=t(pair(this.data,n+1))}return i}nextStates(e){let t=[];for(let n=this.stateSlot(e,1);;n+=3){if(65535==this.data[n]){if(1!=this.data[n+1])break;n=pair(this.data,n+2)}if(0==(1&this.data[n+2])){let e=this.data[n+1];t.some(((t,n)=>1&n&&t==e))||t.push(this.data[n],e)}}return t}configure(e){let t=Object.assign(Object.create(LRParser.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let n=this.topRules[e.top];if(!n)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=n}return e.tokenizers&&(t.tokenizers=this.tokenizers.map((t=>{let n=e.tokenizers.find((e=>e.from==t));return n?n.to:t}))),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map(((n,i)=>{let r=e.specializers.find((e=>e.from==n.external));if(!r)return n;let s=Object.assign(Object.assign({},n),{external:r.to});return t.specializers[i]=getSpecializer(s),s}))),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),null!=e.strict&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),null!=e.bufferLength&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return null==t?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),n=t.map((()=>!1));if(e)for(let i of e.split(" ")){let e=t.indexOf(i);e>=0&&(n[e]=!0)}let i=null;for(let e=0;e<t.length;e++)if(!n[e])for(let n,r=this.dialects[t[e]];65535!=(n=this.data[r++]);)(i||(i=new Uint8Array(this.maxTerm+1)))[n]=1;return new Dialect(e,n,i)}static deserialize(e){return new LRParser(e)}}function pair(e,t){return e[t]|e[t+1]<<16}function findFinished(e){let t=null;for(let n of e){let e=n.p.stoppedAt;(n.pos==n.p.stream.end||null!=e&&n.pos>e)&&n.p.parser.stateFlag(n.state,2)&&(!t||t.score<n.score)&&(t=n)}return t}function getSpecializer(e){if(e.external){let t=e.extend?1:0;return(n,i)=>e.external(n,i)<<1|t}return e.get}const scriptText=54,StartCloseScriptTag=1,styleText=55,StartCloseStyleTag=2,textareaText=56,StartCloseTextareaTag=3,EndTag=4,SelfClosingEndTag=5,StartTag=6,StartScriptTag=7,StartStyleTag=8,StartTextareaTag=9,StartSelfClosingTag=10,StartCloseTag=11,NoMatchStartCloseTag=12,MismatchedStartCloseTag=13,missingCloseTag=57,IncompleteCloseTag=14,commentContent$1=58,Element$1=20,TagName=22,Attribute=23,AttributeName=24,AttributeValue=26,UnquotedAttributeValue=27,ScriptText=28,StyleText=31,TextareaText=34,OpenTag=36,CloseTag=37,Dialect_noMatch=0,Dialect_selfClosing=1,selfClosers$1={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed={dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},closeOnOpen={dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}};function nameChar(e){return 45==e||46==e||58==e||e>=65&&e<=90||95==e||e>=97&&e<=122||e>=161}function isSpace(e){return 9==e||10==e||13==e||32==e}let cachedName=null,cachedInput=null,cachedPos=0;function tagNameAfter(e,t){let n=e.pos+t;if(cachedPos==n&&cachedInput==e)return cachedName;let i=e.peek(t);for(;isSpace(i);)i=e.peek(++t);let r="";for(;nameChar(i);)r+=String.fromCharCode(i),i=e.peek(++t);return cachedInput=e,cachedPos=n,cachedName=r?r.toLowerCase():i==question||i==bang?void 0:null}const lessThan=60,greaterThan=62,slash$1=47,question=63,bang=33,dash$1=45;function ElementContext(e,t){this.name=e,this.parent=t,this.hash=t?t.hash:0;for(let t=0;t<e.length;t++)this.hash+=(this.hash<<4)+e.charCodeAt(t)+(e.charCodeAt(t)<<8)}const startTagTerms=[StartTag,StartSelfClosingTag,StartScriptTag,StartStyleTag,StartTextareaTag],elementContext=new ContextTracker({start:null,shift:(e,t,n,i)=>startTagTerms.indexOf(t)>-1?new ElementContext(tagNameAfter(i,1)||"",e):e,reduce:(e,t)=>t==Element$1&&e?e.parent:e,reuse(e,t,n,i){let r=t.type.id;return r==StartTag||r==OpenTag?new ElementContext(tagNameAfter(i,1)||"",e):e},hash:e=>e?e.hash:0,strict:!1}),tagStart=new ExternalTokenizer(((e,t)=>{if(e.next!=lessThan)return void(e.next<0&&t.context&&e.acceptToken(missingCloseTag));e.advance();let n=e.next==slash$1;n&&e.advance();let i=tagNameAfter(e,0);if(void 0===i)return;if(!i)return e.acceptToken(n?IncompleteCloseTag:StartTag);let r=t.context?t.context.name:null;if(n){if(i==r)return e.acceptToken(StartCloseTag);if(r&&implicitlyClosed[r])return e.acceptToken(missingCloseTag,-2);if(t.dialectEnabled(Dialect_noMatch))return e.acceptToken(NoMatchStartCloseTag);for(let e=t.context;e;e=e.parent)if(e.name==i)return;e.acceptToken(MismatchedStartCloseTag)}else{if("script"==i)return e.acceptToken(StartScriptTag);if("style"==i)return e.acceptToken(StartStyleTag);if("textarea"==i)return e.acceptToken(StartTextareaTag);if(selfClosers$1.hasOwnProperty(i))return e.acceptToken(StartSelfClosingTag);r&&closeOnOpen[r]&&closeOnOpen[r][i]?e.acceptToken(missingCloseTag,-1):e.acceptToken(StartTag)}}),{contextual:!0}),commentContent=new ExternalTokenizer((e=>{for(let t=0,n=0;;n++){if(e.next<0){n&&e.acceptToken(commentContent$1);break}if(e.next==dash$1)t++;else{if(e.next==greaterThan&&t>=2){n>=3&&e.acceptToken(commentContent$1,-2);break}t=0}e.advance()}}));function inForeignElement(e){for(;e;e=e.parent)if("svg"==e.name||"math"==e.name)return!0;return!1}const endTag=new ExternalTokenizer(((e,t)=>{if(e.next==slash$1&&e.peek(1)==greaterThan){let n=t.dialectEnabled(Dialect_selfClosing)||inForeignElement(t.context);e.acceptToken(n?SelfClosingEndTag:EndTag,2)}else e.next==greaterThan&&e.acceptToken(EndTag,1)}));function contentTokenizer(e,t,n){let i=2+e.length;return new ExternalTokenizer((r=>{for(let s=0,o=0,a=0;;a++){if(r.next<0){a&&r.acceptToken(t);break}if(0==s&&r.next==lessThan||1==s&&r.next==slash$1||s>=2&&s<i&&r.next==e.charCodeAt(s-2))s++,o++;else if(2!=s&&s!=i||!isSpace(r.next)){if(s==i&&r.next==greaterThan){a>o?r.acceptToken(t,-o):r.acceptToken(n,-(o-2));break}if((10==r.next||13==r.next)&&a){r.acceptToken(t,1);break}s=o=0}else o++;r.advance()}}))}const scriptTokens=contentTokenizer("script",scriptText,StartCloseScriptTag),styleTokens=contentTokenizer("style",styleText,StartCloseStyleTag),textareaTokens=contentTokenizer("textarea",textareaText,StartCloseTextareaTag),htmlHighlighting=styleTags({"Text RawText":tags$1.content,"StartTag StartCloseTag SelfClosingEndTag EndTag":tags$1.angleBracket,TagName:tags$1.tagName,"MismatchedCloseTag/TagName":[tags$1.tagName,tags$1.invalid],AttributeName:tags$1.attributeName,"AttributeValue UnquotedAttributeValue":tags$1.attributeValue,Is:tags$1.definitionOperator,"EntityReference CharacterReference":tags$1.character,Comment:tags$1.blockComment,ProcessingInst:tags$1.processingInstruction,DoctypeDecl:tags$1.documentMeta}),parser$2=LRParser.deserialize({version:14,states:",xOVO!rOOO!WQ#tO'#CqO!]Q#tO'#CzO!bQ#tO'#C}O!gQ#tO'#DQO!lQ#tO'#DSO!qOaO'#CpO!|ObO'#CpO#XOdO'#CpO$eO!rO'#CpOOO`'#Cp'#CpO$lO$fO'#DTO$tQ#tO'#DVO$yQ#tO'#DWOOO`'#Dk'#DkOOO`'#DY'#DYQVO!rOOO%OQ&rO,59]O%WQ&rO,59fO%`Q&rO,59iO%hQ&rO,59lO%sQ&rO,59nOOOa'#D^'#D^O%{OaO'#CxO&WOaO,59[OOOb'#D_'#D_O&`ObO'#C{O&kObO,59[OOOd'#D`'#D`O&sOdO'#DOO'OOdO,59[OOO`'#Da'#DaO'WO!rO,59[O'_Q#tO'#DROOO`,59[,59[OOOp'#Db'#DbO'dO$fO,59oOOO`,59o,59oO'lQ#|O,59qO'qQ#|O,59rOOO`-E7W-E7WO'vQ&rO'#CsOOQW'#DZ'#DZO(UQ&rO1G.wOOOa1G.w1G.wO(^Q&rO1G/QOOOb1G/Q1G/QO(fQ&rO1G/TOOOd1G/T1G/TO(nQ&rO1G/WOOO`1G/W1G/WOOO`1G/Y1G/YO(yQ&rO1G/YOOOa-E7[-E7[O)RQ#tO'#CyOOO`1G.v1G.vOOOb-E7]-E7]O)WQ#tO'#C|OOOd-E7^-E7^O)]Q#tO'#DPOOO`-E7_-E7_O)bQ#|O,59mOOOp-E7`-E7`OOO`1G/Z1G/ZOOO`1G/]1G/]OOO`1G/^1G/^O)gQ,UO,59_OOQW-E7X-E7XOOOa7+$c7+$cOOOb7+$l7+$lOOOd7+$o7+$oOOO`7+$r7+$rOOO`7+$t7+$tO)rQ#|O,59eO)wQ#|O,59hO)|Q#|O,59kOOO`1G/X1G/XO*RO7[O'#CvO*dOMhO'#CvOOQW1G.y1G.yOOO`1G/P1G/POOO`1G/S1G/SOOO`1G/V1G/VOOOO'#D['#D[O*uO7[O,59bOOQW,59b,59bOOOO'#D]'#D]O+WOMhO,59bOOOO-E7Y-E7YOOQW1G.|1G.|OOOO-E7Z-E7Z",stateData:"+s~O!^OS~OUSOVPOWQOXROYTO[]O][O^^O`^Oa^Ob^Oc^Ox^O{_O!dZO~OfaO~OfbO~OfcO~OfdO~OfeO~O!WfOPlP!ZlP~O!XiOQoP!ZoP~O!YlORrP!ZrP~OUSOVPOWQOXROYTOZqO[]O][O^^O`^Oa^Ob^Oc^Ox^O!dZO~O!ZrO~P#dO![sO!euO~OfvO~OfwO~OS|OhyO~OS!OOhyO~OS!QOhyO~OS!SOT!TOhyO~OS!TOhyO~O!WfOPlX!ZlX~OP!WO!Z!XO~O!XiOQoX!ZoX~OQ!ZO!Z!XO~O!YlORrX!ZrX~OR!]O!Z!XO~O!Z!XO~P#dOf!_O~O![sO!e!aO~OS!bO~OS!cO~Oi!dOSgXhgXTgX~OS!fOhyO~OS!gOhyO~OS!hOhyO~OS!iOT!jOhyO~OS!jOhyO~Of!kO~Of!lO~Of!mO~OS!nO~Ok!qO!`!oO!b!pO~OS!rO~OS!sO~OS!tO~Oa!uOb!uOc!uO!`!wO!a!uO~Oa!xOb!xOc!xO!b!wO!c!xO~Oa!uOb!uOc!uO!`!{O!a!uO~Oa!xOb!xOc!xO!b!{O!c!xO~OT~bac!dx{!d~",goto:"%p!`PPPPPPPPPPPPPPPPPPPP!a!gP!mPP!yP!|#P#S#Y#]#`#f#i#l#r#x!aP!a!aP$O$U$l$r$x%O%U%[%bPPPPPPPP%hX^OX`pXUOX`pezabcde{}!P!R!UR!q!dRhUR!XhXVOX`pRkVR!XkXWOX`pRnWR!XnXXOX`pQrXR!XpXYOX`pQ`ORx`Q{aQ}bQ!PcQ!RdQ!UeZ!e{}!P!R!UQ!v!oR!z!vQ!y!pR!|!yQgUR!VgQjVR!YjQmWR![mQpXR!^pQtZR!`tS_O`ToXp",nodeNames:" StartCloseTag StartCloseTag StartCloseTag EndTag SelfClosingEndTag StartTag StartTag StartTag StartTag StartTag StartCloseTag StartCloseTag StartCloseTag IncompleteCloseTag Document Text EntityReference CharacterReference InvalidEntity Element OpenTag TagName Attribute AttributeName Is AttributeValue UnquotedAttributeValue ScriptText CloseTag OpenTag StyleText CloseTag OpenTag TextareaText CloseTag OpenTag CloseTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag CloseTag DoctypeDecl",maxTerm:67,context:elementContext,nodeProps:[["closedBy",-10,1,2,3,7,8,9,10,11,12,13,"EndTag",6,"EndTag SelfClosingEndTag",-4,21,30,33,36,"CloseTag"],["openedBy",4,"StartTag StartCloseTag",5,"StartTag",-4,29,32,35,37,"OpenTag"],["group",-9,14,17,18,19,20,39,40,41,42,"Entity",16,"Entity TextContent",-3,28,31,34,"TextContent Entity"],["isolate",-11,21,29,30,32,33,35,36,37,38,41,42,"ltr",-3,26,27,39,""]],propSources:[htmlHighlighting],skippedNodes:[0],repeatNodeCount:9,tokenData:"!<p!aR!YOX$qXY,QYZ,QZ[$q[]&X]^,Q^p$qpq,Qqr-_rs3_sv-_vw3}wxHYx}-_}!OH{!O!P-_!P!Q$q!Q![-_![!]Mz!]!^-_!^!_!$S!_!`!;x!`!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4U-_4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!Z$|c`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr$qrs&}sv$qvw+Pwx(tx!^$q!^!_*V!_!a&X!a#S$q#S#T&X#T;'S$q;'S;=`+z<%lO$q!R&bX`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&Xq'UV`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}P'pT`POv'kw!^'k!_;'S'k;'S;=`(P<%lO'kP(SP;=`<%l'kp([S!cpOv(Vx;'S(V;'S;=`(h<%lO(Vp(kP;=`<%l(Vq(qP;=`<%l&}a({W`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t`)jT!a`Or)esv)ew;'S)e;'S;=`)y<%lO)e`)|P;=`<%l)ea*SP;=`<%l(t!Q*^V!a`!cpOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!Q*vP;=`<%l*V!R*|P;=`<%l&XW+UYkWOX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+PW+wP;=`<%l+P!Z+}P;=`<%l$q!a,]``P!a`!cp!^^OX&XXY,QYZ,QZ]&X]^,Q^p&Xpq,Qqr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!_-ljhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q[/ebhSkWOX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+PS0rXhSqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0mS1bP;=`<%l0m[1hP;=`<%l/^!V1vchS`P!a`!cpOq&Xqr1krs&}sv1kvw0mwx(tx!P1k!P!Q&X!Q!^1k!^!_*V!_!a&X!a#s1k#s$f&X$f;'S1k;'S;=`3R<%l?Ah1k?Ah?BY&X?BY?Mn1k?MnO&X!V3UP;=`<%l1k!_3[P;=`<%l-_!Z3hV!`h`P!cpOv&}wx'kx!^&}!^!_(V!_;'S&};'S;=`(n<%lO&}!_4WihSkWc!ROX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst>]tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^/^!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!Z5zbkWOX5uXZ7SZ[5u[^7S^p5uqr5urs7Sst+Ptw5uwx7Sx!]5u!]!^7w!^!a7S!a#S5u#S#T7S#T;'S5u;'S;=`8n<%lO5u!R7VVOp7Sqs7St!]7S!]!^7l!^;'S7S;'S;=`7q<%lO7S!R7qOa!R!R7tP;=`<%l7S!Z8OYkWa!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!Z8qP;=`<%l5u!_8{ihSkWOX5uXZ7SZ[5u[^7S^p5uqr8trs7Sst/^tw8twx7Sx!P8t!P!Q5u!Q!]8t!]!^:j!^!a7S!a#S8t#S#T;{#T#s8t#s$f5u$f;'S8t;'S;=`>V<%l?Ah8t?Ah?BY5u?BY?Mn8t?MnO5u!_:sbhSkWa!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!V<QchSOp7Sqr;{rs7Sst0mtw;{wx7Sx!P;{!P!Q7S!Q!];{!]!^=]!^!a7S!a#s;{#s$f7S$f;'S;{;'S;=`>P<%l?Ah;{?Ah?BY7S?BY?Mn;{?MnO7S!V=dXhSa!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!V>SP;=`<%l;{!_>YP;=`<%l8t!_>dhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^/^!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!Z@TakWOX@OXZAYZ[@O[^AY^p@Oqr@OrsAYsw@OwxAYx!]@O!]!^Az!^!aAY!a#S@O#S#TAY#T;'S@O;'S;=`Bq<%lO@O!RA]UOpAYq!]AY!]!^Ao!^;'SAY;'S;=`At<%lOAY!RAtOb!R!RAwP;=`<%lAY!ZBRYkWb!ROX+PZ[+P^p+Pqr+Psw+Px!^+P!a#S+P#T;'S+P;'S;=`+t<%lO+P!ZBtP;=`<%l@O!_COhhSkWOX@OXZAYZ[@O[^AY^p@OqrBwrsAYswBwwxAYx!PBw!P!Q@O!Q!]Bw!]!^Dj!^!aAY!a#SBw#S#TE{#T#sBw#s$f@O$f;'SBw;'S;=`HS<%l?AhBw?Ah?BY@O?BY?MnBw?MnO@O!_DsbhSkWb!ROX+PZ[+P^p+Pqr/^sw/^x!P/^!P!Q+P!Q!^/^!a#S/^#S#T0m#T#s/^#s$f+P$f;'S/^;'S;=`1e<%l?Ah/^?Ah?BY+P?BY?Mn/^?MnO+P!VFQbhSOpAYqrE{rsAYswE{wxAYx!PE{!P!QAY!Q!]E{!]!^GY!^!aAY!a#sE{#s$fAY$f;'SE{;'S;=`G|<%l?AhE{?Ah?BYAY?BY?MnE{?MnOAY!VGaXhSb!Rqr0msw0mx!P0m!Q!^0m!a#s0m$f;'S0m;'S;=`1_<%l?Ah0m?BY?Mn0m!VHPP;=`<%lE{!_HVP;=`<%lBw!ZHcW!bx`P!a`Or(trs'ksv(tw!^(t!^!_)e!_;'S(t;'S;=`*P<%lO(t!aIYlhS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OKQ!O!P-_!P!Q$q!Q!^-_!^!_*V!_!a&X!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!aK_khS`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx!P-_!P!Q$q!Q!^-_!^!_*V!_!`&X!`!aMS!a#S-_#S#T1k#T#s-_#s$f$q$f;'S-_;'S;=`3X<%l?Ah-_?Ah?BY$q?BY?Mn-_?MnO$q!TM_X`P!a`!cp!eQOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X!aNZ!ZhSfQ`PkW!a`!cpOX$qXZ&XZ[$q[^&X^p$qpq&Xqr-_rs&}sv-_vw/^wx(tx}-_}!OMz!O!PMz!P!Q$q!Q![Mz![!]Mz!]!^-_!^!_*V!_!a&X!a!c-_!c!}Mz!}#R-_#R#SMz#S#T1k#T#oMz#o#s-_#s$f$q$f$}-_$}%OMz%O%W-_%W%oMz%o%p-_%p&aMz&a&b-_&b1pMz1p4UMz4U4dMz4d4e-_4e$ISMz$IS$I`-_$I`$IbMz$Ib$Je-_$Je$JgMz$Jg$Kh-_$Kh%#tMz%#t&/x-_&/x&EtMz&Et&FV-_&FV;'SMz;'S;:j!#|;:j;=`3X<%l?&r-_?&r?AhMz?Ah?BY$q?BY?MnMz?MnO$q!a!$PP;=`<%lMz!R!$ZY!a`!cpOq*Vqr!$yrs(Vsv*Vwx)ex!a*V!a!b!4t!b;'S*V;'S;=`*s<%lO*V!R!%Q]!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!%y!O!f*V!f!g!']!g#W*V#W#X!0`#X;'S*V;'S;=`*s<%lO*V!R!&QX!a`!cpOr*Vrs(Vsv*Vwx)ex}*V}!O!&m!O;'S*V;'S;=`*s<%lO*V!R!&vV!a`!cp!dPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!'dX!a`!cpOr*Vrs(Vsv*Vwx)ex!q*V!q!r!(P!r;'S*V;'S;=`*s<%lO*V!R!(WX!a`!cpOr*Vrs(Vsv*Vwx)ex!e*V!e!f!(s!f;'S*V;'S;=`*s<%lO*V!R!(zX!a`!cpOr*Vrs(Vsv*Vwx)ex!v*V!v!w!)g!w;'S*V;'S;=`*s<%lO*V!R!)nX!a`!cpOr*Vrs(Vsv*Vwx)ex!{*V!{!|!*Z!|;'S*V;'S;=`*s<%lO*V!R!*bX!a`!cpOr*Vrs(Vsv*Vwx)ex!r*V!r!s!*}!s;'S*V;'S;=`*s<%lO*V!R!+UX!a`!cpOr*Vrs(Vsv*Vwx)ex!g*V!g!h!+q!h;'S*V;'S;=`*s<%lO*V!R!+xY!a`!cpOr!+qrs!,hsv!+qvw!-Swx!.[x!`!+q!`!a!/j!a;'S!+q;'S;=`!0Y<%lO!+qq!,mV!cpOv!,hvx!-Sx!`!,h!`!a!-q!a;'S!,h;'S;=`!.U<%lO!,hP!-VTO!`!-S!`!a!-f!a;'S!-S;'S;=`!-k<%lO!-SP!-kO{PP!-nP;=`<%l!-Sq!-xS!cp{POv(Vx;'S(V;'S;=`(h<%lO(Vq!.XP;=`<%l!,ha!.aX!a`Or!.[rs!-Ssv!.[vw!-Sw!`!.[!`!a!.|!a;'S!.[;'S;=`!/d<%lO!.[a!/TT!a`{POr)esv)ew;'S)e;'S;=`)y<%lO)ea!/gP;=`<%l!.[!R!/sV!a`!cp{POr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!0]P;=`<%l!+q!R!0gX!a`!cpOr*Vrs(Vsv*Vwx)ex#c*V#c#d!1S#d;'S*V;'S;=`*s<%lO*V!R!1ZX!a`!cpOr*Vrs(Vsv*Vwx)ex#V*V#V#W!1v#W;'S*V;'S;=`*s<%lO*V!R!1}X!a`!cpOr*Vrs(Vsv*Vwx)ex#h*V#h#i!2j#i;'S*V;'S;=`*s<%lO*V!R!2qX!a`!cpOr*Vrs(Vsv*Vwx)ex#m*V#m#n!3^#n;'S*V;'S;=`*s<%lO*V!R!3eX!a`!cpOr*Vrs(Vsv*Vwx)ex#d*V#d#e!4Q#e;'S*V;'S;=`*s<%lO*V!R!4XX!a`!cpOr*Vrs(Vsv*Vwx)ex#X*V#X#Y!+q#Y;'S*V;'S;=`*s<%lO*V!R!4{Y!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!a!4t!a!b!:]!b;'S!4t;'S;=`!;r<%lO!4tq!5pV!cpOv!5kvx!6Vx!a!5k!a!b!7W!b;'S!5k;'S;=`!8V<%lO!5kP!6YTO!a!6V!a!b!6i!b;'S!6V;'S;=`!7Q<%lO!6VP!6lTO!`!6V!`!a!6{!a;'S!6V;'S;=`!7Q<%lO!6VP!7QOxPP!7TP;=`<%l!6Vq!7]V!cpOv!5kvx!6Vx!`!5k!`!a!7r!a;'S!5k;'S;=`!8V<%lO!5kq!7yS!cpxPOv(Vx;'S(V;'S;=`(h<%lO(Vq!8YP;=`<%l!5ka!8bX!a`Or!8]rs!6Vsv!8]vw!6Vw!a!8]!a!b!8}!b;'S!8];'S;=`!:V<%lO!8]a!9SX!a`Or!8]rs!6Vsv!8]vw!6Vw!`!8]!`!a!9o!a;'S!8];'S;=`!:V<%lO!8]a!9vT!a`xPOr)esv)ew;'S)e;'S;=`)y<%lO)ea!:YP;=`<%l!8]!R!:dY!a`!cpOr!4trs!5ksv!4tvw!6Vwx!8]x!`!4t!`!a!;S!a;'S!4t;'S;=`!;r<%lO!4t!R!;]V!a`!cpxPOr*Vrs(Vsv*Vwx)ex;'S*V;'S;=`*s<%lO*V!R!;uP;=`<%l!4t!V!<TXiS`P!a`!cpOr&Xrs&}sv&Xwx(tx!^&X!^!_*V!_;'S&X;'S;=`*y<%lO&X",tokenizers:[scriptTokens,styleTokens,textareaTokens,endTag,tagStart,commentContent,0,1,2,3,4,5],topRules:{Document:[0,15]},dialects:{noMatch:0,selfClosing:485},tokenPrec:487});function getAttrs(e,t){let n=Object.create(null);for(let i of e.getChildren(Attribute)){let e=i.getChild(AttributeName),r=i.getChild(AttributeValue)||i.getChild(UnquotedAttributeValue);e&&(n[t.read(e.from,e.to)]=r?r.type.id==AttributeValue?t.read(r.from+1,r.to-1):t.read(r.from,r.to):"")}return n}function findTagName(e,t){let n=e.getChild(TagName);return n?t.read(n.from,n.to):" "}function maybeNest(e,t,n){let i;for(let r of n)if(!r.attrs||r.attrs(i||(i=getAttrs(e.node.parent.firstChild,t))))return{parser:r.parser};return null}function configureNesting(e=[],t=[]){let n=[],i=[],r=[],s=[];for(let t of e){("script"==t.tag?n:"style"==t.tag?i:"textarea"==t.tag?r:s).push(t)}let o=t.length?Object.create(null):null;for(let e of t)(o[e.name]||(o[e.name]=[])).push(e);return parseMixed(((e,t)=>{let a=e.type.id;if(a==ScriptText)return maybeNest(e,t,n);if(a==StyleText)return maybeNest(e,t,i);if(a==TextareaText)return maybeNest(e,t,r);if(a==Element$1&&s.length){let n,i=e.node,r=i.firstChild,o=r&&findTagName(r,t);if(o)for(let e of s)if(e.tag==o&&(!e.attrs||e.attrs(n||(n=getAttrs(i,t))))){let t=i.lastChild,n=t.type.id==CloseTag?t.from:i.to;if(n>r.to)return{parser:e.parser,overlay:[{from:r.to,to:n}]}}}if(o&&a==Attribute){let n,i=e.node;if(n=i.firstChild){let e=o[t.read(n.from,n.to)];if(e)for(let n of e){if(n.tagName&&n.tagName!=findTagName(i.parent,t))continue;let e=i.lastChild;if(e.type.id==AttributeValue){let t=e.from+1,i=e.lastChild,r=e.to-(i&&i.isError?0:1);if(r>t)return{parser:n.parser,overlay:[{from:t,to:r}]}}else if(e.type.id==UnquotedAttributeValue)return{parser:n.parser,overlay:[{from:e.from,to:e.to}]}}}}return null}))}const descendantOp=99,Unit=1,callee=100,identifier$2=101,VariableName=2,space$1=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],colon=58,parenL=40,underscore=95,bracketL=91,dash=45,period=46,hash=35,percent=37,ampersand=38,backslash=92,newline$1=10;function isAlpha(e){return e>=65&&e<=90||e>=97&&e<=122||e>=161}function isDigit(e){return e>=48&&e<=57}const identifiers=new ExternalTokenizer(((e,t)=>{for(let n=!1,i=0,r=0;;r++){let{next:s}=e;if(isAlpha(s)||s==dash||s==underscore||n&&isDigit(s))!n&&(s!=dash||r>0)&&(n=!0),i===r&&s==dash&&i++,e.advance();else{if(s!=backslash||e.peek(1)==newline$1){n&&e.acceptToken(s==parenL?callee:2==i&&t.canShift(VariableName)?VariableName:identifier$2);break}e.advance(),e.next>-1&&e.advance(),n=!0}}})),descendant=new ExternalTokenizer((e=>{if(space$1.includes(e.peek(-1))){let{next:t}=e;(isAlpha(t)||t==underscore||t==hash||t==period||t==bracketL||t==colon||t==dash||t==ampersand)&&e.acceptToken(descendantOp)}})),unitToken=new ExternalTokenizer((e=>{if(!space$1.includes(e.peek(-1))){let{next:t}=e;if(t==percent&&(e.advance(),e.acceptToken(Unit)),isAlpha(t)){do{e.advance()}while(isAlpha(e.next));e.acceptToken(Unit)}}})),cssHighlighting=styleTags({"AtKeyword import charset namespace keyframes media supports":tags$1.definitionKeyword,"from to selector":tags$1.keyword,NamespaceName:tags$1.namespace,KeyframeName:tags$1.labelName,KeyframeRangeName:tags$1.operatorKeyword,TagName:tags$1.tagName,ClassName:tags$1.className,PseudoClassName:tags$1.constant(tags$1.className),IdName:tags$1.labelName,"FeatureName PropertyName":tags$1.propertyName,AttributeName:tags$1.attributeName,NumberLiteral:tags$1.number,KeywordQuery:tags$1.keyword,UnaryQueryOp:tags$1.operatorKeyword,"CallTag ValueName":tags$1.atom,VariableName:tags$1.variableName,Callee:tags$1.operatorKeyword,Unit:tags$1.unit,"UniversalSelector NestingSelector":tags$1.definitionOperator,MatchOp:tags$1.compareOperator,"ChildOp SiblingOp, LogicOp":tags$1.logicOperator,BinOp:tags$1.arithmeticOperator,Important:tags$1.modifier,Comment:tags$1.blockComment,ColorLiteral:tags$1.color,"ParenthesizedContent StringLiteral":tags$1.string,":":tags$1.punctuation,"PseudoOp #":tags$1.derefOperator,"; ,":tags$1.separator,"( )":tags$1.paren,"[ ]":tags$1.squareBracket,"{ }":tags$1.brace}),spec_callee={__proto__:null,lang:32,"nth-child":32,"nth-last-child":32,"nth-of-type":32,"nth-last-of-type":32,dir:32,"host-context":32,url:60,"url-prefix":60,domain:60,regexp:60,selector:138},spec_AtKeyword={__proto__:null,"@import":118,"@media":142,"@charset":146,"@namespace":150,"@keyframes":156,"@supports":168},spec_identifier$1={__proto__:null,not:132,only:132},parser$1=LRParser.deserialize({version:14,states:":^QYQ[OOO#_Q[OOP#fOWOOOOQP'#Cd'#CdOOQP'#Cc'#CcO#kQ[O'#CfO$_QXO'#CaO$fQ[O'#ChO$qQ[O'#DTO$vQ[O'#DWOOQP'#Em'#EmO${QdO'#DgO%jQ[O'#DtO${QdO'#DvO%{Q[O'#DxO&WQ[O'#D{O&`Q[O'#ERO&nQ[O'#ETOOQS'#El'#ElOOQS'#EW'#EWQYQ[OOO&uQXO'#CdO'jQWO'#DcO'oQWO'#EsO'zQ[O'#EsQOQWOOP(UO#tO'#C_POOO)C@[)C@[OOQP'#Cg'#CgOOQP,59Q,59QO#kQ[O,59QO(aQ[O'#E[O({QWO,58{O)TQ[O,59SO$qQ[O,59oO$vQ[O,59rO(aQ[O,59uO(aQ[O,59wO(aQ[O,59xO)`Q[O'#DbOOQS,58{,58{OOQP'#Ck'#CkOOQO'#DR'#DROOQP,59S,59SO)gQWO,59SO)lQWO,59SOOQP'#DV'#DVOOQP,59o,59oOOQO'#DX'#DXO)qQ`O,59rOOQS'#Cp'#CpO${QdO'#CqO)yQvO'#CsO+ZQtO,5:ROOQO'#Cx'#CxO)lQWO'#CwO+oQWO'#CyO+tQ[O'#DOOOQS'#Ep'#EpOOQO'#Dj'#DjO+|Q[O'#DqO,[QWO'#EtO&`Q[O'#DoO,jQWO'#DrOOQO'#Eu'#EuO)OQWO,5:`O,oQpO,5:bOOQS'#Dz'#DzO,wQWO,5:dO,|Q[O,5:dOOQO'#D}'#D}O-UQWO,5:gO-ZQWO,5:mO-cQWO,5:oOOQS-E8U-E8UO${QdO,59}O-kQ[O'#E^O-xQWO,5;_O-xQWO,5;_POOO'#EV'#EVP.TO#tO,58yPOOO,58y,58yOOQP1G.l1G.lO.zQXO,5:vOOQO-E8Y-E8YOOQS1G.g1G.gOOQP1G.n1G.nO)gQWO1G.nO)lQWO1G.nOOQP1G/Z1G/ZO/XQ`O1G/^O/rQXO1G/aO0YQXO1G/cO0pQXO1G/dO1WQWO,59|O1]Q[O'#DSO1dQdO'#CoOOQP1G/^1G/^O${QdO1G/^O1kQpO,59]OOQS,59_,59_O${QdO,59aO1sQWO1G/mOOQS,59c,59cO1xQ!bO,59eOOQS'#DP'#DPOOQS'#EY'#EYO2QQ[O,59jOOQS,59j,59jO2YQWO'#DjO2eQWO,5:VO2jQWO,5:]O&`Q[O,5:XO&`Q[O'#E_O2rQWO,5;`O2}QWO,5:ZO(aQ[O,5:^OOQS1G/z1G/zOOQS1G/|1G/|OOQS1G0O1G0OO3`QWO1G0OO3eQdO'#EOOOQS1G0R1G0ROOQS1G0X1G0XOOQS1G0Z1G0ZO3pQtO1G/iOOQO,5:x,5:xO4WQ[O,5:xOOQO-E8[-E8[O4eQWO1G0yPOOO-E8T-E8TPOOO1G.e1G.eOOQP7+$Y7+$YOOQP7+$x7+$xO${QdO7+$xOOQS1G/h1G/hO4pQXO'#ErO4wQWO,59nO4|QtO'#EXO5tQdO'#EoO6OQWO,59ZO6TQpO7+$xOOQS1G.w1G.wOOQS1G.{1G.{OOQS7+%X7+%XO6]QWO1G/POOQS-E8W-E8WOOQS1G/U1G/UO${QdO1G/qOOQO1G/w1G/wOOQO1G/s1G/sO6bQWO,5:yOOQO-E8]-E8]O6pQXO1G/xOOQS7+%j7+%jO6wQYO'#CsOOQO'#EQ'#EQO7SQ`O'#EPOOQO'#EP'#EPO7_QWO'#E`O7gQdO,5:jOOQS,5:j,5:jO7rQtO'#E]O${QdO'#E]O8sQdO7+%TOOQO7+%T7+%TOOQO1G0d1G0dO9WQpO<<HdO9`QWO,5;^OOQP1G/Y1G/YOOQS-E8V-E8VO${QdO'#EZO9hQWO,5;ZOOQT1G.u1G.uOOQP<<Hd<<HdOOQS7+$k7+$kO9pQdO7+%]OOQO7+%d7+%dOOQO,5:k,5:kO3hQdO'#EaO7_QWO,5:zOOQS,5:z,5:zOOQS-E8^-E8^OOQS1G0U1G0UO9wQtO,5:wOOQS-E8Z-E8ZOOQO<<Ho<<HoOOQPAN>OAN>OO:xQdO,5:uOOQO-E8X-E8XOOQO<<Hw<<HwOOQO,5:{,5:{OOQO-E8_-E8_OOQS1G0f1G0f",stateData:";[~O#ZOS#[QQ~OUYOXYO]VO^VOqXOxWO![aO!]ZO!i[O!k]O!m^O!p_O!v`O#XRO#bTO~OQfOUYOXYO]VO^VOqXOxWO![aO!]ZO!i[O!k]O!m^O!p_O!v`O#XeO#bTO~O#U#gP~P!ZO#[jO~O#XlO~O]qO^qOqsOtoOxrO!OtO!RvO#VuO#bnO~O!TwO~P#pO`}O#WzO#XyO~O#X!OO~O#X!QO~OQ![Ob!TOf![Oh![On!YOq!ZO#W!WO#X!SO#e!UO~Ob!^O!d!`O!g!aO#X!]O!T#hP~Oh!fOn!YO#X!eO~Oh!hO#X!hO~Ob!^O!d!`O!g!aO#X!]O~O!Y#hP~P%jO]WX]!WX^WXqWXtWXxWX!OWX!RWX!TWX#VWX#bWX~O]!mO~O!Y!nO#U#gX!S#gX~O#U#gX!S#gX~P!ZO#]!qO#^!qO#_!sO~OUYOXYO]VO^VOqXOxWO#XRO#bTO~OtoO!TwO~O`!zO#WzO#XyO~O!S#gP~P!ZOb#RO~Ob#SO~Op#TO|#UO~OP#WObgXjgX!YgX!dgX!ggX#XgXagXQgXfgXhgXngXqgXtgX!XgX#UgX#WgX#egXpgX!SgX~Ob!^Oj#XO!d!`O!g!aO#X!]O!Y#hP~Ob#[O~Op#`O#X#]O~Ob!^O!d!`O!g!aO#X#aO~Ot#eO!b#dO!T#hX!Y#hX~Ob#hO~Oj#XO!Y#jO~O!Y#kO~Oh#lOn!YO~O!T#mO~O!TwO!b#dO~O!TwO!Y#pO~O!Y#QX#U#QX!S#QX~P!ZO!Y!nO#U#ga!S#ga~O#]!qO#^!qO#_#wO~O]qO^qOqsOxrO!OtO!RvO#VuO#bnO~Ot#Oa!T#Oaa#Oa~P.`Op#yO|#zO~O]qO^qOqsOxrO#bnO~Ot}i!O}i!R}i!T}i#V}ia}i~P/aOt!Pi!O!Pi!R!Pi!T!Pi#V!Pia!Pi~P/aOt!Qi!O!Qi!R!Qi!T!Qi#V!Qia!Qi~P/aO!S#{O~Oa#fP~P(aOa#cP~P${Oa$SOj#XO~O!Y$UO~Oh$VOo$VO~Op$XO#X#]O~O]!`Xa!^X!b!^X~O]$YO~Oa$ZO!b#dO~Ot#eO!T#ha!Y#ha~O!b#dOt!ca!T!ca!Y!caa!ca~O!Y$`O~O!S$gO#X$bO#e$aO~Oj#XOt$iO!X$kO!Y!Vi#U!Vi!S!Vi~P${O!Y#Qa#U#Qa!S#Qa~P!ZO!Y!nO#U#gi!S#gi~Oa#fX~P#pOa$oO~Oj#XOQ!{Xa!{Xb!{Xf!{Xh!{Xn!{Xq!{Xt!{X#W!{X#X!{X#e!{X~Ot$qOa#cX~P${Oa$sO~Oj#XOp$tO~Oa$uO~O!b#dOt#Ra!T#Ra!Y#Ra~Oa$wO~P.`OP#WOtgX!TgX~O#e$aOt!sX!T!sX~Ot$yO!TwO~O!S$}O#X$bO#e$aO~Oj#XOQ#PXb#PXf#PXh#PXn#PXq#PXt#PX!X#PX!Y#PX#U#PX#W#PX#X#PX#e#PX!S#PX~Ot$iO!X%QO!Y!Vq#U!Vq!S!Vq~P${Oj#XOp%RO~OtoOa#fa~Ot$qOa#ca~Oa%UO~P${Oj#XOQ#Pab#Paf#Pah#Pan#Paq#Pat#Pa!X#Pa!Y#Pa#U#Pa#W#Pa#X#Pa#e#Pa!S#Pa~Oa!}at!}a~P${O#Zo#[#ej!R#e~",goto:"-g#jPPP#kP#nP#w$WP#w$g#wPP$mPPP$s$|$|P%`P$|P$|%z&^PPPP$|&vP&z'Q#wP'W#w'^P#wP#w#wPPP'd'y(WPP#nPP(_(_(i(_P(_P(_(_P#nP#nP#nP(l#nP(o(r(u(|#nP#nP)R)X)h)v)|*S*^*d*n*t*zPPPPPPPPPP+Q+ZP+v+yP,o,r,x-RRkQ_bOPdhw!n#skYOPdhotuvw!n#R#h#skSOPdhotuvw!n#R#h#sQmTR!tnQ{VR!xqQ!x}Q#Z!XR#x!zq![Z]!T!m#S#U#X#q#z$P$Y$i$j$q$v%Sp![Z]!T!m#S#U#X#q#z$P$Y$i$j$q$v%SU$d#m$f$yR$x$cq!XZ]!T!m#S#U#X#q#z$P$Y$i$j$q$v%Sp![Z]!T!m#S#U#X#q#z$P$Y$i$j$q$v%SQ!f^R#l!gT#^!Z#_Q|VR!yqQ!x|R#x!yQ!PWR!{rQ!RXR!|sQxUQ!wpQ#i!cQ#o!jQ#p!kQ${$eR%X$zSgPwQ!phQ#r!nR$l#sZfPhw!n#sa!b[`a!V!^!`#d#eR#b!^R!g^R!i_R#n!iS$e#m$fR%V$yV$c#m$f$yQ!rjR#v!rQdOShPwU!ldh#sR#s!nQ$P#SU$p$P$v%SQ$v$YR%S$qQ#_!ZR$W#_Q$r$PR%T$rQpUS!vp$nR$n#|Q$j#qR%P$jQ!ogS#t!o#uR#u!pQ#f!_R$^#fQ$f#mR$|$fQ$z$eR%W$z_cOPdhw!n#s^UOPdhw!n#sQ!uoQ!}tQ#OuQ#PvQ#|#RR$_#hR$Q#SQ!VZQ!d]Q#V!TQ#q!m[$O#S$P$Y$q$v%SQ$R#UQ$T#XS$h#q$jQ$m#zR%O$iR#}#RQiPR#QwQ!c[Q!kaR#Y!VU!_[a!VQ!j`Q#c!^Q#g!`Q$[#dR$]#e",nodeNames:" Unit VariableName Comment StyleSheet RuleSet UniversalSelector TagSelector TagName NestingSelector ClassSelector ClassName PseudoClassSelector : :: PseudoClassName PseudoClassName ) ( ArgList ValueName ParenthesizedValue ColorLiteral NumberLiteral StringLiteral BinaryExpression BinOp CallExpression Callee CallLiteral CallTag ParenthesizedContent ] [ LineNames LineName , PseudoClassName ArgList IdSelector # IdName AttributeSelector AttributeName MatchOp ChildSelector ChildOp DescendantSelector SiblingSelector SiblingOp } { Block Declaration PropertyName Important ; ImportStatement AtKeyword import KeywordQuery FeatureQuery FeatureName BinaryQuery LogicOp UnaryQuery UnaryQueryOp ParenthesizedQuery SelectorQuery selector MediaStatement media CharsetStatement charset NamespaceStatement namespace NamespaceName KeyframesStatement keyframes KeyframeName KeyframeList KeyframeSelector KeyframeRangeName SupportsStatement supports AtRule Styles",maxTerm:117,nodeProps:[["isolate",-2,3,24,""],["openedBy",17,"(",32,"[",50,"{"],["closedBy",18,")",33,"]",51,"}"]],propSources:[cssHighlighting],skippedNodes:[0,3,87],repeatNodeCount:11,tokenData:"J^~R!^OX$}X^%u^p$}pq%uqr)Xrs.Rst/utu6duv$}vw7^wx7oxy9^yz9oz{9t{|:_|}?Q}!O?c!O!P@Q!P!Q@i!Q![Ab![!]B]!]!^CX!^!_$}!_!`Cj!`!aC{!a!b$}!b!cDw!c!}$}!}#OFa#O#P$}#P#QFr#Q#R6d#R#T$}#T#UGT#U#c$}#c#dHf#d#o$}#o#pH{#p#q6d#q#rI^#r#sIo#s#y$}#y#z%u#z$f$}$f$g%u$g#BY$}#BY#BZ%u#BZ$IS$}$IS$I_%u$I_$I|$}$I|$JO%u$JO$JT$}$JT$JU%u$JU$KV$}$KV$KW%u$KW&FU$}&FU&FV%u&FV;'S$};'S;=`JW<%lO$}`%QSOy%^z;'S%^;'S;=`%o<%lO%^`%cSo`Oy%^z;'S%^;'S;=`%o<%lO%^`%rP;=`<%l%^~%zh#Z~OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^~'mh#Z~o`OX%^X^'f^p%^pq'fqy%^z#y%^#y#z'f#z$f%^$f$g'f$g#BY%^#BY#BZ'f#BZ$IS%^$IS$I_'f$I_$I|%^$I|$JO'f$JO$JT%^$JT$JU'f$JU$KV%^$KV$KW'f$KW&FU%^&FU&FV'f&FV;'S%^;'S;=`%o<%lO%^l)[UOy%^z#]%^#]#^)n#^;'S%^;'S;=`%o<%lO%^l)sUo`Oy%^z#a%^#a#b*V#b;'S%^;'S;=`%o<%lO%^l*[Uo`Oy%^z#d%^#d#e*n#e;'S%^;'S;=`%o<%lO%^l*sUo`Oy%^z#c%^#c#d+V#d;'S%^;'S;=`%o<%lO%^l+[Uo`Oy%^z#f%^#f#g+n#g;'S%^;'S;=`%o<%lO%^l+sUo`Oy%^z#h%^#h#i,V#i;'S%^;'S;=`%o<%lO%^l,[Uo`Oy%^z#T%^#T#U,n#U;'S%^;'S;=`%o<%lO%^l,sUo`Oy%^z#b%^#b#c-V#c;'S%^;'S;=`%o<%lO%^l-[Uo`Oy%^z#h%^#h#i-n#i;'S%^;'S;=`%o<%lO%^l-uS!X[o`Oy%^z;'S%^;'S;=`%o<%lO%^~.UWOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o<%lO.R~.sOh~~.vRO;'S.R;'S;=`/P;=`O.R~/SXOY.RZr.Rrs.ns#O.R#O#P.s#P;'S.R;'S;=`/o;=`<%l.R<%lO.R~/rP;=`<%l.Rn/zYxQOy%^z!Q%^!Q![0j![!c%^!c!i0j!i#T%^#T#Z0j#Z;'S%^;'S;=`%o<%lO%^l0oYo`Oy%^z!Q%^!Q![1_![!c%^!c!i1_!i#T%^#T#Z1_#Z;'S%^;'S;=`%o<%lO%^l1dYo`Oy%^z!Q%^!Q![2S![!c%^!c!i2S!i#T%^#T#Z2S#Z;'S%^;'S;=`%o<%lO%^l2ZYf[o`Oy%^z!Q%^!Q![2y![!c%^!c!i2y!i#T%^#T#Z2y#Z;'S%^;'S;=`%o<%lO%^l3QYf[o`Oy%^z!Q%^!Q![3p![!c%^!c!i3p!i#T%^#T#Z3p#Z;'S%^;'S;=`%o<%lO%^l3uYo`Oy%^z!Q%^!Q![4e![!c%^!c!i4e!i#T%^#T#Z4e#Z;'S%^;'S;=`%o<%lO%^l4lYf[o`Oy%^z!Q%^!Q![5[![!c%^!c!i5[!i#T%^#T#Z5[#Z;'S%^;'S;=`%o<%lO%^l5aYo`Oy%^z!Q%^!Q![6P![!c%^!c!i6P!i#T%^#T#Z6P#Z;'S%^;'S;=`%o<%lO%^l6WSf[o`Oy%^z;'S%^;'S;=`%o<%lO%^d6gUOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^d7QS|So`Oy%^z;'S%^;'S;=`%o<%lO%^b7cSXQOy%^z;'S%^;'S;=`%o<%lO%^~7rWOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W<%lO7o~8_RO;'S7o;'S;=`8h;=`O7o~8kXOY7oZw7owx.nx#O7o#O#P8[#P;'S7o;'S;=`9W;=`<%l7o<%lO7o~9ZP;=`<%l7on9cSb^Oy%^z;'S%^;'S;=`%o<%lO%^~9tOa~n9{UUQjWOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^n:fWjW!RQOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^l;TUo`Oy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^l;nYo`#e[Oy%^z!Q%^!Q![;g![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^l<cYo`Oy%^z{%^{|=R|}%^}!O=R!O!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=WUo`Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l=qUo`#e[Oy%^z!Q%^!Q![=j![;'S%^;'S;=`%o<%lO%^l>[[o`#e[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^n?VSt^Oy%^z;'S%^;'S;=`%o<%lO%^l?hWjWOy%^z!O%^!O!P;O!P!Q%^!Q![>T![;'S%^;'S;=`%o<%lO%^n@VU#bQOy%^z!Q%^!Q![;g![;'S%^;'S;=`%o<%lO%^~@nTjWOy%^z{@}{;'S%^;'S;=`%o<%lO%^~AUSo`#[~Oy%^z;'S%^;'S;=`%o<%lO%^lAg[#e[Oy%^z!O%^!O!P;g!P!Q%^!Q![>T![!g%^!g!h<^!h#X%^#X#Y<^#Y;'S%^;'S;=`%o<%lO%^bBbU]QOy%^z![%^![!]Bt!];'S%^;'S;=`%o<%lO%^bB{S^Qo`Oy%^z;'S%^;'S;=`%o<%lO%^nC^S!Y^Oy%^z;'S%^;'S;=`%o<%lO%^dCoS|SOy%^z;'S%^;'S;=`%o<%lO%^bDQU!OQOy%^z!`%^!`!aDd!a;'S%^;'S;=`%o<%lO%^bDkS!OQo`Oy%^z;'S%^;'S;=`%o<%lO%^bDzWOy%^z!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^bEk[![Qo`Oy%^z}%^}!OEd!O!Q%^!Q![Ed![!c%^!c!}Ed!}#T%^#T#oEd#o;'S%^;'S;=`%o<%lO%^nFfSq^Oy%^z;'S%^;'S;=`%o<%lO%^nFwSp^Oy%^z;'S%^;'S;=`%o<%lO%^bGWUOy%^z#b%^#b#cGj#c;'S%^;'S;=`%o<%lO%^bGoUo`Oy%^z#W%^#W#XHR#X;'S%^;'S;=`%o<%lO%^bHYS!bQo`Oy%^z;'S%^;'S;=`%o<%lO%^bHiUOy%^z#f%^#f#gHR#g;'S%^;'S;=`%o<%lO%^fIQS!TUOy%^z;'S%^;'S;=`%o<%lO%^nIcS!S^Oy%^z;'S%^;'S;=`%o<%lO%^fItU!RQOy%^z!_%^!_!`6y!`;'S%^;'S;=`%o<%lO%^`JZP;=`<%l$}",tokenizers:[descendant,unitToken,identifiers,1,2,3,4,new LocalTokenGroup("m~RRYZ[z{a~~g~aO#^~~dP!P!Qg~lO#_~~",28,105)],topRules:{StyleSheet:[0,4],Styles:[1,86]},specialized:[{term:100,get:e=>spec_callee[e]||-1},{term:58,get:e=>spec_AtKeyword[e]||-1},{term:101,get:e=>spec_identifier$1[e]||-1}],tokenPrec:1200});let _properties=null;function properties(){if(!_properties&&"object"==typeof document&&document.body){let{style:e}=document.body,t=[],n=new Set;for(let i in e)"cssText"!=i&&"cssFloat"!=i&&"string"==typeof e[i]&&(/[A-Z]/.test(i)&&(i=i.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase()))),n.has(i)||(t.push(i),n.add(i)));_properties=t.sort().map((e=>({type:"property",label:e})))}return _properties||[]}const pseudoClasses=["active","after","any-link","autofill","backdrop","before","checked","cue","default","defined","disabled","empty","enabled","file-selector-button","first","first-child","first-letter","first-line","first-of-type","focus","focus-visible","focus-within","fullscreen","has","host","host-context","hover","in-range","indeterminate","invalid","is","lang","last-child","last-of-type","left","link","marker","modal","not","nth-child","nth-last-child","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","part","placeholder","placeholder-shown","read-only","read-write","required","right","root","scope","selection","slotted","target","target-text","valid","visited","where"].map((e=>({type:"class",label:e}))),values=["above","absolute","activeborder","additive","activecaption","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","antialiased","appworkspace","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic-abegede-gez","ethiopic-halehame-aa-er","ethiopic-halehame-gez","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","graytext","grid","groove","hand","hard-light","help","hidden","hide","higher","highlight","highlighttext","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","justify","keep-all","landscape","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-hexadecimal","lower-latin","lower-norwegian","lowercase","ltr","luminosity","manipulation","match","matrix","matrix3d","medium","menu","menutext","message-box","middle","min-intrinsic","mix","monospace","move","multiple","multiple_mask_images","multiply","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","opacity","open-quote","optimizeLegibility","optimizeSpeed","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","text","text-bottom","text-top","textarea","textfield","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","to","top","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-latin","uppercase","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"].map((e=>({type:"keyword",label:e}))).concat(["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"].map((e=>({type:"constant",label:e})))),tags=["a","abbr","address","article","aside","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dialog","div","dl","dt","em","figcaption","figure","footer","form","header","hgroup","h1","h2","h3","h4","h5","h6","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","main","meter","nav","ol","output","p","pre","ruby","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","tr","u","ul"].map((e=>({type:"type",label:e}))),identifier$1=/^(\w[\w-]*|-\w[\w-]*|)$/,variable=/^-(-[\w-]*)?$/;function isVarArg(e,t){var n;if(("("==e.name||e.type.isError)&&(e=e.parent||e),"ArgList"!=e.name)return!1;let i=null===(n=e.parent)||void 0===n?void 0:n.firstChild;return"Callee"==(null==i?void 0:i.name)&&"var"==t.sliceString(i.from,i.to)}const VariablesByNode=new NodeWeakMap,declSelector=["Declaration"];function astTop(e){for(let t=e;;){if(t.type.isTop)return t;if(!(t=t.parent))return e}}function variableNames(e,t,n){if(t.to-t.from>4096){let i=VariablesByNode.get(t);if(i)return i;let r=[],s=new Set,o=t.cursor(IterMode.IncludeAnonymous);if(o.firstChild())do{for(let t of variableNames(e,o.node,n))s.has(t.label)||(s.add(t.label),r.push(t))}while(o.nextSibling());return VariablesByNode.set(t,r),r}{let i=[],r=new Set;return t.cursor().iterate((t=>{var s;if(n(t)&&t.matchContext(declSelector)&&":"==(null===(s=t.node.nextSibling)||void 0===s?void 0:s.name)){let n=e.sliceString(t.from,t.to);r.has(n)||(r.add(n),i.push({label:n,type:"variable"}))}})),i}}const defineCSSCompletionSource=e=>t=>{let{state:n,pos:i}=t,r=syntaxTree(n).resolveInner(i,-1),s=r.type.isError&&r.from==r.to-1&&"-"==n.doc.sliceString(r.from,r.to);if("PropertyName"==r.name||(s||"TagName"==r.name)&&/^(Block|Styles)$/.test(r.resolve(r.to).name))return{from:r.from,options:properties(),validFor:identifier$1};if("ValueName"==r.name)return{from:r.from,options:values,validFor:identifier$1};if("PseudoClassName"==r.name)return{from:r.from,options:pseudoClasses,validFor:identifier$1};if(e(r)||(t.explicit||s)&&isVarArg(r,n.doc))return{from:e(r)||s?r.from:i,options:variableNames(n.doc,astTop(r),e),validFor:variable};if("TagName"==r.name){for(let{parent:e}=r;e;e=e.parent)if("Block"==e.name)return{from:r.from,options:properties(),validFor:identifier$1};return{from:r.from,options:tags,validFor:identifier$1}}if(!t.explicit)return null;let o=r.resolve(i),a=o.childBefore(i);return a&&":"==a.name&&"PseudoClassSelector"==o.name?{from:i,options:pseudoClasses,validFor:identifier$1}:a&&":"==a.name&&"Declaration"==o.name||"ArgList"==o.name?{from:i,options:values,validFor:identifier$1}:"Block"==o.name||"Styles"==o.name?{from:i,options:properties(),validFor:identifier$1}:null},cssCompletionSource=defineCSSCompletionSource((e=>"VariableName"==e.name)),cssLanguage=LRLanguage.define({name:"css",parser:parser$1.configure({props:[indentNodeProp.add({Declaration:continuedIndent()}),foldNodeProp.add({"Block KeyframeList":foldInside})]}),languageData:{commentTokens:{block:{open:"/*",close:"*/"}},indentOnInput:/^\s*\}$/,wordChars:"-"}});function css(){return new LanguageSupport(cssLanguage,cssLanguage.data.of({autocomplete:cssCompletionSource}))}const noSemi=309,incdec=1,incdecPrefix=2,JSXStartTag=3,insertSemi=310,spaces=312,newline=313,LineComment=4,BlockComment=5,Dialect_jsx=0,space=[9,10,11,12,13,32,133,160,5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8239,8287,12288],braceR=125,semicolon=59,slash=47,star=42,plus=43,minus=45,lt=60,comma=44,trackNewline=new ContextTracker({start:!1,shift:(e,t)=>t==LineComment||t==BlockComment||t==spaces?e:t==newline,strict:!1}),insertSemicolon=new ExternalTokenizer(((e,t)=>{let{next:n}=e;(n==braceR||-1==n||t.context)&&e.acceptToken(insertSemi)}),{contextual:!0,fallback:!0}),noSemicolon=new ExternalTokenizer(((e,t)=>{let n,{next:i}=e;space.indexOf(i)>-1||(i!=slash||(n=e.peek(1))!=slash&&n!=star)&&(i==braceR||i==semicolon||-1==i||t.context||e.acceptToken(noSemi))}),{contextual:!0}),incdecToken=new ExternalTokenizer(((e,t)=>{let{next:n}=e;if((n==plus||n==minus)&&(e.advance(),n==e.next)){e.advance();let n=!t.context&&t.canShift(incdec);e.acceptToken(n?incdec:incdecPrefix)}}),{contextual:!0});function identifierChar(e,t){return e>=65&&e<=90||e>=97&&e<=122||95==e||e>=192||!t&&e>=48&&e<=57}const jsx=new ExternalTokenizer(((e,t)=>{if(e.next!=lt||!t.dialectEnabled(Dialect_jsx))return;if(e.advance(),e.next==slash)return;let n=0;for(;space.indexOf(e.next)>-1;)e.advance(),n++;if(identifierChar(e.next,!0)){for(e.advance(),n++;identifierChar(e.next,!1);)e.advance(),n++;for(;space.indexOf(e.next)>-1;)e.advance(),n++;if(e.next==comma)return;for(let t=0;;t++){if(7==t){if(!identifierChar(e.next,!0))return;break}if(e.next!="extends".charCodeAt(t))break;e.advance(),n++}}e.acceptToken(JSXStartTag,-n)})),jsHighlight=styleTags({"get set async static":tags$1.modifier,"for while do if else switch try catch finally return throw break continue default case":tags$1.controlKeyword,"in of await yield void typeof delete instanceof":tags$1.operatorKeyword,"let var const using function class extends":tags$1.definitionKeyword,"import export from":tags$1.moduleKeyword,"with debugger as new":tags$1.keyword,TemplateString:tags$1.special(tags$1.string),super:tags$1.atom,BooleanLiteral:tags$1.bool,this:tags$1.self,null:tags$1.null,Star:tags$1.modifier,VariableName:tags$1.variableName,"CallExpression/VariableName TaggedTemplateExpression/VariableName":tags$1.function(tags$1.variableName),VariableDefinition:tags$1.definition(tags$1.variableName),Label:tags$1.labelName,PropertyName:tags$1.propertyName,PrivatePropertyName:tags$1.special(tags$1.propertyName),"CallExpression/MemberExpression/PropertyName":tags$1.function(tags$1.propertyName),"FunctionDeclaration/VariableDefinition":tags$1.function(tags$1.definition(tags$1.variableName)),"ClassDeclaration/VariableDefinition":tags$1.definition(tags$1.className),PropertyDefinition:tags$1.definition(tags$1.propertyName),PrivatePropertyDefinition:tags$1.definition(tags$1.special(tags$1.propertyName)),UpdateOp:tags$1.updateOperator,"LineComment Hashbang":tags$1.lineComment,BlockComment:tags$1.blockComment,Number:tags$1.number,String:tags$1.string,Escape:tags$1.escape,ArithOp:tags$1.arithmeticOperator,LogicOp:tags$1.logicOperator,BitOp:tags$1.bitwiseOperator,CompareOp:tags$1.compareOperator,RegExp:tags$1.regexp,Equals:tags$1.definitionOperator,Arrow:tags$1.function(tags$1.punctuation),": Spread":tags$1.punctuation,"( )":tags$1.paren,"[ ]":tags$1.squareBracket,"{ }":tags$1.brace,"InterpolationStart InterpolationEnd":tags$1.special(tags$1.brace),".":tags$1.derefOperator,", ;":tags$1.separator,"@":tags$1.meta,TypeName:tags$1.typeName,TypeDefinition:tags$1.definition(tags$1.typeName),"type enum interface implements namespace module declare":tags$1.definitionKeyword,"abstract global Privacy readonly override":tags$1.modifier,"is keyof unique infer":tags$1.operatorKeyword,JSXAttributeValue:tags$1.attributeValue,JSXText:tags$1.content,"JSXStartTag JSXStartCloseTag JSXSelfCloseEndTag JSXEndTag":tags$1.angleBracket,"JSXIdentifier JSXNameSpacedName":tags$1.tagName,"JSXAttribute/JSXIdentifier JSXAttribute/JSXNameSpacedName":tags$1.attributeName,"JSXBuiltin/JSXIdentifier":tags$1.standard(tags$1.tagName)}),spec_identifier={__proto__:null,export:18,as:23,from:31,default:34,async:39,function:40,extends:52,this:56,true:64,false:64,null:76,void:80,typeof:84,super:102,new:136,delete:152,yield:161,await:165,class:170,public:227,private:227,protected:227,readonly:229,instanceof:248,satisfies:251,in:252,const:254,import:286,keyof:339,unique:343,infer:349,is:385,abstract:405,implements:407,type:409,let:412,var:414,using:417,interface:423,enum:427,namespace:433,module:435,declare:439,global:443,for:462,of:471,while:474,with:478,do:482,if:486,else:488,switch:492,case:498,try:504,catch:508,finally:512,return:516,throw:520,break:524,continue:528,debugger:532},spec_word={__proto__:null,async:123,get:125,set:127,declare:187,public:189,private:189,protected:189,static:191,abstract:193,override:195,readonly:201,accessor:203,new:389},spec_LessThan={__proto__:null,"<":143},parser=LRParser.deserialize({version:14,states:"$<UO%TQ^OOO%[Q^OOO'_Q`OOP(lOWOOO*zQ08SO'#ChO+RO!bO'#CiO+aO#tO'#CiO+oO?MpO'#D^O.QQ^O'#DdO.bQ^O'#DoO%[Q^O'#DyO0fQ^O'#EROOQ07b'#EZ'#EZO1PQWO'#EWOOQO'#El'#ElOOQO'#Ie'#IeO1XQWO'#GmO1dQWO'#EkO1iQWO'#EkO3kQ08SO'#JiO6[Q08SO'#JjO6xQWO'#FZO6}Q&jO'#FqOOQ07b'#Fc'#FcO7YO,YO'#FcO7hQ7[O'#FxO9UQWO'#FwOOQ07b'#Jj'#JjOOQ07`'#Ji'#JiO9ZQWO'#GqOOQU'#KU'#KUO9fQWO'#IRO9kQ07hO'#ISOOQU'#JW'#JWOOQU'#IW'#IWQ`Q^OOO`Q^OOO%[Q^O'#DqO9sQ^O'#D}O9zQ^O'#EPO9aQWO'#GmO:RQ7[O'#CnO:aQWO'#EjO:lQWO'#EuO:qQ7[O'#FbO;`QWO'#GmOOQO'#KV'#KVO;eQWO'#KVO;sQWO'#GuO;sQWO'#GvO;sQWO'#GxO9aQWO'#G{O<jQWO'#HOO>RQWO'#CdO>cQWO'#H[O>kQWO'#HbO>kQWO'#HdO`Q^O'#HfO>kQWO'#HhO>kQWO'#HkO>pQWO'#HqO>uQ07iO'#HwO%[Q^O'#HyO?QQ07iO'#H{O?]Q07iO'#H}O9kQ07hO'#IPO?hQ08SO'#ChO@jQ`O'#DiQOQWOOO%[Q^O'#EPOAQQWO'#ESO:RQ7[O'#EjOA]QWO'#EjOAhQpO'#FbOOQU'#Cf'#CfOOQ07`'#Dn'#DnOOQ07`'#Jm'#JmO%[Q^O'#JmOOQO'#Jq'#JqOOQO'#Ib'#IbOBhQ`O'#EcOOQ07`'#Eb'#EbOCdQ07pO'#EcOCnQ`O'#EVOOQO'#Jp'#JpODSQ`O'#JqOEaQ`O'#EVOCnQ`O'#EcPEnO!0LbO'#CaPOOO)CDu)CDuOOOO'#IX'#IXOEyO!bO,59TOOQ07b,59T,59TOOOO'#IY'#IYOFXO#tO,59TO%[Q^O'#D`OOOO'#I['#I[OFgO?MpO,59xOOQ07b,59x,59xOFuQ^O'#I]OGYQWO'#JkOI[QrO'#JkO+}Q^O'#JkOIcQWO,5:OOIyQWO'#ElOJWQWO'#JyOJcQWO'#JxOJcQWO'#JxOJkQWO,5;YOJpQWO'#JwOOQ07f,5:Z,5:ZOJwQ^O,5:ZOLxQ08SO,5:eOMiQWO,5:mONSQ07hO'#JvONZQWO'#JuO9ZQWO'#JuONoQWO'#JuONwQWO,5;XON|QWO'#JuO!#UQrO'#JjOOQ07b'#Ch'#ChO%[Q^O'#ERO!#tQpO,5:rOOQO'#Jr'#JrOOQO-E<c-E<cO9aQWO,5=XO!$[QWO,5=XO!$aQ^O,5;VO!&dQ7[O'#EgO!'}QWO,5;VO!)mQ7[O'#DsO!)tQ^O'#DxO!*OQ`O,5;`O!*WQ`O,5;`O%[Q^O,5;`OOQU'#FR'#FROOQU'#FT'#FTO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aO%[Q^O,5;aOOQU'#FX'#FXO!*fQ^O,5;rOOQ07b,5;w,5;wOOQ07b,5;x,5;xO!,iQWO,5;xOOQ07b,5;y,5;yO%[Q^O'#IiO!,qQ07hO,5<eO!&dQ7[O,5;aO!-`Q7[O,5;aO%[Q^O,5;uO!-gQ&jO'#FgO!.dQ&jO'#J}O!.OQ&jO'#J}O!.kQ&jO'#J}OOQO'#J}'#J}O!/PQ&jO,5<POOOS,5<],5<]O!/bQ^O'#FsOOOS'#Ih'#IhO7YO,YO,5;}O!/iQ&jO'#FuOOQ07b,5;},5;}O!0YQMhO'#CuOOQ07b'#Cy'#CyO!0mQWO'#CyO!0rO?MpO'#C}O!1`Q7[O,5<bO!1gQWO,5<dO!3SQ!LQO'#GSO!3aQWO'#GTO!3fQWO'#GTO!3kQ!LQO'#GXO!4jQ`O'#G]OOQO'#Gh'#GhO!(SQ7[O'#GgOOQO'#Gj'#GjO!(SQ7[O'#GiO!5]QMhO'#JdOOQ07b'#Jd'#JdO!5gQWO'#JcO!5uQWO'#JbO!5}QWO'#CtOOQ07b'#Cw'#CwOOQ07b'#DR'#DROOQ07b'#DT'#DTO1SQWO'#DVO!(SQ7[O'#FzO!(SQ7[O'#F|O!6VQWO'#GOO!6[QWO'#GPO!3fQWO'#GVO!(SQ7[O'#G[O!6aQWO'#EmO!7OQWO,5<cOOQ07`'#Cq'#CqO!7WQWO'#EnO!8QQ`O'#EoOOQ07`'#Jw'#JwO!8XQ07hO'#KWO9kQ07hO,5=]O`Q^O,5>mOOQU'#J`'#J`OOQU,5>n,5>nOOQU-E<U-E<UO!:ZQ08SO,5:]O!<wQ08SO,5:iO%[Q^O,5:iO!?bQ08SO,5:kOOQO,5@q,5@qO!@RQ7[O,5=XO!@aQ07hO'#JaO9UQWO'#JaO!@rQ07hO,59YO!@}Q`O,59YO!AVQ7[O,59YO:RQ7[O,59YO!AbQWO,5;VO!AjQWO'#HZO!BOQWO'#KZO%[Q^O,5;zO!7{Q`O,5;|O!BWQWO,5=tO!B]QWO,5=tO!BbQWO,5=tO9kQ07hO,5=tO;sQWO,5=dOOQO'#Cu'#CuO!BpQ`O,5=aO!BxQ7[O,5=bO!CTQWO,5=dO!CYQpO,5=gO!CbQWO'#KVO>pQWO'#HQO9aQWO'#HSO!CgQWO'#HSO:RQ7[O'#HUO!ClQWO'#HUOOQU,5=j,5=jO!CqQWO'#HVO!DSQWO'#CnO!DXQWO,59OO!DcQWO,59OO!FhQ^O,59OOOQU,59O,59OO!FxQ07hO,59OO%[Q^O,59OO!ITQ^O'#H^OOQU'#H_'#H_OOQU'#H`'#H`O`Q^O,5=vO!IkQWO,5=vO`Q^O,5=|O`Q^O,5>OO!IpQWO,5>QO`Q^O,5>SO!IuQWO,5>VO!IzQ^O,5>]OOQU,5>c,5>cO%[Q^O,5>cO9kQ07hO,5>eOOQU,5>g,5>gO!NUQWO,5>gOOQU,5>i,5>iO!NUQWO,5>iOOQU,5>k,5>kO!NZQ`O'#D[O%[Q^O'#JmO!NxQ`O'#JmO# gQ`O'#DjO# xQ`O'#DjO#$ZQ^O'#DjO#$bQWO'#JlO#$jQWO,5:TO#$oQWO'#EpO#$}QWO'#JzO#%VQWO,5;ZO#%[Q`O'#DjO#%iQ`O'#EUOOQ07b,5:n,5:nO%[Q^O,5:nO#%pQWO,5:nO>pQWO,5;UO!@}Q`O,5;UO!AVQ7[O,5;UO:RQ7[O,5;UO#%xQWO,5@XO#%}Q$ISO,5:rOOQO-E<`-E<`O#'TQ07pO,5:}OCnQ`O,5:qO#'_Q`O,5:qOCnQ`O,5:}O!@rQ07hO,5:qOOQ07`'#Ef'#EfOOQO,5:},5:}O%[Q^O,5:}O#'lQ07hO,5:}O#'wQ07hO,5:}O!@}Q`O,5:qOOQO,5;T,5;TO#(VQ07hO,5:}POOO'#IV'#IVP#(kO!0LbO,58{POOO,58{,58{OOOO-E<V-E<VOOQ07b1G.o1G.oOOOO-E<W-E<WO#(vQpO,59zOOOO-E<Y-E<YOOQ07b1G/d1G/dO#({QrO,5>wO+}Q^O,5>wOOQO,5>},5>}O#)VQ^O'#I]OOQO-E<Z-E<ZO#)dQWO,5@VO#)lQrO,5@VO#)sQWO,5@dOOQ07b1G/j1G/jO%[Q^O,5@eO#){QWO'#IcOOQO-E<a-E<aO#)sQWO,5@dOOQ07`1G0t1G0tOOQ07f1G/u1G/uOOQ07f1G0X1G0XO%[Q^O,5@bO#*aQ07hO,5@bO#*rQ07hO,5@bO#*yQWO,5@aO9ZQWO,5@aO#+RQWO,5@aO#+aQWO'#IfO#*yQWO,5@aOOQ07`1G0s1G0sO!*OQ`O,5:tO!*ZQ`O,5:tOOQO,5:v,5:vO#,RQWO,5:vO#,ZQ7[O1G2sO9aQWO1G2sOOQ07b1G0q1G0qO#,iQ08SO1G0qO#-nQ08QO,5;ROOQ07b'#GR'#GRO#.[Q08SO'#JdO!$aQ^O1G0qO#0dQ7[O'#JnO#0nQWO,5:_O#0sQrO'#JoO%[Q^O'#JoO#0}QWO,5:dOOQ07b'#D['#D[OOQ07b1G0z1G0zO%[Q^O1G0zOOQ07b1G1d1G1dO#1SQWO1G0zO#3kQ08SO1G0{O#3rQ08SO1G0{O#6]Q08SO1G0{O#6dQ08SO1G0{O#8nQ08SO1G0{O#9UQ08SO1G0{O#<OQ08SO1G0{O#<VQ08SO1G0{O#>pQ08SO1G0{O#>wQ08SO1G0{O#@oQ08SO1G0{O#CoQ(CYO'#ChO#EmQ(CYO1G1^O#EtQ(CYO'#JjO!,lQWO1G1dO#FUQ08SO,5?TOOQ07`-E<g-E<gO#FxQ08SO1G0{OOQ07b1G0{1G0{O#ITQ08SO1G1aO#IwQ&jO,5<TO#JPQ&jO,5<UO#JXQ&jO'#FlO#JpQWO'#FkOOQO'#KO'#KOOOQO'#Ig'#IgO#JuQ&jO1G1kOOQ07b1G1k1G1kOOOS1G1v1G1vO#KWQ(CYO'#JiO#KbQWO,5<_O!*fQ^O,5<_OOOS-E<f-E<fOOQ07b1G1i1G1iO#KgQ`O'#J}OOQ07b,5<a,5<aO#KoQ`O,5<aOOQ07b,59e,59eO!&dQ7[O'#DPOOOO'#IZ'#IZO#KtO?MpO,59iOOQ07b,59i,59iO%[Q^O1G1|O!6[QWO'#IkO#LPQ7[O,5<uOOQ07b,5<r,5<rO!(SQ7[O'#InO#LoQ7[O,5=RO!(SQ7[O'#IpO#MbQ7[O,5=TO!&dQ7[O,5=VOOQO1G2O1G2OO#MlQpO'#CqO#NPQpO,5<nO#NWQWO'#KRO9aQWO'#KRO#NfQWO,5<pO!(SQ7[O,5<oO#NkQWO'#GUO#NvQWO,5<oO#N{QpO'#GRO$ YQpO'#KSO$ dQWO'#KSO!&dQ7[O'#KSO$ iQWO,5<sO$ nQ`O'#G^O!4eQ`O'#G^O$!PQWO'#G`O$!UQWO'#GbO!3fQWO'#GeO$!ZQ07hO'#ImO$!fQ`O,5<wOOQ07f,5<w,5<wO$!mQ`O'#G^O$!{Q`O'#G_O$#TQ`O'#G_O$#YQ7[O,5=RO$#jQ7[O,5=TOOQ07b,5=W,5=WO!(SQ7[O,5?}O!(SQ7[O,5?}O$#zQWO'#IrO$$VQWO,5?|O$$_QWO,59`O$%OQ7[O,59qOOQ07b,59q,59qO$%qQ7[O,5<fO$&dQ7[O,5<hO@bQWO,5<jOOQ07b,5<k,5<kO$&nQWO,5<qO$&sQ7[O,5<vO$'TQWO'#JuO!$aQ^O1G1}O$'YQWO1G1}O9ZQWO'#JxO9ZQWO'#EpO%[Q^O'#EpO9ZQWO'#ItO$'_Q07hO,5@rOOQU1G2w1G2wOOQU1G4X1G4XOOQ07b1G/w1G/wO!,iQWO1G/wO$)dQ08SO1G0TOOQU1G2s1G2sO!&dQ7[O1G2sO%[Q^O1G2sO#,^QWO1G2sO$+hQ7[O'#EgOOQ07`,5?{,5?{O$+rQ07hO,5?{OOQU1G.t1G.tO!@rQ07hO1G.tO!@}Q`O1G.tO!AVQ7[O1G.tO$,TQWO1G0qO$,YQWO'#ChO$,eQWO'#K[O$,mQWO,5=uO$,rQWO'#K[O$,wQWO'#K[O$-VQWO'#IzO$-eQWO,5@uO$-mQrO1G1fOOQ07b1G1h1G1hO9aQWO1G3`O@bQWO1G3`O$-tQWO1G3`O$-yQWO1G3`OOQU1G3`1G3`O!CTQWO1G3OO!&dQ7[O1G2{O$.OQWO1G2{OOQU1G2|1G2|O!&dQ7[O1G2|O$.TQWO1G2|O$.]Q`O'#GzOOQU1G3O1G3OO!4eQ`O'#IvO!CYQpO1G3ROOQU1G3R1G3ROOQU,5=l,5=lO$.eQ7[O,5=nO9aQWO,5=nO$!UQWO,5=pO9UQWO,5=pO!@}Q`O,5=pO!AVQ7[O,5=pO:RQ7[O,5=pO$.sQWO'#KYO$/OQWO,5=qOOQU1G.j1G.jO$/TQ07hO1G.jO@bQWO1G.jO$/`QWO1G.jO9kQ07hO1G.jO$1eQrO,5@wO$1uQWO,5@wO9ZQWO,5@wO$2QQ^O,5=xO$2XQWO,5=xOOQU1G3b1G3bO`Q^O1G3bOOQU1G3h1G3hOOQU1G3j1G3jO>kQWO1G3lO$2^Q^O1G3nO$6bQ^O'#HmOOQU1G3q1G3qO$6oQWO'#HsO>pQWO'#HuOOQU1G3w1G3wO$6wQ^O1G3wO9kQ07hO1G3}OOQU1G4P1G4POOQ07`'#GY'#GYO9kQ07hO1G4RO9kQ07hO1G4TO$;OQWO,5@XO!*fQ^O,5;[O9ZQWO,5;[O>pQWO,5:UO!*fQ^O,5:UO!@}Q`O,5:UO$;TQ(CYO,5:UOOQO,5;[,5;[O$;_Q`O'#I^O$;uQWO,5@WOOQ07b1G/o1G/oO$;}Q`O'#IdO$<XQWO,5@fOOQ07`1G0u1G0uO# xQ`O,5:UOOQO'#Ia'#IaO$<aQ`O,5:pOOQ07f,5:p,5:pO#%sQWO1G0YOOQ07b1G0Y1G0YO%[Q^O1G0YOOQ07b1G0p1G0pO>pQWO1G0pO!@}Q`O1G0pO!AVQ7[O1G0pOOQ07`1G5s1G5sO!@rQ07hO1G0]OOQO1G0i1G0iO%[Q^O1G0iO$<hQ07hO1G0iO$<sQ07hO1G0iO!@}Q`O1G0]OCnQ`O1G0]O$=RQ07hO1G0iOOQO1G0]1G0]O$=gQ08SO1G0iPOOO-E<T-E<TPOOO1G.g1G.gOOOO1G/f1G/fO$=qQpO,5<eO$=yQrO1G4cOOQO1G4i1G4iO%[Q^O,5>wO$>TQWO1G5qO$>]QWO1G6OO$>eQrO1G6PO9ZQWO,5>}O$>oQ08SO1G5|O%[Q^O1G5|O$?PQ07hO1G5|O$?bQWO1G5{O$?bQWO1G5{O9ZQWO1G5{O$?jQWO,5?QO9ZQWO,5?QOOQO,5?Q,5?QO$@OQWO,5?QO$'TQWO,5?QOOQO-E<d-E<dOOQO1G0`1G0`OOQO1G0b1G0bO!,lQWO1G0bOOQU7+(_7+(_O!&dQ7[O7+(_O%[Q^O7+(_O$@^QWO7+(_O$@iQ7[O7+(_O$@wQ08SO,5=RO$CSQ08SO,5=TO$E_Q08SO,5=RO$GpQ08SO,5=TO$JRQ08SO,59qO$LZQ08SO,5<fO$NfQ08SO,5<hO%!qQ08SO,5<vOOQ07b7+&]7+&]O%%SQ08SO7+&]O%%vQ7[O'#I_O%&QQWO,5@YOOQ07b1G/y1G/yO%&YQ^O'#I`O%&gQWO,5@ZO%&oQrO,5@ZOOQ07b1G0O1G0OO%&yQWO7+&fOOQ07b7+&f7+&fO%'OQ(CYO,5:eO%[Q^O7+&xO%'YQ(CYO,5:]O%'gQ(CYO,5:iO%'qQ(CYO,5:kOOQ07b7+'O7+'OOOQO1G1o1G1oOOQO1G1p1G1pO%'{QtO,5<WO!*fQ^O,5<VOOQO-E<e-E<eOOQ07b7+'V7+'VOOOS7+'b7+'bOOOS1G1y1G1yO%(WQWO1G1yOOQ07b1G1{1G1{O%(]QpO,59kOOOO-E<X-E<XOOQ07b1G/T1G/TO%(dQ08SO7+'hOOQ07b,5?V,5?VO%)WQpO,5?VOOQ07b1G2a1G2aP!&dQ7[O'#IkPOQ07b-E<i-E<iO%)vQ7[O,5?YOOQ07b-E<l-E<lO%*iQ7[O,5?[OOQ07b-E<n-E<nO%*sQpO1G2qOOQ07b1G2Y1G2YO%*zQWO'#IjO%+YQWO,5@mO%+YQWO,5@mO%+bQWO,5@mO%+mQWO,5@mOOQO1G2[1G2[O%+{Q7[O1G2ZO!(SQ7[O1G2ZO%,]Q!LQO'#IlO%,mQWO,5@nO!&dQ7[O,5@nO%,uQpO,5@nOOQ07b1G2_1G2_OOQ07`,5<x,5<xOOQ07`,5<y,5<yO$'TQWO,5<yOC_QWO,5<yO!@}Q`O,5<xOOQO'#Ga'#GaO%-PQWO,5<zOOQ07`,5<|,5<|O$'TQWO,5=POOQO,5?X,5?XOOQO-E<k-E<kOOQ07f1G2c1G2cO!4eQ`O,5<xO%-XQWO,5<yO$!PQWO,5<zO!4eQ`O,5<yO!(SQ7[O'#InO%-{Q7[O1G2mO!(SQ7[O'#IpO%.nQ7[O1G2oO%.xQ7[O1G5iO%/SQ7[O1G5iOOQO,5?^,5?^OOQO-E<p-E<pOOQO1G.z1G.zO!7{Q`O,59sO%[Q^O,59sO%/aQWO1G2UO!(SQ7[O1G2]O%/fQ08SO7+'iOOQ07b7+'i7+'iO!$aQ^O7+'iO%0YQWO,5;[OOQ07`,5?`,5?`OOQ07`-E<r-E<rOOQ07b7+%c7+%cO%0_QpO'#KTO#%sQWO7+(_O%0iQrO7+(_O$@aQWO7+(_O%0pQ08QO'#ChO%1TQ08QO,5<}O%1uQWO,5<}OOQ07`1G5g1G5gOOQU7+$`7+$`O!@rQ07hO7+$`O!@}Q`O7+$`O!$aQ^O7+&]O%1zQWO'#IyO%2cQWO,5@vOOQO1G3a1G3aO9aQWO,5@vO%2cQWO,5@vO%2kQWO,5@vOOQO,5?f,5?fOOQO-E<x-E<xOOQ07b7+'Q7+'QO%2pQWO7+(zO9kQ07hO7+(zO9aQWO7+(zO@bQWO7+(zOOQU7+(j7+(jO%2uQ08QO7+(gO!&dQ7[O7+(gO%3PQpO7+(hOOQU7+(h7+(hO!&dQ7[O7+(hO%3WQWO'#KXO%3cQWO,5=fOOQO,5?b,5?bOOQO-E<t-E<tOOQU7+(m7+(mO%4rQ`O'#HTOOQU1G3Y1G3YO!&dQ7[O1G3YO%[Q^O1G3YO%4yQWO1G3YO%5UQ7[O1G3YO9kQ07hO1G3[O$!UQWO1G3[O9UQWO1G3[O!@}Q`O1G3[O!AVQ7[O1G3[O%5dQWO'#IxO%5xQWO,5@tO%6QQ`O,5@tOOQ07`1G3]1G3]OOQU7+$U7+$UO@bQWO7+$UO9kQ07hO7+$UO%6]QWO7+$UO%[Q^O1G6cO%[Q^O1G6dO%6bQ07hO1G6cO%6lQ^O1G3dO%6sQWO1G3dO%6xQ^O1G3dOOQU7+(|7+(|O9kQ07hO7+)WO`Q^O7+)YOOQU'#K_'#K_OOQU'#I{'#I{O%7PQ^O,5>XOOQU,5>X,5>XO%[Q^O'#HnO%7^QWO'#HpOOQU,5>_,5>_O9ZQWO,5>_OOQU,5>a,5>aOOQU7+)c7+)cOOQU7+)i7+)iOOQU7+)m7+)mOOQU7+)o7+)oO%7cQ`O1G5sO%7wQ(CYO1G0vO%8RQWO1G0vOOQO1G/p1G/pO%8^Q(CYO1G/pO>pQWO1G/pO!*fQ^O'#DjOOQO,5>x,5>xOOQO-E<[-E<[OOQO,5?O,5?OOOQO-E<b-E<bO!@}Q`O1G/pOOQO-E<_-E<_OOQ07f1G0[1G0[OOQ07b7+%t7+%tO#%sQWO7+%tOOQ07b7+&[7+&[O>pQWO7+&[O!@}Q`O7+&[OOQO7+%w7+%wO$=gQ08SO7+&TOOQO7+&T7+&TO%[Q^O7+&TO%8hQ07hO7+&TO!@rQ07hO7+%wO!@}Q`O7+%wO%8sQ07hO7+&TO%9RQ08SO7++hO%[Q^O7++hO%9cQWO7++gO%9cQWO7++gOOQO1G4l1G4lO9ZQWO1G4lO%9kQWO1G4lOOQO7+%|7+%|O#%sQWO<<KyO%0iQrO<<KyO%9yQWO<<KyOOQU<<Ky<<KyO!&dQ7[O<<KyO%[Q^O<<KyO%:RQWO<<KyO%:^Q08SO,5?YO%<iQ08SO,5?[O%>tQ08SO1G2ZO%AVQ08SO1G2mO%CbQ08SO1G2oO%EmQ7[O,5>yOOQO-E<]-E<]O%EwQrO,5>zO%[Q^O,5>zOOQO-E<^-E<^O%FRQWO1G5uOOQ07b<<JQ<<JQO%FZQ(CYO1G0qO%HeQ(CYO1G0{O%HlQ(CYO1G0{O%JpQ(CYO1G0{O%JwQ(CYO1G0{O%LlQ(CYO1G0{O%MSQ(CYO1G0{O& gQ(CYO1G0{O& nQ(CYO1G0{O&#rQ(CYO1G0{O&#yQ(CYO1G0{O&%qQ(CYO1G0{O&&UQ08SO<<JdO&'ZQ(CYO1G0{O&)PQ(CYO'#JdO&+SQ(CYO1G1aO&+aQ(CYO1G0TO!*fQ^O'#FnOOQO'#KP'#KPOOQO1G1r1G1rO&+kQWO1G1qO&+pQ(CYO,5?TOOOS7+'e7+'eOOOO1G/V1G/VOOQ07b1G4q1G4qO!(SQ7[O7+(]O&+zQWO,5?UO9aQWO,5?UOOQO-E<h-E<hO&,YQWO1G6XO&,YQWO1G6XO&,bQWO1G6XO&,mQ7[O7+'uO&,}QpO,5?WO&-XQWO,5?WO!&dQ7[O,5?WOOQO-E<j-E<jO&-^QpO1G6YO&-hQWO1G6YOOQ07`1G2e1G2eO$'TQWO1G2eOOQ07`1G2d1G2dO&-pQWO1G2fO!&dQ7[O1G2fOOQ07`1G2k1G2kO!@}Q`O1G2dOC_QWO1G2eO&-uQWO1G2fO&-}QWO1G2eO&.qQ7[O,5?YOOQ07b-E<m-E<mO&/dQ7[O,5?[OOQ07b-E<o-E<oO!(SQ7[O7++TOOQ07b1G/_1G/_O&/nQWO1G/_OOQ07b7+'p7+'pO&/sQ7[O7+'wO&0TQ08SO<<KTOOQ07b<<KT<<KTO&0wQWO1G0vO!&dQ7[O'#IsO&0|QWO,5@oO!&dQ7[O1G2iOOQU<<Gz<<GzO!@rQ07hO<<GzO&1UQ08SO<<IwOOQ07b<<Iw<<IwOOQO,5?e,5?eO&1xQWO,5?eO&1}QWO,5?eOOQO-E<w-E<wO&2]QWO1G6bO&2]QWO1G6bO9aQWO1G6bO@bQWO<<LfOOQU<<Lf<<LfO&2eQWO<<LfO9kQ07hO<<LfOOQU<<LR<<LRO%2uQ08QO<<LROOQU<<LS<<LSO%3PQpO<<LSO&2jQ`O'#IuO&2uQWO,5@sO!*fQ^O,5@sOOQU1G3Q1G3QO&2}Q^O'#JmOOQO'#Iw'#IwO9kQ07hO'#IwO&3XQ`O,5=oOOQU,5=o,5=oO&3`Q`O'#EcO&3tQWO7+(tO&3yQWO7+(tOOQU7+(t7+(tO!&dQ7[O7+(tO%[Q^O7+(tO&4RQWO7+(tOOQU7+(v7+(vO9kQ07hO7+(vO$!UQWO7+(vO9UQWO7+(vO!@}Q`O7+(vO&4^QWO,5?dOOQO-E<v-E<vOOQO'#HW'#HWO&4iQWO1G6`O9kQ07hO<<GpOOQU<<Gp<<GpO@bQWO<<GpO&4qQWO7++}O&4vQWO7+,OO%[Q^O7++}O%[Q^O7+,OOOQU7+)O7+)OO&4{QWO7+)OO&5QQ^O7+)OO&5XQWO7+)OOOQU<<Lr<<LrOOQU<<Lt<<LtOOQU-E<y-E<yOOQU1G3s1G3sO&5^QWO,5>YOOQU,5>[,5>[O&5cQWO1G3yO9ZQWO7+&bO!*fQ^O7+&bOOQO7+%[7+%[O&5hQ(CYO1G6PO>pQWO7+%[OOQ07b<<I`<<I`OOQ07b<<Iv<<IvO>pQWO<<IvOOQO<<Io<<IoO$=gQ08SO<<IoO%[Q^O<<IoOOQO<<Ic<<IcO!@rQ07hO<<IcO&5rQ07hO<<IoO&5}Q08SO<= SO&6_QWO<= ROOQO7+*W7+*WO9ZQWO7+*WOOQUANAeANAeO&6gQWOANAeO!&dQ7[OANAeO#%sQWOANAeO%0iQrOANAeO%[Q^OANAeO&6oQ08SO7+'uO&9QQ08SO,5?YO&;]Q08SO,5?[O&=hQ08SO7+'wO&?yQrO1G4fO&@TQ(CYO7+&]O&BXQ(CYO,5=RO&D`Q(CYO,5=TO&DpQ(CYO,5=RO&EQQ(CYO,5=TO&EbQ(CYO,59qO&GeQ(CYO,5<fO&IhQ(CYO,5<hO&KkQ(CYO,5<vO&MaQ(CYO7+'hO&MnQ(CYO7+'iO&M{QWO,5<YOOQO7+']7+']O&NQQ7[O<<KwOOQO1G4p1G4pO&NXQWO1G4pO&NdQWO1G4pO&NrQWO7++sO&NrQWO7++sO!&dQ7[O1G4rO&NzQpO1G4rO' UQWO7++tOOQ07`7+(P7+(PO$'TQWO7+(QO' ^QpO7+(QOOQ07`7+(O7+(OO$'TQWO7+(PO' eQWO7+(QO!&dQ7[O7+(QOC_QWO7+(PO' jQ7[O<<NoOOQ07b7+$y7+$yO' tQpO,5?_OOQO-E<q-E<qO'!OQ08QO7+(TOOQUAN=fAN=fO9aQWO1G5POOQO1G5P1G5PO'!`QWO1G5PO'!eQWO7++|O'!eQWO7++|O9kQ07hOANBQO@bQWOANBQOOQUANBQANBQOOQUANAmANAmOOQUANAnANAnO'!mQWO,5?aOOQO-E<s-E<sO'!xQ(CYO1G6_O'%YQrO'#ChOOQO,5?c,5?cOOQO-E<u-E<uOOQU1G3Z1G3ZO&2}Q^O,5<zOOQU<<L`<<L`O!&dQ7[O<<L`O&3tQWO<<L`O'%dQWO<<L`O%[Q^O<<L`OOQU<<Lb<<LbO9kQ07hO<<LbO$!UQWO<<LbO9UQWO<<LbO'%lQ`O1G5OO'%wQWO7++zOOQUAN=[AN=[O9kQ07hOAN=[OOQU<= i<= iOOQU<= j<= jO'&PQWO<= iO'&UQWO<= jOOQU<<Lj<<LjO'&ZQWO<<LjO'&`Q^O<<LjOOQU1G3t1G3tO>pQWO7+)eO'&gQWO<<I|O'&rQ(CYO<<I|OOQO<<Hv<<HvOOQ07bAN?bAN?bOOQOAN?ZAN?ZO$=gQ08SOAN?ZOOQOAN>}AN>}O%[Q^OAN?ZOOQO<<Mr<<MrOOQUG27PG27PO!&dQ7[OG27PO#%sQWOG27PO'&|QWOG27PO%0iQrOG27PO''UQ(CYO<<JdO''cQ(CYO1G2ZO')XQ(CYO,5?YO'+[Q(CYO,5?[O'-_Q(CYO1G2mO'/bQ(CYO1G2oO'1eQ(CYO<<KTO'1rQ(CYO<<IwOOQO1G1t1G1tO!(SQ7[OANAcOOQO7+*[7+*[O'2PQWO7+*[O'2[QWO<= _O'2dQpO7+*^OOQ07`<<Kl<<KlO$'TQWO<<KlOOQ07`<<Kk<<KkO'2nQpO<<KlO$'TQWO<<KkOOQO7+*k7+*kO9aQWO7+*kO'2uQWO<= hOOQUG27lG27lO9kQ07hOG27lO!*fQ^O1G4{O'2}QWO7++yO&3tQWOANAzOOQUANAzANAzO!&dQ7[OANAzO'3VQWOANAzOOQUANA|ANA|O9kQ07hOANA|O$!UQWOANA|OOQO'#HX'#HXOOQO7+*j7+*jOOQUG22vG22vOOQUANETANETOOQUANEUANEUOOQUANBUANBUO'3_QWOANBUOOQU<<MP<<MPO!*fQ^OAN?hOOQOG24uG24uO$=gQ08SOG24uO#%sQWOLD,kOOQULD,kLD,kO!&dQ7[OLD,kO'3dQWOLD,kO'3lQ(CYO7+'uO'5bQ(CYO,5?YO'7eQ(CYO,5?[O'9hQ(CYO7+'wO';^Q7[OG26}OOQO<<Mv<<MvOOQ07`ANAWANAWO$'TQWOANAWOOQ07`ANAVANAVOOQO<<NV<<NVOOQULD-WLD-WO';nQ(CYO7+*gOOQUG27fG27fO&3tQWOG27fO!&dQ7[OG27fOOQUG27hG27hO9kQ07hOG27hOOQUG27pG27pO';xQ(CYOG25SOOQOLD*aLD*aOOQU!$(!V!$(!VO#%sQWO!$(!VO!&dQ7[O!$(!VO'<SQ08SOG26}OOQ07`G26rG26rOOQULD-QLD-QO&3tQWOLD-QOOQULD-SLD-SOOQU!)9Eq!)9EqO#%sQWO!)9EqOOQU!$(!l!$(!lOOQU!.K;]!.K;]O'>eQ(CYOG26}O!*fQ^O'#DyO1PQWO'#EWO'@ZQrO'#JiO!*fQ^O'#DqO'@bQ^O'#D}O'@iQrO'#ChO'CPQrO'#ChO!*fQ^O'#EPO'CaQ^O,5;VO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O,5;aO!*fQ^O'#IiO'EdQWO,5<eO'ElQ7[O,5;aO'GVQ7[O,5;aO!*fQ^O,5;uO!&dQ7[O'#GgO'ElQ7[O'#GgO!&dQ7[O'#GiO'ElQ7[O'#GiO1SQWO'#DVO1SQWO'#DVO!&dQ7[O'#FzO'ElQ7[O'#FzO!&dQ7[O'#F|O'ElQ7[O'#F|O!&dQ7[O'#G[O'ElQ7[O'#G[O!*fQ^O,5:iO!*fQ^O,5@eO'CaQ^O1G0qO'G^Q(CYO'#ChO!*fQ^O1G1|O!&dQ7[O'#InO'ElQ7[O'#InO!&dQ7[O'#IpO'ElQ7[O'#IpO!&dQ7[O,5<oO'ElQ7[O,5<oO'CaQ^O1G1}O!*fQ^O7+&xO!&dQ7[O1G2ZO'ElQ7[O1G2ZO!&dQ7[O'#InO'ElQ7[O'#InO!&dQ7[O'#IpO'ElQ7[O'#IpO!&dQ7[O1G2]O'ElQ7[O1G2]O'CaQ^O7+'iO'CaQ^O7+&]O!&dQ7[OANAcO'ElQ7[OANAcO'GhQWO'#EkO'GmQWO'#EkO'GuQWO'#FZO'GzQWO'#EuO'HPQWO'#JyO'H[QWO'#JwO'HgQWO,5;VO'HlQ7[O,5<bO'HsQWO'#GTO'HxQWO'#GTO'H}QWO,5<cO'IVQWO,5;VO'I_Q(CYO1G1^O'IfQWO,5<oO'IkQWO,5<oO'IpQWO,5<qO'IuQWO,5<qO'IzQWO1G1}O'JPQWO1G0qO'JUQ7[O<<KwO'J]Q7[O<<KwO7hQ7[O'#FxO9UQWO'#FwOA]QWO'#EjO!*fQ^O,5;rO!3fQWO'#GTO!3fQWO'#GTO!3fQWO'#GVO!3fQWO'#GVO!(SQ7[O7+(]O!(SQ7[O7+(]O%*sQpO1G2qO%*sQpO1G2qO!&dQ7[O,5=VO!&dQ7[O,5=V",stateData:"'Ka~O'tOS'uOSSOS'vRQ~OPYOQYORfOX!VO`qOczOdyOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![XO!fuO!kZO!nYO!oYO!pYO!rvO!twO!wxO!{]O#s!PO$T|O%b}O%d!QO%f!OO%g!OO%h!OO%k!RO%m!SO%p!TO%q!TO%s!UO&P!WO&V!XO&X!YO&Z!ZO&]![O&`!]O&f!^O&l!_O&n!`O&p!aO&r!bO&t!cO'{SO'}TO(QUO(XVO(g[O(tiO~OVtO~P`OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'{!dO'}TO(QUO(XVO(g[O(tiO~O`!vOo!nO!P!oO!_!xO!`!uO!a!uO!{:dO#P!pO#Q!pO#R!wO#S!pO#T!pO#W!yO#X!yO'|!lO'}TO(QUO([!mO(g!sO~O'v!zO~OP[XZ[X`[Xn[X|[X}[X!P[X!Y[X!h[X!i[X!k[X!o[X#[[X#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X'r[X(X[X(h[X(o[X(p[X~O!d$|X~P(qO^!|O'}#OO(O!|O(P#OO~O^#PO(P#OO(Q#OO(R#PO~Ot#RO!R#SO(Y#SO(Z#UO~OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'{:hO'}TO(QUO(XVO(g[O(tiO~O!X#YO!Y#VO!V(_P!V(lP~P+}O!Z#bO~P`OPYOQYORfOc!jOd!iOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'}TO(QUO(XVO(g[O(tiO~Ol#lO!X#hO!{]O#e#kO#f#hO'{:iO!j(iP~P.iO!k#nO'{#mO~O!w#rO!{]O%b#sO~O#g#tO~O!d#uO#g#tO~OP$]OZ$dOn$QO|#yO}#zO!P#{O!Y$aO!h$SO!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO#o$SO#p$SO#q$cO#r$SO#t$TO#v$VO#x$XO#y$YO(XVO(h$ZO(o#|O(p#}O~O`(]X'r(]X'p(]X!j(]X!V(]X![(]X%c(]X!d(]X~P1qO#[$eO$O$eOP(^XZ(^Xn(^X|(^X}(^X!P(^X!Y(^X!h(^X!k(^X!o(^X#j(^X#k(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#t(^X#v(^X#x(^X#y(^X(X(^X(h(^X(o(^X(p(^X![(^X%c(^X~O`(^X!i(^X'r(^X'p(^X!V(^X!j(^Xr(^X!d(^X~P4XO#[$eO~O$Y$gO$[$fO$c$lO~ORfO![$mO$f$nO$h$pO~Og%VOl%WOn$tOo$sOp$sOv%XOx%YOz%ZO!P${O![$|O!f%`O!k$xO#f%aO$T%^O$o%[O$q%]O$t%_O'{$rO'}TO(QUO(X$uO(o$}O(p%POf(UP~O!k%bO~O!P%eO![%fO'{%dO~O!d%jO~O`%kO'r%kO~O'|!lO~P%[O%h%rO~P%[Og%VO!k%bO'{%dO'|!lO~Od%yO!k%bO'{%dO~O#r$SO~O|&OO![%{O!k%}O%d&RO'{%dO'|!lO'}TO(QUO_(}P~O!w#rO~O%m&TO!P(yX![(yX'{(yX~O'{&UO~O!t&ZO#s!PO%d!QO%f!OO%g!OO%h!OO%k!RO%m!SO%p!TO%q!TO~Oc&`Od&_O!w&]O%b&^O%u&[O~P;xOc&cOdyO![&bO!t&ZO!wxO!{]O#s!PO%b}O%f!OO%g!OO%h!OO%k!RO%m!SO%p!TO%q!TO%s!UO~Oa&fO#[&iO%d&dO'|!lO~P<}O!k&jO!t&nO~O!k#nO~O![XO~O`%kO'q&vO'r%kO~O`%kO'q&yO'r%kO~O`%kO'q&{O'r%kO~O'p[X!V[Xr[X!j[X&T[X![[X%c[X!d[X~P(qO!_'YO!`'RO!a'RO'|!lO'}TO(QUO~Oo'PO!P'OO!X'SO([&}O!Z(`P!Z(nP~P@UOj']O!['ZO'{%dO~Od'bO!k%bO'{%dO~O|&OO!k%}O~Oo!nO!P!oO!{:dO#P!pO#Q!pO#S!pO#T!pO'|!lO'}TO(QUO([!mO(g!sO~O!_'hO!`'gO!a'gO#R!pO#W'iO#X'iO~PApO`%kOg%VO!d#uO!k%bO'r%kO(h'kO~O!o'oO#['mO~PCOOo!nO!P!oO'}TO(QUO([!mO(g!sO~O![XOo(eX!P(eX!_(eX!`(eX!a(eX!{(eX#P(eX#Q(eX#R(eX#S(eX#T(eX#W(eX#X(eX'|(eX'}(eX(Q(eX([(eX(g(eX~O!`'gO!a'gO'|!lO~PCnO'w'sO'x'sO'y'uO~O^!|O'}'wO(O!|O(P'wO~O^#PO(P'wO(Q'wO(R#PO~Ot#RO!R#SO(Y#SO(Z'{O~O!X'}O!V'PX!V'VX!Y'PX!Y'VX~P+}O!Y(PO!V(_X~OP$]OZ$dOn$QO|#yO}#zO!P#{O!Y(PO!h$SO!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO#o$SO#p$SO#q$cO#r$SO#t$TO#v$VO#x$XO#y$YO(XVO(h$ZO(o#|O(p#}O~O!V(_X~PGbO!V(UO~O!V(kX!Y(kX!d(kX!j(kX(h(kX~O#[(kX#g#`X!Z(kX~PIhO#[(VO!V(mX!Y(mX~O!Y(WO!V(lX~O!V(ZO~O#[$eO~PIhO!Z([O~P`O|#yO}#zO!P#{O!i#wO!k#xO(XVOP!maZ!man!ma!Y!ma!h!ma!o!ma#j!ma#k!ma#l!ma#m!ma#n!ma#o!ma#p!ma#q!ma#r!ma#t!ma#v!ma#x!ma#y!ma(h!ma(o!ma(p!ma~O`!ma'r!ma'p!ma!V!ma!j!mar!ma![!ma%c!ma!d!ma~PKOO!j(]O~O!d#uO#[(^O(h'kO!Y(jX`(jX'r(jX~O!j(jX~PMnO!P%eO![%fO!{]O#e(cO#f(bO'{%dO~O!Y(dO!j(iX~O!j(fO~O!P%eO![%fO#f(bO'{%dO~OP(^XZ(^Xn(^X|(^X}(^X!P(^X!Y(^X!h(^X!i(^X!k(^X!o(^X#j(^X#k(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#r(^X#t(^X#v(^X#x(^X#y(^X(X(^X(h(^X(o(^X(p(^X~O!d#uO!j(^X~P! [O|(gO}(hO!i#wO!k#xO!{!za!P!za~O!w!za%b!za![!za#e!za#f!za'{!za~P!#`O!w(lO~OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![XO!fuO!kZO!nYO!oYO!pYO!rvO!t!gO!w!hO$T!kO'{!dO'}TO(QUO(XVO(g[O(tiO~Og%VOl%WOn$tOo$sOp$sOv%XOx%YOz;QO!P${O![$|O!f<`O!k$xO#f;WO$T%^O$o;SO$q;UO$t%_O'{(pO'}TO(QUO(X$uO(o$}O(p%PO~O#g(rO~Og%VOl%WOn$tOo$sOp$sOv%XOx%YOz%ZO!P${O![$|O!f%`O!k$xO#f%aO$T%^O$o%[O$q%]O$t%_O'{(pO'}TO(QUO(X$uO(o$}O(p%PO~Of(bP~P!(SO!X(vO!j(cP~P%[O([(xO(g[O~O!P(zO!k#xO([(xO(g[O~OP:cOQ:cORfOc<[Od!iOlkOn:cOokOpkOvkOx:cOz:cO!PWO!TkO!UkO![!eO!f:fO!kZO!n:cO!o:cO!p:cO!r:gO!t:jO!w!hO$T!kO'{)YO'}TO(QUO(XVO(g[O(t<YO~O})]O!k#xO~O!Y$aO`$ma'r$ma'p$ma!j$ma!V$ma![$ma%c$ma!d$ma~O#s)aO~P!&dO|)dO!d)cO![$ZX$W$ZX$Y$ZX$[$ZX$c$ZX~O!d)cO![(qX$W(qX$Y(qX$[(qX$c(qX~O|)dO~P!.OO|)dO![(qX$W(qX$Y(qX$[(qX$c(qX~O![)fO$W)jO$Y)eO$[)eO$c)kO~O!X)nO~P!*fO$Y$gO$[$fO$c)rO~Oj$uX|$uX!P$uX!i$uX(o$uX(p$uX~OfiXf$uXjiX!YiX#[iX~P!/tOo)tO~Ot)uO(Y)vO(Z)xO~Oj*RO|)zO!P){O(o$}O(p%PO~Of)yO~P!0}Of*SO~Og%VOl%WOn$tOo$sOp$sOv%XOx%YOz;QO!P${O![$|O!f<`O!k$xO#f;WO$T%^O$o;SO$q;UO$t%_O'}TO(QUO(X$uO(o$}O(p%PO~O!X*WO'{*TO!j(uP~P!1lO#g*YO~O!k*ZO~O!X*`O'{*]O!V(vP~P!1lOn*lO!P*dO!_*jO!`*cO!a*cO!k*ZO#W*kO%Y*fO'|!lO([!mO~O!Z*iO~P!3xO!i#wOj(WX|(WX!P(WX(o(WX(p(WX!Y(WX#[(WX~Of(WX#|(WX~P!4qOj*qO#[*pOf(VX!Y(VX~O!Y*rOf(UX~O'{&UOf(UP~O!k*yO~O'{(pO~Ol*}O!P%eO!X#hO![%fO!{]O#e#kO#f#hO'{%dO!j(iP~O!d#uO#g+OO~O!P%eO!X+QO!Y(WO![%fO'{%dO!V(lP~Oo'VO!P+SO!X+RO'}TO(QUO([(xO~O!Z(nP~P!7lO!Y+TO`(zX'r(zX~OP$]OZ$dOn$QO|#yO}#zO!P#{O!h$SO!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO#o$SO#p$SO#q$cO#r$SO#t$TO#v$VO#x$XO#y$YO(XVO(h$ZO(o#|O(p#}O~O`!ea!Y!ea'r!ea'p!ea!V!ea!j!ear!ea![!ea%c!ea!d!ea~P!8dO|#yO}#zO!P#{O!i#wO!k#xO(XVOP!qaZ!qan!qa!Y!qa!h!qa!o!qa#j!qa#k!qa#l!qa#m!qa#n!qa#o!qa#p!qa#q!qa#r!qa#t!qa#v!qa#x!qa#y!qa(h!qa(o!qa(p!qa~O`!qa'r!qa'p!qa!V!qa!j!qar!qa![!qa%c!qa!d!qa~P!:}O|#yO}#zO!P#{O!i#wO!k#xO(XVOP!saZ!san!sa!Y!sa!h!sa!o!sa#j!sa#k!sa#l!sa#m!sa#n!sa#o!sa#p!sa#q!sa#r!sa#t!sa#v!sa#x!sa#y!sa(h!sa(o!sa(p!sa~O`!sa'r!sa'p!sa!V!sa!j!sar!sa![!sa%c!sa!d!sa~P!=hOg%VOj+^O!['ZO%c+]O~O!d+`O`(TX![(TX'r(TX!Y(TX~O`%kO![XO'r%kO~Og%VO!k%bO~Og%VO!k%bO'{%dO~O!d#uO#g(rO~Oa+kO%d+lO'{+hO'}TO(QUO!Z)OP~O!Y+mO_(}X~OZ+qO~O_+rO~O![%{O'{%dO'|!lO_(}P~Og%VO#[+wO~Og%VOj+zO![$|O~O![+|O~O|,OO![XO~O%h%rO~O!w,TO~Od,YO~Oa,ZO'{#mO'}TO(QUO!Z(|P~Od%yO~O%d!QO'{&UO~P<}OZ,`O_,_O~OPYOQYORfOczOdyOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO!fuO!kZO!nYO!oYO!pYO!rvO!wxO!{]O%b}O'}TO(QUO(XVO(g[O(tiO~O![!eO!t!gO$T!kO'{!dO~P!DkO_,_O`%kO'r%kO~OPYOQYORfOc!jOd!iOlkOnYOokOpkOvkOxYOzYO!PWO!TkO!UkO![!eO!fuO!kZO!nYO!oYO!pYO!rvO!w!hO$T!kO'{!dO'}TO(QUO(XVO(g[O(tiO~O`,eO!twO#s!OO%f!OO%g!OO%h!OO~P!GTO!k&jO~O&V,kO~O![,mO~O&h,oO&j,pOP&eaQ&eaR&eaX&ea`&eac&ead&eal&ean&eao&eap&eav&eax&eaz&ea!P&ea!T&ea!U&ea![&ea!f&ea!k&ea!n&ea!o&ea!p&ea!r&ea!t&ea!w&ea!{&ea#s&ea$T&ea%b&ea%d&ea%f&ea%g&ea%h&ea%k&ea%m&ea%p&ea%q&ea%s&ea&P&ea&V&ea&X&ea&Z&ea&]&ea&`&ea&f&ea&l&ea&n&ea&p&ea&r&ea&t&ea'p&ea'{&ea'}&ea(Q&ea(X&ea(g&ea(t&ea!Z&ea&^&eaa&ea&c&ea~O'{,uO~Og!bX!Y!OX!Y!bX!Z!OX!Z!bX!d!OX!d!bX!k!bX#[!OX~O!d,zO#[,yOg(aX!Y#dX!Y(aX!Z#dX!Z(aX!d(aX!k(aX~Og%VO!d,|O!k%bO!Y!^X!Z!^X~Oo!nO!P!oO'}TO(QUO([!mO~OP:cOQ:cORfOc<[Od!iOlkOn:cOokOpkOvkOx:cOz:cO!PWO!TkO!UkO![!eO!f:fO!kZO!n:cO!o:cO!p:cO!r:gO!t:jO!w!hO$T!kO'}TO(QUO(XVO(g[O(t<YO~O'{;]O~P#!ZO!Y-QO!Z(`X~O!Z-SO~O!d,zO#[,yO!Y#dX!Z#dX~O!Y-TO!Z(nX~O!Z-VO~O!`-WO!a-WO'|!lO~P# xO!Z-ZO~P'_Oj-^O!['ZO~O!V-cO~Oo!za!_!za!`!za!a!za#P!za#Q!za#R!za#S!za#T!za#W!za#X!za'|!za'}!za(Q!za([!za(g!za~P!#`O!o-hO#[-fO~PCOO!`-jO!a-jO'|!lO~PCnO`%kO#[-fO'r%kO~O`%kO!d#uO#[-fO'r%kO~O`%kO!d#uO!o-hO#[-fO'r%kO(h'kO~O'w'sO'x'sO'y-oO~Or-pO~O!V'Pa!Y'Pa~P!8dO!X-tO!V'PX!Y'PX~P%[O!Y(PO!V(_a~O!V(_a~PGbO!Y(WO!V(la~O!P%eO!X-xO![%fO'{%dO!V'VX!Y'VX~O#[-zO!Y(ja!j(ja`(ja'r(ja~O!d#uO~P#*aO!Y(dO!j(ia~O!P%eO![%fO#f.OO'{%dO~Ol.TO!P%eO!X.QO![%fO!{]O#e.SO#f.QO'{%dO!Y'YX!j'YX~O}.XO!k#xO~Og%VOj.[O!['ZO%c.ZO~O`#_i!Y#_i'r#_i'p#_i!V#_i!j#_ir#_i![#_i%c#_i!d#_i~P!8dOj<fO|)zO!P){O(o$}O(p%PO~O#g#Za`#Za#[#Za'r#Za!Y#Za!j#Za![#Za!V#Za~P#-]O#g(WXP(WXZ(WX`(WXn(WX}(WX!h(WX!k(WX!o(WX#j(WX#k(WX#l(WX#m(WX#n(WX#o(WX#p(WX#q(WX#r(WX#t(WX#v(WX#x(WX#y(WX'r(WX(X(WX(h(WX!j(WX!V(WX'p(WXr(WX![(WX%c(WX!d(WX~P!4qO!Y.iOf(bX~P!0}Of.kO~O!Y.lO!j(cX~P!8dO!j.oO~O!V.qO~OP$]O|#yO}#zO!P#{O!i#wO!k#xO!o$]O(XVOZ#ii`#iin#ii!Y#ii!h#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii'r#ii(h#ii(o#ii(p#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~O#j#ii~P#1XO#j$OO~P#1XOP$]O|#yO}#zO!P#{O!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO(XVOZ#ii`#ii!Y#ii!h#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii'r#ii(h#ii(o#ii(p#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~On#ii~P#3yOn$QO~P#3yOP$]On$QO|#yO}#zO!P#{O!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO(XVO`#ii!Y#ii#t#ii#v#ii#x#ii#y#ii'r#ii(h#ii(o#ii(p#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~OZ#ii!h#ii#o#ii#p#ii#q#ii#r#ii~P#6kOZ$dO!h$SO#o$SO#p$SO#q$cO#r$SO~P#6kOP$]OZ$dOn$QO|#yO}#zO!P#{O!h$SO!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO#o$SO#p$SO#q$cO#r$SO#t$TO(XVO`#ii!Y#ii#v#ii#x#ii#y#ii'r#ii(h#ii(p#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~O(o#ii~P#9lO(o#|O~P#9lOP$]OZ$dOn$QO|#yO}#zO!P#{O!h$SO!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO#o$SO#p$SO#q$cO#r$SO#t$TO#v$VO(XVO(o#|O`#ii!Y#ii#x#ii#y#ii'r#ii(h#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~O(p#ii~P#<^O(p#}O~P#<^OP$]OZ$dOn$QO|#yO}#zO!P#{O!h$SO!i#wO!k#xO!o$]O#j$OO#k$PO#l$PO#m$PO#n$RO#o$SO#p$SO#q$cO#r$SO#t$TO#v$VO#x$XO(XVO(o#|O(p#}O~O`#ii!Y#ii#y#ii'r#ii(h#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~P#?OOP[XZ[Xn[X|[X}[X!P[X!h[X!i[X!k[X!o[X#[[X#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X(X[X(h[X(o[X(p[X!Y[X!Z[X~O#|[X~P#AiOP$]OZ:zOn:nO|#yO}#zO!P#{O!h:pO!i#wO!k#xO!o$]O#j:lO#k:mO#l:mO#m:mO#n:oO#o:pO#p:pO#q:yO#r:pO#t:qO#v:sO#x:uO#y:vO(XVO(h$ZO(o#|O(p#}O~O#|.sO~P#CvO#[:{O$O:{O#|(^X!Z(^X~P! [O`']a!Y']a'r']a'p']a!j']a!V']ar']a![']a%c']a!d']a~P!8dOP#iiZ#ii`#iin#ii}#ii!Y#ii!h#ii!i#ii!k#ii!o#ii#j#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii'r#ii(X#ii(h#ii'p#ii!V#ii!j#iir#ii![#ii%c#ii!d#ii~P#-]O`#}i!Y#}i'r#}i'p#}i!V#}i!j#}ir#}i![#}i%c#}i!d#}i~P!8dO$Y.xO$[.xO~O$Y.yO$[.yO~O!d)cO#[.zO![$`X$W$`X$Y$`X$[$`X$c$`X~O!X.{O~O![)fO$W.}O$Y)eO$[)eO$c/OO~O!Y:wO!Z(]X~P#CvO!Z/PO~O!d)cO$c(qX~O$c/RO~Ot)uO(Y)vO(Z/UO~O!V/YO~P!&dO(o$}Oj%Za|%Za!P%Za(p%Za!Y%Za#[%Za~Of%Za#|%Za~P#LWO(p%POj%]a|%]a!P%]a(o%]a!Y%]a#[%]a~Of%]a#|%]a~P#LyO!YeX!deX!jeX!j$uX(heX~P!/tO!j/bO~P#-]O!Y/cO!d#uO(h'kO!j(uX~O!j/hO~O!X*WO'{%dO!j(uP~O#g/jO~O!V$uX!Y$uX!d$|X~P!/tO!Y/kO!V(vX~P#-]O!d/mO~O!V/oO~Og%VOn/sO!d#uO!k%bO(h'kO~O'{/uO~O!d+`O~O`%kO!Y/yO'r%kO~O!Z/{O~P!3xO!`/|O!a/|O'|!lO([!mO~O!P0OO([!mO~O#W0PO~Of%Za!Y%Za#[%Za#|%Za~P!0}Of%]a!Y%]a#[%]a#|%]a~P!0}O'{&UOf'fX!Y'fX~O!Y*rOf(Ua~Of0YO~O|0ZO}0ZO!P0[Ojya(oya(pya!Yya#[ya~Ofya#|ya~P$$dO|)zO!P){Oj$na(o$na(p$na!Y$na#[$na~Of$na#|$na~P$%YO|)zO!P){Oj$pa(o$pa(p$pa!Y$pa#[$pa~Of$pa#|$pa~P$%{O#g0^O~Of%Oa!Y%Oa#[%Oa#|%Oa~P!0}O!d#uO~O#g0aO~O!Y+TO`(za'r(za~O|#yO}#zO!P#{O!i#wO!k#xO(XVOP!qiZ!qin!qi!Y!qi!h!qi!o!qi#j!qi#k!qi#l!qi#m!qi#n!qi#o!qi#p!qi#q!qi#r!qi#t!qi#v!qi#x!qi#y!qi(h!qi(o!qi(p!qi~O`!qi'r!qi'p!qi!V!qi!j!qir!qi![!qi%c!qi!d!qi~P$'jOg%VOn$tOo$sOp$sOv%XOx%YOz;QO!P${O![$|O!f<`O!k$xO#f;WO$T%^O$o;SO$q;UO$t%_O'}TO(QUO(X$uO(o$}O(p%PO~Ol0kO'{0jO~P$*TO!d+`O`(Ta![(Ta'r(Ta!Y(Ta~O#g0qO~OZ[X!YeX!ZeX~O!Y0rO!Z)OX~O!Z0tO~OZ0uO~Oa0wO'{+hO'}TO(QUO~O![%{O'{%dO_'nX!Y'nX~O!Y+mO_(}a~O!j0zO~P!8dOZ0}O~O_1OO~O#[1RO~Oj1UO![$|O~O([(xO!Z({P~Og%VOj1_O![1[O%c1^O~OZ1iO!Y1gO!Z(|X~O!Z1jO~O_1lO`%kO'r%kO~O'{#mO'}TO(QUO~O#[$eO$O$eOP(^XZ(^Xn(^X|(^X}(^X!P(^X!Y(^X!h(^X!k(^X!o(^X#j(^X#k(^X#l(^X#m(^X#n(^X#o(^X#p(^X#q(^X#t(^X#v(^X#x(^X#y(^X(X(^X(h(^X(o(^X(p(^X~O#r1oO&T1pO`(^X!i(^X~P$/kO#[$eO#r1oO&T1pO~O`1rO~P%[O`1tO~O&^1wOP&[iQ&[iR&[iX&[i`&[ic&[id&[il&[in&[io&[ip&[iv&[ix&[iz&[i!P&[i!T&[i!U&[i![&[i!f&[i!k&[i!n&[i!o&[i!p&[i!r&[i!t&[i!w&[i!{&[i#s&[i$T&[i%b&[i%d&[i%f&[i%g&[i%h&[i%k&[i%m&[i%p&[i%q&[i%s&[i&P&[i&V&[i&X&[i&Z&[i&]&[i&`&[i&f&[i&l&[i&n&[i&p&[i&r&[i&t&[i'p&[i'{&[i'}&[i(Q&[i(X&[i(g&[i(t&[i!Z&[ia&[i&c&[i~Oa1}O!Z1{O&c1|O~P`O![XO!k2PO~O&j,pOP&eiQ&eiR&eiX&ei`&eic&eid&eil&ein&eio&eip&eiv&eix&eiz&ei!P&ei!T&ei!U&ei![&ei!f&ei!k&ei!n&ei!o&ei!p&ei!r&ei!t&ei!w&ei!{&ei#s&ei$T&ei%b&ei%d&ei%f&ei%g&ei%h&ei%k&ei%m&ei%p&ei%q&ei%s&ei&P&ei&V&ei&X&ei&Z&ei&]&ei&`&ei&f&ei&l&ei&n&ei&p&ei&r&ei&t&ei'p&ei'{&ei'}&ei(Q&ei(X&ei(g&ei(t&ei!Z&ei&^&eia&ei&c&ei~O!V2VO~O!Y!^a!Z!^a~P#CvOo!nO!P!oO!X2]O([!mO!Y'QX!Z'QX~P@UO!Y-QO!Z(`a~O!Y'WX!Z'WX~P!7lO!Y-TO!Z(na~O!Z2dO~P'_O`%kO#[2mO'r%kO~O`%kO!d#uO#[2mO'r%kO~O`%kO!d#uO!o2qO#[2mO'r%kO(h'kO~O`%kO'r%kO~P!8dO!Y$aOr$ma~O!V'Pi!Y'Pi~P!8dO!Y(PO!V(_i~O!Y(WO!V(li~O!V(mi!Y(mi~P!8dO!Y(ji!j(ji`(ji'r(ji~P!8dO#[2sO!Y(ji!j(ji`(ji'r(ji~O!Y(dO!j(ii~O!P%eO![%fO!{]O#e2xO#f2wO'{%dO~O!P%eO![%fO#f2wO'{%dO~Oj3PO!['ZO%c3OO~Og%VOj3PO!['ZO%c3OO~O#g%ZaP%ZaZ%Za`%Zan%Za}%Za!h%Za!i%Za!k%Za!o%Za#j%Za#k%Za#l%Za#m%Za#n%Za#o%Za#p%Za#q%Za#r%Za#t%Za#v%Za#x%Za#y%Za'r%Za(X%Za(h%Za!j%Za!V%Za'p%Zar%Za![%Za%c%Za!d%Za~P#LWO#g%]aP%]aZ%]a`%]an%]a}%]a!h%]a!i%]a!k%]a!o%]a#j%]a#k%]a#l%]a#m%]a#n%]a#o%]a#p%]a#q%]a#r%]a#t%]a#v%]a#x%]a#y%]a'r%]a(X%]a(h%]a!j%]a!V%]a'p%]ar%]a![%]a%c%]a!d%]a~P#LyO#g%ZaP%ZaZ%Za`%Zan%Za}%Za!Y%Za!h%Za!i%Za!k%Za!o%Za#j%Za#k%Za#l%Za#m%Za#n%Za#o%Za#p%Za#q%Za#r%Za#t%Za#v%Za#x%Za#y%Za'r%Za(X%Za(h%Za!j%Za!V%Za'p%Za#[%Zar%Za![%Za%c%Za!d%Za~P#-]O#g%]aP%]aZ%]a`%]an%]a}%]a!Y%]a!h%]a!i%]a!k%]a!o%]a#j%]a#k%]a#l%]a#m%]a#n%]a#o%]a#p%]a#q%]a#r%]a#t%]a#v%]a#x%]a#y%]a'r%]a(X%]a(h%]a!j%]a!V%]a'p%]a#[%]ar%]a![%]a%c%]a!d%]a~P#-]O#gyaPyaZya`yanya!hya!iya!kya!oya#jya#kya#lya#mya#nya#oya#pya#qya#rya#tya#vya#xya#yya'rya(Xya(hya!jya!Vya'pyarya![ya%cya!dya~P$$dO#g$naP$naZ$na`$nan$na}$na!h$na!i$na!k$na!o$na#j$na#k$na#l$na#m$na#n$na#o$na#p$na#q$na#r$na#t$na#v$na#x$na#y$na'r$na(X$na(h$na!j$na!V$na'p$nar$na![$na%c$na!d$na~P$%YO#g$paP$paZ$pa`$pan$pa}$pa!h$pa!i$pa!k$pa!o$pa#j$pa#k$pa#l$pa#m$pa#n$pa#o$pa#p$pa#q$pa#r$pa#t$pa#v$pa#x$pa#y$pa'r$pa(X$pa(h$pa!j$pa!V$pa'p$par$pa![$pa%c$pa!d$pa~P$%{O#g%OaP%OaZ%Oa`%Oan%Oa}%Oa!Y%Oa!h%Oa!i%Oa!k%Oa!o%Oa#j%Oa#k%Oa#l%Oa#m%Oa#n%Oa#o%Oa#p%Oa#q%Oa#r%Oa#t%Oa#v%Oa#x%Oa#y%Oa'r%Oa(X%Oa(h%Oa!j%Oa!V%Oa'p%Oa#[%Oar%Oa![%Oa%c%Oa!d%Oa~P#-]O`#_q!Y#_q'r#_q'p#_q!V#_q!j#_qr#_q![#_q%c#_q!d#_q~P!8dOf'RX!Y'RX~P!(SO!Y.iOf(ba~O!X3ZO!Y'SX!j'SX~P%[O!Y.lO!j(ca~O!Y.lO!j(ca~P!8dO!V3^O~O#|!ma!Z!ma~PKOO#|!ea!Y!ea!Z!ea~P#CvO#|!qa!Z!qa~P!:}O#|!sa!Z!sa~P!=hORfO![3pO$a3qO~O!Z3uO~Or3vO~P#-]O`$jq!Y$jq'r$jq'p$jq!V$jq!j$jqr$jq![$jq%c$jq!d$jq~P!8dO!V3wO~P#-]O|)zO!P){O(p%POj'ba(o'ba!Y'ba#['ba~Of'ba#|'ba~P%)_O|)zO!P){Oj'da(o'da(p'da!Y'da#['da~Of'da#|'da~P%*QO(h$ZO~P#-]O!X3zO'{%dO!Y'^X!j'^X~O!Y/cO!j(ua~O!Y/cO!d#uO!j(ua~O!Y/cO!d#uO(h'kO!j(ua~Of$wi!Y$wi#[$wi#|$wi~P!0}O!X4SO'{*]O!V'`X!Y'`X~P!1lO!Y/kO!V(va~O!Y/kO!V(va~P#-]O!d#uO#r4[O~On4_O!d#uO(h'kO~O(o$}Oj%Zi|%Zi!P%Zi(p%Zi!Y%Zi#[%Zi~Of%Zi#|%Zi~P%-dO(p%POj%]i|%]i!P%]i(o%]i!Y%]i#[%]i~Of%]i#|%]i~P%.VOf(Vi!Y(Vi~P!0}O#[4fOf(Vi!Y(Vi~P!0}O!j4iO~O`$kq!Y$kq'r$kq'p$kq!V$kq!j$kqr$kq![$kq%c$kq!d$kq~P!8dO!V4mO~O!Y4nO![(wX~P#-]O!i#wO~P4XO`$uX![$uX%W[X'r$uX!Y$uX~P!/tO%W4pO`kXjkX|kX!PkX![kX'rkX(okX(pkX!YkX~O%W4pO~Oa4vO%d4wO'{+hO'}TO(QUO!Y'mX!Z'mX~O!Y0rO!Z)Oa~OZ4{O~O_4|O~O`%kO'r%kO~P#-]O![$|O~P#-]O!Y5UO#[5WO!Z({X~O!Z5XO~Oo!nO!P5YO!_!xO!`!uO!a!uO!{:dO#P!pO#Q!pO#R!pO#S!pO#T!pO#W5_O#X!yO'|!lO'}TO(QUO([!mO(g!sO~O!Z5^O~P%3hOj5dO![1[O%c5cO~Og%VOj5dO![1[O%c5cO~Oa5kO'{#mO'}TO(QUO!Y'lX!Z'lX~O!Y1gO!Z(|a~O'}TO(QUO([5mO~O_5qO~O#r5tO&T5uO~PMnO!j5vO~P%[O`5xO~O`5xO~P%[Oa1}O!Z5}O&c1|O~P`O!d6PO~O!d6ROg(ai!Y(ai!Z(ai!d(ai!k(ai~O!Y#di!Z#di~P#CvO#[6SO!Y#di!Z#di~O!Y!^i!Z!^i~P#CvO`%kO#[6]O'r%kO~O`%kO!d#uO#[6]O'r%kO~O!Y(jq!j(jq`(jq'r(jq~P!8dO!Y(dO!j(iq~O!P%eO![%fO#f6dO'{%dO~O!['ZO%c6gO~Oj6jO!['ZO%c6gO~O#g'baP'baZ'ba`'ban'ba}'ba!h'ba!i'ba!k'ba!o'ba#j'ba#k'ba#l'ba#m'ba#n'ba#o'ba#p'ba#q'ba#r'ba#t'ba#v'ba#x'ba#y'ba'r'ba(X'ba(h'ba!j'ba!V'ba'p'bar'ba!['ba%c'ba!d'ba~P%)_O#g'daP'daZ'da`'dan'da}'da!h'da!i'da!k'da!o'da#j'da#k'da#l'da#m'da#n'da#o'da#p'da#q'da#r'da#t'da#v'da#x'da#y'da'r'da(X'da(h'da!j'da!V'da'p'dar'da!['da%c'da!d'da~P%*QO#g$wiP$wiZ$wi`$win$wi}$wi!Y$wi!h$wi!i$wi!k$wi!o$wi#j$wi#k$wi#l$wi#m$wi#n$wi#o$wi#p$wi#q$wi#r$wi#t$wi#v$wi#x$wi#y$wi'r$wi(X$wi(h$wi!j$wi!V$wi'p$wi#[$wir$wi![$wi%c$wi!d$wi~P#-]O#g%ZiP%ZiZ%Zi`%Zin%Zi}%Zi!h%Zi!i%Zi!k%Zi!o%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#p%Zi#q%Zi#r%Zi#t%Zi#v%Zi#x%Zi#y%Zi'r%Zi(X%Zi(h%Zi!j%Zi!V%Zi'p%Zir%Zi![%Zi%c%Zi!d%Zi~P%-dO#g%]iP%]iZ%]i`%]in%]i}%]i!h%]i!i%]i!k%]i!o%]i#j%]i#k%]i#l%]i#m%]i#n%]i#o%]i#p%]i#q%]i#r%]i#t%]i#v%]i#x%]i#y%]i'r%]i(X%]i(h%]i!j%]i!V%]i'p%]ir%]i![%]i%c%]i!d%]i~P%.VOf'Ra!Y'Ra~P!0}O!Y'Sa!j'Sa~P!8dO!Y.lO!j(ci~O#|#_i!Y#_i!Z#_i~P#CvOP$]O|#yO}#zO!P#{O!i#wO!k#xO!o$]O(XVOZ#iin#ii!h#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii#|#ii(h#ii(o#ii(p#ii!Y#ii!Z#ii~O#j#ii~P%FhO#j:lO~P%FhOP$]O|#yO}#zO!P#{O!i#wO!k#xO!o$]O#j:lO#k:mO#l:mO#m:mO(XVOZ#ii!h#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii#|#ii(h#ii(o#ii(p#ii!Y#ii!Z#ii~On#ii~P%HsOn:nO~P%HsOP$]On:nO|#yO}#zO!P#{O!i#wO!k#xO!o$]O#j:lO#k:mO#l:mO#m:mO#n:oO(XVO#t#ii#v#ii#x#ii#y#ii#|#ii(h#ii(o#ii(p#ii!Y#ii!Z#ii~OZ#ii!h#ii#o#ii#p#ii#q#ii#r#ii~P%KOOZ:zO!h:pO#o:pO#p:pO#q:yO#r:pO~P%KOOP$]OZ:zOn:nO|#yO}#zO!P#{O!h:pO!i#wO!k#xO!o$]O#j:lO#k:mO#l:mO#m:mO#n:oO#o:pO#p:pO#q:yO#r:pO#t:qO(XVO#v#ii#x#ii#y#ii#|#ii(h#ii(p#ii!Y#ii!Z#ii~O(o#ii~P%MjO(o#|O~P%MjOP$]OZ:zOn:nO|#yO}#zO!P#{O!h:pO!i#wO!k#xO!o$]O#j:lO#k:mO#l:mO#m:mO#n:oO#o:pO#p:pO#q:yO#r:pO#t:qO#v:sO(XVO(o#|O#x#ii#y#ii#|#ii(h#ii!Y#ii!Z#ii~O(p#ii~P& uO(p#}O~P& uOP$]OZ:zOn:nO|#yO}#zO!P#{O!h:pO!i#wO!k#xO!o$]O#j:lO#k:mO#l:mO#m:mO#n:oO#o:pO#p:pO#q:yO#r:pO#t:qO#v:sO#x:uO(XVO(o#|O(p#}O~O#y#ii#|#ii(h#ii!Y#ii!Z#ii~P&$QO`#zy!Y#zy'r#zy'p#zy!V#zy!j#zyr#zy![#zy%c#zy!d#zy~P!8dOj<gO|)zO!P){O(o$}O(p%PO~OP#iiZ#iin#ii}#ii!h#ii!i#ii!k#ii!o#ii#j#ii#k#ii#l#ii#m#ii#n#ii#o#ii#p#ii#q#ii#r#ii#t#ii#v#ii#x#ii#y#ii#|#ii(X#ii(h#ii!Y#ii!Z#ii~P&&xO!i#wOP(WXZ(WXj(WXn(WX|(WX}(WX!P(WX!h(WX!k(WX!o(WX#j(WX#k(WX#l(WX#m(WX#n(WX#o(WX#p(WX#q(WX#r(WX#t(WX#v(WX#x(WX#y(WX#|(WX(X(WX(h(WX(o(WX(p(WX!Y(WX!Z(WX~O#|#}i!Y#}i!Z#}i~P#CvO#|!qi!Z!qi~P$'jO!Z6|O~O!Y']a!Z']a~P#CvO!d#uO(h'kO!Y'^a!j'^a~O!Y/cO!j(ui~O!Y/cO!d#uO!j(ui~Of$wq!Y$wq#[$wq#|$wq~P!0}O!V'`a!Y'`a~P#-]O!d7TO~O!Y/kO!V(vi~P#-]O!Y/kO!V(vi~O!V7XO~O!d#uO#r7^O~On7_O!d#uO(h'kO~O|)zO!P){O(p%POj'ca(o'ca!Y'ca#['ca~Of'ca#|'ca~P&.YO|)zO!P){Oj'ea(o'ea(p'ea!Y'ea#['ea~Of'ea#|'ea~P&.{O!V7aO~Of$yq!Y$yq#[$yq#|$yq~P!0}O`$ky!Y$ky'r$ky'p$ky!V$ky!j$kyr$ky![$ky%c$ky!d$ky~P!8dO!d6RO~O!Y4nO![(wa~O`#_y!Y#_y'r#_y'p#_y!V#_y!j#_yr#_y![#_y%c#_y!d#_y~P!8dOZ7fO~Oa7hO'{+hO'}TO(QUO~O!Y0rO!Z)Oi~O_7lO~O([(xO!Y'iX!Z'iX~O!Y5UO!Z({a~OlkO'{7sO~P.iO!Z7vO~P%3hOo!nO!P7wO'}TO(QUO([!mO(g!sO~O![1[O~O![1[O%c7yO~Oj7|O![1[O%c7yO~OZ8RO!Y'la!Z'la~O!Y1gO!Z(|i~O!j8VO~O!j8WO~O!j8ZO~O!j8ZO~P%[O`8]O~O!d8^O~O!j8_O~O!Y(mi!Z(mi~P#CvO`%kO#[8gO'r%kO~O!Y(jy!j(jy`(jy'r(jy~P!8dO!Y(dO!j(iy~O!['ZO%c8jO~O#g$wqP$wqZ$wq`$wqn$wq}$wq!Y$wq!h$wq!i$wq!k$wq!o$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#p$wq#q$wq#r$wq#t$wq#v$wq#x$wq#y$wq'r$wq(X$wq(h$wq!j$wq!V$wq'p$wq#[$wqr$wq![$wq%c$wq!d$wq~P#-]O#g'caP'caZ'ca`'can'ca}'ca!h'ca!i'ca!k'ca!o'ca#j'ca#k'ca#l'ca#m'ca#n'ca#o'ca#p'ca#q'ca#r'ca#t'ca#v'ca#x'ca#y'ca'r'ca(X'ca(h'ca!j'ca!V'ca'p'car'ca!['ca%c'ca!d'ca~P&.YO#g'eaP'eaZ'ea`'ean'ea}'ea!h'ea!i'ea!k'ea!o'ea#j'ea#k'ea#l'ea#m'ea#n'ea#o'ea#p'ea#q'ea#r'ea#t'ea#v'ea#x'ea#y'ea'r'ea(X'ea(h'ea!j'ea!V'ea'p'ear'ea!['ea%c'ea!d'ea~P&.{O#g$yqP$yqZ$yq`$yqn$yq}$yq!Y$yq!h$yq!i$yq!k$yq!o$yq#j$yq#k$yq#l$yq#m$yq#n$yq#o$yq#p$yq#q$yq#r$yq#t$yq#v$yq#x$yq#y$yq'r$yq(X$yq(h$yq!j$yq!V$yq'p$yq#[$yqr$yq![$yq%c$yq!d$yq~P#-]O!Y'Si!j'Si~P!8dO#|#_q!Y#_q!Z#_q~P#CvO(o$}OP%ZaZ%Zan%Za}%Za!h%Za!i%Za!k%Za!o%Za#j%Za#k%Za#l%Za#m%Za#n%Za#o%Za#p%Za#q%Za#r%Za#t%Za#v%Za#x%Za#y%Za#|%Za(X%Za(h%Za!Y%Za!Z%Za~Oj%Za|%Za!P%Za(p%Za~P&@bO(p%POP%]aZ%]an%]a}%]a!h%]a!i%]a!k%]a!o%]a#j%]a#k%]a#l%]a#m%]a#n%]a#o%]a#p%]a#q%]a#r%]a#t%]a#v%]a#x%]a#y%]a#|%]a(X%]a(h%]a!Y%]a!Z%]a~Oj%]a|%]a!P%]a(o%]a~P&BiOj<gO|)zO!P){O(p%PO~P&@bOj<gO|)zO!P){O(o$}O~P&BiO|0ZO}0ZO!P0[OPyaZyajyanya!hya!iya!kya!oya#jya#kya#lya#mya#nya#oya#pya#qya#rya#tya#vya#xya#yya#|ya(Xya(hya(oya(pya!Yya!Zya~O|)zO!P){OP$naZ$naj$nan$na}$na!h$na!i$na!k$na!o$na#j$na#k$na#l$na#m$na#n$na#o$na#p$na#q$na#r$na#t$na#v$na#x$na#y$na#|$na(X$na(h$na(o$na(p$na!Y$na!Z$na~O|)zO!P){OP$paZ$paj$pan$pa}$pa!h$pa!i$pa!k$pa!o$pa#j$pa#k$pa#l$pa#m$pa#n$pa#o$pa#p$pa#q$pa#r$pa#t$pa#v$pa#x$pa#y$pa#|$pa(X$pa(h$pa(o$pa(p$pa!Y$pa!Z$pa~OP%OaZ%Oan%Oa}%Oa!h%Oa!i%Oa!k%Oa!o%Oa#j%Oa#k%Oa#l%Oa#m%Oa#n%Oa#o%Oa#p%Oa#q%Oa#r%Oa#t%Oa#v%Oa#x%Oa#y%Oa#|%Oa(X%Oa(h%Oa!Y%Oa!Z%Oa~P&&xO#|$jq!Y$jq!Z$jq~P#CvO#|$kq!Y$kq!Z$kq~P#CvO!Z8vO~O#|8wO~P!0}O!d#uO!Y'^i!j'^i~O!d#uO(h'kO!Y'^i!j'^i~O!Y/cO!j(uq~O!V'`i!Y'`i~P#-]O!Y/kO!V(vq~O!V8}O~P#-]O!V8}O~Of(Vy!Y(Vy~P!0}O!Y'ga!['ga~P#-]O`%Vq![%Vq'r%Vq!Y%Vq~P#-]OZ9SO~O!Y0rO!Z)Oq~O#[9WO!Y'ia!Z'ia~O!Y5UO!Z({i~P#CvOP[XZ[Xn[X|[X}[X!P[X!V[X!Y[X!h[X!i[X!k[X!o[X#[[X#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X(X[X(h[X(o[X(p[X~O!d%TX#r%TX~P'#SO![1[O%c9[O~O'}TO(QUO([9aO~O!Y1gO!Z(|q~O!j9dO~O!j9eO~O!j9fO~O!j9fO~P%[O#[9iO!Y#dy!Z#dy~O!Y#dy!Z#dy~P#CvO!['ZO%c9nO~O#|#zy!Y#zy!Z#zy~P#CvOP$wiZ$win$wi}$wi!h$wi!i$wi!k$wi!o$wi#j$wi#k$wi#l$wi#m$wi#n$wi#o$wi#p$wi#q$wi#r$wi#t$wi#v$wi#x$wi#y$wi#|$wi(X$wi(h$wi!Y$wi!Z$wi~P&&xO|)zO!P){O(p%POP'baZ'baj'ban'ba}'ba!h'ba!i'ba!k'ba!o'ba#j'ba#k'ba#l'ba#m'ba#n'ba#o'ba#p'ba#q'ba#r'ba#t'ba#v'ba#x'ba#y'ba#|'ba(X'ba(h'ba(o'ba!Y'ba!Z'ba~O|)zO!P){OP'daZ'daj'dan'da}'da!h'da!i'da!k'da!o'da#j'da#k'da#l'da#m'da#n'da#o'da#p'da#q'da#r'da#t'da#v'da#x'da#y'da#|'da(X'da(h'da(o'da(p'da!Y'da!Z'da~O(o$}OP%ZiZ%Zij%Zin%Zi|%Zi}%Zi!P%Zi!h%Zi!i%Zi!k%Zi!o%Zi#j%Zi#k%Zi#l%Zi#m%Zi#n%Zi#o%Zi#p%Zi#q%Zi#r%Zi#t%Zi#v%Zi#x%Zi#y%Zi#|%Zi(X%Zi(h%Zi(p%Zi!Y%Zi!Z%Zi~O(p%POP%]iZ%]ij%]in%]i|%]i}%]i!P%]i!h%]i!i%]i!k%]i!o%]i#j%]i#k%]i#l%]i#m%]i#n%]i#o%]i#p%]i#q%]i#r%]i#t%]i#v%]i#x%]i#y%]i#|%]i(X%]i(h%]i(o%]i!Y%]i!Z%]i~O#|$ky!Y$ky!Z$ky~P#CvO#|#_y!Y#_y!Z#_y~P#CvO!d#uO!Y'^q!j'^q~O!Y/cO!j(uy~O!V'`q!Y'`q~P#-]O!V9wO~P#-]O!Y0rO!Z)Oy~O!Y5UO!Z({q~O![1[O%c:OO~O!j:RO~O!['ZO%c:WO~OP$wqZ$wqn$wq}$wq!h$wq!i$wq!k$wq!o$wq#j$wq#k$wq#l$wq#m$wq#n$wq#o$wq#p$wq#q$wq#r$wq#t$wq#v$wq#x$wq#y$wq#|$wq(X$wq(h$wq!Y$wq!Z$wq~P&&xO|)zO!P){O(p%POP'caZ'caj'can'ca}'ca!h'ca!i'ca!k'ca!o'ca#j'ca#k'ca#l'ca#m'ca#n'ca#o'ca#p'ca#q'ca#r'ca#t'ca#v'ca#x'ca#y'ca#|'ca(X'ca(h'ca(o'ca!Y'ca!Z'ca~O|)zO!P){OP'eaZ'eaj'ean'ea}'ea!h'ea!i'ea!k'ea!o'ea#j'ea#k'ea#l'ea#m'ea#n'ea#o'ea#p'ea#q'ea#r'ea#t'ea#v'ea#x'ea#y'ea#|'ea(X'ea(h'ea(o'ea(p'ea!Y'ea!Z'ea~OP$yqZ$yqn$yq}$yq!h$yq!i$yq!k$yq!o$yq#j$yq#k$yq#l$yq#m$yq#n$yq#o$yq#p$yq#q$yq#r$yq#t$yq#v$yq#x$yq#y$yq#|$yq(X$yq(h$yq!Y$yq!Z$yq~P&&xOf%_!Z!Y%_!Z#[%_!Z#|%_!Z~P!0}O!Y'iq!Z'iq~P#CvO!Y#d!Z!Z#d!Z~P#CvO#g%_!ZP%_!ZZ%_!Z`%_!Zn%_!Z}%_!Z!Y%_!Z!h%_!Z!i%_!Z!k%_!Z!o%_!Z#j%_!Z#k%_!Z#l%_!Z#m%_!Z#n%_!Z#o%_!Z#p%_!Z#q%_!Z#r%_!Z#t%_!Z#v%_!Z#x%_!Z#y%_!Z'r%_!Z(X%_!Z(h%_!Z!j%_!Z!V%_!Z'p%_!Z#[%_!Zr%_!Z![%_!Z%c%_!Z!d%_!Z~P#-]OP%_!ZZ%_!Zn%_!Z}%_!Z!h%_!Z!i%_!Z!k%_!Z!o%_!Z#j%_!Z#k%_!Z#l%_!Z#m%_!Z#n%_!Z#o%_!Z#p%_!Z#q%_!Z#r%_!Z#t%_!Z#v%_!Z#x%_!Z#y%_!Z#|%_!Z(X%_!Z(h%_!Z!Y%_!Z!Z%_!Z~P&&xOr(]X~P1qO'|!lO~P!*fO!VeX!YeX#[eX~P'#SOP[XZ[Xn[X|[X}[X!P[X!Y[X!YeX!h[X!i[X!k[X!o[X#[[X#[eX#geX#j[X#k[X#l[X#m[X#n[X#o[X#p[X#q[X#r[X#t[X#v[X#x[X#y[X$O[X(X[X(h[X(o[X(p[X~O!deX!j[X!jeX(heX~P'@vOP:cOQ:cORfOc<[Od!iOlkOn:cOokOpkOvkOx:cOz:cO!PWO!TkO!UkO![XO!f:fO!kZO!n:cO!o:cO!p:cO!r:gO!t:jO!w!hO$T!kO'{)YO'}TO(QUO(XVO(g[O(t<YO~O!Y:wO!Z$ma~Og%VOl%WOn$tOo$sOp$sOv%XOx%YOz;RO!P${O![$|O!f<aO!k$xO#f;XO$T%^O$o;TO$q;VO$t%_O'{(pO'}TO(QUO(X$uO(o$}O(p%PO~O#s)aO~P'ElO!Z[X!ZeX~P'@vO#g:kO~O!d#uO#g:kO~O#[:{O~O#r:pO~O#[;ZO!Y(mX!Z(mX~O#[:{O!Y(kX!Z(kX~O#g;[O~Of;^O~P!0}O#g;cO~O#g;dO~O!d#uO#g;eO~O!d#uO#g;[O~O#|;fO~P#CvO#g;gO~O#g;hO~O#g;mO~O#g;nO~O#g;oO~O#g;pO~O#|;qO~P!0}O#|;rO~P!0}O!i#P#Q#S#T#W#e#f#q(t$o$q$t%W%b%c%d%k%m%p%q%s%u~'vS#k!U't'|#lo#j#mn|'u$Y'u'{$[([~",goto:"$2p)SPPPPP)TPP)WP)iP*x.|PPPP5pPP6WPP<S?gP?zP?zPPP?zPAxP?zP?zP?zPA|PPBRPBlPGdPPPGhPPPPGhJiPPPJoKjPGhPMxPPPP!!WGhPPPGhPGhP!$fGhP!'z!(|!)VP!)y!)}!)yPPPPP!-Y!(|PP!-v!.pP!1dGhGh!1i!4s!9Y!9Y!=OPPP!=VGhPPPPPPPPPPP!@dP!AuPPGh!CSPGhPGhGhGhGhPGh!DfP!GnP!JrP!Jv!KQ!KU!KUP!GkP!KY!KYP!N^P!NbGhGh!Nh##k?zP?zP?z?zP#$v?z?z#'O?z#)k?z#+m?z?z#,[#.f#.f#.j#.r#.f#.zP#.fP?z#/d?z#3R?z?z5pPPP#6vPPP#7a#7aP#7aP#7w#7aPP#7}P#7tP#7t#8b#7t#8|#9S5m)W#9V)WP#9^#9^#9^P)WP)WP)WP)WPP)WP#9d#9gP#9g)WP#9kP#9nP)WP)WP)WP)WP)WP)W)WPP#9t#9z#:V#:]#:c#:i#:o#:}#;T#;Z#;e#;k#;u#<U#<[#<|#=`#=f#=l#=z#>a#@O#@^#@d#Ax#BW#Cr#DQ#DW#D^#Dd#Dn#Dt#Dz#EU#Eh#EnPPPPPPPPPP#EtPPPPPPP#Fi#Ip#KP#KW#K`PPPP$!d$%Z$+r$+u$+x$,q$,t$,w$-O$-WPP$-^$-b$.Y$/X$/]$/qPP$/u$/{$0PP$0S$0W$0Z$1P$1h$2P$2T$2W$2Z$2a$2d$2h$2lR!{RoqOXst!Z#c%j&m&o&p&r,h,m1w1zY!uQ'Z-Y1[5]Q%pvQ%xyQ&P|Q&e!VS'R!e-QQ'a!iS'g!r!xS*c$|*hQ+f%yQ+s&RQ,X&_Q-W'YQ-b'bQ-j'hQ/|*jQ1f,YR;Y:g%OdOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&m&o&p&r&v'O']'m'}(P(V(^(r(v(z)y+O+S,e,h,m-^-f-t-z.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3Z5Y5d5t5u5x6]7w7|8]8gS#p]:d!r)[$[$m'S)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]Q*u%ZQ+k%{Q,Z&bQ,b&jQ.c;QQ0h+^Q0l+`Q0w+lQ1n,`Q2{.[Q4v0rQ5k1gQ6i3PQ6u;RQ7h4wR8m6j&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]t!nQ!r!u!x!y'R'Y'Z'g'h'i-Q-W-Y-j1[5]5_$v$si#u#w$c$d$x${%O%Q%[%]%a)u){)}*P*R*Y*`*p*q+]+`+w+z.Z.i/Z/j/k/m0Q0S0^1R1U1^3O3x4S4[4f4n4p5c6g7T7^7y8j8w9[9n:O:W:y:z:|:};O;P;S;T;U;V;W;X;_;`;a;b;c;d;g;h;i;j;k;l;m;n;q;r<Y<b<c<f<gQ&S|Q'P!eS'V%f-TQ+k%{Q,Z&bQ0]*yQ0w+lQ0|+rQ1m,_Q1n,`Q4v0rQ5P1OQ5k1gQ5n1iQ5o1lQ7h4wQ7k4|Q8U5qQ9V7lR9b8RrnOXst!V!Z#c%j&d&m&o&p&r,h,m1w1zR,]&f&v^OPXYstuvwz!Z!`!g!j!o#R#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%j%p%}&f&i&j&m&o&p&r&v'O']'m(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<[<][#[WZ#V#Y'S'}!S%gm#g#h#k%b%e(W(b(c(d+Q+R+T,d,z-x.O.P.Q.S2P2w2x6R6dQ%sxQ%wyS%||&RQ&Y!TQ'^!hQ'`!iQ(k#rS*V$x*ZS+e%x%yQ+i%{Q,S&]Q,W&_S-a'a'bQ.^(lQ/g*WQ0p+fQ0v+lQ0x+mQ0{+qQ1a,TS1e,X,YQ2i-bQ3y/cQ4u0rQ4y0uQ5O0}Q5j1fQ7Q3zQ7g4wQ7j4{Q9R7fR9y9S!O$zi#w%O%Q%[%]%a)}*P*Y*p*q.i/j0Q0S0^3x4f8w<Y<b<c!S%uy!i!t%w%x%y'Q'`'a'b'f'p*b+e+f,}-a-b-i/t0p2b2i2p4^Q+_%sQ+x&VQ+{&WQ,V&_Q.](kQ1`,SU1d,W,X,YQ3Q.^Q5e1aS5i1e1fQ8Q5j#W<^#u$c$d$x${)u){*R*`+]+`+w+z.Z/Z/k/m1R1U1^3O4S4[4n4p5c6g7T7^7y8j9[9n:O:W:|;O;S;U;W;_;a;c;g;i;k;m;q<f<go<_:y:z:};P;T;V;X;`;b;d;h;j;l;n;rW%Ti%V*r<YS&V!Q&dQ&W!RQ&X!SR+v&T$w%Si#u#w$c$d$x${%O%Q%[%]%a)u){)}*P*R*Y*`*p*q+]+`+w+z.Z.i/Z/j/k/m0Q0S0^1R1U1^3O3x4S4[4f4n4p5c6g7T7^7y8j8w9[9n:O:W:y:z:|:};O;P;S;T;U;V;W;X;_;`;a;b;c;d;g;h;i;j;k;l;m;n;q;r<Y<b<c<f<gT)v$u)wV*v%Z;Q;RU'V!e%f-TS(y#y#zQ+p&OS.V(g(hQ1V+|Q4g0ZR7p5U&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]$i$`c#X#d%n%o%q'|(S(n(u(})O)P)Q)R)S)T)U)V)W)X)Z)^)b)l+Z+o-O-m-r-w-y.h.n.r.t.u.v/V0_2W2Z2k2r3Y3_3`3a3b3c3d3e3f3g3h3i3j3k3n3o3t4k4s6U6[6a6o6p6y6z7r8a8e8n8t8u9k9{:S:e<PT#SV#T&}kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]Q'T!eR2^-Qv!nQ!e!r!u!x!y'R'Y'Z'g'h'i-Q-W-Y-j1[5]5_S*b$|*hS/t*c*jQ/}*kQ1X,OQ4^/|R4a0PnqOXst!Z#c%j&m&o&p&r,h,m1w1zQ&t!^Q'q!wS(m#t:kQ+c%vQ,Q&YQ,R&[Q-_'_Q-l'jS.g(r;[S0`+O;eQ0n+dQ1Z,PQ2O,oQ2Q,pQ2Y,{Q2g-`Q2j-dS4l0a;oQ4q0oS4t0q;pQ6T2[Q6X2hQ6^2oQ7e4rQ8b6VQ8c6YQ8f6_R9h8_$d$_c#X#d%o%q'|(S(n(u(})O)P)Q)R)S)T)U)V)W)X)Z)^)b)l+Z+o-O-m-r-w-y.h.n.r.u.v/V0_2W2Z2k2r3Y3_3`3a3b3c3d3e3f3g3h3i3j3k3n3o3t4k4s6U6[6a6o6p6y6z7r8a8e8n8t8u9k9{:S:e<PS(j#o'dU*o%R(q3mS+Y%n.tQ2|0hQ6f2{Q8l6iR9o8m$d$^c#X#d%o%q'|(S(n(u(})O)P)Q)R)S)T)U)V)W)X)Z)^)b)l+Z+o-O-m-r-w-y.h.n.r.u.v/V0_2W2Z2k2r3Y3_3`3a3b3c3d3e3f3g3h3i3j3k3n3o3t4k4s6U6[6a6o6p6y6z7r8a8e8n8t8u9k9{:S:e<PS(i#o'dS({#z$_S+X%n.tS.W(h(jQ.w)]Q0e+YR2y.X&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]S#p]:dQ&o!XQ&p!YQ&r![Q&s!]R1v,kQ'[!hQ+[%sQ-]'^S.Y(k+_Q2e-[W2}.].^0g0iQ6W2fU6e2z2|3QS8i6f6hS9m8k8lS:U9l9oQ:^:VR:a:_U!vQ'Z-YT5Z1[5]!Q_OXZ`st!V!Z#c#g%b%j&d&f&m&o&p&r(d,h,m.P1w1z]!pQ!r'Z-Y1[5]T#p]:d%Y{OPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&j&m&o&p&r&v'O']'m'}(P(V(^(r(v(z)y+O+S+^,e,h,m-^-f-t-z.[.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3P3Z5Y5d5t5u5x6]6j7w7|8]8gS(y#y#zS.V(g(h!s;v$[$m'S)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]Y!tQ'Z-Y1[5]Q'f!rS'p!u!xS'r!y5_S-i'g'hQ-k'iR2p-jQ'o!tS(`#f1qS-h'f'rQ/f*VQ/r*bQ2q-kQ4O/gS4X/s/}Q7P3yS7[4_4aQ8y7QR9Q7_Q#vbQ'n!tS(_#f1qS(a#l*}Q+P%cQ+a%tQ+g%zU-g'f'o'rQ-{(`Q/e*VQ/q*bQ/w*eQ0m+bQ1b,US2n-h-kQ2v.TS3}/f/gS4W/r/}Q4Z/vQ4]/xQ5g1cQ6`2qQ7O3yQ7S4OS7W4X4aQ7]4`Q8O5hS8x7P7QQ8|7XQ9O7[Q9_8PQ9u8yQ9v8}Q9x9QQ:Q9`Q:Y9wQ;y;tQ<U;}R<V<OV!vQ'Z-Y%YaOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&j&m&o&p&r&v'O']'m'}(P(V(^(r(v(z)y+O+S+^,e,h,m-^-f-t-z.[.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3P3Z5Y5d5t5u5x6]6j7w7|8]8gS#vz!j!r;s$[$m'S)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]R;y<[%YbOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&j&m&o&p&r&v'O']'m'}(P(V(^(r(v(z)y+O+S+^,e,h,m-^-f-t-z.[.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3P3Z5Y5d5t5u5x6]6j7w7|8]8gQ%cj!S%ty!i!t%w%x%y'Q'`'a'b'f'p*b+e+f,}-a-b-i/t0p2b2i2p4^S%zz!jQ+b%uQ,U&_W1c,V,W,X,YU5h1d1e1fS8P5i5jQ9`8Q!r;t$[$m'S)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]Q;}<ZR<O<[$|eOPXYstuvw!Z!`!g!o#R#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&m&o&p&r&v'O']'m(P(V(^(r(v(z)y+O+S+^,e,h,m-^-f-t-z.[.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3P3Z5Y5d5t5u5x6]6j7w7|8]8gY#aWZ#V#Y'}!S%gm#g#h#k%b%e(W(b(c(d+Q+R+T,d,z-x.O.P.Q.S2P2w2x6R6dQ,c&j!p;u$[$m)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]R;x'SS'W!e%fR2`-T%OdOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&m&o&p&r&v'O']'m'}(P(V(^(r(v(z)y+O+S,e,h,m-^-f-t-z.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3Z5Y5d5t5u5x6]7w7|8]8g!r)[$[$m'S)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]Q,b&jQ0h+^Q2{.[Q6i3PR8m6j!f$Uc#X%n'|(S(n(u)U)V)W)X)^)b+o-m-r-w-y.h.n/V0_2k2r3Y3k4k4s6[6a6o8e9k:e!T:r)Z)l-O.t2W2Z3_3g3h3i3j3n3t6U6p6y6z7r8a8n8t8u9{:S<P!b$Wc#X%n'|(S(n(u)W)X)^)b+o-m-r-w-y.h.n/V0_2k2r3Y3k4k4s6[6a6o8e9k:e!P:t)Z)l-O.t2W2Z3_3i3j3n3t6U6p6y6z7r8a8n8t8u9{:S<P!^$[c#X%n'|(S(n(u)^)b+o-m-r-w-y.h.n/V0_2k2r3Y3k4k4s6[6a6o8e9k:eQ3x/az<])Z)l-O.t2W2Z3_3n3t6U6p6y6z7r8a8n8t8u9{:S<PQ<b<dR<c<e&|kOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]S$nh$oR3q.z'TgOPWXYZhstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m$o%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.z.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]T$jf$pQ$hfS)e$k)iR)q$pT$if$pT)g$k)i'ThOPWXYZhstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$[$a$e$m$o%j%p%}&f&i&j&m&o&p&r&v'O'S']'m'}(P(V(^(r(v(z)n)y+O+S+^,e,h,m,y,|-^-f-t-z.[.l.s.z.{0[0a0q1_1o1p1r1t1w1z1|2]2m2s3P3Z3p5W5Y5d5t5u5x6S6]6j7w7|8]8g9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]T$nh$oQ$qhR)p$o%YjOPWXYZstuvw!Z!`!g!o#R#V#Y#c#n#t#x#{$O$P$Q$R$S$T$U$V$W$X$Y$a$e%j%p%}&f&i&j&m&o&p&r&v'O']'m'}(P(V(^(r(v(z)y+O+S+^,e,h,m-^-f-t-z.[.l.s0[0a0q1_1o1p1r1t1w1z1|2m2s3P3Z5Y5d5t5u5x6]6j7w7|8]8g!s<Z$[$m'S)n,y,|.{2]3p5W6S9W9i:c:f:g:j:k:l:m:n:o:p:q:r:s:t:u:v:w:{;Y;Z;[;^;e;f;o;p<]#clOPXZst!Z!`!o#R#c#n#{$m%j&f&i&j&m&o&p&r&v'O'](z)n+S+^,e,h,m-^.[.{0[1_1o1p1r1t1w1z1|3P3p5Y5d5t5u5x6j7w7|8]!O%Ri#w%O%Q%[%]%a)}*P*Y*p*q.i/j0Q0S0^3x4f8w<Y<b<c#W(q#u$c$d$x${)u){*R*`+]+`+w+z.Z/Z/k/m1R1U1^3O4S4[4n4p5c6g7T7^7y8j9[9n:O:W:|;O;S;U;W;_;a;c;g;i;k;m;q<f<gQ*z%_Q/W)zo3m:y:z:};P;T;V;X;`;b;d;h;j;l;n;r!O$yi#w%O%Q%[%]%a)}*P*Y*p*q.i/j0Q0S0^3x4f8w<Y<b<cQ*[$zS*e$|*hQ*{%`Q/x*f#W;{#u$c$d$x${)u){*R*`+]+`+w+z.Z/Z/k/m1R1U1^3O4S4[4n4p5c6g7T7^7y8j9[9n:O:W:|;O;S;U;W;_;a;c;g;i;k;m;q<f<gn;|:y:z:};P;T;V;X;`;b;d;h;j;l;n;rQ<Q<^Q<R<_Q<S<`R<T<a!O%Ri#w%O%Q%[%]%a)}*P*Y*p*q.i/j0Q0S0^3x4f8w<Y<b<c#W(q#u$c$d$x${)u){*R*`+]+`+w+z.Z/Z/k/m1R1U1^3O4S4[4n4p5c6g7T7^7y8j9[9n:O:W:|;O;S;U;W;_;a;c;g;i;k;m;q<f<go3m:y:z:};P;T;V;X;`;b;d;h;j;l;n;rnoOXst!Z#c%j&m&o&p&r,h,m1w1zQ*_${Q,v&yQ,w&{R4R/k$v%Si#u#w$c$d$x${%O%Q%[%]%a)u){)}*P*R*Y*`*p*q+]+`+w+z.Z.i/Z/j/k/m0Q0S0^1R1U1^3O3x4S4[4f4n4p5c6g7T7^7y8j8w9[9n:O:W:y:z:|:};O;P;S;T;U;V;W;X;_;`;a;b;c;d;g;h;i;j;k;l;m;n;q;r<Y<b<c<f<gQ+y&WQ1T+{Q5S1SR7o5TT*g$|*hS*g$|*hT5[1[5]S/v*d5YT4`0O7wQ+a%tQ/w*eQ0m+bQ1b,UQ5g1cQ8O5hQ9_8PR:Q9`!O%Oi#w%O%Q%[%]%a)}*P*Y*p*q.i/j0Q0S0^3x4f8w<Y<b<cr)}$v(s*O*n*|/i0U0V3W4P4j6}7`9t;z<W<XS0Q*m0R#W:|#u$c$d$x${)u){*R*`+]+`+w+z.Z/Z/k/m1R1U1^3O4S4[4n4p5c6g7T7^7y8j9[9n:O:W:|;O;S;U;W;_;a;c;g;i;k;m;q<f<gn:}:y:z:};P;T;V;X;`;b;d;h;j;l;n;r!^;_(o)`*U*^._.b.f/S/X/a/n0f1Q1S3T4Q4U5R5T6k6n7U7Y7b7d8{9P:X<d<e`;`3l6q6t6x8o9p9s:bS;i.a3UT;j6s8r!O%Qi#w%O%Q%[%]%a)}*P*Y*p*q.i/j0Q0S0^3x4f8w<Y<b<cv*P$v(s*Q*m*|/]/i0U0V3W4P4b4j6}7`9t;z<W<XS0S*n0T#W;O#u$c$d$x${)u){*R*`+]+`+w+z.Z/Z/k/m1R1U1^3O4S4[4n4p5c6g7T7^7y8j9[9n:O:W:|;O;S;U;W;_;a;c;g;i;k;m;q<f<gn;P:y:z:};P;T;V;X;`;b;d;h;j;l;n;r!b;a(o)`*U*^.`.a.f/S/X/a/n0f1Q1S3R3T4Q4U5R5T6k6l6n7U7Y7b7d8{9P:X<d<ed;b3l6r6s6x8o8p9p9q9s:bS;k.b3VT;l6t8srnOXst!V!Z#c%j&d&m&o&p&r,h,m1w1zQ&a!UR,e&jrnOXst!V!Z#c%j&d&m&o&p&r,h,m1w1zR&a!UQ+}&XR1P+vsnOXst!V!Z#c%j&d&m&o&p&r,h,m1w1zQ1],SS5b1`1aU7x5`5a5eS9Z7z7{S9|9Y9]Q:Z9}R:`:[Q&h!VR,^&dR5n1iS%||&RR0x+mQ&m!WR,h&nR,n&sT1x,m1zR,r&tQ,q&tR2R,rQ't!zR-n'tSsOtQ#cXT%ms#cQ!}TR'v!}Q#QUR'x#QQ)w$uR/T)wQ#TVR'z#TQ#WWU(Q#W(R-uQ(R#XR-u(SQ-R'TR2_-RQ.j(sR3X.jQ.m(uS3[.m3]R3].nQ-Y'ZR2c-YY!rQ'Z-Y1[5]R'e!rS#^W%eU(X#^(Y-vQ(Y#_R-v(TQ-U'WR2a-Ut`OXst!V!Z#c%j&d&f&m&o&p&r,h,m1w1zS#gZ%bU#q`#g.PR.P(dQ(e#iQ-|(aW.U(e-|2t6bQ2t-}R6b2uQ)i$kR.|)iQ$ohR)o$oQ$bcU)_$b-q:xQ-q:eR:x)lQ/d*VW3{/d3|7R8zU3|/e/f/gS7R3}4OR8z7S$X)|$v(o(s)`*U*^*m*n*w*x*|.a.b.d.e.f/S/X/]/_/a/i/n0U0V0f1Q1S3R3S3T3W3l4P4Q4U4b4d4j5R5T6k6l6m6n6s6t6v6w6x6}7U7Y7`7b7d8o8p8q8{9P9p9q9r9s9t:X:b;z<W<X<d<eQ/l*^U4T/l4V7VQ4V/nR7V4UQ*h$|R/z*hr*O$v(s*m*n*|/i0U0V3W4P4j6}7`9t;z<W<X!^._(o)`*U*^.a.b.f/S/X/a/n0f1Q1S3T4Q4U5R5T6k6n7U7Y7b7d8{9P:X<d<eU/^*O._6qa6q3l6s6t6x8o9p9s:bQ0R*mQ3U.aU4c0R3U8rR8r6sv*Q$v(s*m*n*|/]/i0U0V3W4P4b4j6}7`9t;z<W<X!b.`(o)`*U*^.a.b.f/S/X/a/n0f1Q1S3R3T4Q4U5R5T6k6l6n7U7Y7b7d8{9P:X<d<eU/`*Q.`6re6r3l6s6t6x8o8p9p9q9s:bQ0T*nQ3V.bU4e0T3V8sR8s6tQ*s%UR0X*sQ4o0fR7c4oQ+U%hR0d+UQ5V1VS7q5V9XR9X7rQ,P&YR1Y,PQ5]1[R7u5]Q1h,ZS5l1h8SR8S5nQ0s+iW4x0s4z7i9TQ4z0vQ7i4yR9T7jQ+n%|R0y+nQ1z,mR5|1zYrOXst#cQ&q!ZQ+W%jQ,g&mQ,i&oQ,j&pQ,l&rQ1u,hS1x,m1zR5{1wQ%lpQ&u!_Q&x!aQ&z!bQ&|!cQ'l!tQ+V%iQ+c%vQ+u&SQ,]&hQ,t&wW-e'f'n'o'rQ-l'jQ/y*gQ0n+dS1k,^,aQ2S,sQ2T,vQ2U,wQ2j-dW2l-g-h-k-mQ4q0oQ4}0|Q5Q1QQ5f1bQ5p1mQ5z1vU6Z2k2n2qQ6^2oQ7e4rQ7m5PQ7n5RQ7t5[Q7}5gQ8T5oS8d6[6`Q8f6_Q9U7kQ9^8OQ9c8UQ9j8eQ9z9VQ:P9_Q:T9kR:]:QQ%vyQ'_!iQ'j!tU+d%w%x%yQ,{'QU-`'`'a'bS-d'f'pQ/p*bS0o+e+fQ2[,}S2h-a-bQ2o-iQ4Y/tQ4r0pQ6V2bQ6Y2iQ6_2pR7Z4^S$wi<YR*t%VU%Ui%V<YR0W*rQ$viS(o#u+`Q(s#wS)`$c$dQ*U$xQ*^${Q*m%OQ*n%QQ*w%[Q*x%]Q*|%aQ.a:|Q.b;OQ.d;SQ.e;UQ.f;WQ/S)uS/X){/ZQ/])}Q/_*PQ/a*RQ/i*YQ/n*`Q0U*pQ0V*qh0f+].Z1^3O5c6g7y8j9[9n:O:WQ1Q+wQ1S+zQ3R;_Q3S;aQ3T;cQ3W.iS3l:y:zQ4P/jQ4Q/kQ4U/mQ4b0QQ4d0SQ4j0^Q5R1RQ5T1UQ6k;gQ6l;iQ6m;kQ6n;mQ6s:}Q6t;PQ6v;TQ6w;VQ6x;XQ6}3xQ7U4SQ7Y4[Q7`4fQ7b4nQ7d4pQ8o;dQ8p;`Q8q;bQ8{7TQ9P7^Q9p;hQ9q;jQ9r;lQ9s;nQ9t8wQ:X;qQ:b;rQ;z<YQ<W<bQ<X<cQ<d<fR<e<gnpOXst!Z#c%j&m&o&p&r,h,m1w1zQ!fPS#eZ#nQ&w!`U'c!o5Y7wQ'y#RQ(|#{Q)m$mS,a&f&iQ,f&jQ,s&vQ,x'OQ-[']Q.p(zQ/Q)nQ0b+SQ0i+^Q1s,eQ2f-^Q2|.[Q3s.{Q4h0[Q5a1_Q5r1oQ5s1pQ5w1rQ5y1tQ6O1|Q6f3PQ6{3pQ7{5dQ8X5tQ8Y5uQ8[5xQ8l6jQ9]7|R9g8]#WcOPXZst!Z!`!o#c#n#{%j&f&i&j&m&o&p&r&v'O'](z+S+^,e,h,m-^.[0[1_1o1p1r1t1w1z1|3P5Y5d5t5u5x6j7w7|8]Q#XWQ#dYQ%nuQ%ovS%qw!gS'|#V(PQ(S#YQ(n#tQ(u#xQ(}$OQ)O$PQ)P$QQ)Q$RQ)R$SQ)S$TQ)T$UQ)U$VQ)V$WQ)W$XQ)X$YQ)Z$[Q)^$aQ)b$eW)l$m)n.{3pQ+Z%pQ+o%}S-O'S2]Q-m'mS-r'}-tQ-w(VQ-y(^Q.h(rQ.n(vQ.r:cQ.t:fQ.u:gQ.v:jQ/V)yQ0_+OQ2W,yQ2Z,|Q2k-fQ2r-zQ3Y.lQ3_:kQ3`:lQ3a:mQ3b:nQ3c:oQ3d:pQ3e:qQ3f:rQ3g:sQ3h:tQ3i:uQ3j:vQ3k.sQ3n:{Q3o;YQ3t:wQ4k0aQ4s0qQ6U;ZQ6[2mQ6a2sQ6o3ZQ6p;[Q6y;^Q6z;eQ7r5WQ8a6SQ8e6]Q8n;fQ8t;oQ8u;pQ9k8gQ9{9WQ:S9iQ:e#RR<P<]R#ZWR'U!eY!tQ'Z-Y1[5]S'Q!e-QQ'f!rS'p!u!xS'r!y5_S,}'R'YS-i'g'hQ-k'iQ2b-WR2p-jR(t#wR(w#xQ!fQT-X'Z-Y]!qQ!r'Z-Y1[5]Q#o]R'd:dT#jZ%bS#iZ%bS%hm,dU(a#g#h#kS-}(b(cQ.R(dQ0c+TQ2u.OU2v.P.Q.SS6c2w2xR8h6d`#]W#V#Y%e'}(W+Q-xr#fZm#g#h#k%b(b(c(d+T.O.P.Q.S2w2x6dQ1q,dQ2X,zQ6Q2PQ8`6RT;w'S+RT#`W%eS#_W%eS(O#V(WS(T#Y+QS-P'S+RT-s'}-xT'X!e%fQ$kfR)s$pT)h$k)iR3r.zT*X$x*ZR*a${Q0g+]Q2z.ZQ5`1^Q6h3OQ7z5cQ8k6gQ9Y7yQ9l8jQ9}9[Q:V9nQ:[:OR:_:WnqOXst!Z#c%j&m&o&p&r,h,m1w1zQ&g!VR,]&dtmOXst!U!V!Z#c%j&d&m&o&p&r,h,m1w1zR,d&jT%im,dR1W+|R,[&bQ&Q|R+t&RR+j%{T&k!W&nT&l!W&nT1y,m1z",nodeNames:" ArithOp ArithOp JSXStartTag LineComment BlockComment Script Hashbang ExportDeclaration export Star as VariableName String Escape from ; default FunctionDeclaration async function VariableDefinition > < TypeParamList TypeDefinition extends ThisType this LiteralType ArithOp Number BooleanLiteral TemplateType InterpolationEnd Interpolation InterpolationStart NullType null VoidType void TypeofType typeof MemberExpression . ?. PropertyName [ TemplateString Escape Interpolation super RegExp ] ArrayExpression Spread , } { ObjectExpression Property async get set PropertyDefinition Block : NewExpression new TypeArgList CompareOp < ) ( ArgList UnaryExpression delete LogicOp BitOp YieldExpression yield AwaitExpression await ParenthesizedExpression ClassExpression class ClassBody MethodDeclaration Decorator @ MemberExpression PrivatePropertyName CallExpression declare Privacy static abstract override PrivatePropertyDefinition PropertyDeclaration readonly accessor Optional TypeAnnotation Equals StaticBlock FunctionExpression ArrowFunction ParamList ParamList ArrayPattern ObjectPattern PatternProperty Privacy readonly Arrow MemberExpression BinaryExpression ArithOp ArithOp ArithOp ArithOp BitOp CompareOp instanceof satisfies in const CompareOp BitOp BitOp BitOp LogicOp LogicOp ConditionalExpression LogicOp LogicOp AssignmentExpression UpdateOp PostfixExpression CallExpression TaggedTemplateExpression DynamicImport import ImportMeta JSXElement JSXSelfCloseEndTag JSXSelfClosingTag JSXIdentifier JSXBuiltin JSXIdentifier JSXNamespacedName JSXMemberExpression JSXSpreadAttribute JSXAttribute JSXAttributeValue JSXEscape JSXEndTag JSXOpenTag JSXFragmentTag JSXText JSXEscape JSXStartCloseTag JSXCloseTag PrefixCast ArrowFunction TypeParamList SequenceExpression KeyofType keyof UniqueType unique ImportType InferredType infer TypeName ParenthesizedType FunctionSignature ParamList NewSignature IndexedType TupleType Label ArrayType ReadonlyType ObjectType MethodType PropertyType IndexSignature PropertyDefinition CallSignature TypePredicate is NewSignature new UnionType LogicOp IntersectionType LogicOp ConditionalType ParameterizedType ClassDeclaration abstract implements type VariableDeclaration let var using TypeAliasDeclaration InterfaceDeclaration interface EnumDeclaration enum EnumBody NamespaceDeclaration namespace module AmbientDeclaration declare GlobalDeclaration global ClassDeclaration ClassBody AmbientFunctionDeclaration ExportGroup VariableName VariableName ImportDeclaration ImportGroup ForStatement for ForSpec ForInSpec ForOfSpec of WhileStatement while WithStatement with DoStatement do IfStatement if else SwitchStatement switch SwitchBody CaseLabel case DefaultLabel TryStatement try CatchClause catch FinallyClause finally ReturnStatement return ThrowStatement throw BreakStatement break ContinueStatement continue DebuggerStatement debugger LabeledStatement ExpressionStatement SingleExpression SingleClassItem",maxTerm:371,context:trackNewline,nodeProps:[["group",-26,8,16,18,65,201,205,209,210,212,215,218,228,230,236,238,240,242,245,251,257,259,261,263,265,267,268,"Statement",-32,12,13,28,31,32,38,48,51,52,54,59,67,75,79,81,83,84,106,107,116,117,134,137,139,140,141,142,144,145,164,165,167,"Expression",-23,27,29,33,37,39,41,168,170,172,173,175,176,177,179,180,181,183,184,185,195,197,199,200,"Type",-3,87,99,105,"ClassItem"],["openedBy",22,"<",34,"InterpolationStart",53,"[",57,"{",72,"(",157,"JSXStartCloseTag"],["closedBy",23,">",36,"InterpolationEnd",47,"]",58,"}",73,")",162,"JSXEndTag"]],propSources:[jsHighlight],skippedNodes:[0,4,5,271],repeatNodeCount:37,tokenData:"$Fj(CSR!bOX%ZXY+gYZ-yZ[+g[]%Z]^.c^p%Zpq+gqr/mrs3cst:_tuEruvJSvwLkwx! Yxy!'iyz!(sz{!)}{|!,q|}!.O}!O!,q!O!P!/Y!P!Q!9j!Q!R#8g!R![#:v![!]#Gv!]!^#IS!^!_#J^!_!`#Ns!`!a$#_!a!b$(l!b!c$,k!c!}Er!}#O$-u#O#P$/P#P#Q$4h#Q#R$5r#R#SEr#S#T$7P#T#o$8Z#o#p$<k#p#q$=a#q#r$>q#r#s$?}#s$f%Z$f$g+g$g#BYEr#BY#BZ$AX#BZ$ISEr$IS$I_$AX$I_$I|Er$I|$I}$Dd$I}$JO$Dd$JO$JTEr$JT$JU$AX$JU$KVEr$KV$KW$AX$KW&FUEr&FU&FV$AX&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$AX?HUOEr(n%d_$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&j&hT$f&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c&j&zP;=`<%l&c'|'U]$f&j(R!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!b(SU(R!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!b(iP;=`<%l'}'|(oP;=`<%l&}'[(y]$f&j(OpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rp)wU(OpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)rp*^P;=`<%l)r'[*dP;=`<%l(r#S*nX(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g#S+^P;=`<%l*g(n+dP;=`<%l%Z(CS+rq$f&j(Op(R!b't(;dOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p$f%Z$f$g+g$g#BY%Z#BY#BZ+g#BZ$IS%Z$IS$I_+g$I_$JT%Z$JT$JU+g$JU$KV%Z$KV$KW+g$KW&FU%Z&FU&FV+g&FV;'S%Z;'S;=`+a<%l?HT%Z?HT?HU+g?HUO%Z(CS.ST(P#S$f&j'u(;dO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c(CS.n_$f&j(Op(R!b'u(;dOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#`/x`$f&j!o$Ip(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S1V`#t$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`2X!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S2d_#t$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/|3l_'}$(n$f&j(R!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k(^4r_$f&j(R!bOY4kYZ5qZr4krs7nsw4kwx5qx!^4k!^!_8p!_#O4k#O#P5q#P#o4k#o#p8p#p;'S4k;'S;=`:X<%lO4k&z5vX$f&jOr5qrs6cs!^5q!^!_6y!_#o5q#o#p6y#p;'S5q;'S;=`7h<%lO5q&z6jT$a`$f&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c`6|TOr6yrs7]s;'S6y;'S;=`7b<%lO6y`7bO$a``7eP;=`<%l6y&z7kP;=`<%l5q(^7w]$a`$f&j(R!bOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!r8uZ(R!bOY8pYZ6yZr8prs9hsw8pwx6yx#O8p#O#P6y#P;'S8p;'S;=`:R<%lO8p!r9oU$a`(R!bOY'}Zw'}x#O'}#P;'S'};'S;=`(f<%lO'}!r:UP;=`<%l8p(^:[P;=`<%l4k#%|:hh$f&j(Op(R!bOY%ZYZ&cZq%Zqr<Srs&}st%ZtuCruw%Zwx(rx!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr(r<__VS$f&j(Op(R!bOY<SYZ&cZr<Srs=^sw<Swx@nx!^<S!^!_Bm!_#O<S#O#P>`#P#o<S#o#pBm#p;'S<S;'S;=`Cl<%lO<S(Q=g]VS$f&j(R!bOY=^YZ&cZw=^wx>`x!^=^!^!_?q!_#O=^#O#P>`#P#o=^#o#p?q#p;'S=^;'S;=`@h<%lO=^&n>gXVS$f&jOY>`YZ&cZ!^>`!^!_?S!_#o>`#o#p?S#p;'S>`;'S;=`?k<%lO>`S?XSVSOY?SZ;'S?S;'S;=`?e<%lO?SS?hP;=`<%l?S&n?nP;=`<%l>`!f?xWVS(R!bOY?qZw?qwx?Sx#O?q#O#P?S#P;'S?q;'S;=`@b<%lO?q!f@eP;=`<%l?q(Q@kP;=`<%l=^'`@w]VS$f&j(OpOY@nYZ&cZr@nrs>`s!^@n!^!_Ap!_#O@n#O#P>`#P#o@n#o#pAp#p;'S@n;'S;=`Bg<%lO@ntAwWVS(OpOYApZrAprs?Ss#OAp#O#P?S#P;'SAp;'S;=`Ba<%lOAptBdP;=`<%lAp'`BjP;=`<%l@n#WBvYVS(Op(R!bOYBmZrBmrs?qswBmwxApx#OBm#O#P?S#P;'SBm;'S;=`Cf<%lOBm#WCiP;=`<%lBm(rCoP;=`<%l<S#%|C}i$f&j(g!L^(Op(R!bOY%ZYZ&cZr%Zrs&}st%ZtuCruw%Zwx(rx!Q%Z!Q![Cr![!^%Z!^!_*g!_!c%Z!c!}Cr!}#O%Z#O#P&c#P#R%Z#R#SCr#S#T%Z#T#oCr#o#p*g#p$g%Z$g;'SCr;'S;=`El<%lOCr#%|EoP;=`<%lCr(CSFRk$f&j(Op(R!b$Y#t'{&;d([!LYOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr+dHRk$f&j(Op(R!b$Y#tOY%ZYZ&cZr%Zrs&}st%ZtuGvuw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Gv![!^%Z!^!_*g!_!c%Z!c!}Gv!}#O%Z#O#P&c#P#R%Z#R#SGv#S#T%Z#T#oGv#o#p*g#p$g%Z$g;'SGv;'S;=`Iv<%lOGv+dIyP;=`<%lGv(CSJPP;=`<%lEr%#SJ_`$f&j(Op(R!b#l$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SKl_$f&j$O$Id(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&COLva(p&;`$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sv%ZvwM{wx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#SNW`$f&j#x$Id(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/|! c_(Q$)`$f&j(OpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b'l!!i_$f&j(OpOY!!bYZ!#hZr!!brs!#hsw!!bwx!$xx!^!!b!^!_!%z!_#O!!b#O#P!#h#P#o!!b#o#p!%z#p;'S!!b;'S;=`!'c<%lO!!b&z!#mX$f&jOw!#hwx6cx!^!#h!^!_!$Y!_#o!#h#o#p!$Y#p;'S!#h;'S;=`!$r<%lO!#h`!$]TOw!$Ywx7]x;'S!$Y;'S;=`!$l<%lO!$Y`!$oP;=`<%l!$Y&z!$uP;=`<%l!#h'l!%R]$a`$f&j(OpOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(r!Q!&PZ(OpOY!%zYZ!$YZr!%zrs!$Ysw!%zwx!&rx#O!%z#O#P!$Y#P;'S!%z;'S;=`!']<%lO!%z!Q!&yU$a`(OpOY)rZr)rs#O)r#P;'S)r;'S;=`*Z<%lO)r!Q!'`P;=`<%l!%z'l!'fP;=`<%l!!b(*Q!'t_!k(!b$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'l!)O_!jM|$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h!*[b$f&j(Op(R!b'|#)d#m$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rxz%Zz{!+d{!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S!+o`$f&j(Op(R!b#j$IdOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&-O!,|`$f&j(Op(R!bn&%`OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&C[!.Z_!Y&;l$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!/ec$f&j(Op(R!b|'<nOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!0p!P!Q%Z!Q![!3Y![!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!0ya$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!2O!P!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z!'d!2Z_!XMt$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!3eg$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!3Y![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S!3Y#S#X%Z#X#Y!4|#Y#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!5Vg$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx{%Z{|!6n|}%Z}!O!6n!O!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!6wc$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l!8_c$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![!8S![!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S!8S#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS!9uf$f&j(Op(R!b#k$IdOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpxz!;Zz{#,f{!P!;Z!P!Q#-{!Q!^!;Z!^!_#'Z!_!`#5k!`!a#7Q!a!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(r!;fb$f&j(Op(R!b!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(Q!<w`$f&j(R!b!USOY!<nYZ&cZw!<nwx!=yx!P!<n!P!Q!Eb!Q!^!<n!^!_!GY!_!}!<n!}#O!Ja#O#P!Dj#P#o!<n#o#p!GY#p;'S!<n;'S;=`!Kj<%lO!<n&n!>Q^$f&j!USOY!=yYZ&cZ!P!=y!P!Q!>|!Q!^!=y!^!_!@Y!_!}!=y!}#O!Bw#O#P!Dj#P#o!=y#o#p!@Y#p;'S!=y;'S;=`!E[<%lO!=y&n!?Ta$f&j!USO!^&c!_#Z&c#Z#[!>|#[#]&c#]#^!>|#^#a&c#a#b!>|#b#g&c#g#h!>|#h#i&c#i#j!>|#j#m&c#m#n!>|#n#o&c#p;'S&c;'S;=`&w<%lO&cS!@_X!USOY!@YZ!P!@Y!P!Q!@z!Q!}!@Y!}#O!Ac#O#P!Bb#P;'S!@Y;'S;=`!Bq<%lO!@YS!APU!US#Z#[!@z#]#^!@z#a#b!@z#g#h!@z#i#j!@z#m#n!@zS!AfVOY!AcZ#O!Ac#O#P!A{#P#Q!@Y#Q;'S!Ac;'S;=`!B[<%lO!AcS!BOSOY!AcZ;'S!Ac;'S;=`!B[<%lO!AcS!B_P;=`<%l!AcS!BeSOY!@YZ;'S!@Y;'S;=`!Bq<%lO!@YS!BtP;=`<%l!@Y&n!B|[$f&jOY!BwYZ&cZ!^!Bw!^!_!Ac!_#O!Bw#O#P!Cr#P#Q!=y#Q#o!Bw#o#p!Ac#p;'S!Bw;'S;=`!Dd<%lO!Bw&n!CwX$f&jOY!BwYZ&cZ!^!Bw!^!_!Ac!_#o!Bw#o#p!Ac#p;'S!Bw;'S;=`!Dd<%lO!Bw&n!DgP;=`<%l!Bw&n!DoX$f&jOY!=yYZ&cZ!^!=y!^!_!@Y!_#o!=y#o#p!@Y#p;'S!=y;'S;=`!E[<%lO!=y&n!E_P;=`<%l!=y(Q!Eki$f&j(R!b!USOY&}YZ&cZw&}wx&cx!^&}!^!_'}!_#O&}#O#P&c#P#Z&}#Z#[!Eb#[#]&}#]#^!Eb#^#a&}#a#b!Eb#b#g&}#g#h!Eb#h#i&}#i#j!Eb#j#m&}#m#n!Eb#n#o&}#o#p'}#p;'S&};'S;=`(l<%lO&}!f!GaZ(R!b!USOY!GYZw!GYwx!@Yx!P!GY!P!Q!HS!Q!}!GY!}#O!Ic#O#P!Bb#P;'S!GY;'S;=`!JZ<%lO!GY!f!HZb(R!b!USOY'}Zw'}x#O'}#P#Z'}#Z#[!HS#[#]'}#]#^!HS#^#a'}#a#b!HS#b#g'}#g#h!HS#h#i'}#i#j!HS#j#m'}#m#n!HS#n;'S'};'S;=`(f<%lO'}!f!IhX(R!bOY!IcZw!Icwx!Acx#O!Ic#O#P!A{#P#Q!GY#Q;'S!Ic;'S;=`!JT<%lO!Ic!f!JWP;=`<%l!Ic!f!J^P;=`<%l!GY(Q!Jh^$f&j(R!bOY!JaYZ&cZw!Jawx!Bwx!^!Ja!^!_!Ic!_#O!Ja#O#P!Cr#P#Q!<n#Q#o!Ja#o#p!Ic#p;'S!Ja;'S;=`!Kd<%lO!Ja(Q!KgP;=`<%l!Ja(Q!KmP;=`<%l!<n'`!Ky`$f&j(Op!USOY!KpYZ&cZr!Kprs!=ys!P!Kp!P!Q!L{!Q!^!Kp!^!_!Ns!_!}!Kp!}#O##z#O#P!Dj#P#o!Kp#o#p!Ns#p;'S!Kp;'S;=`#%T<%lO!Kp'`!MUi$f&j(Op!USOY(rYZ&cZr(rrs&cs!^(r!^!_)r!_#O(r#O#P&c#P#Z(r#Z#[!L{#[#](r#]#^!L{#^#a(r#a#b!L{#b#g(r#g#h!L{#h#i(r#i#j!L{#j#m(r#m#n!L{#n#o(r#o#p)r#p;'S(r;'S;=`*a<%lO(rt!NzZ(Op!USOY!NsZr!Nsrs!@Ys!P!Ns!P!Q# m!Q!}!Ns!}#O#!|#O#P!Bb#P;'S!Ns;'S;=`##t<%lO!Nst# tb(Op!USOY)rZr)rs#O)r#P#Z)r#Z#[# m#[#])r#]#^# m#^#a)r#a#b# m#b#g)r#g#h# m#h#i)r#i#j# m#j#m)r#m#n# m#n;'S)r;'S;=`*Z<%lO)rt##RX(OpOY#!|Zr#!|rs!Acs#O#!|#O#P!A{#P#Q!Ns#Q;'S#!|;'S;=`##n<%lO#!|t##qP;=`<%l#!|t##wP;=`<%l!Ns'`#$R^$f&j(OpOY##zYZ&cZr##zrs!Bws!^##z!^!_#!|!_#O##z#O#P!Cr#P#Q!Kp#Q#o##z#o#p#!|#p;'S##z;'S;=`#$}<%lO##z'`#%QP;=`<%l##z'`#%WP;=`<%l!Kp(r#%fk$f&j(Op(R!b!USOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#Z%Z#Z#[#%Z#[#]%Z#]#^#%Z#^#a%Z#a#b#%Z#b#g%Z#g#h#%Z#h#i%Z#i#j#%Z#j#m%Z#m#n#%Z#n#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#W#'d](Op(R!b!USOY#'ZZr#'Zrs!GYsw#'Zwx!Nsx!P#'Z!P!Q#(]!Q!}#'Z!}#O#)w#O#P!Bb#P;'S#'Z;'S;=`#*w<%lO#'Z#W#(fe(Op(R!b!USOY*gZr*grs'}sw*gwx)rx#O*g#P#Z*g#Z#[#(]#[#]*g#]#^#(]#^#a*g#a#b#(]#b#g*g#g#h#(]#h#i*g#i#j#(]#j#m*g#m#n#(]#n;'S*g;'S;=`+Z<%lO*g#W#*OZ(Op(R!bOY#)wZr#)wrs!Icsw#)wwx#!|x#O#)w#O#P!A{#P#Q#'Z#Q;'S#)w;'S;=`#*q<%lO#)w#W#*tP;=`<%l#)w#W#*zP;=`<%l#'Z(r#+W`$f&j(Op(R!bOY#*}YZ&cZr#*}rs!Jasw#*}wx##zx!^#*}!^!_#)w!_#O#*}#O#P!Cr#P#Q!;Z#Q#o#*}#o#p#)w#p;'S#*};'S;=`#,Y<%lO#*}(r#,]P;=`<%l#*}(r#,cP;=`<%l!;Z(CS#,sb$f&j(Op(R!b'v(;d!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z(CS#.W_$f&j(Op(R!bS(;dOY#-{YZ&cZr#-{rs#/Vsw#-{wx#2gx!^#-{!^!_#4f!_#O#-{#O#P#0X#P#o#-{#o#p#4f#p;'S#-{;'S;=`#5e<%lO#-{(Bb#/`]$f&j(R!bS(;dOY#/VYZ&cZw#/Vwx#0Xx!^#/V!^!_#1j!_#O#/V#O#P#0X#P#o#/V#o#p#1j#p;'S#/V;'S;=`#2a<%lO#/V(AO#0`X$f&jS(;dOY#0XYZ&cZ!^#0X!^!_#0{!_#o#0X#o#p#0{#p;'S#0X;'S;=`#1d<%lO#0X(;d#1QSS(;dOY#0{Z;'S#0{;'S;=`#1^<%lO#0{(;d#1aP;=`<%l#0{(AO#1gP;=`<%l#0X(<v#1qW(R!bS(;dOY#1jZw#1jwx#0{x#O#1j#O#P#0{#P;'S#1j;'S;=`#2Z<%lO#1j(<v#2^P;=`<%l#1j(Bb#2dP;=`<%l#/V(Ap#2p]$f&j(OpS(;dOY#2gYZ&cZr#2grs#0Xs!^#2g!^!_#3i!_#O#2g#O#P#0X#P#o#2g#o#p#3i#p;'S#2g;'S;=`#4`<%lO#2g(<U#3pW(OpS(;dOY#3iZr#3irs#0{s#O#3i#O#P#0{#P;'S#3i;'S;=`#4Y<%lO#3i(<U#4]P;=`<%l#3i(Ap#4cP;=`<%l#2g(=h#4oY(Op(R!bS(;dOY#4fZr#4frs#1jsw#4fwx#3ix#O#4f#O#P#0{#P;'S#4f;'S;=`#5_<%lO#4f(=h#5bP;=`<%l#4f(CS#5hP;=`<%l#-{%#W#5xb$f&j$O$Id(Op(R!b!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z+h#7_b$W#t$f&j(Op(R!b!USOY!;ZYZ&cZr!;Zrs!<nsw!;Zwx!Kpx!P!;Z!P!Q#%Z!Q!^!;Z!^!_#'Z!_!}!;Z!}#O#*}#O#P!Dj#P#o!;Z#o#p#'Z#p;'S!;Z;'S;=`#,`<%lO!;Z$/l#8rp$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#:v![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#:v#S#U%Z#U#V#>Q#V#X%Z#X#Y!4|#Y#b%Z#b#c#<v#c#d#AY#d#l%Z#l#m#D[#m#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#;Rk$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P!3Y!P!Q%Z!Q![#:v![!^%Z!^!_*g!_!g%Z!g!h!4|!h#O%Z#O#P&c#P#R%Z#R#S#:v#S#X%Z#X#Y!4|#Y#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#=R_$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#>Zd$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#?i!R!S#?i!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#?i#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#?tf$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!R#?i!R!S#?i!S!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#?i#S#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Acc$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#Bn!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#Bn#S#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Bye$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q!Y#Bn!Y!^%Z!^!_*g!_#O%Z#O#P&c#P#R%Z#R#S#Bn#S#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#Deg$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#E|![!^%Z!^!_*g!_!c%Z!c!i#E|!i#O%Z#O#P&c#P#R%Z#R#S#E|#S#T%Z#T#Z#E|#Z#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z$/l#FXi$f&j(Op(R!bo$'|OY%ZYZ&cZr%Zrs&}sw%Zwx(rx!Q%Z!Q![#E|![!^%Z!^!_*g!_!c%Z!c!i#E|!i#O%Z#O#P&c#P#R%Z#R#S#E|#S#T%Z#T#Z#E|#Z#b%Z#b#c#<v#c#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh#HT_!d$b$f&j#|%<f(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z)[#I__`l$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^#Jk^g!*v!h'.r(Op(R!b(tSOY*gZr*grs'}sw*gwx)rx!P*g!P!Q#Kg!Q!^*g!^!_#L]!_!`#M}!`#O*g#P;'S*g;'S;=`+Z<%lO*g(n#KpX$h&j(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#LfZ#n$Id(Op(R!bOY*gZr*grs'}sw*gwx)rx!_*g!_!`#MX!`#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#MbX$O$Id(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g$Kh#NWX#o$Id(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g%Gh$ Oa#[%?x$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`0z!`!a$!T!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#W$!`_#g$Ih$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%Gh$#nafBf#o$Id$c#|$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`$$s!`!a$%}!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$%O_#o$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$&Ya#n$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`!a$'_!a#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$'j`#n$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+h$(wc(h$Ip$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!O%Z!O!P$*S!P!^%Z!^!_*g!_!a%Z!a!b$+^!b#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z'+`$*__}'#p$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$+i`$f&j#y$Id(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z#&^$,v_!{!Ln$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(@^$.Q_!P(8n$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(n$/UZ$f&jO!^$/w!^!_$0_!_#i$/w#i#j$0d#j#l$/w#l#m$2V#m#o$/w#o#p$0_#p;'S$/w;'S;=`$4b<%lO$/w(n$0OT^#S$f&jO!^&c!_#o&c#p;'S&c;'S;=`&w<%lO&c#S$0dO^#S(n$0i[$f&jO!Q&c!Q![$1_![!^&c!_!c&c!c!i$1_!i#T&c#T#Z$1_#Z#o&c#o#p$3u#p;'S&c;'S;=`&w<%lO&c(n$1dZ$f&jO!Q&c!Q![$2V![!^&c!_!c&c!c!i$2V!i#T&c#T#Z$2V#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$2[Z$f&jO!Q&c!Q![$2}![!^&c!_!c&c!c!i$2}!i#T&c#T#Z$2}#Z#o&c#p;'S&c;'S;=`&w<%lO&c(n$3SZ$f&jO!Q&c!Q![$/w![!^&c!_!c&c!c!i$/w!i#T&c#T#Z$/w#Z#o&c#p;'S&c;'S;=`&w<%lO&c#S$3xR!Q![$4R!c!i$4R#T#Z$4R#S$4US!Q![$4R!c!i$4R#T#Z$4R#q#r$0_(n$4eP;=`<%l$/w!2r$4s_!V!+S$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z%#S$5}`#v$Id$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z&,v$7[_$f&j(Op(R!b(X&%WOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$8jk$f&j(Op(R!b'{&;d$[#t([!LYOY%ZYZ&cZr%Zrs&}st%Ztu$8Zuw%Zwx(rx}%Z}!O$:_!O!Q%Z!Q![$8Z![!^%Z!^!_*g!_!c%Z!c!}$8Z!}#O%Z#O#P&c#P#R%Z#R#S$8Z#S#T%Z#T#o$8Z#o#p*g#p$g%Z$g;'S$8Z;'S;=`$<e<%lO$8Z+d$:jk$f&j(Op(R!b$[#tOY%ZYZ&cZr%Zrs&}st%Ztu$:_uw%Zwx(rx}%Z}!O$:_!O!Q%Z!Q![$:_![!^%Z!^!_*g!_!c%Z!c!}$:_!}#O%Z#O#P&c#P#R%Z#R#S$:_#S#T%Z#T#o$:_#o#p*g#p$g%Z$g;'S$:_;'S;=`$<_<%lO$:_+d$<bP;=`<%l$:_(CS$<hP;=`<%l$8Z!5p$<tX![!3l(Op(R!bOY*gZr*grs'}sw*gwx)rx#O*g#P;'S*g;'S;=`+Z<%lO*g&CO$=la(o&;`$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_!`Ka!`#O%Z#O#P&c#P#o%Z#o#p*g#p#q$+^#q;'S%Z;'S;=`+a<%lO%Z%#`$?O_!Z$I`r`$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(r$@Y_!pS$f&j(Op(R!bOY%ZYZ&cZr%Zrs&}sw%Zwx(rx!^%Z!^!_*g!_#O%Z#O#P&c#P#o%Z#o#p*g#p;'S%Z;'S;=`+a<%lO%Z(CS$Aj|$f&j(Op(R!b't(;d$Y#t'{&;d([!LYOX%ZXY+gYZ&cZ[+g[p%Zpq+gqr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$f%Z$f$g+g$g#BYEr#BY#BZ$AX#BZ$ISEr$IS$I_$AX$I_$JTEr$JT$JU$AX$JU$KVEr$KV$KW$AX$KW&FUEr&FU&FV$AX&FV;'SEr;'S;=`I|<%l?HTEr?HT?HU$AX?HUOEr(CS$Duk$f&j(Op(R!b'u(;d$Y#t'{&;d([!LYOY%ZYZ&cZr%Zrs&}st%ZtuEruw%Zwx(rx}%Z}!OGv!O!Q%Z!Q![Er![!^%Z!^!_*g!_!c%Z!c!}Er!}#O%Z#O#P&c#P#R%Z#R#SEr#S#T%Z#T#oEr#o#p*g#p$g%Z$g;'SEr;'S;=`I|<%lOEr",tokenizers:[noSemicolon,incdecToken,jsx,2,3,4,5,6,7,8,9,10,11,12,13,insertSemicolon,new LocalTokenGroup("$S~RRtu[#O#Pg#S#T#|~_P#o#pb~gOt~~jVO#i!P#i#j!U#j#l!P#l#m!q#m;'S!P;'S;=`#v<%lO!P~!UO!R~~!XS!Q![!e!c!i!e#T#Z!e#o#p#Z~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!P!c!i!P#T#Z!P~#^R!Q![#g!c!i#g#T#Z#g~#jS!Q![#g!c!i#g#T#Z#g#q#r!P~#yP;=`<%l!P~$RO(Z~~",141,332),new LocalTokenGroup("j~RQYZXz{^~^O'x~~aP!P!Qd~iO'y~~",25,315)],topRules:{Script:[0,6],SingleExpression:[1,269],SingleClassItem:[2,270]},dialects:{jsx:0,ts:14602},dynamicPrecedences:{69:1,79:1,81:1,165:1,193:1},specialized:[{term:319,get:e=>spec_identifier[e]||-1},{term:334,get:e=>spec_word[e]||-1},{term:70,get:e=>spec_LessThan[e]||-1}],tokenPrec:14626}),snippets=[snippetCompletion("function ${name}(${params}) {\n\t${}\n}",{label:"function",detail:"definition",type:"keyword"}),snippetCompletion("for (let ${index} = 0; ${index} < ${bound}; ${index}++) {\n\t${}\n}",{label:"for",detail:"loop",type:"keyword"}),snippetCompletion("for (let ${name} of ${collection}) {\n\t${}\n}",{label:"for",detail:"of loop",type:"keyword"}),snippetCompletion("do {\n\t${}\n} while (${})",{label:"do",detail:"loop",type:"keyword"}),snippetCompletion("while (${}) {\n\t${}\n}",{label:"while",detail:"loop",type:"keyword"}),snippetCompletion("try {\n\t${}\n} catch (${error}) {\n\t${}\n}",{label:"try",detail:"/ catch block",type:"keyword"}),snippetCompletion("if (${}) {\n\t${}\n}",{label:"if",detail:"block",type:"keyword"}),snippetCompletion("if (${}) {\n\t${}\n} else {\n\t${}\n}",{label:"if",detail:"/ else block",type:"keyword"}),snippetCompletion("class ${name} {\n\tconstructor(${params}) {\n\t\t${}\n\t}\n}",{label:"class",detail:"definition",type:"keyword"}),snippetCompletion('import {${names}} from "${module}"\n${}',{label:"import",detail:"named",type:"keyword"}),snippetCompletion('import ${name} from "${module}"\n${}',{label:"import",detail:"default",type:"keyword"})],typescriptSnippets=snippets.concat([snippetCompletion("interface ${name} {\n\t${}\n}",{label:"interface",detail:"definition",type:"keyword"}),snippetCompletion("type ${name} = ${type}",{label:"type",detail:"definition",type:"keyword"}),snippetCompletion("enum ${name} {\n\t${}\n}",{label:"enum",detail:"definition",type:"keyword"})]),cache=new NodeWeakMap,ScopeNodes=new Set(["Script","Block","FunctionExpression","FunctionDeclaration","ArrowFunction","MethodDeclaration","ForStatement"]);function defID(e){return(t,n)=>{let i=t.node.getChild("VariableDefinition");return i&&n(i,e),!0}}const functionContext=["FunctionDeclaration"],gatherCompletions={FunctionDeclaration:defID("function"),ClassDeclaration:defID("class"),ClassExpression:()=>!0,EnumDeclaration:defID("constant"),TypeAliasDeclaration:defID("type"),NamespaceDeclaration:defID("namespace"),VariableDefinition(e,t){e.matchContext(functionContext)||t(e,"variable")},TypeDefinition(e,t){t(e,"type")},__proto__:null};function getScope(e,t){let n=cache.get(t);if(n)return n;let i=[],r=!0;function s(t,n){let r=e.sliceString(t.from,t.to);i.push({label:r,type:n})}return t.cursor(IterMode.IncludeAnonymous).iterate((t=>{if(r)r=!1;else if(t.name){let e=gatherCompletions[t.name];if(e&&e(t,s)||ScopeNodes.has(t.name))return!1}else if(t.to-t.from>8192){for(let n of getScope(e,t.node))i.push(n);return!1}})),cache.set(t,i),i}const Identifier=/^[\w$\xa1-\uffff][\w$\d\xa1-\uffff]*$/,dontComplete=["TemplateString","String","RegExp","LineComment","BlockComment","VariableDefinition","TypeDefinition","Label","PropertyDefinition","PropertyName","PrivatePropertyDefinition","PrivatePropertyName",".","?."];function localCompletionSource(e){let t=syntaxTree(e.state).resolveInner(e.pos,-1);if(dontComplete.indexOf(t.name)>-1)return null;let n="VariableName"==t.name||t.to-t.from<20&&Identifier.test(e.state.sliceDoc(t.from,t.to));if(!n&&!e.explicit)return null;let i=[];for(let n=t;n;n=n.parent)ScopeNodes.has(n.name)&&(i=i.concat(getScope(e.state.doc,n)));return{options:i,from:n?t.from:e.pos,validFor:Identifier}}const javascriptLanguage=LRLanguage.define({name:"javascript",parser:parser.configure({props:[indentNodeProp.add({IfStatement:continuedIndent({except:/^\s*({|else\b)/}),TryStatement:continuedIndent({except:/^\s*({|catch\b|finally\b)/}),LabeledStatement:flatIndent,SwitchBody:e=>{let t=e.textAfter,n=/^\s*\}/.test(t),i=/^\s*(case|default)\b/.test(t);return e.baseIndent+(n?0:i?1:2)*e.unit},Block:delimitedIndent({closing:"}"}),ArrowFunction:e=>e.baseIndent+e.unit,"TemplateString BlockComment":()=>null,"Statement Property":continuedIndent({except:/^{/}),JSXElement(e){let t=/^\s*<\//.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},JSXEscape(e){let t=/\s*\}/.test(e.textAfter);return e.lineIndent(e.node.from)+(t?0:e.unit)},"JSXOpenTag JSXSelfClosingTag":e=>e.column(e.node.from)+e.unit}),foldNodeProp.add({"Block ClassBody SwitchBody EnumBody ObjectExpression ArrayExpression ObjectType":foldInside,BlockComment:e=>({from:e.from+2,to:e.to-2})})]}),languageData:{closeBrackets:{brackets:["(","[","{","'",'"',"`"]},commentTokens:{line:"//",block:{open:"/*",close:"*/"}},indentOnInput:/^\s*(?:case |default:|\{|\}|<\/)$/,wordChars:"$"}}),jsxSublanguage={test:e=>/^JSX/.test(e.name),facet:defineLanguageFacet({commentTokens:{block:{open:"{/*",close:"*/}"}}})},typescriptLanguage=javascriptLanguage.configure({dialect:"ts"},"typescript"),jsxLanguage=javascriptLanguage.configure({dialect:"jsx",props:[sublanguageProp.add((e=>e.isTop?[jsxSublanguage]:void 0))]}),tsxLanguage=javascriptLanguage.configure({dialect:"jsx ts",props:[sublanguageProp.add((e=>e.isTop?[jsxSublanguage]:void 0))]},"typescript");let kwCompletion=e=>({label:e,type:"keyword"});const keywords="break case const continue default delete export extends false finally in instanceof let new return static super switch this throw true typeof var yield".split(" ").map(kwCompletion),typescriptKeywords=keywords.concat(["declare","implements","private","protected","public"].map(kwCompletion));function javascript(e={}){let t=e.jsx?e.typescript?tsxLanguage:jsxLanguage:e.typescript?typescriptLanguage:javascriptLanguage,n=e.typescript?typescriptSnippets.concat(typescriptKeywords):snippets.concat(keywords);return new LanguageSupport(t,[javascriptLanguage.data.of({autocomplete:ifNotIn(dontComplete,completeFromList(n))}),javascriptLanguage.data.of({autocomplete:localCompletionSource}),e.jsx?autoCloseTags$1:[]])}function findOpenTag(e){for(;;){if("JSXOpenTag"==e.name||"JSXSelfClosingTag"==e.name||"JSXFragmentTag"==e.name)return e;if("JSXEscape"==e.name||!e.parent)return null;e=e.parent}}function elementName$1(e,t,n=e.length){for(let i=null==t?void 0:t.firstChild;i;i=i.nextSibling)if("JSXIdentifier"==i.name||"JSXBuiltin"==i.name||"JSXNamespacedName"==i.name||"JSXMemberExpression"==i.name)return e.sliceString(i.from,Math.min(i.to,n));return""}const android="object"==typeof navigator&&/Android\b/.test(navigator.userAgent),autoCloseTags$1=EditorView.inputHandler.of(((e,t,n,i,r)=>{if((android?e.composing:e.compositionStarted)||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!javascriptLanguage.isActiveAt(e.state,t,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange((e=>{var t;let n,{head:r}=e,s=syntaxTree(o).resolveInner(r-1,-1);if("JSXStartTag"==s.name&&(s=s.parent),o.doc.sliceString(r-1,r)!=i||"JSXAttributeValue"==s.name&&s.to>r);else{if(">"==i&&"JSXFragmentTag"==s.name)return{range:e,changes:{from:r,insert:"</>"}};if("/"==i&&"JSXStartCloseTag"==s.name){let e=s.parent,i=e.parent;if(i&&e.from==r-2&&((n=elementName$1(o.doc,i.firstChild,r))||"JSXFragmentTag"==(null===(t=i.firstChild)||void 0===t?void 0:t.name))){let e=`${n}>`;return{range:EditorSelection.cursor(r+e.length,-1),changes:{from:r,insert:e}}}}else if(">"==i){let t=findOpenTag(s);if(t&&!/^\/?>|^<\//.test(o.doc.sliceString(r,r+2))&&(n=elementName$1(o.doc,t,r)))return{range:e,changes:{from:r,insert:`</${n}>`}}}}return{range:e}}));return!a.changes.empty&&(e.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)})),Targets=["_blank","_self","_top","_parent"],Charsets=["ascii","utf-8","utf-16","latin1","latin1"],Methods=["get","post","put","delete"],Encs=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],Bool=["true","false"],S={},Tags={a:{attrs:{href:null,ping:null,type:null,media:null,target:Targets,hreflang:null}},abbr:S,address:S,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:null,hreflang:null,type:null,shape:["default","rect","circle","poly"]}},article:S,aside:S,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["autoplay"],loop:["loop"],controls:["controls"]}},b:S,base:{attrs:{href:null,target:Targets}},bdi:S,bdo:S,blockquote:{attrs:{cite:null}},body:S,br:S,button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["autofocus"],disabled:["autofocus"],formenctype:Encs,formmethod:Methods,formnovalidate:["novalidate"],formtarget:Targets,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:S,center:S,cite:S,code:S,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["disabled"],checked:["checked"]}},data:{attrs:{value:null}},datagrid:{attrs:{disabled:["disabled"],multiple:["multiple"]}},datalist:{attrs:{data:null}},dd:S,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["open"]}},dfn:S,div:S,dl:S,dt:S,em:S,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["disabled"],form:null,name:null}},figcaption:S,figure:S,footer:S,form:{attrs:{action:null,name:null,"accept-charset":Charsets,autocomplete:["on","off"],enctype:Encs,method:Methods,novalidate:["novalidate"],target:Targets}},h1:S,h2:S,h3:S,h4:S,h5:S,h6:S,head:{children:["title","base","link","style","meta","script","noscript","command"]},header:S,hgroup:S,hr:S,html:{attrs:{manifest:null}},i:S,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["autofocus"],checked:["checked"],disabled:["disabled"],formenctype:Encs,formmethod:Methods,formnovalidate:["novalidate"],formtarget:Targets,multiple:["multiple"],readonly:["readonly"],required:["required"],type:["hidden","text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","number","range","color","checkbox","radio","file","submit","image","reset","button"]}},ins:{attrs:{cite:null,datetime:null}},kbd:S,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["autofocus"],disabled:["disabled"],keytype:["RSA"]}},label:{attrs:{for:null,form:null}},legend:S,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,hreflang:null,media:null,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:S,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:Charsets,name:["viewport","application-name","author","description","generator","keywords"],"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:S,noscript:S,object:{attrs:{data:null,type:null,name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["typemustmatch"]}},ol:{attrs:{reversed:["reversed"],start:null,type:["1","a","A","i","I"]},children:["li","script","template","ul","ol"]},optgroup:{attrs:{disabled:["disabled"],label:null}},option:{attrs:{disabled:["disabled"],label:null,selected:["selected"],value:null}},output:{attrs:{for:null,form:null,name:null}},p:S,param:{attrs:{name:null,value:null}},pre:S,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:S,rt:S,ruby:S,samp:S,script:{attrs:{type:["text/javascript"],src:null,async:["async"],defer:["defer"],charset:Charsets}},section:S,select:{attrs:{form:null,name:null,size:null,autofocus:["autofocus"],disabled:["disabled"],multiple:["multiple"]}},slot:{attrs:{name:null}},small:S,source:{attrs:{src:null,type:null,media:null}},span:S,strong:S,style:{attrs:{type:["text/css"],media:null,scoped:null}},sub:S,summary:S,sup:S,table:S,tbody:S,td:{attrs:{colspan:null,rowspan:null,headers:null}},template:S,textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,cols:null,autofocus:["autofocus"],disabled:["disabled"],readonly:["readonly"],required:["required"],wrap:["soft","hard"]}},tfoot:S,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:S,time:{attrs:{datetime:null}},title:S,tr:S,track:{attrs:{src:null,label:null,default:null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:null}},ul:{children:["li","script","template","ul","ol"]},var:S,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous","use-credentials"],preload:["auto","metadata","none"],autoplay:["autoplay"],mediagroup:["movie"],muted:["muted"],controls:["controls"]}},wbr:S},GlobalAttrs={accesskey:null,class:null,contenteditable:Bool,contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,lang:["ar","bn","de","en-GB","en-US","es","fr","hi","id","ja","pa","pt","ru","tr","zh"],spellcheck:Bool,autocorrect:Bool,autocapitalize:Bool,style:null,tabindex:null,title:null,translate:["yes","no"],rel:["stylesheet","alternate","author","bookmark","help","license","next","nofollow","noreferrer","prefetch","prev","search","tag"],role:"alert application article banner button cell checkbox complementary contentinfo dialog document feed figure form grid gridcell heading img list listbox listitem main navigation region row rowgroup search switch tab table tabpanel textbox timer".split(" "),"aria-activedescendant":null,"aria-atomic":Bool,"aria-autocomplete":["inline","list","both","none"],"aria-busy":Bool,"aria-checked":["true","false","mixed","undefined"],"aria-controls":null,"aria-describedby":null,"aria-disabled":Bool,"aria-dropeffect":null,"aria-expanded":["true","false","undefined"],"aria-flowto":null,"aria-grabbed":["true","false","undefined"],"aria-haspopup":Bool,"aria-hidden":Bool,"aria-invalid":["true","false","grammar","spelling"],"aria-label":null,"aria-labelledby":null,"aria-level":null,"aria-live":["off","polite","assertive"],"aria-multiline":Bool,"aria-multiselectable":Bool,"aria-owns":null,"aria-posinset":null,"aria-pressed":["true","false","mixed","undefined"],"aria-readonly":Bool,"aria-relevant":null,"aria-required":Bool,"aria-selected":["true","false","undefined"],"aria-setsize":null,"aria-sort":["ascending","descending","none","other"],"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null,"aria-valuetext":null},eventAttributes="beforeunload copy cut dragstart dragover dragleave dragenter dragend drag paste focus blur change click load mousedown mouseenter mouseleave mouseup keydown keyup resize scroll unload".split(" ").map((e=>"on"+e));for(let e of eventAttributes)GlobalAttrs[e]=null;class Schema{constructor(e,t){this.tags=Object.assign(Object.assign({},Tags),e),this.globalAttrs=Object.assign(Object.assign({},GlobalAttrs),t),this.allTags=Object.keys(this.tags),this.globalAttrNames=Object.keys(this.globalAttrs)}}function elementName(e,t,n=e.length){if(!t)return"";let i=t.firstChild,r=i&&i.getChild("TagName");return r?e.sliceString(r.from,Math.min(r.to,n)):""}function findParentElement(e,t=!1){for(;e;e=e.parent)if("Element"==e.name){if(!t)return e;t=!1}return null}function allowedChildren(e,t,n){let i=n.tags[elementName(e,findParentElement(t))];return(null==i?void 0:i.children)||n.allTags}function openTags(e,t){let n=[];for(let i=findParentElement(t);i&&!i.type.isTop;i=findParentElement(i.parent)){let r=elementName(e,i);if(r&&"CloseTag"==i.lastChild.name)break;r&&n.indexOf(r)<0&&("EndTag"==t.name||t.from>=i.firstChild.to)&&n.push(r)}return n}Schema.default=new Schema;const identifier=/^[:\-\.\w\u00b7-\uffff]*$/;function completeTag(e,t,n,i,r){let s=/\s*>/.test(e.sliceDoc(r,r+5))?"":">",o=findParentElement(n,!0);return{from:i,to:r,options:allowedChildren(e.doc,o,t).map((e=>({label:e,type:"type"}))).concat(openTags(e.doc,n).map(((e,t)=>({label:"/"+e,apply:"/"+e+s,type:"type",boost:99-t})))),validFor:/^\/?[:\-\.\w\u00b7-\uffff]*$/}}function completeCloseTag(e,t,n,i){let r=/\s*>/.test(e.sliceDoc(i,i+5))?"":">";return{from:n,to:i,options:openTags(e.doc,t).map(((e,t)=>({label:e,apply:e+r,type:"type",boost:99-t}))),validFor:identifier}}function completeStartTag(e,t,n,i){let r=[],s=0;for(let i of allowedChildren(e.doc,n,t))r.push({label:"<"+i,type:"type"});for(let t of openTags(e.doc,n))r.push({label:"</"+t+">",type:"type",boost:99-s++});return{from:i,to:i,options:r,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}function completeAttrName(e,t,n,i,r){let s=findParentElement(n),o=s?t.tags[elementName(e.doc,s)]:null,a=o&&o.attrs?Object.keys(o.attrs):[];return{from:i,to:r,options:(o&&!1===o.globalAttrs?a:a.length?a.concat(t.globalAttrNames):t.globalAttrNames).map((e=>({label:e,type:"property"}))),validFor:identifier}}function completeAttrValue(e,t,n,i,r){var s;let o,a=null===(s=n.parent)||void 0===s?void 0:s.getChild("AttributeName"),l=[];if(a){let s=e.sliceDoc(a.from,a.to),c=t.globalAttrs[s];if(!c){let i=findParentElement(n),r=i?t.tags[elementName(e.doc,i)]:null;c=(null==r?void 0:r.attrs)&&r.attrs[s]}if(c){let t=e.sliceDoc(i,r).toLowerCase(),n='"',s='"';/^['"]/.test(t)?(o='"'==t[0]?/^[^"]*$/:/^[^']*$/,n="",s=e.sliceDoc(r,r+1)==t[0]?"":t[0],t=t.slice(1),i++):o=/^[^\s<>='"]*$/;for(let e of c)l.push({label:e,apply:n+e+s,type:"constant"})}}return{from:i,to:r,options:l,validFor:o}}function htmlCompletionFor(e,t){let{state:n,pos:i}=t,r=syntaxTree(n).resolveInner(i,-1),s=r.resolve(i);for(let e,t=i;s==r&&(e=r.childBefore(t));){let n=e.lastChild;if(!n||!n.type.isError||n.from<n.to)break;s=r=e,t=n.from}return"TagName"==r.name?r.parent&&/CloseTag$/.test(r.parent.name)?completeCloseTag(n,r,r.from,i):completeTag(n,e,r,r.from,i):"StartTag"==r.name?completeTag(n,e,r,i,i):"StartCloseTag"==r.name||"IncompleteCloseTag"==r.name?completeCloseTag(n,r,i,i):t.explicit&&("OpenTag"==r.name||"SelfClosingTag"==r.name)||"AttributeName"==r.name?completeAttrName(n,e,r,"AttributeName"==r.name?r.from:i,i):"Is"==r.name||"AttributeValue"==r.name||"UnquotedAttributeValue"==r.name?completeAttrValue(n,e,r,"Is"==r.name?i:r.from,i):!t.explicit||"Element"!=s.name&&"Text"!=s.name&&"Document"!=s.name?null:completeStartTag(n,e,r,i)}function htmlCompletionSource(e){return htmlCompletionFor(Schema.default,e)}function htmlCompletionSourceWith(e){let{extraTags:t,extraGlobalAttributes:n}=e,i=n||t?new Schema(t,n):Schema.default;return e=>htmlCompletionFor(i,e)}const jsonParser=javascriptLanguage.parser.configure({top:"SingleExpression"}),defaultNesting=[{tag:"script",attrs:e=>"text/typescript"==e.type||"ts"==e.lang,parser:typescriptLanguage.parser},{tag:"script",attrs:e=>"text/babel"==e.type||"text/jsx"==e.type,parser:jsxLanguage.parser},{tag:"script",attrs:e=>"text/typescript-jsx"==e.type,parser:tsxLanguage.parser},{tag:"script",attrs:e=>/^(importmap|speculationrules|application\/(.+\+)?json)$/i.test(e.type),parser:jsonParser},{tag:"script",attrs:e=>!e.type||/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i.test(e.type),parser:javascriptLanguage.parser},{tag:"style",attrs:e=>(!e.lang||"css"==e.lang)&&(!e.type||/^(text\/)?(x-)?(stylesheet|css)$/i.test(e.type)),parser:cssLanguage.parser}],defaultAttrs=[{name:"style",parser:cssLanguage.parser.configure({top:"Styles"})}].concat(eventAttributes.map((e=>({name:e,parser:javascriptLanguage.parser})))),htmlPlain=LRLanguage.define({name:"html",parser:parser$2.configure({props:[indentNodeProp.add({Element(e){let t=/^(\s*)(<\/)?/.exec(e.textAfter);return e.node.to<=e.pos+t[0].length?e.continue():e.lineIndent(e.node.from)+(t[2]?0:e.unit)},"OpenTag CloseTag SelfClosingTag":e=>e.column(e.node.from)+e.unit,Document(e){if(e.pos+/\s*/.exec(e.textAfter)[0].length<e.node.to)return e.continue();let t,n=null;for(let t=e.node;;){let e=t.lastChild;if(!e||"Element"!=e.name||e.to!=t.to)break;n=t=e}return n&&(!(t=n.lastChild)||"CloseTag"!=t.name&&"SelfClosingTag"!=t.name)?e.lineIndent(n.from)+e.unit:null}}),foldNodeProp.add({Element(e){let t=e.firstChild,n=e.lastChild;return t&&"OpenTag"==t.name?{from:t.to,to:"CloseTag"==n.name?n.from:e.to}:null}}),bracketMatchingHandle.add({"OpenTag CloseTag":e=>e.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}},indentOnInput:/^\s*<\/\w+\W$/,wordChars:"-._"}}),htmlLanguage=htmlPlain.configure({wrap:configureNesting(defaultNesting,defaultAttrs)});function html(e={}){let t,n="";!1===e.matchClosingTags&&(n="noMatch"),!0===e.selfClosingTags&&(n=(n?n+" ":"")+"selfClosing"),(e.nestedLanguages&&e.nestedLanguages.length||e.nestedAttributes&&e.nestedAttributes.length)&&(t=configureNesting((e.nestedLanguages||[]).concat(defaultNesting),(e.nestedAttributes||[]).concat(defaultAttrs)));let i=t?htmlPlain.configure({wrap:t,dialect:n}):n?htmlLanguage.configure({dialect:n}):htmlLanguage;return new LanguageSupport(i,[htmlLanguage.data.of({autocomplete:htmlCompletionSourceWith(e)}),!1!==e.autoCloseTags?autoCloseTags:[],javascript().support,css().support])}const selfClosers=new Set("area base br col command embed frame hr img input keygen link meta param source track wbr menuitem".split(" ")),autoCloseTags=EditorView.inputHandler.of(((e,t,n,i,r)=>{if(e.composing||e.state.readOnly||t!=n||">"!=i&&"/"!=i||!htmlLanguage.isActiveAt(e.state,t,-1))return!1;let s=r(),{state:o}=s,a=o.changeByRange((e=>{var t,n,r;let s,a=o.doc.sliceString(e.from-1,e.to)==i,{head:l}=e,c=syntaxTree(o).resolveInner(l-1,-1);if("TagName"!=c.name&&"StartTag"!=c.name||(c=c.parent),a&&">"==i&&"OpenTag"==c.name){if("CloseTag"!=(null===(n=null===(t=c.parent)||void 0===t?void 0:t.lastChild)||void 0===n?void 0:n.name)&&(s=elementName(o.doc,c.parent,l))&&!selfClosers.has(s)){return{range:e,changes:{from:l,to:l+(">"===o.doc.sliceString(l,l+1)?1:0),insert:`</${s}>`}}}}else if(a&&"/"==i&&"IncompleteCloseTag"==c.name){let e=c.parent;if(c.from==l-2&&"CloseTag"!=(null===(r=e.lastChild)||void 0===r?void 0:r.name)&&(s=elementName(o.doc,e,l))&&!selfClosers.has(s)){let e=l+(">"===o.doc.sliceString(l,l+1)?1:0),t=`${s}>`;return{range:EditorSelection.cursor(l+t.length,-1),changes:{from:l,to:e,insert:t}}}}return{range:e}}));return!a.changes.empty&&(e.dispatch([s,o.update(a,{userEvent:"input.complete",scrollIntoView:!0})]),!0)})),data=defineLanguageFacet({commentTokens:{block:{open:"\x3c!--",close:"--\x3e"}}}),headingProp=new NodeProp,commonmark=parser$3.configure({props:[foldNodeProp.add((e=>!e.is("Block")||e.is("Document")||null!=isHeading(e)?void 0:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to}))),headingProp.add(isHeading),indentNodeProp.add({Document:()=>null}),languageDataProp.add({Document:data})]});function isHeading(e){let t=/^(?:ATX|Setext)Heading(\d)$/.exec(e.name);return t?+t[1]:void 0}function findSectionEnd(e,t){let n=e;for(;;){let e,i=n.nextSibling;if(!i||null!=(e=isHeading(i.type))&&e<=t)break;n=i}return n.to}const headerIndent=foldService.of(((e,t,n)=>{for(let i=syntaxTree(e).resolveInner(n,-1);i&&!(i.from<t);i=i.parent){let e=i.type.prop(headingProp);if(null==e)continue;let t=findSectionEnd(i,e);if(t>n)return{from:n,to:t}}return null}));function mkLang(e){return new Language(data,e,[headerIndent],"markdown")}const commonmarkLanguage=mkLang(commonmark),extended=commonmark.configure([GFM,Subscript,Superscript,Emoji,{props:[foldNodeProp.add({Table:(e,t)=>({from:t.doc.lineAt(e.from).to,to:e.to})})]}]),markdownLanguage=mkLang(extended);function getCodeParser(e,t){return n=>{if(n&&e){let t=null;if(n=/\S*/.exec(n)[0],t="function"==typeof e?e(n):LanguageDescription.matchLanguageName(e,n,!0),t instanceof LanguageDescription)return t.support?t.support.language.parser:ParseContext.getSkippingParser(t.load());if(t)return t.parser}return t?t.parser:null}}class Context{constructor(e,t,n,i,r,s,o){this.node=e,this.from=t,this.to=n,this.spaceBefore=i,this.spaceAfter=r,this.type=s,this.item=o}blank(e,t=!0){let n=this.spaceBefore+("Blockquote"==this.node.name?">":"");if(null!=e){for(;n.length<e;)n+=" ";return n}for(let e=this.to-this.from-n.length-this.spaceAfter.length;e>0;e--)n+=" ";return n+(t?this.spaceAfter:"")}marker(e,t){let n="OrderedList"==this.node.name?String(+itemNumber(this.item,e)[2]+t):"";return this.spaceBefore+n+this.type+this.spaceAfter}}function getContext(e,t){let n=[];for(let t=e;t&&"Document"!=t.name;t=t.parent)"ListItem"!=t.name&&"Blockquote"!=t.name&&"FencedCode"!=t.name||n.push(t);let i=[];for(let e=n.length-1;e>=0;e--){let r,s=n[e],o=t.lineAt(s.from),a=s.from-o.from;if("FencedCode"==s.name)i.push(new Context(s,a,a,"","","",null));else if("Blockquote"==s.name&&(r=/^ *>( ?)/.exec(o.text.slice(a))))i.push(new Context(s,a,a+r[0].length,"",r[1],">",null));else if("ListItem"==s.name&&"OrderedList"==s.parent.name&&(r=/^( *)\d+([.)])( *)/.exec(o.text.slice(a)))){let e=r[3],t=r[0].length;e.length>=4&&(e=e.slice(0,e.length-4),t-=4),i.push(new Context(s.parent,a,a+t,r[1],e,r[2],s))}else if("ListItem"==s.name&&"BulletList"==s.parent.name&&(r=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(o.text.slice(a)))){let e=r[4],t=r[0].length;e.length>4&&(e=e.slice(0,e.length-4),t-=4);let n=r[2];r[3]&&(n+=r[3].replace(/[xX]/," ")),i.push(new Context(s.parent,a,a+t,r[1],e,n,s))}}return i}function itemNumber(e,t){return/^(\s*)(\d+)(?=[.)])/.exec(t.sliceString(e.from,e.from+10))}function renumberList(e,t,n,i=0){for(let r=-1,s=e;;){if("ListItem"==s.name){let e=itemNumber(s,t),o=+e[2];if(r>=0){if(o!=r+1)return;n.push({from:s.from+e[1].length,to:s.from+e[0].length,insert:String(r+2+i)})}r=o}let e=s.nextSibling;if(!e)break;s=e}}function normalizeIndent(e,t){let n=/^[ \t]*/.exec(e)[0].length;if(!n||"\t"!=t.facet(indentUnit))return e;let i="";for(let t=countColumn(e,4,n);t>0;)t>=4?(i+="\t",t-=4):(i+=" ",t--);return i+e.slice(n)}const insertNewlineContinueMarkup=({state:e,dispatch:t})=>{let n=syntaxTree(e),{doc:i}=e,r=null,s=e.changeByRange((t=>{if(!t.empty||!markdownLanguage.isActiveAt(e,t.from))return r={range:t};let s=t.from,o=i.lineAt(s),a=getContext(n.resolveInner(s,-1),i);for(;a.length&&a[a.length-1].from>s-o.from;)a.pop();if(!a.length)return r={range:t};let l=a[a.length-1];if(l.to-l.spaceAfter.length>s-o.from)return r={range:t};let c=s>=l.to-l.spaceAfter.length&&!/\S/.test(o.text.slice(l.to));if(l.item&&c){if(l.node.firstChild.to>=s||o.from>0&&!/[^\s>]/.test(i.lineAt(o.from-1).text)){let e,t=a.length>1?a[a.length-2]:null,n="";t&&t.item?(e=o.from+t.from,n=t.marker(i,1)):e=o.from+(t?t.to:0);let r=[{from:e,to:s,insert:n}];return"OrderedList"==l.node.name&&renumberList(l.item,i,r,-2),t&&"OrderedList"==t.node.name&&renumberList(t.item,i,r),{range:EditorSelection.cursor(e+n.length),changes:r}}{let t="";for(let e=0,n=a.length-2;e<=n;e++)t+=a[e].blank(e<n?countColumn(o.text,4,a[e+1].from)-t.length:null,e<n);return t=normalizeIndent(t,e),{range:EditorSelection.cursor(s+t.length+1),changes:{from:o.from,insert:t+e.lineBreak}}}}if("Blockquote"==l.node.name&&c&&o.from){let n=i.lineAt(o.from-1),r=/>\s*$/.exec(n.text);if(r&&r.index==l.from){let i=e.changes([{from:n.from+r.index,to:n.to},{from:o.from+l.from,to:o.to}]);return{range:t.map(i),changes:i}}}let h=[];"OrderedList"==l.node.name&&renumberList(l.item,i,h);let d=l.item&&l.item.from<o.from,u="";if(!d||/^[\s\d.)\-+*>]*/.exec(o.text)[0].length>=l.to)for(let e=0,t=a.length-1;e<=t;e++)u+=e!=t||d?a[e].blank(e<t?countColumn(o.text,4,a[e+1].from)-u.length:null):a[e].marker(i,1);let p=s;for(;p>o.from&&/\s/.test(o.text.charAt(p-o.from-1));)p--;return u=normalizeIndent(u,e),h.push({from:p,to:s,insert:e.lineBreak+u}),{range:EditorSelection.cursor(p+u.length+1),changes:h}}));return!r&&(t(e.update(s,{scrollIntoView:!0,userEvent:"input"})),!0)};function isMark(e){return"QuoteMark"==e.name||"ListMark"==e.name}function contextNodeForDelete(e,t){let n=e.resolveInner(t,-1),i=t;isMark(n)&&(i=n.from,n=n.parent);for(let e;e=n.childBefore(i);)if(isMark(e))i=e.from;else{if("OrderedList"!=e.name&&"BulletList"!=e.name)break;n=e.lastChild,i=n.to}return n}const deleteMarkupBackward=({state:e,dispatch:t})=>{let n=syntaxTree(e),i=null,r=e.changeByRange((t=>{let r=t.from,{doc:s}=e;if(t.empty&&markdownLanguage.isActiveAt(e,t.from)){let t=s.lineAt(r),i=getContext(contextNodeForDelete(n,r),s);if(i.length){let n=i[i.length-1],s=n.to-n.spaceAfter.length+(n.spaceAfter?1:0);if(r-t.from>s&&!/\S/.test(t.text.slice(s,r-t.from)))return{range:EditorSelection.cursor(t.from+s),changes:{from:t.from+s,to:r}};if(r-t.from==s&&(!n.item||t.from<=n.item.from||!/\S/.test(t.text.slice(0,n.to)))){let i=t.from+n.from;if(n.item&&n.node.from<n.item.from&&/\S/.test(t.text.slice(n.from,n.to))){let r=n.blank(countColumn(t.text,4,n.to)-countColumn(t.text,4,n.from));return i==t.from&&(r=normalizeIndent(r,e)),{range:EditorSelection.cursor(i+r.length),changes:{from:i,to:t.from+n.to,insert:r}}}if(i<r)return{range:EditorSelection.cursor(i),changes:{from:i,to:r}}}}}return i={range:t}}));return!i&&(t(e.update(r,{scrollIntoView:!0,userEvent:"delete"})),!0)},markdownKeymap=[{key:"Enter",run:insertNewlineContinueMarkup},{key:"Backspace",run:deleteMarkupBackward}],htmlNoMatch=html({matchClosingTags:!1});function markdown(e={}){let{codeLanguages:t,defaultCodeLanguage:n,addKeymap:i=!0,base:{parser:r}=commonmarkLanguage,completeHTMLTags:s=!0}=e;if(!(r instanceof MarkdownParser))throw new RangeError("Base parser provided to `markdown` should be a Markdown parser");let o,a=e.extensions?[e.extensions]:[],l=[htmlNoMatch.support];n instanceof LanguageSupport?(l.push(n.support),o=n.language):n&&(o=n);let c=t||o?getCodeParser(t,o):void 0;a.push(parseCode({codeParser:c,htmlParser:htmlNoMatch.language.parser})),i&&l.push(Prec.high(keymap.of(markdownKeymap)));let h=mkLang(r.configure(a));return s&&l.push(h.data.of({autocomplete:htmlTagCompletion})),new LanguageSupport(h,l)}function htmlTagCompletion(e){let{state:t,pos:n}=e,i=/<[:\-\.\w\u00b7-\uffff]*$/.exec(t.sliceDoc(n-25,n));if(!i)return null;let r=syntaxTree(t).resolveInner(n,-1);for(;r&&!r.type.isTop;){if("CodeBlock"==r.name||"FencedCode"==r.name||"ProcessingInstructionBlock"==r.name||"CommentBlock"==r.name||"Link"==r.name||"Image"==r.name)return null;r=r.parent}return{from:n-i[0].length,to:n,options:htmlTagCompletions(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let _tagCompletions=null;function htmlTagCompletions(){if(_tagCompletions)return _tagCompletions;let e=htmlCompletionSource(new CompletionContext(EditorState.create({extensions:htmlNoMatch}),0,!0));return _tagCompletions=e?e.options:[]}const mentionMatcher=new MatchDecorator({regexp:/(\[(.+?)\])(\(@u(\d+)\))/g,decoration:e=>Decoration.replace({inclusive:!0,widget:new MentionWidget(e)})});class MentionWidget extends WidgetType{constructor(e){super(),this.match=e}eq(e){return e.match[1]===this.match[1]}toDOM(){let e=document.createElement("span");return e.className="wy-mention",e.innerHTML=void 0!==this.match[5]?this.match[5]:this.match[2],e}ignoreEvent(){return!1}}const mentions=ViewPlugin.fromClass(class{constructor(e){this.mentions=mentionMatcher.createDeco(e)}update(e){this.mentions=mentionMatcher.updateDeco(e,this.mentions)}},{decorations:e=>e.mentions,provide:e=>EditorView.atomicRanges.of((t=>{var n;return(null===(n=t.plugin(e))||void 0===n?void 0:n.mentions)||Decoration.none}))});function useEmbeds(e){const{client:t}=React.useContext(WeavyContext),n=/(((https?|ftp):\/\/|(www|ftp)\.)[\w]+(.[\w]+)([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#]))/gim,[i,r]=React.useState([]),[s,o]=React.useState([]),[a,l]=React.useState([]),[c,h]=React.useState([]),[d,u]=React.useState({});if(!t)throw new Error("useEmbeds must be used within an WeavyProvider");return{getEmbeds:async p=>{var f;let m=(null===(f=p.match(n))||void 0===f?void 0:f.map((e=>e)))||null;if(null!==m&&(m=m.map((e=>e.startsWith("//")?"http:"+e:e.startsWith("http://")||e.startsWith("https://")?e:"http://"+e))),null===m||0===m.length);else if(m.length!==i.length||(O=i,(g=m).length!==O.length||!g.every(((e,t)=>e===O[t])))){r(m),m.forEach((n=>{s.includes(n)||a.includes(n)||c.includes(n)||void 0!==d[n]||u((i=>(i[n]=setTimeout((()=>{(async n=>{(new FormData).append("url",n);try{const r=await t.post("/api/embeds","POST",JSON.stringify({url:n}));if(!r.ok)throw new Error;var i=await r.json();o((e=>[...e,n])),u((e=>(delete e[n],e))),e(i)}catch(e){l((e=>[...e,n])),u((e=>(delete e[n],e)))}})(n)}),500),i)))})),h((e=>e.filter((e=>i.includes(e)))));for(let e in d)i.includes(e)||(clearTimeout(d[e]),u((t=>(delete t[e],t))))}var g,O},initEmbeds:e=>{o(e)},clearEmbeds:()=>{r([]),o([]),l([]),h([]),u({})}}}const Blob$1=({id:e,name:t,className:n,children:i})=>{let r=getExtension(t),{icon:s}=getIcon(t),o=getKind(t);return React.createElement("div",{className:"wy-item"},React.createElement(UIIcon.UI,{name:s,size:24,className:classNames("wy-kind-"+toKebabCase(o),"wy-ext-"+r.substring(1))}),React.createElement("div",{className:"wy-item-body"},t),i)},Embed=({embed:e,onRemove:t,onSwap:n})=>{const i="photo"===e.type&&"giphy"===e.provider_name.toLocaleLowerCase(),r=!e.html&&!i;return React.createElement("div",{className:"wy-embed"},React.createElement("div",{className:"wy-embed-actions"},n&&React.createElement(UIButton.UI,{title:"Switch",onClick:n},React.createElement(UIIcon.UI,{name:"swap-horizontal"})),!n&&React.createElement(UIButton.UI,{className:"wy-embed-cycle"}),t&&React.createElement(UIButton.UI,{title:"Remove",onClick:()=>t(e.id)},React.createElement(UIIcon.UI,{name:"close-circle"}))),"audio"===e.type&&React.createElement("div",{className:"wy-embed-audio"}),"video"===e.type&&e.html&&React.createElement("div",{className:"wy-embed-video"},React.createElement("div",{dangerouslySetInnerHTML:{__html:e.html}})),"rich"===e.type&&React.createElement("div",{className:"wy-embed-rich"}),"photo"===e.type&&e.thumbnail_url&&React.createElement("div",{className:"wy-embed-photo"+((e.thumbnail_width||0)<250?"wy-embed-photo-sm":"")},React.createElement("a",{href:e.original_url,target:"_blank"},React.createElement("img",{src:e.thumbnail_url,width:e.thumbnail_width,height:e.thumbnail_height,alt:""}))),"audio"!==e.type&&"video"!==e.type&&"rich"!==e.type&&"photo"!==e.type&&e.thumbnail_url&&React.createElement("div",{className:"wy-embed-photo"+((e.thumbnail_width||0)<250?"wy-embed-photo-sm":"")},React.createElement("a",{href:e.original_url,target:"_blank"},React.createElement("img",{src:e.thumbnail_url,width:e.thumbnail_width,height:e.thumbnail_height,alt:""}))),r&&React.createElement("div",{className:"wy-embed-caption"},React.createElement("a",{className:"wy-embed-link",href:e.original_url,target:"_blank"},e.host),e.title&&React.createElement("div",{className:"wy-embed-title"},e.title),e.description&&React.createElement("div",{className:"wy-embed-description"},e.description)))};function useCloudFiles(e){const{open:t}=React.useContext(CloudFilesContext);return{openCloudFiles:()=>{t(e)}}}function useMutateTyping(){const{client:e}=React.useContext(WeavyContext);if(!e)throw new Error("useMutateTyping must be used within an WeavyProvider");return useMutation((async({id:t,type:n,location:i})=>await e.post(`/api/${i}/${t}/${n}/typing`,"PUT",JSON.stringify({}))),{})}function useMutateMeeting(){const{client:e}=React.useContext(WeavyContext);if(useQueryClient(),!e)throw new Error("useMutateMeeting must be used within an WeavyProvider");return useMutation((async({provider:t})=>(await e.post("/api/meetings","POST",JSON.stringify({provider:t}))).json()),{onSuccess:e=>{}})}const Meetings=({onMeetingAdded:e,dropdown:t=!1})=>{const{options:n}=React.useContext(WeavyContext),{user:i}=React.useContext(UserContext),r=useMutateMeeting();React.useEffect((()=>(window.addEventListener("message",s),()=>{window.removeEventListener("message",s)})),[e]);const s=async t=>{if("zoom-signed-in"===t.data.name){var n=await r.mutateAsync({provider:"zoom"});e(n)}},o=()=>{window.open(`${null==n?void 0:n.zoomAuthenticationUrl}&state=${i.id}`,"zoomAuthWin","height=640,width=480")};return React.createElement(React.Fragment,null,(null==n?void 0:n.zoomAuthenticationUrl)&&t&&React.createElement(UIDropdown.Item,{onClick:o},React.createElement(UIIcon.UI,{name:"zoom"})," Zoom meeting"),(null==n?void 0:n.zoomAuthenticationUrl)&&!t&&React.createElement(UIButton.UI,{onClick:o,title:"Zoom meeting"},React.createElement(UIIcon.UI,{name:"zoom"})))},Meeting=({id:e,title:t,className:n})=>React.createElement(React.Fragment,null,React.createElement(UIIcon.UI,{name:"zoom"}),React.createElement("div",{className:n},"Zoom meeting"));function useIsFirstRender(){const e=React.useRef(!0);return e.current?(e.current=!1,!0):e.current}function useUpdateEffect(e,t){const n=useIsFirstRender();React.useEffect((()=>{if(!n)return e()}),t)}function useUploadFile(){const{client:e}=React.useContext(WeavyContext);if(!e)throw new Error("useMutateFile must be used within an WeavyProvider");return async(t,n)=>{const i=new FormData;i.append("blob",t);const r=await e.upload("/api/blobs","POST",i,"",(e=>{n&&n({progress:e})}));if(!r.ok)throw await r.json();return await r.json()}}function isFileMutation(e){return void 0!==e.state}const getTempFile=(e,t,n=0,i="application/octet-stream",r,s)=>{const o=e&&(e instanceof URL?e.toString():URL.createObjectURL(e));return{id:r,refId:r,name:t,kind:getKind(t),size:n,media_type:i,embed_url:"",preview_format:getWebPreviewFormat(t),thumbnail_url:o,preview_url:o,download_url:o,version:-1,created_by:s,created_by_id:s.id,created_at:(new Date).toUTCString(),is_subscribed:!1,is_trashed:!1,status:"pending"}},setMutationContext=(e,t,n,i)=>{let r=e.getMutationCache().find({mutationKey:t,predicate:e=>e.options.variables===n});if(r&&r.state.context){let e=Object.assign({},r.state.context);i(e),r.setState(Object.assign(Object.assign({},r.state),{context:e}))}};function useMutatingFileUploads(e){const t=useQueryClient(),[n,i]=React.useState([]),[r,s]=React.useState(),[o,a]=React.useState(),l=()=>{let n=t.getMutationCache().findAll({mutationKey:e});i(n)};return React.useEffect((()=>(l(),t.getMutationCache().subscribe((()=>l())))),[...e]),React.useEffect((()=>{s((e=>e.some((e=>{var t;return 409===(null===(t=e.state.error)||void 0===t?void 0:t.status)}))?"conflict":e.some((e=>"error"===e.state.status))?"error":e.every((e=>"success"===e.state.status))?"ok":"pending")(n));let e=(e=>e.reduce(((e,t)=>{var n;let i=null===(n=t.state.context)||void 0===n?void 0:n.file;return i&&i.progress&&i.size?{loaded:e.loaded+i.progress*i.size,total:e.total+i.size}:e}),{loaded:0,total:0}))(n);a(e.total>0?e.loaded/e.total:void 0)}),[n]),{mutations:n,status:r,progress:o}}function useRemoveMutatingFileUpload(e){const t=useQueryClient(),n=e;return i=>{var r,s;t.getMutationCache().find({mutationKey:n,predicate:e=>e===i})&&(updateCacheItem(t,e,(null===(r=i.state.context.file)||void 0===r?void 0:r.refId)||(null===(s=i.state.context.file)||void 0===s?void 0:s.id),(e=>Object.assign(e,{status:"ok",statusText:void 0,progress:void 0}))),t.getMutationCache().remove(i))}}function useClearMutatingFileUpload(e){const t=useQueryClient(),n=e;return()=>{t.getMutationCache().findAll({mutationKey:n}).forEach((n=>{var i,r,s;isFileMutation(n)&&updateCacheItem(t,e,(null===(r=null===(i=n.state.context)||void 0===i?void 0:i.file)||void 0===r?void 0:r.refId)||(null===(s=n.state.context.file)||void 0===s?void 0:s.id),(e=>Object.assign(e,{status:"ok",statusText:void 0,progress:void 0}))),t.getMutationCache().remove(n)}))}}function useMutateFileUpload(e,t){const n=useQueryClient(),{user:i}=React.useContext(UserContext),r=e,s=useUploadFile();return useMutation((async e=>{let i=await s(e.file,e.onProgress);return setMutationContext(n,r,e,(e=>{e.blob=i})),t?await t({blob:i}):i}),{mutationKey:r,onMutate:async t=>{var s;await n.cancelQueries({queryKey:e,exact:!0});let o=findAnyExistingItem(n.getQueryData(e),"name",t.file.name,!0);if(!o){const r=null===(s=n.getQueryCache().find(e))||void 0===s?void 0:s.meta,a=null==r?void 0:r.order;let l=Math.random();o=getTempFile(t.file,t.file.name,t.file.size,t.file.type,l,i),addCacheItem(n,e,o,o.id,a)}return t.onProgress=({progress:i})=>{(null==o?void 0:o.id)&&updateCacheItem(n,e,o.refId||o.id,(e=>Object.assign(e,{status:"pending",progress:i}))),setMutationContext(n,r,t,(e=>{e.file.progress=i,e.file.status="pending"}))},{file:o}},onSuccess:(t,i,s)=>{var o;(null===(o=null==s?void 0:s.file)||void 0===o?void 0:o.id)&&updateCacheItem(n,e,s.file.id,(e=>Object.assign(e,t||(null==s?void 0:s.file),{status:"ok",statusText:void 0,progress:void 0}))),setMutationContext(n,r,i,(e=>{e.file.progress=void 0,e.file.status="ok",e.file.statusText=void 0})),n.invalidateQueries({queryKey:e})},onError(t,i,s){var o,a;t&&409===t.status?((null===(o=null==s?void 0:s.file)||void 0===o?void 0:o.id)&&updateCacheItem(n,e,s.file.id,(e=>Object.assign(e,{status:"conflict",statusText:t.detail||t.title,progress:void 0}))),setMutationContext(n,r,i,(e=>{e.file.progress=void 0,e.file.status="conflict",e.file.statusText=t.detail||t.title}))):((null===(a=null==s?void 0:s.file)||void 0===a?void 0:a.id)&&(s.file.id>=1?updateCacheItem(n,e,s.file.id,(e=>Object.assign(e,{status:"error",statusText:t.detail||t.title,progress:void 0}))):s.file.id>=0&&s.file.id<1&&removeCacheItem(n,e,s.file.id)),setMutationContext(n,r,i,(e=>{e&&(e.file.progress=void 0,e.file.status="error",e.file.statusText=t.detail||t.title)})))}})}function useMutateFileCreate(e,t){const n=useQueryClient(),{user:i}=React.useContext(UserContext),r=e;return useMutation(t,{mutationKey:r,onMutate:async t=>{await n.cancelQueries({queryKey:e,exact:!0});let r=findAnyExistingItem(n.getQueryData(e),"name",t.blob.name,!0)||t.file;if(r)updateCacheItem(n,e,(null==r?void 0:r.refId)||(null==r?void 0:r.id),(e=>Object.assign(e,{status:"pending"})));else{const o=n.getQueryCache().find(e).meta.order;let a=Math.random();var s;try{s=t.blob.thumbnail_url&&new URL(t.blob.thumbnail_url)||void 0}catch(e){}r=getTempFile(s,t.blob.name,t.blob.size,t.blob.media_type,a,i),addCacheItem(n,e,r,r.id,o)}return{file:r,blob:t.blob}},onSuccess:(t,i,s)=>{var o,a;updateCacheItem(n,e,(null===(o=s.file)||void 0===o?void 0:o.refId)||(null===(a=s.file)||void 0===a?void 0:a.id),(e=>Object.assign(e,t,{status:"ok",statusText:void 0,progress:void 0}))),setMutationContext(n,r,i,(e=>{e.file.progress=void 0,e.file.status="ok",e.file.statusText=void 0})),n.invalidateQueries({queryKey:e})},onError(t,i,s){var o,a,l,c;if(t&&409===t.status)updateCacheItem(n,e,(null===(o=s.file)||void 0===o?void 0:o.refId)||(null===(a=s.file)||void 0===a?void 0:a.id),(e=>Object.assign(e,{status:"conflict",statusText:t.detail||t.title,progress:void 0}))),setMutationContext(n,r,i,(e=>{e.file.progress=void 0,e.file.status="conflict",e.file.statusText=t.detail||t.title}));else{const o=(null===(l=s.file)||void 0===l?void 0:l.refId)||(null===(c=s.file)||void 0===c?void 0:c.id);o&&(o>=1?updateCacheItem(n,e,o,(e=>Object.assign(e,{status:"error",statusText:t.detail||t.title,progress:void 0}))):o>0&&o<1&&removeCacheItem(n,r,o)),setMutationContext(n,r,i,(e=>{e&&(e.file.progress=void 0,e.file.status="error",e.file.statusText=t.detail||t.title)}))}}})}const triggerDownload=e=>{openUrl(e.download_url,"_top",e.name,!0)},triggerExternal=e=>{openUrl(null==e?void 0:e.external_url,"_blank",e.name)},triggerApplication=e=>{openUrl(null==e?void 0:e.application_url,"_top",e.name)},FileMenu=e=>{var{file:t,className:n,onRename:i,onSubscribe:r,onUnsubscribe:s,onTrash:o,onRestore:a,onDeleteForever:l,children:c,noWrapper:h,features:d,appFeatures:u}=e,p=__rest(e,["file","className","onRename","onSubscribe","onUnsubscribe","onTrash","onRestore","onDeleteForever","children","noWrapper","features","appFeatures"]);let{icon:f}=getIcon(t.name),m=t.id>=1;return React.createElement(UIDropdown.UI,Object.assign({directionX:"left",className:n,disabled:t.status&&"ok"!==t.status,noWrapper:h},p),m&&t.is_trashed&&React.createElement(React.Fragment,null,a&&React.createElement(UIDropdown.Item,{onClick:a},React.createElement(UIIcon.UI,{name:"delete-restore"}),"Restore"),a&&l&&React.createElement(UIDropdown.Divider,null),l&&React.createElement(UIDropdown.Item,{onClick:l},React.createElement(UIIcon.UI,{name:"delete-forever"}),"Delete")),!t.is_trashed&&React.createElement(React.Fragment,null,t.external_url?React.createElement(UIDropdown.Item,{onClick:()=>triggerExternal(t)},React.createElement(UIIcon.UI,{name:f})," ",`Open in ${t.provider}`):React.createElement(React.Fragment,null,t.application_url&&hasFeature(d,Feature.WebDAV,null==u?void 0:u.webDAV)&&React.createElement(UIDropdown.Item,{onClick:()=>triggerApplication(t)},React.createElement(UIIcon.UI,{name:t.provider?toKebabCase(t.provider):f})," ",`Open in ${t.provider||"app"}`),React.createElement(UIDropdown.Item,{onClick:()=>triggerDownload(t)},React.createElement(UIIcon.UI,{name:"download",size:24})," Download")),m&&React.createElement(React.Fragment,null,i&&React.createElement(UIDropdown.Item,{onClick:i},React.createElement(UIIcon.UI,{name:"textbox",size:24})," Rename"),!t.is_subscribed&&r&&React.createElement(UIDropdown.Item,{onClick:r},React.createElement(UIIcon.UI,{name:"bell",size:24})," Subscribe"),t.is_subscribed&&s&&React.createElement(UIDropdown.Item,{onClick:s},React.createElement(UIIcon.UI,{name:"bell-off",size:24})," Unsubscribe"),o&&React.createElement(React.Fragment,null,React.createElement(UIDropdown.Divider,null),React.createElement(UIDropdown.Item,{onClick:o},React.createElement(UIIcon.UI,{name:"delete",size:24})," Trash")))),c)},clickBlock=e=>t=>{t.preventDefault();const n=e=>{console.debug("Blocked event",e.type),e.preventDefault(),e.stopImmediatePropagation()};return document.addEventListener("click",n,{once:!0,capture:!0}),setTimeout((()=>{document.removeEventListener("click",n,{capture:!0})}),500),e(t)},FileRow=({file:e,className:t,onClick:n,onRename:i,isRenaming:r,onSubscribe:s,onUnsubscribe:o,onTrash:a,onRestore:l,onDeleteForever:c,onHandleError:h,statusText:d,title:u,features:p,appFeatures:f,children:m})=>{const[g,O]=React.useState(!1);React.useEffect((()=>{void 0!==r&&O(r)}),[r]);let y=e.size&&e.size>0?fileSizeAsString(e.size):null;const v=e.modified_at||e.created_at,b=dayjs.utc(v).tz(dayjs.tz.guess());let{icon:w}=getIcon(e.name),S=getExtension(e.name);const x=t=>{let n=t.target;n.value&&n.value!==e.name&&i(n.value,e),O(!1)};return React.createElement("tr",{className:classNames({"wy-table-trashed":e.is_trashed},t),onClick:t=>{t.defaultPrevented||(!h||"conflict"!==e.status&&"error"!==e.status?n&&n(t):h(e))},title:u},React.createElement("td",{className:"wy-table-cell-icon"},"error"===e.status?React.createElement(UIIcon.UI,{name:"alert-octagon",color:"error",size:24,title:e.statusText||d}):"conflict"===e.status?React.createElement(UIIcon.UI,{name:"alert",color:"yellow",size:24,title:e.statusText||d}):"pending"===e.status?React.createElement(UISpinner.UI,{spin:!e.progress,progress:e.progress}):React.createElement(UIIcon.UI,{name:w,size:24,className:classNames("wy-kind-"+toKebabCase(e.kind),"wy-ext-"+S.substring(1))})),React.createElement("td",null,g&&i?React.createElement(React.Fragment,null,React.createElement("input",{type:"text",maxLength:256,className:"wy-input",defaultValue:e.name,onBlur:clickBlock(x),onKeyUp:t=>{"Escape"===t.key?(t.preventDefault(),t.target.value=e.name,t.target.blur()):"Enter"===t.key&&(t.preventDefault(),x(t))},onClick:e=>e.preventDefault(),onFocus:e=>{const t=e.target.value.lastIndexOf(".");-1===t?e.target.select():e.target.setSelectionRange(0,t)},autoFocus:!0})):React.createElement(React.Fragment,null,React.createElement("span",{title:e.name+(d||e.statusText?`: ${d||e.statusText}`:"")},e.name,(d||e.statusText)&&React.createElement(React.Fragment,null,": ",React.createElement("em",null,d||e.statusText))))),React.createElement("td",null,React.createElement("time",{dateTime:v,title:b.format("LLLL")},b.format("l"))),React.createElement("td",null,React.createElement("span",null,e.kind)),React.createElement("td",null,React.createElement("span",null,y)),React.createElement("td",{className:"wy-table-cell-icon"},m||React.createElement(React.Fragment,null,React.createElement(FileMenu,{file:e,onRename:i?()=>O(!0):void 0,onSubscribe:null==s?void 0:s.bind(FileRow,e),onUnsubscribe:null==o?void 0:o.bind(FileRow,e),onTrash:null==a?void 0:a.bind(FileRow,e),onRestore:null==l?void 0:l.bind(FileRow,e),onDeleteForever:null==c?void 0:c.bind(FileRow,e),noWrapper:!0,features:p,appFeatures:f}))))},FileCard=({file:e,className:t,onClick:n,onRename:i,isRenaming:r,onSubscribe:s,onUnsubscribe:o,onTrash:a,onRestore:l,onDeleteForever:c,onHandleError:h,statusText:d,title:u,features:p,appFeatures:f,children:m})=>{const[g,O]=React.useState(!1);React.useEffect((()=>{void 0!==r&&O(r)}),[r]);let{icon:y}=getIcon(e.name),v=getExtension(e.name);const b=t=>{let n=t.target;n.value&&n.value!==e.name&&i(n.value,e),O(!1)};return React.createElement("div",{className:classNames("wy-card",{"wy-card-trashed":e.is_trashed,"wy-card-hover":n&&!e.is_trashed&&!g},t),onClick:t=>{t.defaultPrevented||g||(!h||"conflict"!==e.status&&"error"!==e.status?n&&n(t):h(e))},title:u},React.createElement("div",{className:"wy-card-actions"},"error"===e.status&&React.createElement(UIIcon.UI,{name:"alert-octagon",color:"error",size:24,title:e.statusText||d})||"conflict"===e.status&&React.createElement(UIIcon.UI,{name:"alert",color:"yellow",size:24,title:e.statusText||d})||"pending"===e.status&&React.createElement(UISpinner.UI,{spin:!e.progress,progress:e.progress}),m||React.createElement(React.Fragment,null,React.createElement(FileMenu,{file:e,onRename:i?()=>O(!0):void 0,onSubscribe:null==s?void 0:s.bind(FileRow,e),onUnsubscribe:null==o?void 0:o.bind(FileRow,e),onTrash:null==a?void 0:a.bind(FileRow,e),onRestore:null==l?void 0:l.bind(FileRow,e),onDeleteForever:null==c?void 0:c.bind(FileRow,e),features:p,appFeatures:f}))),!e.is_trashed&&e.thumbnail_url&&React.createElement("img",{className:classNames("wy-card-top wy-card-content",{"wy-card-top-image":"image"===e.kind}),src:e.thumbnail_url,loading:"lazy"})||React.createElement("div",{className:"wy-content-icon wy-card-top wy-card-content"},React.createElement(UIIcon.UI,{name:y,size:96,className:classNames("wy-kind-"+toKebabCase(e.kind),"wy-ext-"+v.substring(1))})),React.createElement("div",{className:"wy-card-label wy-card-content wy-filename"},g&&i?React.createElement(React.Fragment,null,React.createElement("input",{type:"text",maxLength:256,className:"wy-input",defaultValue:e.name,onBlur:clickBlock(b),onKeyUp:t=>{"Escape"===t.key?(t.preventDefault(),t.target.value=e.name,t.target.blur()):"Enter"===t.key&&(t.preventDefault(),b(t))},onClick:e=>e.preventDefault(),onFocus:e=>{const t=e.target.value.lastIndexOf(".");-1===t?e.target.select():e.target.setSelectionRange(0,t)},autoFocus:!0})):React.createElement("span",{title:e.name+(d||e.statusText?`: ${d||e.statusText}`:"")},e.name,(d||e.statusText)&&React.createElement(React.Fragment,null,": ",React.createElement("em",null,d||e.statusText)))))},FileItem=({file:e,className:t,onClick:n,onRename:i,isRenaming:r,onSubscribe:s,onUnsubscribe:o,onTrash:a,onRestore:l,onDeleteForever:c,onHandleError:h,statusText:d,title:u,features:p,appFeatures:f,children:m})=>{const[g,O]=React.useState(!1);React.useEffect((()=>{void 0!==r&&O(r)}),[r]);let{icon:y}=getIcon(e.name),v=getExtension(e.name);const b=t=>{let n=t.target;n.value&&n.value!==e.name&&i(n.value,e),O(!1)};return React.createElement("div",{className:classNames("wy-item",{"wy-item-trashed":e.is_trashed,"wy-item-hover":n&&!e.is_trashed&&!g},t),onClick:t=>{t.defaultPrevented||g||(!h||"conflict"!==e.status&&"error"!==e.status?n&&n(t):h(e))},title:u},"error"===e.status?React.createElement(UIIcon.UI,{name:"alert-octagon",color:"error",size:24,title:e.statusText||d}):"conflict"===e.status?React.createElement(UIIcon.UI,{name:"alert",color:"yellow",size:24,title:e.statusText||d}):"pending"===e.status?React.createElement(UISpinner.UI,{spin:!e.progress,progress:e.progress}):React.createElement(UIIcon.UI,{name:y,size:24,className:classNames("wy-kind-"+toKebabCase(e.kind),"wy-ext-"+v.substring(1))}),React.createElement("div",{className:"wy-item-body"},g&&i?React.createElement(React.Fragment,null,React.createElement("input",{type:"text",maxLength:256,className:"wy-input",defaultValue:e.name,onBlur:clickBlock(b),onKeyUp:t=>{"Escape"===t.key?(t.preventDefault(),t.target.value=e.name,t.target.blur()):"Enter"===t.key&&(t.preventDefault(),b(t))},onClick:e=>e.preventDefault(),onFocus:e=>{const t=e.target.value.lastIndexOf(".");-1===t?e.target.select():e.target.setSelectionRange(0,t)},autoFocus:!0})):React.createElement("span",{title:e.name+(d||e.statusText?`: ${d||e.statusText}`:"")},e.name,(d||e.statusText)&&React.createElement(React.Fragment,null,": ",React.createElement("em",null,d||e.statusText)))),m||React.createElement(React.Fragment,null,React.createElement(FileMenu,{file:e,onRename:i?()=>O(!0):void 0,onSubscribe:null==s?void 0:s.bind(FileRow,e),onUnsubscribe:null==o?void 0:o.bind(FileRow,e),onTrash:null==a?void 0:a.bind(FileRow,e),onRestore:null==l?void 0:l.bind(FileRow,e),onDeleteForever:null==c?void 0:c.bind(FileRow,e),features:p,appFeatures:f})))};var FileItem$1={Row:FileRow,Card:FileCard,Item:FileItem,Menu:FileMenu},propTypesExports=requirePropTypes(),PropTypes=getDefaultExportFromCjs(propTypesExports),COMMON_MIME_TYPES=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function toFileWithPath(e,t){var n=withMimeType(e);if("string"!=typeof n.path){var i=e.webkitRelativePath;Object.defineProperty(n,"path",{value:"string"==typeof t?t:"string"==typeof i&&i.length>0?i:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}function withMimeType(e){var t=e.name;if(t&&-1!==t.lastIndexOf(".")&&!e.type){var n=t.split(".").pop().toLowerCase(),i=COMMON_MIME_TYPES.get(n);i&&Object.defineProperty(e,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return e}var FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return isObject(e)&&isDataTransfer(e.dataTransfer)?[2,getDataTransferFiles(e.dataTransfer,e.type)]:isChangeEvt(e)?[2,getInputFiles(e)]:Array.isArray(e)&&e.every((function(e){return"getFile"in e&&"function"==typeof e.getFile}))?[2,getFsHandleFiles(e)]:[2,[]]}))}))}function isDataTransfer(e){return isObject(e)}function isChangeEvt(e){return isObject(e)&&isObject(e.target)}function isObject(e){return"object"==typeof e&&null!==e}function getInputFiles(e){return fromList(e.target.files).map((function(e){return toFileWithPath(e)}))}function getFsHandleFiles(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return e.getFile()})))];case 1:return[2,t.sent().map((function(e){return toFileWithPath(e)}))]}}))}))}function getDataTransferFiles(e,t){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(i){switch(i.label){case 0:return e.items?(n=fromList(e.items).filter((function(e){return"file"===e.kind})),"drop"!==t?[2,n]:[4,Promise.all(n.map(toFilePromises))]):[3,2];case 1:return[2,noIgnoredFiles(flatten(i.sent()))];case 2:return[2,noIgnoredFiles(fromList(e.files).map((function(e){return toFileWithPath(e)})))]}}))}))}function noIgnoredFiles(e){return e.filter((function(e){return-1===FILES_TO_IGNORE.indexOf(e.name)}))}function fromList(e){if(null===e)return[];for(var t=[],n=0;n<e.length;n++){var i=e[n];t.push(i)}return t}function toFilePromises(e){if("function"!=typeof e.webkitGetAsEntry)return fromDataTransferItem(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?fromDirEntry(t):fromDataTransferItem(e)}function flatten(e){return e.reduce((function(e,t){return __spreadArray(__spreadArray([],__read(e),!1),__read(Array.isArray(t)?flatten(t):[t]),!1)}),[])}function fromDataTransferItem(e){var t=e.getAsFile();if(!t)return Promise.reject("".concat(e," is not a File"));var n=toFileWithPath(t);return Promise.resolve(n)}function fromEntry(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return[2,e.isDirectory?fromDirEntry(e):fromFileEntry(e)]}))}))}function fromDirEntry(e){var t=e.createReader();return new Promise((function(e,n){var i=[];!function r(){var s=this;t.readEntries((function(t){return __awaiter(s,void 0,void 0,(function(){var s,o,a;return __generator(this,(function(l){switch(l.label){case 0:if(t.length)return[3,5];l.label=1;case 1:return l.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return s=l.sent(),e(s),[3,4];case 3:return o=l.sent(),n(o),[3,4];case 4:return[3,6];case 5:a=Promise.all(t.map(fromEntry)),i.push(a),r(),l.label=6;case 6:return[2]}}))}))}),(function(e){n(e)}))}()}))}function fromFileEntry(e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return[2,new Promise((function(t,n){e.file((function(n){var i=toFileWithPath(n,e.fullPath);t(i)}),(function(e){n(e)}))}))]}))}))}var _default=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),i=e.name||"",r=(e.type||"").toLowerCase(),s=r.replace(/\/.*$/,"");return n.some((function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?i.toLowerCase().endsWith(t):t.endsWith("/*")?s===t.replace(/\/.*$/,""):r===t}))}return!0};function _toConsumableArray$1(e){return _arrayWithoutHoles$1(e)||_iterableToArray$1(e)||_unsupportedIterableToArray$1(e)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray$1(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles$1(e){if(Array.isArray(e))return _arrayLikeToArray$1(e)}function ownKeys$1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread$1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys$1(Object(n),!0).forEach((function(t){_defineProperty$1(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys$1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty$1(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_unsupportedIterableToArray$1(e,t)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray$1(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray$1(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray$1(e,t):void 0}}function _arrayLikeToArray$1(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit$1(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(s.push(i.value),!t||s.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}var FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(e){e=Array.isArray(e)&&1===e.length?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(t)}},getTooLargeRejectionErr=function(e){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},getTooSmallRejectionErr=function(e){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(e,t){var n="application/x-moz-file"===e.type||_default(e,t);return[n,n?null:getInvalidTypeRejectionErr(t)]}function fileMatchSize(e,t,n){if(isDefined(e.size))if(isDefined(t)&&isDefined(n)){if(e.size>n)return[!1,getTooLargeRejectionErr(n)];if(e.size<t)return[!1,getTooSmallRejectionErr(t)]}else{if(isDefined(t)&&e.size<t)return[!1,getTooSmallRejectionErr(t)];if(isDefined(n)&&e.size>n)return[!1,getTooLargeRejectionErr(n)]}return[!0,null]}function isDefined(e){return null!=e}function allFilesAccepted(e){var t=e.files,n=e.accept,i=e.minSize,r=e.maxSize,s=e.multiple,o=e.maxFiles,a=e.validator;return!(!s&&t.length>1||s&&o>=1&&t.length>o)&&t.every((function(e){var t=_slicedToArray$1(fileAccepted(e,n),1)[0],s=_slicedToArray$1(fileMatchSize(e,i,r),1)[0],o=a?a(e):null;return t&&s&&!o}))}function isPropagationStopped(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function isEvtWithFiles(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,(function(e){return"Files"===e||"application/x-moz-file"===e})):!!e.target&&!!e.target.files}function onDocumentDragOver(e){e.preventDefault()}function isIe(e){return-1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")}function isEdge(e){return-1!==e.indexOf("Edge/")}function isIeOrEdge(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return isIe(e)||isEdge(e)}function composeEventHandlers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return t.some((function(t){return!isPropagationStopped(e)&&t&&t.apply(void 0,[e].concat(i)),isPropagationStopped(e)}))}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function pickerOptionsFromAccept(e){return isDefined(e)?[{description:"Files",accept:Object.entries(e).filter((function(e){var t=_slicedToArray$1(e,2),n=t[0],i=t[1],r=!0;return isMIMEType(n)||(console.warn('Skipped "'.concat(n,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),r=!1),Array.isArray(i)&&i.every(isExt)||(console.warn('Skipped "'.concat(n,'" because an invalid file extension was provided.')),r=!1),r})).reduce((function(e,t){var n=_slicedToArray$1(t,2),i=n[0],r=n[1];return _objectSpread$1(_objectSpread$1({},e),{},_defineProperty$1({},i,r))}),{})}]:e}function acceptPropAsAcceptAttr(e){if(isDefined(e))return Object.entries(e).reduce((function(e,t){var n=_slicedToArray$1(t,2),i=n[0],r=n[1];return[].concat(_toConsumableArray$1(e),[i],_toConsumableArray$1(r))}),[]).filter((function(e){return isMIMEType(e)||isExt(e)})).join(",")}function isAbort(e){return e instanceof DOMException&&("AbortError"===e.name||e.code===e.ABORT_ERR)}function isSecurityError(e){return e instanceof DOMException&&("SecurityError"===e.name||e.code===e.SECURITY_ERR)}function isMIMEType(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)}function isExt(e){return/^.*\.[\w]+$/.test(e)}var _excluded=["children"],_excluded2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(s.push(i.value),!t||s.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _objectWithoutProperties(e,t){if(null==e)return{};var n,i,r=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n,i,r={},s=Object.keys(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}var Dropzone$1=React.forwardRef((function(e,t){var n=e.children,i=useDropzone(_objectWithoutProperties(e,_excluded)),r=i.open,s=_objectWithoutProperties(i,_excluded2);return React.useImperativeHandle(t,(function(){return{open:r}}),[r]),React.createElement(React.Fragment,null,n(_objectSpread(_objectSpread({},s),{},{open:r})))}));Dropzone$1.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};Dropzone$1.defaultProps=defaultProps,Dropzone$1.propTypes={children:PropTypes.func,accept:PropTypes.objectOf(PropTypes.arrayOf(PropTypes.string)),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,autoFocus:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,onError:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function useDropzone(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=_objectSpread(_objectSpread({},defaultProps),e),n=t.accept,i=t.disabled,r=t.getFilesFromEvent,s=t.maxSize,o=t.minSize,a=t.multiple,l=t.maxFiles,c=t.onDragEnter,h=t.onDragLeave,d=t.onDragOver,u=t.onDrop,p=t.onDropAccepted,f=t.onDropRejected,m=t.onFileDialogCancel,g=t.onFileDialogOpen,O=t.useFsAccessApi,y=t.autoFocus,v=t.preventDropOnDocument,b=t.noClick,w=t.noKeyboard,S=t.noDrag,x=t.noDragEventsBubbling,C=t.onError,_=t.validator,E=React.useMemo((function(){return acceptPropAsAcceptAttr(n)}),[n]),P=React.useMemo((function(){return pickerOptionsFromAccept(n)}),[n]),k=React.useMemo((function(){return"function"==typeof g?g:noop}),[g]),T=React.useMemo((function(){return"function"==typeof m?m:noop}),[m]),A=React.useRef(null),R=React.useRef(null),M=_slicedToArray(React.useReducer(reducer,initialState),2),I=M[0],L=M[1],$=I.isFocused,D=I.isFileDialogActive,N=React.useRef("undefined"!=typeof window&&window.isSecureContext&&O&&canUseFileSystemAccessAPI()),Q=function(){!N.current&&D&&setTimeout((function(){R.current&&(R.current.files.length||(L({type:"closeDialog"}),T()))}),300)};React.useEffect((function(){return window.addEventListener("focus",Q,!1),function(){window.removeEventListener("focus",Q,!1)}}),[R,D,T,N]);var F=React.useRef([]),B=function(e){A.current&&A.current.contains(e.target)||(e.preventDefault(),F.current=[])};React.useEffect((function(){return v&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",B,!1)),function(){v&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",B))}}),[A,v]),React.useEffect((function(){return!i&&y&&A.current&&A.current.focus(),function(){}}),[A,y,i]);var j=React.useCallback((function(e){C?C(e):console.error(e)}),[C]),V=React.useCallback((function(e){e.preventDefault(),e.persist(),te(e),F.current=[].concat(_toConsumableArray(F.current),[e.target]),isEvtWithFiles(e)&&Promise.resolve(r(e)).then((function(t){if(!isPropagationStopped(e)||x){var n=t.length,i=n>0&&allFilesAccepted({files:t,accept:E,minSize:o,maxSize:s,multiple:a,maxFiles:l,validator:_});L({isDragAccept:i,isDragReject:n>0&&!i,isDragActive:!0,type:"setDraggedFiles"}),c&&c(e)}})).catch((function(e){return j(e)}))}),[r,c,j,x,E,o,s,a,l,_]),U=React.useCallback((function(e){e.preventDefault(),e.persist(),te(e);var t=isEvtWithFiles(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(e){}return t&&d&&d(e),!1}),[d,x]),W=React.useCallback((function(e){e.preventDefault(),e.persist(),te(e);var t=F.current.filter((function(e){return A.current&&A.current.contains(e)})),n=t.indexOf(e.target);-1!==n&&t.splice(n,1),F.current=t,t.length>0||(L({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),isEvtWithFiles(e)&&h&&h(e))}),[A,h,x]),Z=React.useCallback((function(e,t){var n=[],i=[];e.forEach((function(e){var t=_slicedToArray(fileAccepted(e,E),2),r=t[0],a=t[1],l=_slicedToArray(fileMatchSize(e,o,s),2),c=l[0],h=l[1],d=_?_(e):null;if(r&&c&&!d)n.push(e);else{var u=[a,h];d&&(u=u.concat(d)),i.push({file:e,errors:u.filter((function(e){return e}))})}})),(!a&&n.length>1||a&&l>=1&&n.length>l)&&(n.forEach((function(e){i.push({file:e,errors:[TOO_MANY_FILES_REJECTION]})})),n.splice(0)),L({acceptedFiles:n,fileRejections:i,type:"setFiles"}),u&&u(n,i,t),i.length>0&&f&&f(i,t),n.length>0&&p&&p(n,t)}),[L,a,E,o,s,l,u,p,f,_]),H=React.useCallback((function(e){e.preventDefault(),e.persist(),te(e),F.current=[],isEvtWithFiles(e)&&Promise.resolve(r(e)).then((function(t){isPropagationStopped(e)&&!x||Z(t,e)})).catch((function(e){return j(e)})),L({type:"reset"})}),[r,Z,j,x]),q=React.useCallback((function(){if(N.current){L({type:"openDialog"}),k();var e={multiple:a,types:P};window.showOpenFilePicker(e).then((function(e){return r(e)})).then((function(e){Z(e,null),L({type:"closeDialog"})})).catch((function(e){isAbort(e)?(T(e),L({type:"closeDialog"})):isSecurityError(e)?(N.current=!1,R.current?(R.current.value=null,R.current.click()):j(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):j(e)}))}else R.current&&(L({type:"openDialog"}),k(),R.current.value=null,R.current.click())}),[L,k,T,O,Z,j,P,a]),X=React.useCallback((function(e){A.current&&A.current.isEqualNode(e.target)&&(" "!==e.key&&"Enter"!==e.key&&32!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),q()))}),[A,q]),z=React.useCallback((function(){L({type:"focus"})}),[]),Y=React.useCallback((function(){L({type:"blur"})}),[]),G=React.useCallback((function(){b||(isIeOrEdge()?setTimeout(q,0):q())}),[b,q]),K=function(e){return i?null:e},J=function(e){return w?null:K(e)},ee=function(e){return S?null:K(e)},te=function(e){x&&e.stopPropagation()},ne=React.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,n=void 0===t?"ref":t,r=e.role,s=e.onKeyDown,o=e.onFocus,a=e.onBlur,l=e.onClick,c=e.onDragEnter,h=e.onDragOver,d=e.onDragLeave,u=e.onDrop,p=_objectWithoutProperties(e,_excluded3);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:J(composeEventHandlers(s,X)),onFocus:J(composeEventHandlers(o,z)),onBlur:J(composeEventHandlers(a,Y)),onClick:K(composeEventHandlers(l,G)),onDragEnter:ee(composeEventHandlers(c,V)),onDragOver:ee(composeEventHandlers(h,U)),onDragLeave:ee(composeEventHandlers(d,W)),onDrop:ee(composeEventHandlers(u,H)),role:"string"==typeof r&&""!==r?r:"presentation"},n,A),i||w?{}:{tabIndex:0}),p)}}),[A,X,z,Y,G,V,U,W,H,w,S,i]),ie=React.useCallback((function(e){e.stopPropagation()}),[]),re=React.useMemo((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,n=void 0===t?"ref":t,i=e.onChange,r=e.onClick,s=_objectWithoutProperties(e,_excluded4);return _objectSpread(_objectSpread({},_defineProperty({accept:E,multiple:a,type:"file",style:{display:"none"},onChange:K(composeEventHandlers(i,H)),onClick:K(composeEventHandlers(r,ie)),tabIndex:-1},n,R)),s)}}),[R,n,a,H,i]);return _objectSpread(_objectSpread({},I),{},{isFocused:$&&!i,getRootProps:ne,getInputProps:re,rootRef:A,inputRef:R,open:K(q)})}function reducer(e,t){switch(t.type){case"focus":return _objectSpread(_objectSpread({},e),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},e),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return _objectSpread(_objectSpread({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return _objectSpread(_objectSpread({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return _objectSpread({},initialState);default:return e}}function noop(){}const Dropzone=({onDrop:e,accept:t,dragClass:n,children:i})=>{const{getRootProps:r,isDragActive:s}=useDropzone({onDrop:e,accept:t,noClick:!0,noKeyboard:!0});return React.createElement("div",Object.assign({className:s?n:""},r()),i)};let typed=null;const Editor=({id:e,appId:t,parentId:n,placeholder:i,text:r,buttonText:s,embed:o,attachments:a,options:l,meeting:c,showAttachments:h=!1,showCloudFiles:d=!1,showEmbeds:u=!1,showPolls:p=!1,showMeetings:f=!1,showTyping:m=!1,useDraft:g=!1,showMention:O=!1,onSubmit:y,editorType:v,editorLocation:b})=>{const{client:w,options:S}=React.useContext(WeavyContext),[x,C]=React.useState(""),[_,E]=React.useState(!1),[P,k]=React.useState([]),[T,A]=React.useState([]),[R,M]=React.useState(null),[I,L]=React.useState([]),[$,D]=React.useState(!1),[N,Q]=React.useState([]),[F,B]=React.useState(!1),[j,V]=React.useState(""),{openCloudFiles:U}=useCloudFiles((function(e){k([...P,...e])})),W=React.useRef(null);let Z;const H=useMutateTyping(),q=[`${b}-${v}-uploads`,t,e],X=useMutateFileUpload(q),{mutations:z,progress:Y,status:G}=useMutatingFileUploads(q),K=useRemoveMutatingFileUpload(q),J=useClearMutatingFileUpload(q),ee=React.useCallback(throttle$1((function(){H.mutate({id:t,type:v,location:b})}),2e3,{trailing:!1}),[t]),te=React.useCallback(throttle$1((function(){ie()}),500),[t,P,R,j,I]),ne=[keymap.of([{key:"messages"==v?"Enter":"Ctrl-Enter",preventDefault:!0,run:()=>(Oe(),!0)}]),markdown({base:markdownLanguage}),mentions,autocompletion({override:O?[async function(e){let n=e.matchBefore(/(?!\]\(@)(^[^@]{0,1}|[^@]{2})@([^@]+)/);if(!e.explicit&&!n)return null;n=e.matchBefore(/@[^@]+/),typed=null==n?void 0:n.text.substring(1);const i=await(null==w?void 0:w.get("/api/users/autocomplete?id="+t+"&q="+typed)),r=await(null==i?void 0:i.json());let s=[];r.data&&(s=r.data.filter((e=>void 0!==e.display_name)).map((e=>({item:e,label:e.display_name,apply:function(t,n,i,r){var s="["+e.display_name+"](@u"+e.id.toString()+")",o=t.state.update({changes:{from:i-1,to:i}});t.dispatch(o),o=t.state.update({changes:{from:i-1,to:r-1,insert:s}}),t.dispatch(o)}}))));return{from:n?n.from+1:e.pos,options:s,filter:!1}}]:null,closeOnBlur:!1,icons:!1,addToOptions:[{render:function(e,t){var n,i,r,s;let o=document.createElement("div");o.classList.add("wy-item"),o.classList.add("wy-item-hover"),(null===(n=e.item)||void 0===n?void 0:n.is_member)||o.classList.add("wy-disabled");let a=document.createElement("div");a.classList.add("wy-avatar"),a.classList.add("wy-avatar-initials"),a.title=(null===(i=e.item)||void 0===i?void 0:i.display_name)||"";let l=document.createElement("span");l.innerHTML=getInitials((null===(r=e.item)||void 0===r?void 0:r.display_name)||"")||"",a.appendChild(l);let c=document.createElement("div");return c.classList.add("wy-item-body"),c.innerText=(null===(s=e.item)||void 0===s?void 0:s.display_name)||"",o.appendChild(a),o.appendChild(c),o},position:10}]}),syntaxHighlighting(defaultHighlightStyle,{fallback:!0}),EditorView.lineWrapping,EditorView.domEventHandlers({paste(e,t){var n;let i=[];const r=(null===(n=e.clipboardData)||void 0===n?void 0:n.items)||[];for(let e in r){const t=r[e];"file"===t.kind&&(i=[...i,t.getAsFile()])}if(i.length>0&&h){for(var s=0;s<i.length;s++){let e={file:i[s]};X.mutateAsync(e,{})}return!0}}})];function ie(){var e,i;let r=`draft-${v}-${n||t}`,s=null===(i=null===(e=W.current)||void 0===e?void 0:e.view)||void 0===i?void 0:i.state.doc.toString();void 0===s&&(s=j);const o=z.filter((e=>{var t,n;return null!=(null===(n=null===(t=null==e?void 0:e.state)||void 0===t?void 0:t.context)||void 0===n?void 0:n.blob)})).map((e=>e.state.context.blob)),a=[...o,...P];a.length||R||N.length||I.length||""!==s?localStorage.setItem(r,JSON.stringify({blobs:a,meeting:R,text:s,pollOptions:I,embeds:N})):localStorage.removeItem(r)}React.useEffect((()=>{null!=r&&V(r),null!=o&&(Q([o]),se([o.original_url])),null!=a&&A(a),null!=l&&(L([...l,{id:null,text:""}]),D(!0)),null!=c&&M(c)}),[t,r,o,a,l,c]),React.useEffect((()=>{var e;if(g){let i=`draft-${v}-${n||t}`,r=localStorage.getItem(i);if(r){let t=JSON.parse(r);V(t.text),k(t.blobs),Q(t.embeds),M(t.meeting),(null===(e=t.pollOptions)||void 0===e?void 0:e.length)>0&&(D(!0),L(t.pollOptions))}}return()=>{J()}}),[]),useUpdateEffect((()=>{g&&ie()}),[W,z,P,R,N,j,I]);const{getEmbeds:re,initEmbeds:se,clearEmbeds:oe}=useEmbeds((e=>{Q((t=>[e,...t]))})),ae=e=>{Q((t=>t.filter((t=>t.id!==e))))},le=()=>{Q((e=>{let t=e.shift();return t?[...e,t]:e}))},ce=(e,t)=>{u&&(async e=>{await re(e)})(e),m&&""!==t.state.doc.toString()&&ee(),g&&te()},he=async e=>{if(e.target.files)for(var t=0;t<e.target.files.length;t++){let n={file:e.target.files[t]};X.mutateAsync(n,{})}},de=e=>{null==Z||Z.click()},ue=(e,t,n)=>{C(""),K(e)},pe=(e,t)=>{C(""),k(P.filter((t=>t.id!==e)))},fe=(e,t)=>{A(T.filter((t=>t.id!==e)))};const me=React.useCallback((e=>{if(e.length>0&&h){for(var t=0;t<e.length;t++){let n={file:e[t]};X.mutateAsync(n,{})}return!0}}),[]),ge=e=>{M(e)},Oe=async()=>{var e,t;const n=(null===(t=null===(e=W.current)||void 0===e?void 0:e.view)||void 0===t?void 0:t.state.doc.toString())||"",i=z.filter((e=>{var t,n;return null!=(null===(n=null===(t=null==e?void 0:e.state)||void 0===t?void 0:t.context)||void 0===n?void 0:n.blob)})).map((e=>e.state.context.blob)),r=[...i,...P];""!==n||0!==r.length||0!==T.length||0!==N.length||null!==R||0!==I.filter((e=>""!==e.text.trim())).length?(B(!0),queueMicrotask((()=>{var e,t,n,i;V(""),C(""),k([]),A([]),Q([]),L([]),D(!1),oe(),M(null),null===(t=null===(e=W.current)||void 0===e?void 0:e.view)||void 0===t||t.dispatch({changes:{from:0,to:null===(i=null===(n=W.current)||void 0===n?void 0:n.view)||void 0===i?void 0:i.state.doc.length,insert:""}}),E(!1),J()})),await y(n,r,T,(null==R?void 0:R.id)||null,N.length>0?N[0].id:null,I),B(!1)):E(!0)};let ye=React.createElement(React.Fragment,null,"messages"===v&&React.createElement("div",{className:"wy-message-editor-inputs"},(h||d)&&React.createElement(UIDropdown.UI,{directionY:"up",icon:"plus"},h&&React.createElement(React.Fragment,null,React.createElement(UIDropdown.Item,{onClick:de},React.createElement(UIIcon.UI,{name:"attachment"})," File from device"),React.createElement("input",{type:"file",ref:e=>Z=e,value:x,onChange:he,multiple:!0,hidden:!0,tabIndex:-1})),d&&React.createElement(UIDropdown.Item,{onClick:U},React.createElement(UIIcon.UI,{name:"cloud"})," File from cloud"),f&&React.createElement(Meetings,{onMeetingAdded:ge,dropdown:!0})),React.createElement("div",{className:classNames("wy-message-editor-text",{"wy-is-invalid":_})},React.createElement(ReactCodeMirror,{ref:W,value:j,placeholder:i,extensions:ne,onChange:ce,indentWithTab:!1,basicSetup:{defaultKeymap:!1,lineNumbers:!1,dropCursor:!0,highlightActiveLine:!1,history:!0,foldGutter:!1,autocompletion:!0,drawSelection:!1,highlightSpecialChars:!1,syntaxHighlighting:!1,highlightSelectionMatches:!1}})),React.createElement(UIButton.UI,{title:s,disabled:F,onClick:Oe},React.createElement(UIIcon.UI,{name:"send",color:"primary"}))),"comments"===v&&React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-comment-editor-inputs"},(h||d)&&React.createElement(UIDropdown.UI,{directionY:"up",icon:"plus"},h&&React.createElement(React.Fragment,null,React.createElement(UIDropdown.Item,{onClick:de},React.createElement(UIIcon.UI,{name:"attachment"})," File from device"),React.createElement("input",{type:"file",ref:e=>Z=e,value:x,onChange:he,multiple:!0,hidden:!0,tabIndex:-1})),d&&React.createElement(UIDropdown.Item,{onClick:U},React.createElement(UIIcon.UI,{name:"cloud"})," File from cloud")),React.createElement("div",{className:classNames("wy-comment-editor-text",{"wy-is-invalid":_})},React.createElement(ReactCodeMirror,{ref:W,value:j,placeholder:i,extensions:ne,onChange:ce,indentWithTab:!1,basicSetup:{defaultKeymap:!1,lineNumbers:!1,dropCursor:!0,highlightActiveLine:!1,history:!0,foldGutter:!1,autocompletion:!0,drawSelection:!1,highlightSpecialChars:!1,syntaxHighlighting:!1,highlightSelectionMatches:!1}})),React.createElement(UIButton.UI,{title:s,disabled:F,onClick:Oe},React.createElement(UIIcon.UI,{name:"send",color:"primary"})))),"posts"===v&&React.createElement(React.Fragment,null,React.createElement("div",{className:classNames("wy-post-editor-text",{"wy-is-invalid":_})},React.createElement(ReactCodeMirror,{ref:W,value:j,placeholder:i,extensions:ne,onChange:ce,indentWithTab:!1,basicSetup:{defaultKeymap:!1,lineNumbers:!1,dropCursor:!0,highlightActiveLine:!1,history:!0,foldGutter:!1,autocompletion:!0,drawSelection:!1,highlightSpecialChars:!1,syntaxHighlighting:!1,highlightSelectionMatches:!1}})),React.createElement("div",{className:"wy-post-editor-inputs"},h&&React.createElement("div",null,React.createElement(UIButton.UI,{title:"Add file from device",onClick:de},React.createElement(UIIcon.UI,{name:"attachment"})),React.createElement("input",{type:"file",ref:e=>Z=e,value:x,onChange:he,multiple:!0,hidden:!0,tabIndex:-1})),d&&React.createElement(UIButton.UI,{title:"Add file from cloud",onClick:U},React.createElement(UIIcon.UI,{name:"cloud"})),f&&React.createElement(Meetings,{onMeetingAdded:ge}),p&&React.createElement(UIButton.UI,{title:"Add poll",onClick:()=>{if($)D(!1);else{if(0===I.length){const e={id:null,text:""};L((t=>[...t,e]))}D(!0)}}},React.createElement(UIIcon.UI,{name:"poll"})),React.createElement(UIButton.UI,{className:"wy-button-primary",title:s,disabled:F,onClick:Oe},s)))),ve=React.createElement(React.Fragment,null,p&&$&&I.length>0&&React.createElement("div",{className:"wy-poll-form"},I.map(((e,t)=>React.createElement("input",{key:"option_"+t,value:e.text,onChange:e=>((e,t)=>{let n=[...I];n[e].text=t.target.value,L(n)})(t,e),className:"wy-input",type:"text",placeholder:"+ add an option",onFocus:e=>((e,t)=>{if(t===I.length-1){const e={id:null,text:""};L((t=>[...t,e]))}})(0,t)})))),(h||d)&&React.createElement("div",null,T.map((e=>React.createElement(Blob$1,{key:e.id,id:e.id,name:e.name,className:"wy-item-body"},React.createElement(UIButton.UI,{onClick:fe.bind(Editor,e.id)},React.createElement(UIIcon.UI,{name:"close-circle"}))))),z&&z.map(((e,t)=>{var n;let i=null===(n=e.state.context)||void 0===n?void 0:n.file;return React.createElement(React.Fragment,{key:"f"+t},i&&React.createElement(FileItem$1.Item,{file:i,features:[],appFeatures:void 0},React.createElement(UIButton.UI,{onClick:ue.bind(Editor,e,i.id)},React.createElement(UIIcon.UI,{name:"close-circle"}))))})),P.map((e=>React.createElement(Blob$1,{key:e.id,id:e.id,name:e.name,className:"wy-item-body"},React.createElement(UIButton.UI,{onClick:pe.bind(Editor,e.id)},React.createElement(UIIcon.UI,{name:"close-circle"})))))),f&&R&&React.createElement("div",{className:"wy-item"},React.createElement(Meeting,{id:R.id,title:R.provider,className:"wy-item-body"}),React.createElement(UIButton.UI,{onClick:()=>{M(null)}},React.createElement(UIIcon.UI,{name:"close-circle"}))),u&&React.createElement("div",{className:"wy-embed-preview"},React.createElement(React.Fragment,null,N.map(((e,t)=>React.createElement(Embed,{key:"embed"+t,embed:e,onRemove:ae,onSwap:N.length>1?le:null}))))));return React.createElement("div",{className:classNames({"wy-post-editor":"posts"===v},{"wy-comment-editor":"comments"===v},{"wy-message-editor":"messages"===v})},React.createElement(Dropzone,{onDrop:me,dragClass:classNames({"wy-post-editor-dragging":"posts"===v},{"wy-comment-editor-dragging":"comments"===v},{"wy-message-editor-dragging":"messages"===v})},"messages"===v&&React.createElement(React.Fragment,null,ve),ye,("posts"===v||"comments"===v)&&React.createElement(React.Fragment,null,ve)))},Messages=({id:e,members:t,displayName:n,avatarUrl:i,lastMessageId:r,chatRoom:s,contextual:o=!1,features:a,appFeatures:l})=>{const[,c]=React.useState(),{user:h}=React.useContext(UserContext),d=useQueryClient(),{client:u}=React.useContext(WeavyContext),p=React.useRef(),{dispatch:f,on:m,events:g}=useEvents(),O=useMessages(e,{}),{isLoading:y,isError:v,data:b,error:w,fetchNextPage:S,hasNextPage:x,isFetching:C,isFetchingNextPage:_}=O,E=useMutateRead(),P=useMutateMessage();React.useLayoutEffect((()=>{e&&!y&&(scrollParentToBottom(p.current),c((()=>requestAnimationFrame((()=>scrollParentToBottom(p.current))))))}),[e,y]);const k=useReverseInfiniteScroll(O,[e]);React.useEffect((()=>{e&&r&&E.mutate({id:e,read:!0,messageId:r})}),[e,r]),React.useEffect((()=>(e&&(null==u||u.subscribe(`a${e}`,"message_created",I),null==u||u.subscribe(`a${e}`,"reaction_added",T),null==u||u.subscribe(`a${e}`,"reaction_removed",A),o||null==u||u.subscribe(`a${e}`,"conversation_marked",M)),()=>{if(e){d.getQueryData(["messages",e])&&d.setQueryData(["messages",e],(e=>({pages:null==e?void 0:e.pages.slice(0,1),pageParams:[void 0]}))),null==u||u.unsubscribe(`a${e}`,"message_created",I),null==u||u.unsubscribe(`a${e}`,"reaction_added",T),null==u||u.unsubscribe(`a${e}`,"reaction_removed",A),o||null==u||u.unsubscribe(`a${e}`,"conversation_marked",M)}})),[e]);const T=React.useCallback((e=>{f("reaction_added_"+e.entity.id,e)}),[e]),A=React.useCallback((e=>{f("reaction_deleted_"+e.entity.id,e)}),[e]),R=()=>{c((()=>requestAnimationFrame((()=>scrollParentToBottom(k.current,!0)))))},M=async t=>{let n=isParentAtBottom(k.current);d.invalidateQueries(["members",e]),n&&c((()=>requestAnimationFrame((()=>scrollParentToBottom(k.current,!0)))))},I=React.useCallback((t=>{var n;if(t.message.app_id!==e||t.message.created_by_id===h.id)return;t.message.created_by=t.actor,E.mutate({id:e,read:!0,messageId:t.message.id});const i=d.getQueryData(["messages",e]);if(i&&i.pages){let r=isParentAtBottom(k.current);const s=null!==(n=i.pages.map(((e,n)=>(0===n&&(e.data=[...e.data,t.message]),e))))&&void 0!==n?n:[];d.setQueryData(["messages",e],(e=>({pages:s,pageParams:e.pageParams}))),r&&c((()=>requestAnimationFrame((()=>scrollParentToBottom(k.current,!0)))))}}),[e]),L=React.createElement("div",{className:"wy-avatar-header"},s&&!i?React.createElement(AvatarGroup,{members:t,user:h,name:n,size:128}):o||!n&&!i?void 0:React.createElement(Avatar,{src:i,name:n,size:128,id:e}),!o&&n&&React.createElement("h3",{className:"wy-headline"},n));let $=React.createElement(UIButton.UI,{onClick:()=>S(),disabled:!x||_,className:"wy-message-readmore"},"Load more"),D=React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-pager",ref:k},_?"Loading more...":x?$:L),b&&t&&b.pages&&b.pages.map(((n,i)=>{var r;let c;return React.createElement(React.Fragment,{key:b.pages.length-i},null===(r=n.data)||void 0===r?void 0:r.map((n=>{const i=dayjs.utc(n.created_at).tz(dayjs.tz.guess());let r=React.createElement(React.Fragment,null);(null==c?void 0:c.format("YYMMDD"))!==i.format("YYMMDD")&&(c=i,r=React.createElement("div",{className:"wy-date-separator"},React.createElement("time",null,i.format("L"))));const d=React.createElement(Message,{key:n.id,id:n.id,html:n.html,temp:n.temp,me:n.created_by.id===h.id,avatar:n.created_by.avatar_url,name:n.created_by.display_name,created_at:n.created_at,created_by:n.created_by.display_name,attachments:n.attachments,meeting:n.meeting,options:n.options,appId:e,reactions:n.reactions,chatRoom:s,features:a,appFeatures:l,seenBy:!o&&t.data&&t.data.length>0?t.data.filter((e=>e.marked_id===n.id&&e.id!==h.id)):[]});return React.createElement(React.Fragment,{key:n.id},r,d)})))})),React.createElement("div",{ref:p}));return y&&(D=React.createElement(UISpinner.UI,{overlay:!0})),React.createElement(React.Fragment,null,React.createElement("div",{id:"container",className:"wy-messages"},D),React.createElement("div",{className:"wy-footerbar wy-footerbar-sticky"},React.createElement(Editor,{key:e,appId:e,placeholder:"Type a message",buttonText:"",editorType:"messages",editorLocation:"apps",onSubmit:async(t,n,i,r,s,o)=>{e&&await P.mutateAsync({id:e,text:t,blobs:n,meeting:r,userId:h.id,callback:R},{onSuccess:t=>{c((()=>requestAnimationFrame((()=>scrollParentToBottom(k.current,!0))))),E.mutate({id:e,read:!0,messageId:t.id},{onSettled:()=>c((()=>requestAnimationFrame((()=>requestAnimationFrame((()=>scrollParentToBottom(p.current,!0)))))))})}})},showMention:hasFeature(a,Feature.Mentions,null==l?void 0:l.mentions),showAttachments:hasFeature(a,Feature.Attachments,null==l?void 0:l.attachments),showCloudFiles:hasFeature(a,Feature.CloudFiles,null==l?void 0:l.cloudFiles),showMeetings:hasFeature(a,Feature.Meetings,null==l?void 0:l.meetings),showTyping:hasFeature(a,Feature.Typing,null==l?void 0:l.typing),useDraft:!0})))};function useMutateLeaveConversation(){const{client:e}=React.useContext(WeavyContext),{setSelectedConversationId:t}=React.useContext(MessengerContext),n=useQueryClient();if(!e)throw new Error("useMutateLeaveConversation must be used within an WeavyProvider");return useMutation((async({id:t,members:n})=>await e.post("/api/apps/"+t+"/members/"+n.join(","),"DELETE",JSON.stringify(n))),{onSuccess:()=>{n.invalidateQueries("conversations"),t(null)}})}function useBadge(){const{client:e}=React.useContext(WeavyContext);if(!e)throw new Error("useBadge must be used within an WeavyProvider");return useQuery("badge",(async()=>{const t=await e.get("/api/conversations/badge");if(t.ok){return await t.json()}return null}))}const ConversationBadge=()=>{const{client:e}=React.useContext(WeavyContext),[t,n]=React.useState(0);if(!e)throw new Error("Weavy Badge component must be used within an WeavyProvider");const{isLoading:i,data:r,refetch:s}=useBadge(),o=e=>{s()};return React.useEffect((()=>{r&&n(r.private+r.rooms)}),[r]),React.useEffect((()=>(e.subscribe(null,"message_created",o),e.subscribe(null,"conversation_marked",o),()=>{e.unsubscribe(null,"message_created",o),e.unsubscribe(null,"conversation_marked",o)})),[]),React.createElement(React.Fragment,null,!i&&t>0&&React.createElement("span",{className:"wy-badge wy-badge-danger"},t))};function useFeatures(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useFeatures must be used within an WeavyProvider");return useQuery(["features",e],(async()=>{const t=await n.get("/api/features/"+e);return await t.json()}),t)}const Conversation=({id:e,showBackButton:t,features:n})=>{var i;const r=useQueryClient(),{client:s}=React.useContext(WeavyContext),{selectedConversationId:o,setSelectedConversationId:a}=React.useContext(MessengerContext),{user:l}=React.useContext(UserContext),[c,h]=React.useState(!1),[d,u]=React.useState(!1),[p,f]=React.useState(""),[m,g]=React.useState(!1),O="edb400ac-839b-45a7-b2a8-6a01820d1c44";if(!s)throw new Error("Weavy Conversation component must be used within an WeavyProvider");const{isLoading:y,data:v}=useConversation(o,{enabled:null!=o}),{isLoading:b,data:w,refetch:S}=useMembers(o,{enabled:null!=o}),{isLoading:x,data:C}=useFeatures("chat",{enabled:null!=o}),_=useMutateMembers(),E=useMutateConversationName(),P=useMutateRemoveMembers(),k=useMutateLeaveConversation(),T=React.useCallback((e=>{e.app.id===o&&r.invalidateQueries(["conversation",o])}),[o]),A=e=>{h(e)},R=e=>{u(e)},M=()=>{k.mutate({id:o,members:[l.id]}),u(!1),h(!1)};return React.useEffect((()=>{e&&a(e)}),[e]),React.useEffect((()=>(o&&s.subscribe(`a${o}`,"app_updated",T),()=>{o&&s.unsubscribe(`a${o}`,"app_updated",T)})),[o]),React.useEffect((()=>{v&&v.type===O&&f(null==v?void 0:v.display_name),!v||v.type!==O&&"d65dd4bc-418e-403c-9f56-f9cf4da931ed"!==v.type||g(!0)}),[v]),React.createElement(React.Fragment,null,React.createElement("header",{className:"wy-appbars","data-adjust-scrollbar-top":!0},React.createElement("nav",{className:"wy-appbar"},React.createElement("div",null,t&&React.createElement(React.Fragment,null,React.createElement(UIButton.UI,{onClick:()=>{a(null)}},React.createElement(UIIcon.UI,{name:"back"})),React.createElement(ConversationBadge,null))),o&&v&&React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-appbar-text"},React.createElement(Typing$1,{id:o,context:"conversation"},React.createElement("div",{className:"wy-appbar-text wy-typing-hide"},!m&&v.user_id&&React.createElement(Presence,{id:v.user_id,status:"away"}),v.display_name))),React.createElement(UIDropdown.UI,{directionX:"left"},React.createElement(UIDropdown.Item,{onClick:()=>R(!0)},React.createElement(UIIcon.UI,{name:"information"}),"Details"),v.type===O&&React.createElement(React.Fragment,null,React.createElement(UIDropdown.Item,{onClick:()=>A(!0)},React.createElement(UIIcon.UI,{name:"account-plus"}),"Add members"),React.createElement(UIDropdown.Item,{onClick:M},React.createElement(UIIcon.UI,{name:"account-minus"}),"Leave conversation")))))),!o&&React.createElement("div",{className:"wy-avatar-header"},React.createElement(Avatar,{src:l.avatar_url,name:l.display_name,presence:l.presence,id:l.id,size:256}),React.createElement("h2",{className:"wy-title"},"Welcome ",l.name,"!"),"Create or select a conversation to get started"),o&&w&&v&&C&&React.createElement("div",{className:"wy-pane-body"},React.createElement(Messages,{id:o,chatRoom:m,members:w,displayName:null==v?void 0:v.display_name,avatarUrl:null==v?void 0:v.avatar_url,lastMessageId:null===(i=null==v?void 0:v.last_message)||void 0===i?void 0:i.id,features:C,appFeatures:n})),React.createElement(UIOverlay.UI,{isOpen:c,className:"wy-modal"},React.createElement("header",{className:"wy-appbars","data-adjust-scrollbar-top":!0},React.createElement("nav",{className:"wy-appbar"},React.createElement(UIButton.UI,{onClick:()=>A(!1)},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("div",{className:"wy-appbar-text"},"Add members"))),w&&React.createElement(SearchUsers,{existingMembers:w.data,handleSubmit:async e=>{const t=e.map((e=>e.id));await _.mutateAsync({id:o,members:t}),h(!1)},buttonTitle:"Save"})),React.createElement(UIOverlay.UI,{isOpen:d,className:"wy-modal"},React.createElement("header",{className:"wy-appbars"},React.createElement("nav",{className:"wy-appbar"},React.createElement(UIButton.UI,{onClick:()=>R(!1)},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("div",{className:"wy-appbar-text"},"Details"))),React.createElement("div",{className:"wy-scroll-y"},v&&React.createElement("div",{className:"wy-avatar-header"},(null==v?void 0:v.type)===O&&l?React.createElement(AvatarGroup,{size:128,members:w,user:l,name:p}):React.createElement(Avatar,{src:null==v?void 0:v.avatar_url,name:null==v?void 0:v.display_name,size:128}),(null==v?void 0:v.type)!==O&&React.createElement("h3",{className:"wy-headline"},null==v?void 0:v.display_name)),(null==v?void 0:v.type)===O&&React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-pane-group"},React.createElement("label",{className:"wy-input-label"},"Conversation name"),React.createElement("div",{className:"wy-input-group"},React.createElement("input",{className:"wy-input",value:p,onChange:e=>(e=>{f(e.target.value)})(e)}),React.createElement(UIButton.UI,{onClick:()=>{E.mutate({id:o,name:p||null})},className:"wy-button-icon"},React.createElement(UIIcon.UI,{name:"content-save"}))),React.createElement("div",{className:"wy-description"},"Changing the name of a group chat changes it for everyone.")),React.createElement("div",{className:"wy-pane-group"},React.createElement("label",{className:"wy-input-label"},"Members"),v&&w&&w.data&&w.data.map((e=>React.createElement("div",{className:"wy-item",key:e.id},React.createElement(Avatar,{src:e.avatar_url,name:e.display_name,id:e.id,size:32,presence:e.presence}),React.createElement("div",{className:"wy-item-body"},e.display_name),v.created_by_id===l.id&&e.id!==l.id&&React.createElement(UIButton.UI,{onClick:()=>(e=>{P.mutate({id:o,members:[e]},{onSuccess:()=>{S()}})})(e.id),className:"wy-button-icon",title:"Remove member"},React.createElement(UIIcon.UI,{name:"account-minus"})),e.id===l.id&&React.createElement(UIButton.UI,{onClick:()=>M(),className:"wy-button-icon",title:"Leave conversation"},React.createElement(UIIcon.UI,{name:"account-minus"}))))),React.createElement(UIButton.UI,{onClick:()=>{u(!1),h(!0)},title:"Add members"},React.createElement(UIIcon.UI,{name:"account-plus"}),React.createElement("div",{className:"wy-item-body"},"Add members")))))))};var Conversation$1=React.memo(Conversation);function useConversations(e){const{client:t}=React.useContext(WeavyContext);if(!t)throw new Error("useConversations must be used within an WeavyProvider");return useInfiniteQuery("conversations",(async e=>{let n=e.pageParam||0;const i=await t.get("/api/conversations?contextual=false&skip="+n+"&top=25");return await i.json()}),Object.assign(Object.assign({},e),{getNextPageParam:(e,t)=>{if((null==e?void 0:e.end)<(null==e?void 0:e.count))return 25*t.length}}))}function useMutatePinned(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutatePinned must be used within an WeavyProvider");return useMutation((async({id:t,pin:n})=>(await e.post("/api/conversations/"+t+"/pin",n?"PUT":"DELETE","")).json()),{onSuccess:()=>{t.invalidateQueries("conversations")}})}function useMutateStarred(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateStarred must be used within an WeavyProvider");return useMutation((async({id:t,star:n})=>await e.post("/api/apps/"+t+"/stars",n?"POST":"DELETE","")),{onSuccess:()=>{t.invalidateQueries("conversations")}})}const ConversationListItem=({item:e,userId:t,members:n,refetchConversations:i})=>{var r,s,o,a,l,c,h,d,u,p;const{client:f}=React.useContext(WeavyContext),{setSelectedConversationId:m,selectedConversationId:g}=React.useContext(MessengerContext),{user:O}=React.useContext(UserContext),y=useMutateRead(),v=useMutatePinned(),b=useMutateStarred(),w=useMutateLeaveConversation(),S=dayjs.utc(null===(r=e.last_message)||void 0===r?void 0:r.created_at).tz(dayjs.tz.guess()),x="edb400ac-839b-45a7-b2a8-6a01820d1c44",C=React.useCallback((t=>{t.app.id===e.id&&i()}),[e.id]),_=React.useCallback((t=>{t.message.app_id===e.id&&i()}),[e.id]),E=React.useCallback((t=>{t.app.id===e.id&&i()}),[e.id]);React.useEffect((()=>(null==f||f.subscribe(`a${e.id}`,"app_updated",C),null==f||f.subscribe(`a${e.id}`,"message_created",_),null==f||f.subscribe(`a${e.id}`,"member_added",E),()=>{null==f||f.unsubscribe(`a${e.id}`,"app_updated",C),null==f||f.unsubscribe(`a${e.id}`,"message_created",_),null==f||f.unsubscribe(`a${e.id}`,"member_added",E)})),[e.id]);const P=t=>{t.preventDefault(),b.mutate({id:e.id,star:!1})},k=e.type!==x?null===(s=((null==n?void 0:n.data)||[]).filter((e=>e.id!==O.id)))||void 0===s?void 0:s[0]:null;return React.createElement("div",{className:classNames("wy-item wy-item-lg wy-item-hover wy-conversation",{"wy-unread":e.is_unread,"wy-active":g===e.id}),key:e.id,onClick:t=>((e,t)=>{e.defaultPrevented||(e.preventDefault(),m(t))})(t,e.id)},e.type===x&&O?React.createElement(AvatarGroup,{members:n,user:O,name:e.display_name}):React.createElement(Avatar,{src:null==k?void 0:k.avatar_url,id:(null==k?void 0:k.id)||-1,presence:(null==k?void 0:k.presence)||"away",name:e.display_name}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-row"},React.createElement("div",{className:"wy-item-title"},e.display_name),e.last_message&&React.createElement("time",{className:"wy-meta",dateTime:e.last_message.created_at.toString(),title:S.format("LLLL")},S.fromNow())),React.createElement("div",{className:"wy-item-row"},React.createElement("div",{className:"wy-item-text"},React.createElement(Typing$1,{id:e.id,context:"listitem"},React.createElement("span",{className:"wy-typing-hide"},e.last_message&&React.createElement(React.Fragment,null,t===(null===(o=e.last_message)||void 0===o?void 0:o.created_by.id)&&React.createElement(React.Fragment,null,"You: "),(e.members.count||0)>2&&t!==(null===(a=e.last_message)||void 0===a?void 0:a.created_by.id)&&React.createElement(React.Fragment,null,null===(l=e.last_message)||void 0===l?void 0:l.created_by.display_name,": ")),(null===(c=e.last_message)||void 0===c?void 0:c.text)&&React.createElement("span",null,e.last_message.plain),!(null===(h=e.last_message)||void 0===h?void 0:h.text)&&((null===(d=e.last_message)||void 0===d?void 0:d.attachment_count)||0)>0&&React.createElement(UIIcon.UI,{name:"attachment"}),!(null===(u=e.last_message)||void 0===u?void 0:u.text)&&(null===(p=e.last_message)||void 0===p?void 0:p.meeting_id)&&React.createElement(UIIcon.UI,{name:"zoom"}),!e.last_message&&React.createElement(React.Fragment,null,"")))))),React.createElement("div",{className:"wy-item-actions wy-item-actions-bottom"},e.is_starred&&React.createElement(UIButton.UI,{onClick:P},React.createElement(UIIcon.UI,{name:"star",size:24,className:"wy-icon-yellow"})),React.createElement(UIDropdown.UI,{directionX:"left",icon:e.is_pinned?"pin":void 0},React.createElement(React.Fragment,null,e.is_unread&&React.createElement(UIDropdown.Item,{onClick:t=>{t.preventDefault(),y.mutate({id:e.id,read:!0,messageId:e.last_message.id})}},React.createElement(UIIcon.UI,{name:"unread"}),"Mark as read"),!e.is_unread&&React.createElement(UIDropdown.Item,{onClick:t=>{t.preventDefault(),y.mutate({id:e.id,read:!1,messageId:null})}},React.createElement(UIIcon.UI,{name:"read"}),"Mark as unread")),React.createElement(React.Fragment,null,e.is_pinned&&React.createElement(UIDropdown.Item,{onClick:t=>{t.preventDefault(),v.mutate({id:e.id,pin:!1})}},React.createElement(UIIcon.UI,{name:"unpin"}),"Unpin"),!e.is_pinned&&React.createElement(UIDropdown.Item,{onClick:t=>{t.preventDefault(),v.mutate({id:e.id,pin:!0})}},React.createElement(UIIcon.UI,{name:"pin"}),"Pin")),React.createElement(React.Fragment,null,e.is_starred&&React.createElement(UIDropdown.Item,{onClick:P},React.createElement(UIIcon.UI,{name:"unstar"}),"Unstar"),!e.is_starred&&React.createElement(UIDropdown.Item,{onClick:t=>{t.preventDefault(),b.mutate({id:e.id,star:!0})}},React.createElement(UIIcon.UI,{name:"star"}),"Star")),e.type===x&&React.createElement(UIDropdown.Item,{onClick:()=>{w.mutate({id:e.id,members:[O.id]})}},React.createElement(UIIcon.UI,{name:"account-minus"}),"Leave conversation"))))};function useMutateConversation(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateConversation must be used within an WeavyProvider");return useMutation((async({members:t})=>(await e.post("/api/conversations/","POST",JSON.stringify({members:t}))).json()),{onSuccess:()=>{t.invalidateQueries("conversations")}})}const NewConversation=()=>{const[e,t]=React.useState(!1),n=useMutateConversation(),{setSelectedConversationId:i}=React.useContext(MessengerContext);return React.createElement(React.Fragment,null,React.createElement(UIButton.UI,{onClick:()=>{t(!0)}},React.createElement(UIIcon.UI,{name:"plus"})),React.createElement(UIOverlay.UI,{isOpen:e,className:"wy-modal"},React.createElement("header",{className:"wy-appbars","data-adjust-scrollbar-top":!0},React.createElement("nav",{className:"wy-appbar"},React.createElement(UIButton.UI,{onClick:()=>{t(!1)}},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("div",{className:"wy-appbar-text"},"New message"))),React.createElement(SearchUsers,{handleSubmit:async e=>{const r=e.map((e=>e.id)),s=await n.mutateAsync({members:r});i(s.id),t(!1)},buttonTitle:"Next"})))};var NewConversation$1=React.memo(NewConversation);const ConversationList=()=>{const{client:e}=React.useContext(WeavyContext),{user:t}=React.useContext(UserContext);if(!e)throw new Error("Weavy ConversationList component must be used within an WeavyProvider");const n=useConversations({}),{data:i,isLoading:r,refetch:s,fetchNextPage:o,hasNextPage:a,isFetchingNextPage:l}=n,c=useInfinteScroll(n);React.useEffect((()=>(e.subscribe(null,"app_created",h),e.subscribe(null,"member_added",h),()=>{e.unsubscribe(null,"app_created",h),e.unsubscribe(null,"member_added",h)})),[]);const h=e=>{s()};let d=React.createElement(UIButton.UI,{onClick:()=>o(),disabled:!a||l,className:"wy-message-readmore"},"Load more");return React.createElement(React.Fragment,null,React.createElement("header",{className:"wy-appbars","data-adjust-scrollbar-top":!0},React.createElement("nav",{className:"wy-appbar"},React.createElement(Avatar,{src:t.avatar_url,name:t.display_name,presence:t.presence,id:t.id,size:24}),React.createElement("div",null,"Messenger"),React.createElement(NewConversation$1,null))),React.createElement("div",{className:"wy-conversations"},r&&React.createElement(UISpinner.UI,{overlay:!0}),i&&i.pages&&i.pages.map(((e,n)=>{var i;return null===(i=e.data)||void 0===i?void 0:i.map((e=>React.createElement(ConversationListItem,{key:e.id,members:e.members,refetchConversations:s,item:e,userId:t.id})))})),React.createElement("div",{className:"wy-pager",ref:c},l?"Loading more...":a?d:"")))},Messenger=({className:e})=>{const{client:t}=React.useContext(WeavyContext);if(!t)throw new Error("Weavy Messenger component must be used within an WeavyProvider");return React.createElement(MessengerProvider,null,React.createElement("div",{className:classNames("wy-messenger-provider",e)},React.createElement("div",{className:"wy-messenger-sidebar wy-scroll-y"},React.createElement(ConversationList,null)),React.createElement("div",{className:"wy-messenger-conversation wy-scroll-y"},React.createElement(Conversation$1,{id:null}))))};function useChat(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useChat must be used within an WeavyProvider");return useQuery(["chat",e],(async()=>{const t=await n.get("/api/apps/"+e);return await t.json()}),t)}const Chat=({uid:e,className:t,features:n})=>{var i;const{client:r}=React.useContext(WeavyContext),[s,o]=React.useState(null);if(!r)throw new Error("Weavy Chat component must be used within an WeavyProvider");const{isLoading:a,data:l}=useChat(e,{}),{isLoading:c,data:h}=useMembers(s,{enabled:null!=s}),{isLoading:d,data:u}=useConversation(s,{enabled:null!=s}),{isLoading:p,data:f}=useFeatures("chat",{enabled:null!=s});return React.useEffect((()=>{o(l?l.id:null)}),[l]),React.createElement("div",{className:classNames("wy-messenger-conversation wy-scroll-y",t)},!a&&!l&&React.createElement("div",null,"No chat with the contextual id ",React.createElement("strong",null,e)),s&&h&&l&&u&&f&&React.createElement(Messages,{id:s,contextual:!0,chatRoom:!0,members:h,lastMessageId:null===(i=u.last_message)||void 0===i?void 0:i.id,features:f,appFeatures:n}))};function usePosts(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("usePosts must be used within an WeavyProvider");return useQuery(["posts",e],(async()=>{const t=await n.get("/api/apps/"+e);return await t.json()}),t)}function usePostsList(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("usePostsList must be used within an WeavyProvider");var i=Object.assign(Object.assign({},t),{getNextPageParam:(e,t)=>{if((null==e?void 0:e.end)<(null==e?void 0:e.count))return 10*t.length}});return useInfiniteQuery(["posts",e],(async t=>{let i=t.pageParam||0;const r=await n.get("/api/apps/"+e+"/posts?orderby=createdat+desc&skip="+i+"&top=10");return await r.json()}),i)}function useCommentList(e,t,n){const{client:i}=React.useContext(WeavyContext);if(!i)throw new Error("useCommentList must be used within an WeavyProvider");var r=Object.assign(Object.assign({},n),{getNextPageParam:(e,t)=>{if((null==e?void 0:e.end)<(null==e?void 0:e.count))return 10*t.length}});return useInfiniteQuery(["comments",e],(async n=>{let r=n.pageParam||0;const s=await i.get(`/api/${t}/${e}/comments?orderby=createdat+asc&skip=${r}&top=10`);return await s.json()}),r)}function useMutateComment(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateComment must be used within an WeavyProvider");return useMutation((async({parentId:t,type:n,text:i,blobs:r,meeting:s,embed:o})=>(await e.post(`/api/${n}/${t}/comments`,"POST",JSON.stringify({text:i,blobs:r.map((e=>e.id)),meeting_id:s,embed_id:o}))).json()),{onSuccess:(e,n,i)=>{addCacheItem(t,["comments",n.parentId],e,i.tempId)},onMutate:async e=>{await t.cancelQueries(["comments",e.parentId]);const n=Math.random(),i={id:n,text:e.text,temp:!0,created_by:{display_name:e.userName},created_at:(new Date).toUTCString()};return addCacheItem(t,["comments",e.parentId],i),{tempId:n}}})}function useMutateEditPost$1(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateEditComment must be used within an WeavyProvider");return useMutation((async({id:t,text:n,blobs:i,attachments:r,meeting:s,embed:o})=>(await e.post("/api/comments/"+t,"PATCH",JSON.stringify({text:n,blobs:i.map((e=>e.id)),attachments:r.map((e=>e.id)),meeting_id:s,embed_id:o}))).json()),{onSuccess:(e,n,i)=>{var r;const s=t.getQueryData(["comments",n.parentId]);if(s&&s.pages){const i=null!==(r=s.pages.map(((t,i)=>(t.data=[...t.data.map((t=>t.id===n.id?e:t))],t))))&&void 0!==r?r:[];t.setQueryData(["comments",n.parentId],(e=>({pages:i,pageParams:e.pageParams})))}},onMutate:async e=>{}})}const CommentEdit=({appId:e,parentId:t,id:n,text:i,embed:r,attachments:s,onClose:o})=>{const a=useMutateEditPost$1();return React.createElement(React.Fragment,null,React.createElement("nav",{className:"wy-item"},React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},"Edit comment")),React.createElement("a",{className:"wy-button wy-button-icon"},React.createElement(UIButton.UI,{onClick:o},React.createElement(UIIcon.UI,{name:"close"})))),React.createElement(Editor,{editorType:"posts",editorLocation:"posts",id:n,appId:e,placeholder:"Update the comment",text:i,embed:r,attachments:s,buttonText:"Update",onSubmit:async(i,r,s,l,c,h)=>{await a.mutateAsync({id:n,appId:e,parentId:t,text:i,blobs:r,attachments:s,meeting:l,embed:c}),o()},showAttachments:!0,showCloudFiles:!0,showEmbeds:!1,showPolls:!1}))};function useMutateRestoreComment(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateRestoreComment must be used within an WeavyProvider");return useMutation((async({id:t})=>(await e.post(`/api/comments/${t}/restore`,"POST","")).json()),{onSuccess:(e,n,i)=>{updateCacheItem(t,["comments",n.parentId],n.id,(t=>{t.is_trashed=e.is_trashed}))},onMutate:async e=>{}})}const CommentTrashed=({id:e,appId:t,parentId:n})=>{const i=useMutateRestoreComment(),r=useQueryClient();return React.createElement("div",{className:"wy-item wy-item-lg"},React.createElement("div",{className:"wy-item-body"},"Comment was trashed."),React.createElement(UIButton.UI,{onClick:()=>{i.mutate({id:e,appId:t,parentId:n},{onSuccess:()=>{updateCacheItem(r,["posts",t],n,(e=>{e.comment_count=(e.comment_count||0)+1}))}})},className:"wy-button-variant"},"Undo"))};function useMutateTrashComment(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateTrashComment must be used within an WeavyProvider");return useMutation((async({id:t})=>(await e.post(`/api/comments/${t}/trash`,"POST","")).json()),{onSuccess:(e,n,i)=>{updateCacheItem(t,["comments",n.parentId],n.id,(t=>{t.is_trashed=e.is_trashed}))},onMutate:async e=>{}})}const CommentView=({appId:e,id:t,parentId:n,html:i,created_at:r,modified_at:s,created_by:o,attachments:a,reactions:l,embed:c,features:h,appFeatures:d,onEdit:u})=>{const{user:p}=React.useContext(UserContext),f=useQueryClient(),{openPreview:m,setPreviewFiles:g}=React.useContext(PreviewContext),O=dayjs.utc(r).tz(dayjs.tz.guess()),y=useMutateTrashComment();let v=null==a?void 0:a.filter((e=>"image"===e.kind&&e.thumbnail_url)),b=null==a?void 0:a.filter((e=>"image"!==e.kind||!e.thumbnail_url));const w=(e,t)=>{e.preventDefault(),g(a),m(t)};return React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-item wy-item-sm wy-comment-header"},React.createElement(Avatar,{src:o.avatar_url,size:32,name:o.display_name}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},o.display_name),React.createElement("div",{className:"wy-item-text"},React.createElement("time",{dateTime:r,title:O.format("LLLL")},O.fromNow()),s&&React.createElement("time",{dateTime:s},"  edited"))),React.createElement("div",{className:"wy-item-actions wy-item-actions-top"},React.createElement(UIDropdown.UI,{directionX:"left"},p.id===o.id&&React.createElement(UIDropdown.Item,{onClick:u},React.createElement(UIIcon.UI,{name:"pencil"})," Edit"),p.id===o.id&&React.createElement(UIDropdown.Item,{onClick:()=>{y.mutate({id:t,appId:e,parentId:n},{onSuccess:()=>{updateCacheItem(f,["posts",e],n,(e=>{e.comment_count=(e.comment_count||1)-1}))}})}},React.createElement(UIIcon.UI,{name:"trashcan"})," Trash")))),React.createElement("div",{className:"wy-comment-body"},React.createElement("div",{className:"wy-comment-content"},v&&!!v.length&&React.createElement(ImageGrid,null,v.map((e=>React.createElement(React.Fragment,{key:e.id},e.download_url&&React.createElement(Image$1,{onClick:t=>w(t,e.id),key:e.id,src:e.download_url,previewSrc:e.preview_url,width:e.width,height:e.height}))))),c&&React.createElement(Embed,{embed:c}),React.createElement("div",{className:"wy-content",dangerouslySetInnerHTML:{__html:i}}),b&&!!b.length&&React.createElement("div",{className:"wy-list wy-list-bordered"},b.map((e=>React.createElement(Attachment,{key:e.id,onClick:t=>w(t,e.id),name:e.name,previewFormat:e.kind,provider:e.provider,url:e.download_url,previewUrl:e.provider?e.external_url:e.preview_url,mediaType:e.media_type,kind:e.kind,size:e.size})))))),React.createElement("div",{className:"wy-reactions-line"},hasFeature(h,Feature.Reactions,null==d?void 0:d.reactions)?React.createElement(React.Fragment,null,React.createElement(ReactionsList,{id:t,type:"comments",parentId:n,reactions:l}),React.createElement(ReactionsMenu,{id:t,type:"comments",parentId:n,reactions:l,placement:"top-end"})):React.createElement(React.Fragment,null,React.createElement(ReactionsLike,{id:t,type:"comments",parentId:n,reactions:l}),React.createElement(ReactionsList,{id:t,type:"comments",parentId:n,reactions:l,featureEnabled:!1}))))},Comment=e=>{var t=__rest(e,[]);const[n,i]=React.useState(!1);return React.createElement("div",{className:"wy-comment"},t.is_trashed&&React.createElement(CommentTrashed,Object.assign({},t)),!t.is_trashed&&n&&React.createElement(CommentEdit,Object.assign({},t,{onClose:()=>i((e=>!e))})),!t.is_trashed&&!n&&React.createElement(CommentView,Object.assign({},t,{onEdit:()=>i((e=>!e))})))},CommentPlaceholder=e=>{var t=__rest(e,[]);return React.createElement("div",{className:"wy-comment"},React.createElement("div",{className:"wy-item wy-comment-header"},React.createElement("img",{alt:"",className:"wy-avatar wy-placeholder",height:32,width:32,src:t.created_by.avatar_url}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},React.createElement("span",{className:"wy-placeholder"},"Placeholder name")),React.createElement("div",{className:"wy-item-text"},React.createElement("time",{className:"wy-placeholder",dateTime:"2022-12-31 00:00:00"},"2022-12-31 00:00:00")))),React.createElement("div",{className:"wy-comment-body"},React.createElement("div",{className:"wy-comment-content"},React.createElement("div",{className:"wy-content"},React.createElement("span",{className:"wy-placeholder"},"Lorem")," ",React.createElement("span",{className:"wy-placeholder"},"ipsum")," ",React.createElement("span",{className:"wy-placeholder"},"dolor")," ",React.createElement("span",{className:"wy-placeholder"},"sit")," ",React.createElement("span",{className:"wy-placeholder"},"amet.")))))},Comments=({appId:e,parentId:t,type:n,features:i,appFeatures:r})=>{const s=useQueryClient(),o=useMutateComment(),{isLoading:a,isError:l,data:c,error:h,fetchNextPage:d,hasNextPage:u,isFetching:p,isFetchingNextPage:f}=useCommentList(t,n,{}),m=async(i,r,a,l,c,h)=>{await o.mutateAsync({parentId:t,type:n,text:i,blobs:r,meeting:null,embed:c},{onSuccess:i=>{updateCacheItem(s,[n,e],t,(e=>{e.comment_count=(e.comment_count||0)+1}))}})};return a?React.createElement("div",{className:"wy-buttons"},React.createElement(UISpinner.UI,null)):React.createElement("div",null,React.createElement("div",{className:"wy-comments"},!a&&c&&c.pages&&c.pages.map(((n,s)=>{var o;return React.createElement(React.Fragment,{key:c.pages.length-s},null===(o=n.data)||void 0===o?void 0:o.map((n=>n.temp?React.createElement(CommentPlaceholder,{key:"comment"+n.id,text:n.text,created_at:n.created_at,created_by:n.created_by}):React.createElement(Comment,{key:"comment"+n.id,appId:e,parentId:t,id:n.id,text:n.text,html:n.html,created_at:n.created_at,modified_at:n.modified_at,created_by:n.created_by,trashed_at:n.trashed_at,attachments:n.attachments,reactions:n.reactions,embed:n.embed,is_trashed:n.is_trashed,features:i,appFeatures:r}))))}))),"files"===n?React.createElement("div",{className:"wy-comment-editor-bottom"},React.createElement(Editor,{editorType:"comments",editorLocation:n,appId:e,parentId:t,placeholder:"Create a comment",buttonText:"Comment",onSubmit:m,showMention:hasFeature(i,Feature.Mentions,null==r?void 0:r.mentions),showAttachments:hasFeature(i,Feature.Attachments,null==r?void 0:r.attachments),showCloudFiles:hasFeature(i,Feature.CloudFiles,null==r?void 0:r.cloudFiles),showEmbeds:!1,showPolls:!1,useDraft:!0})):React.createElement(Editor,{editorType:"comments",editorLocation:n,appId:e,parentId:t,placeholder:"Create a comment",buttonText:"Comment",onSubmit:m,showMention:hasFeature(i,Feature.Mentions,null==r?void 0:r.mentions),showAttachments:hasFeature(i,Feature.Attachments,null==r?void 0:r.attachments),showCloudFiles:hasFeature(i,Feature.CloudFiles,null==r?void 0:r.cloudFiles),showEmbeds:!1,showPolls:!1,useDraft:!0}))};function useMutateTrashPost(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateTrashPost must be used within an WeavyProvider");return useMutation((async({id:t})=>(await e.post(`/api/posts/${t}/trash`,"POST","")).json()),{onSuccess:(e,n,i)=>{updateCacheItem(t,["posts",n.appId],n.id,(t=>{t.is_trashed=e.is_trashed}))},onMutate:async e=>{}})}const CommentCount=({id:e,count:t})=>React.createElement(React.Fragment,null,t," ","comment"+(1!==t?"s":""));function useMutateSubscribe(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateSubscribe must be used within an WeavyProvider");return useMutation((async({id:t})=>(await e.post(`/api/posts/${t}/subscribe`,"POST","")).json()),{onSuccess:(e,n,i)=>{updateCacheItem(t,["posts",n.appId],n.id,(t=>{t.is_subscribed=e.is_subscribed}))},onMutate:async e=>{}})}function useMutateUnsubscribe(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateUnsubscribe must be used within an WeavyProvider");return useMutation((async({id:t})=>(await e.post(`/api/posts/${t}/unsubscribe`,"POST","")).json()),{onSuccess:(e,n,i)=>{updateCacheItem(t,["posts",n.appId],n.id,(t=>{t.is_subscribed=e.is_subscribed}))},onMutate:async e=>{}})}const PostView=({appId:e,id:t,html:n,created_at:i,modified_at:r,created_by:s,attachments:o,reactions:a,embed:l,comment_count:c,is_subscribed:h,options:d,meeting:u,features:p,appFeatures:f,onEdit:m})=>{var g;const{user:O}=React.useContext(UserContext),[y,v]=React.useState(!1),[b,w]=React.useState(!1),{openPreview:S,setPreviewFiles:x}=React.useContext(PreviewContext),C=dayjs.utc(i).tz(dayjs.tz.guess()),_=useMutateTrashPost(),E=useMutateSubscribe(),P=useMutateUnsubscribe();let k=null==o?void 0:o.filter((e=>"image"===e.kind&&e.thumbnail_url)),T=null==o?void 0:o.filter((e=>"image"!==e.kind||!e.thumbnail_url));const A=(e,t)=>{e.preventDefault(),x(o),S(t)};return React.createElement("div",null,React.createElement("div",{className:"wy-item wy-item-lg"},React.createElement(Avatar,{src:s.avatar_url,size:48,name:s.display_name}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-row"},React.createElement("div",{className:"wy-item-title"},s.display_name)),React.createElement("div",{className:"wy-item-row"},React.createElement("div",{className:"wy-item-text"},React.createElement("time",{dateTime:i,title:C.format("LLLL")},C.fromNow()),r&&React.createElement("time",{dateTime:r},"  edited")))),React.createElement("div",{className:"wy-item-actions wy-item-actions-top"},React.createElement(UIDropdown.UI,{directionX:"left"},React.createElement(UIDropdown.Item,{onClick:()=>{h?P.mutate({id:t,appId:e}):E.mutate({id:t,appId:e})}},h&&React.createElement(React.Fragment,null,React.createElement(UIIcon.UI,{name:"bell-off"})," Unsubscribe"),!h&&React.createElement(React.Fragment,null,React.createElement(UIIcon.UI,{name:"bell"})," Subscribe")),O.id===s.id&&React.createElement(UIDropdown.Item,{onClick:m},React.createElement(UIIcon.UI,{name:"pencil"})," Edit"),O.id===s.id&&React.createElement(UIDropdown.Item,{onClick:()=>{_.mutate({id:t,appId:e})}},React.createElement(UIIcon.UI,{name:"trashcan"})," Trash")))),k&&!!k.length&&React.createElement(ImageGrid,null,k.map((e=>React.createElement(React.Fragment,{key:e.id},e.download_url&&React.createElement(Image$1,{onClick:t=>A(t,e.id),src:e.download_url,previewSrc:e.preview_url,width:e.width,height:e.height}))))),l&&React.createElement(Embed,{embed:l}),React.createElement("div",{className:"wy-post-body"},React.createElement("div",{className:"wy-content",dangerouslySetInnerHTML:{__html:n}}),d&&d.length>0&&React.createElement(Poll,{appId:e,parentId:t,parentType:"posts",options:d}),T&&!!T.length&&React.createElement("div",{className:"wy-list wy-list-bordered"},T.map((e=>React.createElement(Attachment,{key:e.id,onClick:t=>A(t,e.id),name:e.name,previewFormat:e.kind,provider:e.provider,url:e.download_url,previewUrl:e.provider?e.external_url:e.preview_url,mediaType:e.media_type,kind:e.kind,size:e.size})))),u&&React.createElement(MeetingCard,{meeting:u})),React.createElement("div",{className:"wy-post-footer"},React.createElement("div",{className:"wy-reactions-line"},hasFeature(p,Feature.Reactions,null==f?void 0:f.reactions)?React.createElement(React.Fragment,null,React.createElement(ReactionsList,{id:t,type:"posts",parentId:e,reactions:a}),React.createElement(ReactionsMenu,{id:t,type:"posts",parentId:e,reactions:a})):React.createElement(React.Fragment,null,React.createElement(ReactionsLike,{id:t,type:"posts",parentId:e,reactions:a}),React.createElement(ReactionsList,{id:t,type:"posts",parentId:e,reactions:a,featureEnabled:!1}))),(null===(g=null==f?void 0:f.comments)||void 0===g||g)&&React.createElement("a",{href:"#",className:"wy-meta",onClick:e=>(e=>{e.preventDefault(),w((e=>!e)),v(!0)})(e)},React.createElement(CommentCount,{id:t,count:c||0}))),y&&React.createElement("div",Object.assign({},b?{}:{hidden:!0}),React.createElement(Comments,{appId:e,parentId:t,type:"posts",features:p,appFeatures:f})))};function useMutateEditPost(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateEditPost must be used within an WeavyProvider");return useMutation((async({id:t,text:n,blobs:i,attachments:r,meeting:s,embed:o,options:a})=>(await e.post("/api/posts/"+t,"PATCH",JSON.stringify({text:n,blobs:i.map((e=>e.id)),attachments:r.map((e=>e.id)),meeting_id:s,embed_id:o,options:a.filter((e=>""!==e.text.trim())).map((e=>({id:e.id,text:e.text})))}))).json()),{onSuccess:(e,n,i)=>{var r;const s=t.getQueryData(["posts",n.appId]);if(s&&s.pages){const i=null!==(r=s.pages.map(((t,i)=>(t.data=[...t.data.map((t=>t.id===n.id?e:t))],t))))&&void 0!==r?r:[];t.setQueryData(["posts",n.appId],(e=>({pages:i,pageParams:e.pageParams})))}},onMutate:async e=>{}})}const PostEdit=({appId:e,id:t,text:n,embed:i,attachments:r,options:s,meeting:o,onClose:a})=>{const l=useMutateEditPost();return React.createElement(React.Fragment,null,React.createElement("nav",{className:"wy-item"},React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},"Edit post")),React.createElement("a",{className:"wy-button wy-button-icon"},React.createElement(UIButton.UI,{onClick:a},React.createElement(UIIcon.UI,{name:"close"})))),React.createElement(Editor,{editorType:"posts",editorLocation:"apps",id:t,appId:e,placeholder:"Update the post",text:n,embed:i,meeting:o,attachments:r,options:s,buttonText:"Update",onSubmit:async(n,i,r,s,o,c)=>{await l.mutateAsync({id:t,appId:e,text:n,blobs:i,attachments:r,meeting:s,embed:o,options:c}),a()},showAttachments:!0,showCloudFiles:!0,showEmbeds:!0,showPolls:!0}))};function useMutateRestorePost(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutateRestorePost must be used within an WeavyProvider");return useMutation((async({id:t})=>(await e.post(`/api/posts/${t}/restore`,"POST","")).json()),{onSuccess:(e,n,i)=>{updateCacheItem(t,["posts",n.appId],n.id,(t=>{t.is_trashed=e.is_trashed}))},onMutate:async e=>{}})}const PostTrashed=({id:e,appId:t})=>{const n=useMutateRestorePost();return React.createElement("div",{className:"wy-item wy-item-lg"},React.createElement("div",{className:"wy-item-body"},"Post was trashed."),React.createElement(UIButton.UI,{onClick:()=>{n.mutate({id:e,appId:t})},className:"wy-button-variant"},"Undo"))},Post=e=>{var t=__rest(e,[]);const[n,i]=React.useState(!1);return React.createElement("div",{className:"wy-post"},t.is_trashed&&React.createElement(PostTrashed,Object.assign({},t)),!t.is_trashed&&n&&React.createElement(PostEdit,Object.assign({},t,{onClose:()=>i((e=>!e))})),!t.is_trashed&&!n&&React.createElement(PostView,Object.assign({},t,{onEdit:()=>i((e=>!e))})))},PostPlaceHolder=e=>{var t=__rest(e,[]);return React.createElement("div",{className:"wy-post"},React.createElement("div",{className:"wy-item wy-item-lg"},React.createElement("img",{alt:"",className:"wy-avatar wy-placeholder",height:48,width:48,src:t.created_by.avatar_url}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},React.createElement("span",{className:"wy-placeholder"},"Placeholder name")),React.createElement("div",{className:"wy-item-text"},React.createElement("time",{className:"wy-placeholder",dateTime:"2022-12-31 00:00:00"},"2022-12-31 00:00:00")))),React.createElement("div",{className:"wy-post-body"},React.createElement("div",{className:"wy-content"},React.createElement("span",{className:"wy-placeholder"},"Lorem")," ",React.createElement("span",{className:"wy-placeholder"},"ipsum")," ",React.createElement("span",{className:"wy-placeholder"},"dolor")," ",React.createElement("span",{className:"wy-placeholder"},"sit")," ",React.createElement("span",{className:"wy-placeholder"},"amet."))))},PostList=({appId:e,features:t,appFeatures:n})=>{const{client:i}=React.useContext(WeavyContext),{dispatch:r}=useEvents(),s=usePostsList(e,{}),{isLoading:o,data:a,fetchNextPage:l,hasNextPage:c,isFetchingNextPage:h,dataUpdatedAt:d}=s,u=useInfinteScroll(s);React.useEffect((()=>{e&&(null==i||i.subscribe(`a${e}`,"reaction_added",p),null==i||i.subscribe(`a${e}`,"reaction_removed",f))}),[e]);const p=React.useCallback((e=>{r("reaction_added_"+e.entity.id,e)}),[e]),f=React.useCallback((e=>{r("reaction_deleted_"+e.entity.id,e)}),[e]);let m=React.createElement(UIButton.UI,{onClick:()=>l(),disabled:!c||h,className:"wy-message-readmore"},d," Load more");return o?React.createElement("div",{className:"wy-buttons"},React.createElement(UISpinner.UI,null)):React.createElement("div",null,a&&a.pages&&a.pages.map(((i,r)=>{var s;return React.createElement(React.Fragment,{key:a.pages.length-r},null===(s=i.data)||void 0===s?void 0:s.map((i=>i.temp?React.createElement(PostPlaceHolder,{key:"post"+i.id,text:i.text,created_at:i.created_at,created_by:i.created_by}):React.createElement(Post,{key:"post"+i.id,appId:e,id:i.id,text:i.text,html:i.html,created_at:i.created_at,modified_at:i.modified_at,created_by:i.created_by,trashed_at:i.trashed_at,attachments:i.attachments,reactions:i.reactions,embed:i.embed,comment_count:i.comment_count,is_subscribed:i.is_subscribed,is_trashed:i.is_trashed,options:i.options,meeting:i.meeting,features:t,appFeatures:n}))))})),React.createElement("div",{className:"wy-message-readmore",ref:u},h?"Loading more...":c?m:""))};function useMutatePost(){const{client:e}=React.useContext(WeavyContext),t=useQueryClient();if(!e)throw new Error("useMutatePost must be used within an WeavyProvider");return useMutation((async({appId:t,text:n,blobs:i,meeting:r,embed:s,options:o})=>(await e.post("/api/apps/"+t+"/posts","POST",JSON.stringify({text:n,blobs:i.map((e=>e.id)),meeting_id:r,embed_id:s,options:o.filter((e=>""!==e.text.trim())).map((e=>({text:e.text})))}))).json()),{onSuccess:(e,n,i)=>{addCacheItem(t,["posts",n.appId],e,i.tempId,{descending:!0})},onMutate:async e=>{await t.cancelQueries(["posts",e.appId]);const n=Math.random(),i={id:n,text:e.text,temp:!0,created_by:{display_name:e.userName},created_at:(new Date).toUTCString()};return addCacheItem(t,["posts",e.appId],i,void 0,{descending:!0}),{tempId:n}}})}const Posts=({uid:e,className:t,features:n})=>{const{client:i}=React.useContext(WeavyContext),[r,s]=React.useState(null),o=useMutatePost();if(!i)throw new Error("Weavy Posts component must be used within an WeavyProvider");const{isLoading:a,data:l}=usePosts(e,{}),{isLoading:c,data:h}=useFeatures("feeds",{});React.useEffect((()=>{s(l?l.id:null)}),[l]);return React.createElement("div",{className:classNames("wy-posts",t)},!a&&!l&&React.createElement("div",null,"No posts app with the contextual id ",React.createElement("strong",null,e)," was found."),r&&l&&h&&React.createElement("div",{className:"wy-post"},React.createElement(Editor,{editorType:"posts",editorLocation:"apps",appId:r,placeholder:"Create a post",buttonText:"Post",onSubmit:async(e,t,n,i,s,a)=>{await o.mutateAsync({appId:r,text:e,blobs:t,meeting:i,embed:s,options:a},{onSuccess:e=>{}})},showMention:hasFeature(h,Feature.Mentions,null==n?void 0:n.mentions),showAttachments:hasFeature(h,Feature.Attachments,null==n?void 0:n.attachments),showCloudFiles:hasFeature(h,Feature.CloudFiles,null==n?void 0:n.cloudFiles),showEmbeds:hasFeature(h,Feature.Embeds,null==n?void 0:n.embeds),showPolls:hasFeature(h,Feature.Polls,null==n?void 0:n.polls),useDraft:!0})),r&&h&&React.createElement(PostList,{appId:r,features:h,appFeatures:n}))};function useApp(e,t){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useApp must be used within an WeavyProvider");return useQuery(["apps",e],(async()=>{const t=await n.get("/api/apps/"+e);return await t.json()}),t)}function useFileList(e,t={}){const{client:n}=React.useContext(WeavyContext);if(!n)throw new Error("useFileList must be used within an WeavyProvider");const i=useQueryClient(),r=["files",e];React.useEffect((()=>{i.removeQueries({queryKey:r,exact:!0,predicate:e=>JSON.stringify(e.meta)!==JSON.stringify(t.meta)})}),[t]);var s=Object.assign(Object.assign({},t),{getNextPageParam:(e,t)=>{if((null==e?void 0:e.end)<(null==e?void 0:e.count))return 25*t.length},select:e=>{var t;const n=i.getMutationCache().findAll({mutationKey:r,predicate:e=>{var t;return!!(null===(t=e.state.context)||void 0===t?void 0:t.file)}}).map((e=>e.state.context.file)),s=null===(t=i.getQueryCache().find(r))||void 0===t?void 0:t.meta,o=null==s?void 0:s.order;return n.forEach((t=>{if(t.id<1&&"ok"!==t.status&&"error"!==t.status){let n=findAnyExistingItem(e,"name",t.name,!0);n&&(t.id=n.id),e=addToQueryData(e,t,o)}else e=updateQueryData(e,t.id,(e=>{Object.assign(e,t)}))})),e}});return useInfiniteQuery(["files",e],(async t=>{var i;let r=t.pageParam||0,s=t.meta&&t.meta.order,o=!!(null===(i=t.meta)||void 0===i?void 0:i.trashed),a=s?s.by+(s.descending?"+desc":""):"",l="/api/apps/"+e+"/files?skip="+r+"&top=25&orderby="+a;o&&(l+="&trashed=null");const c=await n.get(l);return await c.json()}),s)}function useMutateFileRename(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileRename must be used within an WeavyProvider");return useMutation((async({file:e,name:n})=>{if(e.id>=1){const i=await t.post("/api/files/"+e.id,"PATCH",JSON.stringify({name:n}));if(!i.ok)throw await i.json();return i.json()}throw new Error(`Could not rename ${e.name}`)}),{onMutate:async t=>{updateCacheItem(n,e,t.file.id,(e=>Object.assign(e,{name:t.name})))},onSuccess:(t,i,r)=>{updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,t,{status:"ok"})))},onError(t,i,r){updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,{name:i.file.name})))}})}function useMutateFileTrash(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileTrash must be used within an WeavyProvider");const i=useMutation((async({file:e})=>{if(e.id>=1){return(await t.post("/api/files/"+e.id+"/trash","POST","")).json()}throw new Error(`Could not trash ${e.name}.`)}),{onMutate:async t=>{updateCacheItem(n,e,t.file.id,(e=>Object.assign(e,{is_trashed:!0,status:"pending"})))},onSuccess:(t,i,r)=>{updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,t,{status:"ok"})))},onError(t,i,r){updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,{is_trashed:!1,status:"error"})))}});return i}function useMutateFileRestore(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileRestore must be used within an WeavyProvider");const i=useMutation((async({file:e})=>{if(e.id>=1){const n=await t.post("/api/files/"+e.id+"/restore","POST","");if(!n.ok)throw await n.json();return n.json()}throw{status:400,title:`Could not restore ${e.name}.`}}),{onMutate:async t=>{updateCacheItem(n,e,t.file.id,(e=>Object.assign(e,{is_trashed:!1})))},onSuccess:(t,i,r)=>{updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,t,{status:"ok"})))},onError(t,i,r){updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,{is_trashed:!0})))}});return i}function useMutateFileDeleteForever(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileDeleteForever must be used within an WeavyProvider");return useMutation((async({file:e})=>{if(!(e.id>=1&&e.is_trashed))throw{status:400,title:`Could not delete ${e.name} forever.`};{const n=await t.post("/api/files/"+e.id,"DELETE","");if(!n.ok)throw await n.json()}}),{onMutate:async t=>{updateCacheItem(n,e,t.file.id,(e=>Object.assign(e,{status:"pending"})))},onSuccess:(t,i,r)=>{removeCacheItem(n,e,i.file.id)},onError(t,i,r){updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,{status:void 0})))}})}function useMutateFileSubscribe(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileSubscribe must be used within an WeavyProvider");const i=useMutation((async({file:e})=>{if(e.id>=1){const n=await t.post("/api/files/"+e.id+"/subscribe","POST","");if(!n.ok)throw await n.json();return n.json()}throw new Error(`Could not subscribe to ${e.name}.`)}),{onMutate:async t=>{updateCacheItem(n,e,t.file.id,(e=>Object.assign(e,{is_subscribed:!0,status:"pending"})))},onSuccess:(t,i,r)=>{updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,t,{status:"ok"})))},onError(t,i,r){updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,{is_subscribed:i.file.is_subscribed,status:"error"})))}});return i}function useMutateFileUnsubscribe(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileUnsubscribe must be used within an WeavyProvider");const i=useMutation((async({file:e})=>{if(e.id>=1){const n=await t.post("/api/files/"+e.id+"/unsubscribe","POST","");if(!n.ok)throw await n.json();return n.json()}throw new Error(`Could not unsubscribe to ${e.name}.`)}),{onMutate:async t=>{updateCacheItem(n,e,t.file.id,(e=>Object.assign(e,{is_subscribed:!1})))},onSuccess:(t,i,r)=>{updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,t,{status:"ok"})))},onError(t,i,r){updateCacheItem(n,e,i.file.id,(e=>Object.assign(e,{is_subscribed:i.file.is_subscribed})))}});return i}function useFileVersions(e,t,n){const{client:i}=React.useContext(WeavyContext);if(!i)throw new Error("useReactionList must be used within an WeavyProvider");return useQuery([...e,t,"versions"],(async()=>{const e=await i.get(`/api/files/${t}/versions`);return await e.json()}),n)}function useMutateFileVersionRestore(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileVersion must be used within an WeavyProvider");const i=useMutation((async({versionFile:e})=>{if(e.id>=1&&e.version){return(await t.post(`/api/files/${e.id}/versions/${e.version}/restore`,"POST","")).json()}throw new Error(`Could not restore ${e.name} to version ${e.version}.`)}),{onMutate:async t=>{var i;return updateCacheItem(n,e,t.versionFile.id,(e=>(i=e,Object.assign(e,t.versionFile,{status:"pending"})))),updateCacheItem(n,[...e,t.versionFile.id,"versions"],t.versionFile.id,(e=>(i=e,Object.assign(e,{status:"pending"})))),{versionFile:t.versionFile,previousFile:i}},onSuccess:(t,i,r)=>{updateCacheItem(n,e,i.versionFile.id,(e=>Object.assign(e,t,{status:"ok"}))),n.removeQueries([...e,i.versionFile.id,"versions"])},onError(t,i,r){updateCacheItem(n,e,i.versionFile.id,(e=>Object.assign(e,r.previousFile,{status:"error"}))),updateCacheItem(n,[...e,i.versionFile.id,"versions"],i.versionFile.id,(e=>Object.assign(e,{status:"error"})))}});return i}function useMutateFileVersionDelete(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateFileVersionRemove must be used within an WeavyProvider");return useMutation((async({versionFile:e})=>{if(!(e.id>=1&&e.version))throw{status:400,title:`Could not remove ${e.name} version ${e.version}.`};{const n=await t.post(`/api/files/${e.id}/versions/${e.version}`,"DELETE","");if(!n.ok)throw await n.json()}}),{onMutate:async t=>{updateCacheItem(n,[...e,t.versionFile.id,"versions"],(e=>e.id===t.versionFile.id&&e.version===t.versionFile.version),(e=>Object.assign(e,{status:"pending"})))},onSuccess:(t,i,r)=>{removeCacheItem(n,[...e,i.versionFile.id,"versions"],(e=>e.id===i.versionFile.id&&e.version===i.versionFile.version))},onError(t,i,r){updateCacheItem(n,[...e,i.versionFile.id,"versions"],(e=>e.id===i.versionFile.id&&e.version===i.versionFile.version),(e=>Object.assign(e,{status:void 0})))}})}const FileVersions=({filesKey:e,file:t,onVersionSelect:n})=>{const i=useFileVersions(e,t.id,{}),{isLoading:r,isError:s,data:o,error:a,isFetching:l}=i,c=useMutateFileVersionRestore(e),h=useMutateFileVersionDelete(e),[d,u]=React.useState();React.useEffect((()=>{u(t)}),[t,t.version]);const p=e=>{u(e),n&&n(e)},f=(e,t)=>{t.defaultPrevented||p(e)};return r?React.createElement(UISpinner.UI,{spin:!0,overlay:!0}):React.createElement("div",{className:"wy-list wy-versions",key:"file-versions"+t.id},o&&o.map(((e,n)=>{var i;let r=getIcon(e.name||"").icon,s=o.length-n,a=getExtension(e.name);const l=dayjs.utc(e.modified_at||e.created_at).tz(dayjs.tz.guess());return React.createElement("div",{key:"file-version"+e.version,className:classNames("wy-item wy-item-hover wy-item-lg",{"wy-active":e.version==(null==d?void 0:d.version)}),onClick:f.bind(FileVersions,e)},"error"===t.status?React.createElement(UIIcon.UI,{name:"alert-octagon",color:"error",size:48}):"conflict"===t.status?React.createElement(UIIcon.UI,{name:"alert",color:"yellow",size:48}):"pending"===t.status?React.createElement(UISpinner.UI,{spin:!e.progress,progress:e.progress,size:48}):React.createElement(UIIcon.UI,{name:r,size:48,className:classNames("wy-kind-"+toKebabCase(e.kind),"wy-ext-"+a.substring(1))}),React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},s,". ",e.name),React.createElement("div",{className:"wy-item-text"},React.createElement("time",{dateTime:e.modified_at||e.created_at,title:l.format("LLLL")},l.fromNow()),"  ",null===(i=e.modified_by)||void 0===i?void 0:i.display_name)),React.createElement(UIDropdown.UI,{directionX:"left"},React.createElement(UIDropdown.Item,{onClick:()=>triggerDownload(e)},React.createElement(UIIcon.UI,{name:"download"})," Download"),e.version!==t.version&&React.createElement(React.Fragment,null,React.createElement(UIDropdown.Divider,null),React.createElement(UIDropdown.Item,{onClick:()=>(e=>{console.debug("reverting file version",e.version),c.mutate({versionFile:e}),p(e)})(e)},React.createElement(UIIcon.UI,{name:"restore"})," Revert"),React.createElement(UIDropdown.Item,{onClick:()=>(e=>{console.debug("removing file version",e.version),h.mutate({versionFile:e}),d===e&&u(t)})(e)},React.createElement(UIIcon.UI,{name:"delete"})," Remove"))))})))};function allowedKeyTarget(e){return!e.target.matches("input, textarea, select")&&!e.target.closest('[contenteditable="true"]')}const PreviewFiles=({appId:e,infiniteFiles:t,previewId:n,features:i,appFeatures:r,onClose:s})=>{const{client:o}=React.useContext(WeavyContext),[a,l]=React.useState(!1),[c,h]=React.useState(!1),[d,u]=React.useState(!1),[p,f]=React.useState(!1),[m,g]=React.useState(),[O,y]=React.useState(),[v,b]=React.useState(),[w,S]=React.useState(),[x,C]=React.useState(),{isLoading:_,data:E,dataUpdatedAt:P,fetchNextPage:k,hasNextPage:T,isFetchingNextPage:A}=t;React.useEffect((()=>{d||c||f(!1),d||y(void 0)}),[d,c]),React.useEffect((()=>{y(void 0)}),[m]);const R=(e,t)=>{"comments"===e?(u(!1),h(void 0!==t?t:!c)):"versions"===e?(h(!1),u(void 0!==t?t:!d)):(h(!1),u(!1))};React.useEffect((()=>{v&&(_||(async()=>{var e,t;if(E&&E.pages.length>0){if(v>=1){const n=e=>{let t=-1;return E.pages.some((n=>{let i=n.data.findIndex((t=>t.id===e));return-1!==i&&(t=i+n.start),-1!==i})),t},i=async e=>{if(e>0||e<=E.pages[0].count){let t,n=E;if(e>E.pages[E.pages.length-1].end&&(T||A)){n=(await k({cancelRefetch:!1})).data,console.debug("preview nextpage was fetched")}return null==n||n.pages.find((n=>{if(e>=n.start&&e<=n.end)return t=n.data[e-n.start]})),t}};let r=n(v);C(null===(e=await i(r-1))||void 0===e?void 0:e.id),S(null===(t=await i(r+1))||void 0===t?void 0:t.id),g(await i(r))}else if(v>=0&&v<1){const e=e=>{let t;return E.pages.some((n=>t=n.data.find((t=>t.id===e)))),!t&&m&&E.pages.some((e=>t=e.data.find((e=>{if(e.name===m.name)return e.id!==v&&b(e.id),!0})))),t};C(void 0),S(void 0),g(e(v))}}else C(void 0),S(void 0),g(void 0)})())}),[_,E,P,v]);const M=()=>{l(!1),s&&s()};React.useEffect((()=>{n&&(e=>{b(e),l(!0)})(n)}),[n]);const I=O||m;React.useEffect((()=>{if(m){const e=e=>{a&&(27===e.which?(e.stopImmediatePropagation(),M()):37===e.which?allowedKeyTarget(e)&&(e.stopPropagation(),b(x)):39===e.which&&allowedKeyTarget(e)&&(e.stopPropagation(),b(w)))};return document.addEventListener("keyup",e),()=>{document.removeEventListener("keyup",e)}}}),[m,a]);let L=getExtension((null==I?void 0:I.name)||""),$=getIcon((null==I?void 0:I.name)||"").icon,D=(null==I?void 0:I.preview_url)||(null==I?void 0:I.download_url)||"";return"image"===(null==I?void 0:I.preview_format)&&(".gif"===L||".svg"===L)&&(D=(null==I?void 0:I.download_url)||""),React.createElement(React.Fragment,null,E&&React.createElement(UIOverlay.UI,{isOpen:a,className:"wy-dark",closeOnEsc:!1,onClose:()=>l(!1),style:{overlay:{zIndex:1e4}}},React.createElement("header",{className:"wy-appbars"},React.createElement("nav",{className:"wy-appbar"},React.createElement(UIButton.UI,{onClick:M},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("div",{className:classNames("wy-appbar-text",{"wy-appbar-text-trashed":null==m?void 0:m.is_trashed})},m&&React.createElement("span",null,m.name)),React.createElement("div",{className:"wy-appbar-buttons"},m&&React.createElement(React.Fragment,null,m.id>=1&&hasFeature(i,Feature.Comments,null==r?void 0:r.comments)&&React.createElement(UIButton.UI,{active:c,onClick:()=>R("comments"),title:"Comments"},React.createElement(UIIcon.ActiveStack,null,React.createElement(UIIcon.UI,{name:"comment-outline"}),React.createElement(UIIcon.UI,{name:"comment"}))),React.createElement(FileMenu,{file:m,features:i,appFeatures:r},m.id>=1&&hasFeature(i,Feature.Versions,null==r?void 0:r.versions)&&React.createElement(UIDropdown.Item,{active:d,onClick:()=>R("versions")},React.createElement(UIIcon.UI,{name:"backup-restore"})," Versions")))))),React.createElement("div",{className:"wy-main"},React.createElement(React.Fragment,null,React.createElement("aside",{id:"tab-comments",className:classNames("wy-sidebar",{"wy-active":c,"wy-maximized":p}),hidden:!c},React.createElement("nav",{className:"wy-item"},React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},"Comments")),React.createElement(UIButton.UI,{onClick:()=>R("comments",!1)},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("button",{onClick:()=>f(!p),className:"wy-sidebar-handle"})),React.createElement("div",{className:"wy-pane wy-scroll-y"},c&&m&&m.id>=1&&e&&React.createElement(Comments,{appId:e,parentId:m.id,type:"files",features:i,appFeatures:r}))),React.createElement("aside",{id:"tab-versions",className:classNames("wy-sidebar",{"wy-active":d,"wy-maximized":p}),hidden:!d},React.createElement("nav",{className:"wy-item"},React.createElement("div",{className:"wy-item-body"},React.createElement("div",{className:"wy-item-title"},"Versions")),React.createElement(UIButton.UI,{onClick:()=>R("versions",!1)},React.createElement(UIIcon.UI,{name:"close"})),React.createElement("button",{onClick:()=>f(!p),className:"wy-sidebar-handle"})),React.createElement("div",{className:"wy-pane wy-scroll-y"},React.createElement("div",{className:"wy-pane-body"},d&&m&&React.createElement(FileVersions,{key:"files-versions"+e+m.id,filesKey:["files",e],file:m,onVersionSelect:e=>{(null==m?void 0:m.version)!==e.version?y(e):y(void 0)}}))))),React.createElement("div",{className:"wy-preview"},I&&React.createElement(React.Fragment,null,x&&React.createElement("nav",{className:"wy-nav-prev"},React.createElement(UIButton.UI,{onClick:()=>{b(x)}},React.createElement(UIIcon.UI,{name:"previous"}))),w&&React.createElement("nav",{className:"wy-nav-next"},React.createElement(UIButton.UI,{onClick:()=>{b(w)}},React.createElement(UIIcon.UI,{name:"next"}))),React.createElement("div",{className:"wy-preview-area wy-scroll-y wy-scroll-x"},React.createElement(Preview,{client:o,src:D,link:I.external_url,format:I.is_trashed?"none":I.preview_format,name:I.name,icon:$,width:I.width,height:I.height,mediaType:I.media_type,provider:I.provider})))))))},FileList=({appId:e,view:t="list",order:n,trashed:i=!1,features:r,appFeatures:s,onSorting:o,onHandleError:a})=>{const l=useFileList(e,{meta:{order:n,trashed:i}}),{isLoading:c,data:h,fetchNextPage:d,hasNextPage:u,isFetchingNextPage:p,remove:f}=l,[m,g]=React.useState(),O=e=>{g(e)},y=()=>{g(void 0)};React.useEffect((()=>()=>f()),[]);const v=useInfinteScroll(l,[t]),b=useMutateFileRename(["files",e]),w=useMutateFileTrash(["files",e]),S=useMutateFileDeleteForever(["files",e]),x=useMutateFileRestore(["files",e]),C=useMutateFileSubscribe(["files",e]),_=useMutateFileUnsubscribe(["files",e]);if(c)return React.createElement(UISpinner.UI,{spin:!0,overlay:!0});let E=React.createElement(UIButton.UI,{onClick:()=>d(),disabled:!u||p,className:"wy-message-readmore"},"Load more");if("grid"==t)return React.createElement(React.Fragment,null,React.createElement("div",{className:"wy-grid wy-pane-group"},h&&h.pages&&h.pages.map(((e,t)=>{var n;return React.createElement(React.Fragment,{key:t},null===(n=e.data)||void 0===n?void 0:n.map((e=>React.createElement(FileItem$1.Card,{key:"file-card"+e.id,file:e,onClick:t=>!e.is_trashed&&O(e.id),onRename:t=>b.mutateAsync({file:e,name:t}),onSubscribe:e=>C.mutateAsync({file:e}),onUnsubscribe:e=>_.mutateAsync({file:e}),onTrash:e=>w.mutateAsync({file:e}),onRestore:e=>x.mutateAsync({file:e}),onDeleteForever:e=>S.mutateAsync({file:e}),onHandleError:a,features:r,appFeatures:s}))))})),React.createElement("div",{className:"wy-pager",ref:v},p?"Loading more...":u?E:"")),React.createElement(PreviewFiles,{appId:e,infiniteFiles:l,previewId:m,onClose:y,features:r,appFeatures:s}));const P=[{by:"name",title:"Name"},{by:"modified_at",title:"Modified"},{by:void 0,title:"Kind"},{by:"size",title:"Size"}];return React.createElement(React.Fragment,null,React.createElement("table",{className:"wy-table wy-table-hover wy-table-files"},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"wy-table-cell-icon"}),P.map((e=>{let t=e.by===(null==n?void 0:n.by);return React.createElement("th",{key:"files-header"+e.title},e.by?React.createElement("div",{className:"wy-table-sort-link",onClick:i=>{i.preventDefault(),e.by&&o&&o({by:e.by,descending:t&&!(null==n?void 0:n.descending)})}},e.title," ",t&&React.createElement(UIIcon.UI,{name:(null==n?void 0:n.descending)?"menu-down":"menu-up"})):React.createElement(React.Fragment,null,e.title))})),React.createElement("th",{className:"wy-table-cell-icon"}))),React.createElement("tbody",null,h&&h.pages&&h.pages.map(((e,t)=>{var n;return React.createElement(React.Fragment,{key:t},null===(n=e.data)||void 0===n?void 0:n.map((e=>React.createElement(FileItem$1.Row,{key:"file-row"+e.id,file:e,onClick:t=>!e.is_trashed&&O(e.id),onRename:t=>b.mutateAsync({file:e,name:t}),onSubscribe:e=>C.mutateAsync({file:e}),onUnsubscribe:e=>_.mutateAsync({file:e}),onTrash:e=>w.mutateAsync({file:e}),onRestore:e=>x.mutateAsync({file:e}),onDeleteForever:e=>S.mutateAsync({file:e}),onHandleError:a,features:r,appFeatures:s}))))})),React.createElement("tr",{className:"wy-pager",ref:v},React.createElement("td",{colSpan:6},p?"Loading more...":u?E:"")))),React.createElement(PreviewFiles,{appId:e,infiniteFiles:l,previewId:m,onClose:y,features:r,appFeatures:s}))},useMutateFilesCreate=e=>{const{client:t}=React.useContext(WeavyContext);if(!t)throw new Error("useMutateFile must be used within an WeavyProvider");return async({blob:n,replace:i=!1})=>{const r=await t.post("/api/apps/"+e+"/files","POST",JSON.stringify({blob_id:n.id,replace:i}));if(!r.ok)throw await r.json();return await r.json()}},prefix="wy-";function getSessionStorageOrDefault(e,t){const n=sessionStorage.getItem(prefix+e);return n?JSON.parse(n):t}function useSessionState(e,t){const[n,i]=React.useState(getSessionStorageOrDefault(e,t));return React.useEffect((()=>{sessionStorage.setItem(prefix+e,JSON.stringify(n))}),[e,n]),[n,i]}function useMutateAppsSubscribe(e){const{client:t}=React.useContext(WeavyContext),n=useQueryClient();if(!t)throw new Error("useMutateAppsSubscribe must be used within an WeavyProvider");const i=useMutation((async({appId:e,subscribe:n})=>{if(e>=1){const i=await t.post(`/api/apps/${e}/${n?"subscribe":"unsubscribe"}`,"POST","");if(!i.ok)throw await i.json();return i.json()}throw new Error(`Could not subscribe to app ${e}.`)}),{onMutate:async t=>{var i;return n.setQueryData(e,(e=>(i=e.is_subscribed,Object.assign(e,{is_subscribed:t.subscribe})))),{previousSubscribe:i,subscribe:t.subscribe}},onSuccess:(t,i,r)=>{n.setQueryData(e,(e=>Object.assign(e,t)),{updatedAt:Date.now()}),n.invalidateQueries({queryKey:e,exact:!0})},onError(t,i,r){n.setQueryData(e,(e=>Object.assign(e,{is_subscribed:r.previousSubscribe})))}});return i}const Files=({uid:e,className:t,view:n="list",order:i={by:"name",descending:!1},trashed:r=!1,features:s})=>{const{client:o}=React.useContext(WeavyContext),[a,l]=React.useState(),[c,h]=React.useState("");if(!o)throw new Error("Weavy Files component must be used within an WeavyProvider");const{isLoading:d,data:u}=useApp(e,{}),{isLoading:p,data:f}=useFeatures("files",{}),m=useMutateAppsSubscribe(["apps",e]),[g,O]=React.useState(!1),y=useMutateFilesCreate(a),v=useMutateFileUpload(["files",a],y),b=useMutateFileCreate(["files",a],y),{mutations:w,status:S,progress:x}=useMutatingFileUploads(["files",a]),C=useRemoveMutatingFileUpload(["files",a]);let _;const[E,P]=useSessionState(`files-view-${e}`,n),[k,T]=useSessionState(`files-order-${e}`,i),[A,R]=useSessionState(`files-trashed-${e}`,r);React.useEffect((()=>{l(u?u.id:void 0)}),[u]),React.useEffect((()=>{"error"!==S&&"conflict"!==S||O(!0),0===w.length&&O(!1)}),[S,w.length]);const{openCloudFiles:M}=useCloudFiles((e=>{e.forEach((e=>L(e)))})),I=e=>{a&&m.mutateAsync({appId:a,subscribe:e})},L=async(e,t,n)=>{let i={blob:e,file:t,replace:n};await b.mutateAsync(i,{onSuccess:e=>{}})},$=e=>{C(e)},D=e=>{var t,n;C(e);let i=null===(t=e.state.context)||void 0===t?void 0:t.blob;i&&L(i,null===(n=e.state.context)||void 0===n?void 0:n.file,!0)},N=React.useCallback((e=>{if(e.length>0){for(var t=0;t<e.length;t++){let n={file:e[t]};v.mutateAsync(n,{})}return!0}}),[]),{getRootProps:Q,rootRef:F,isDragActive:B}=useDropzone({onDrop:N,noClick:!0,noKeyboard:!0,disabled:!a}),j=e=>{console.debug("File(s) pasted");let t=[];const n=(e.clipboardData||e.originalEvent.clipboardData).items;for(let e in n){const i=n[e];"file"===i.kind&&(t=[...t,i.getAsFile()])}if(t.length)for(var i=0;i<t.length;i++){let e={file:t[i]};v.mutateAsync(e,{onSuccess:e=>{}})}},V=e=>{if(F.current){var t=e.target;do{F.current===t&&j(e)}while((t=t.parentNode)&&t!==e.currentTarget)}};return React.useEffect((()=>{if(a)return document.addEventListener("paste",V),()=>{document.removeEventListener("paste",V)}}),[a]),d||u?React.createElement(React.Fragment,null,a&&f&&React.createElement("div",Object.assign({className:classNames("wy-files",t,{"wy-files-dragging":B})},Q()),React.createElement("header",{className:"wy-appbars"},React.createElement("nav",{className:"wy-toolbar"},React.createElement("div",{className:"wy-toolbar-buttons"},React.createElement(UIDropdown.UI,{title:"Add files",disabled:!a,buttonContent:React.createElement(React.Fragment,null,React.createElement("span",null,"Add files"),React.createElement(UIIcon.UI,{name:"plus"}))},React.createElement(UIDropdown.Item,{onClick:e=>{null==_||_.click()}},React.createElement(UIIcon.UI,{name:"attachment"})," From device"),React.createElement("input",{type:"file",value:c,ref:e=>_=e,onChange:async e=>{if(e.target.files){for(var t=0;t<e.target.files.length;t++){let n={file:e.target.files[t]};v.mutateAsync(n,{onSuccess:e=>{}})}h("")}},multiple:!0,hidden:!0,tabIndex:-1}),hasFeature(f,Feature.CloudFiles,null==s?void 0:s.cloudFiles)&&React.createElement(UIDropdown.Item,{onClick:M},React.createElement(UIIcon.UI,{name:"cloud"})," From cloud"))),React.createElement("div",{className:"wy-toolbar-buttons wy-toolbar-buttons-last"},w.length>0&&React.createElement(UIButton.UI,{onClick:()=>O(!g)},"conflict"===S?React.createElement(UIIcon.UI,{name:"alert",color:"yellow",title:"File conflict"}):"error"===S?React.createElement(UIIcon.UI,{name:"alert-octagon",color:"error",title:"Upload error"}):"pending"===S?React.createElement(UISpinner.UI,{spin:void 0===x,progress:x}):React.createElement(UIIcon.UI,{name:"check",title:"All uploads finished"})),React.createElement(UISheet.UI,{title:"Uploads",isOpen:g,onClose:()=>O(!1)},w.map((e=>{var t;let n=null===(t=e.state.context)||void 0===t?void 0:t.file;if(n)return React.createElement(FileItem$1.Item,{key:"file-mutation"+e.mutationId,features:f,appFeatures:s,file:n,statusText:"conflict"===n.status?"Replace existing file?":"",title:n.name+(n.statusText?`: ${n.statusText}`:"")},React.createElement("div",{className:"wy-item-actions"},"conflict"===n.status&&React.createElement(React.Fragment,null,React.createElement(UIButton.UI,{onClick:D.bind(Files,e),title:"Replace"},React.createElement(UIIcon.UI,{name:"check"}))),React.createElement(UIButton.UI,{onClick:$.bind(Files,e),title:"Discard"},React.createElement(UIIcon.UI,{name:"close"}))))}))),React.createElement(UIDropdown.UI,{icon:"sort",title:"Sort items by",directionX:"left"},React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":"name"===k.by}),onClick:e=>T(Object.assign(Object.assign({},k),{by:"name"}))},React.createElement(UIIcon.UI,{name:"check"})," Name"),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":"modified_at"===k.by}),onClick:e=>T(Object.assign(Object.assign({},k),{by:"modified_at"}))},React.createElement(UIIcon.UI,{name:"check"})," Modified"),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":"size"===k.by}),onClick:e=>T(Object.assign(Object.assign({},k),{by:"size"}))},React.createElement(UIIcon.UI,{name:"check"})," Size"),React.createElement(UIDropdown.Divider,null),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":!k.descending}),onClick:e=>T(Object.assign(Object.assign({},k),{descending:!1}))},React.createElement(UIIcon.UI,{name:"check"})," Ascending"),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":k.descending}),onClick:e=>T(Object.assign(Object.assign({},k),{descending:!0}))},React.createElement(UIIcon.UI,{name:"check"})," Descending")),React.createElement(UIDropdown.UI,{icon:"grid"===E?"view-module-outline":"view-list-outline",title:"View options",directionX:"left"},React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":"list"===E}),onClick:e=>P("list")},React.createElement(UIIcon.UI,{name:"check"})," List view"),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":"grid"===E}),onClick:e=>P("grid")},React.createElement(UIIcon.UI,{name:"check"})," Grid view"),React.createElement(UIDropdown.Divider,null),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":!A}),onClick:e=>R(!1)},React.createElement(UIIcon.UI,{name:"check"})," Hide trashed"),React.createElement(UIDropdown.Item,{className:classNames("wy-option",{"wy-selected":A}),onClick:e=>R(!0)},React.createElement(UIIcon.UI,{name:"check"})," Show trashed")),React.createElement(UIDropdown.UI,{directionX:"left",disabled:d||!u},u&&React.createElement(React.Fragment,null,u.is_subscribed?React.createElement(UIDropdown.Item,{onClick:()=>I(!1)},React.createElement(UIIcon.UI,{name:"bell-off"})," Unsubscribe"):React.createElement(UIDropdown.Item,{onClick:()=>I(!0)},React.createElement(UIIcon.UI,{name:"bell"})," Subscribe"),u.archive_url&&React.createElement(UIDropdown.Item,{onClick:()=>openUrl(u.archive_url,"_top",`${e}.zip`,!0)},React.createElement(UIIcon.UI,{name:"download"})," Download files")))))),React.createElement(FileList,{appId:a,view:E,order:k,trashed:A,onSorting:e=>T(e),onHandleError:e=>O(!0),features:f,appFeatures:s}))):React.createElement("div",null,"No files app with the contextual id ",React.createElement("strong",null,e)," was found.")};exports.Button=UIButton,exports.Chat=Chat,exports.Conversation=Conversation$1,exports.ConversationBadge=ConversationBadge,exports.ConversationList=ConversationList,exports.Dropdown=UIDropdown,exports.Files=Files,exports.Icon=UIIcon,exports.Messenger=Messenger,exports.MessengerContext=MessengerContext,exports.MessengerProvider=MessengerProvider,exports.Overlay=UIOverlay,exports.Posts=Posts,exports.WeavyClient=WeavyClient,exports.WeavyContext=WeavyContext,exports.WeavyProvider=WeavyProvider;
//# sourceMappingURL=index.js.map
